<!doctype html>
<html lang="zh">
<head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <title>åŒ–å­¦ç»“æ„å¼è¯†åˆ«</title>
    <link rel="shortcut icon" href="favicon.ico"/>
    <!--    <link rel="stylesheet" href="https://cdn.bootcss.com/sweetalert/1.1.3/sweetalert.min.css"/>-->
    <!--    <script type="text/javascript" src="https://cdn.bootcss.com/sweetalert/1.1.3/sweetalert.min.js"></script>-->
    <!--    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.js"></script>-->
    <link rel="stylesheet" href="css/sweetalert.css"/>
    <script type="text/javascript" src="js/vendor/sweetalert.min.js"></script>
    <script type="text/javascript" src="js/vendor/jquery-1.10.2.min.js"></script>
    <link rel="stylesheet" href="css/ChemDoodleWeb.css" type="text/css">
    <script type="text/javascript" src="js/ChemDoodleWeb.js"></script>
    <link rel="stylesheet" href="js/uis/jquery-ui-1.11.4.css" type="text/css">
    <script type="text/javascript" src="js/uis/ChemDoodleWeb-uis.js"></script>
</head>
<style type="text/css">
    body > div {
        width: 80%;
        padding: .5em;
        margin: 0.5em auto;
    }

    .demo, .result {
        border: solid 1px #999;
        padding: 0.5em;
        margin: 1em 0 0 0;
        width: 100%;
    }

    .demo {
        width: 620px;
        height: 320px;
        overflow: auto;
    }

    .result > img {
        border: solid 1px #ccc;
        height: 50px;
    }

    .pastable {
        transition: box-shadow ease .3s;
    }

    .pastable:hover {
        box-shadow: 0 0 3px black;
    }

    .pastable.pastable-focus {
        box-shadow: 0 0 10px black;
    }

    .box {
        color: #bbb;
        padding: 10px;
    }
</style>

<script type="text/javascript" src="js/paste.js"></script>
<script type="text/javascript" src="js/img2mol_mark.js"></script>
<script type="text/javascript">
    $(function () {
        $('.demo-noninputable').pastableNonInputable();

        $('.demo').on('pasteImage', function (ev, data) {
            querySmiles(data.blob);
            $('.box').html('<img src="' + data.dataURL + '" style="max-height:300px; max-width:600px" alt=""> ');
            $('#debug').text('ç²˜è´´äº†å›¾ç‰‡: å®½' + data.width + ', é«˜ ' + data.height + ', å¤§å° ' + data.blob.size);
        }).on('pasteImageError', function (ev, data) {
            alert('Oops: ' + data.message);
            if (data.url) {
                alert('But we got its url anyway:' + data.url)
            }
        }).on('pasteText', function (ev, data) {
            // $('<div class="result"></div>').text('text: "' + data.text + '"').insertAfter(this);
            $('#debug').text('ç²˜è´´äº†æ–‡æœ¬: ' + data.text);
        });

        var imgContainer = document.getElementById("imgContainer");
        imgContainer.ondragover = function (e) {
            e.preventDefault();
            this.style.borderColor = 'red';
        };
        imgContainer.ondrop = function (e) {
            e.preventDefault();
            this.style.borderColor = 'black';
            if (e.dataTransfer.files.length > 1) {
                swal('æ‹–æ”¾æ–‡ä»¶è¿‡å¤š', 'ç›®å‰æ¯æ¬¡åªæ”¯æŒæ‹–æ”¾ä¸€å¼ å›¾ç‰‡', 'error');
                $('#debug').text('æ‹–æ”¾æ–‡ä»¶è¿‡å¤š');
            } else {
                var fileObj = e.dataTransfer.files[0];
                if (fileObj.type.indexOf('image') !== -1) {
                    $('#debug').text('æ‹–æ”¾äº†å›¾ç‰‡: "' + fileObj.name + '"  å¤§å°: ' + fileObj.size);
                    querySmiles(fileObj);
                    var blob = window.URL.createObjectURL(fileObj);
                    $('.box').html('<img src="' + blob + '" />'); // " style="max-height:300px; max-width:600px"

                } else {
                    $('#debug').text('æ‹–æ”¾äº†éå›¾ç‰‡æ–‡ä»¶: "' + fileObj.name + '"');
                    swal('æ‹–æ”¾äº†éå›¾ç‰‡æ–‡ä»¶', 'åªæ”¯æŒæ‹–æ”¾å›¾ç‰‡æ–‡ä»¶', 'error');
                }
            }
        };
    });
    // test
    let pyridineMolFile = 'Molecule Name\n  CHEMDOOD01011121543D 0   0.00000     0.00000     0\n[Insert Comment Here]\n  6  6  0  0  0  0  0  0  0  0  1 V2000\n    0.0000    1.0000    0.0000   N 0  0  0  0  0  0  0  0  0  0  0  0\n   -0.8660    0.5000    0.0000   C 0  0  0  0  0  0  0  0  0  0  0  0\n   -0.8660   -0.5000    0.0000   C 0  0  0  0  0  0  0  0  0  0  0  0\n    0.0000   -1.0000    0.0000   C 0  0  0  0  0  0  0  0  0  0  0  0\n    0.8660   -0.5000    0.0000   C 0  0  0  0  0  0  0  0  0  0  0  0\n    0.8660    0.5000    0.0000   C 0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  2  0  0  0  0\n  2  3  1  0  0  0  0\n  3  4  2  0  0  0  0\n  4  5  1  0  0  0  0\n  5  6  2  0  0  0  0\n  6  1  1  0  0  0  0\nM  END';
    let mol = ChemDoodle.readMOL(pyridineMolFile);
    let formula = {};
    for (let i = 0; i < mol.atoms.length; i++) {
        if (formula.hasOwnProperty(mol.atoms[i]['label'])) {
            formula[mol.atoms[i]['label']] += 1;
        } else {
            formula[mol.atoms[i]['label']] = 1;
        }
    }
</script>
<script type="application/javascript">
    $(document).ready
    {
        // ACS Document 1996
        ChemDoodle.DEFAULT_STYLES.bondLength_2D = 14.4;
        ChemDoodle.DEFAULT_STYLES.bonds_width_2D = .6;
        ChemDoodle.DEFAULT_STYLES.bonds_saturationWidthAbs_2D = 2.6;
        ChemDoodle.DEFAULT_STYLES.bonds_hashSpacing_2D = 2.5;
        ChemDoodle.DEFAULT_STYLES.atoms_font_size_2D = 10;
        ChemDoodle.DEFAULT_STYLES.atoms_font_families_2D = ['Helvetica', 'Arial', 'sans-serif'];
        ChemDoodle.DEFAULT_STYLES.atoms_displayTerminalCarbonLabels_2D = true;
        ChemDoodle.DEFAULT_STYLES.atoms_useJMOLColors = true;

        // changes the default JMol color of hydrogen to black so it appears on white backgrounds
        ChemDoodle.ELEMENT['H'].jmolColor = 'black';
        // darkens the default JMol color of sulfur so it appears on white backgrounds
        ChemDoodle.ELEMENT['S'].jmolColor = '#B9A130';
        // initializes the SketcherCanvas
        let sketcher = new ChemDoodle.SketcherCanvas('sketcher', 500, 300, {useServices: false, oneMolecule: false});
        // sets terminal carbon labels to display
        sketcher.styles.atoms_displayTerminalCarbonLabels_2D = true;
        // sets atom labels to be colored by JMol colors, which are easy to recognize
        sketcher.styles.atoms_useJMOLColors = true;
        // enables overlap clear widths, so that some depth is introduced to overlapping bonds
        sketcher.styles.bonds_clearOverlaps_2D = true;
        // sets the shape color to improve contrast when drawing figures
        sketcher.styles.shapes_color = 'c10000';
        // because we do not load any content, we need to repaint the sketcher, otherwise we would just see an empty area with the toolbar
        // however, you can instead use one of the Canvas.load... functions to pre-populate the canvas with content, then you don't need to call repaint
        sketcher.repaint();

        function redrawMolecular(molFile) {
            // let myCanvas = new ChemDoodle.ViewerCanvas('ChemDoodle', 150, 150);
            // let myCanvas = new ChemDoodle.SketcherCanvas('ChemDoodle', 500, 300, {'useServices': false});
            // let mol = ChemDoodle.readMOL(molFile);
            // myCanvas.loadMolecule(mol);

            let mol = ChemDoodle.readMOL(molFile);
            sketcher.loadMolecule(mol);
        }
    }
</script>
<body>

<div>
    <h1>åŒ–å­¦ç»“æ„å¼è¯†åˆ«å·¥å…· V0.0.0.0.3</h1>
    <div class="demo demo-noninputable pastable" id="imgContainer">
        <div class="box">
            <h3>ä½¿ç”¨æ–¹æ³•ï¼š</h3>
            <p>step.0 åœ¨ç”µè„‘ä¸Šä½¿ç”¨Chrome/Firefoxç­‰ç°ä»£æµè§ˆå™¨è®¿é—®æ­¤ç½‘é¡µ</p>
            <p>step.1 ä½¿ç”¨QQ/å¾®ä¿¡ç­‰æˆªå›¾è½¯ä»¶, æˆªå–æ–‡çŒ®ä¸­çš„ç»“æ„å¼</p>
            <p>step.2 å•å‡»æ­¤å¤„ï¼Œåœ¨æ­¤å¤„(Ctrl+V)ç²˜è´´æˆªå›¾</p>
            <p>step.3 å•å‡»æ–‡æœ¬æ¡†ä¸­çš„MOLæ–‡æœ¬(å•å‡»å³å¯, ä¼šè‡ªåŠ¨å¤åˆ¶)</p>
            <p>step.4 åœ¨KingDrawä¸­å³é”® é€‰æ‹©æ€§ç²˜è´´ > MOL V2000(æš‚æ— å¿«æ·é”®)</p>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; åœ¨ChemDrawä¸­å³é”® paste special > MOL TEXT
                (Alt+Shift+Ctrl+P)</p>
        </div>
    </div>
    <canvas id="sketcher"></canvas>
    <div style="background: #b3d4fc">
        <p><span id="debug"></span></p>
        <p><span id="smiles"></span></p>

    </div>
    <div id="introduce">
        <h4>Feature</h4>
        <ul type="circle">
            <li>è¯†åˆ«ç‡è¿˜è¡ŒğŸ˜‚</li>
            <li>é‡ç»˜ç»“æ„ä¸åŸå§‹ç»“æ„çš„æ’ç‰ˆåŸºæœ¬ä¿æŒä¸€è‡´</li>
            <li>æ”¯æŒå›¾ç‰‡æ–‡ä»¶æ‹–æ”¾</li>
            <li>è¯†åˆ«åˆ°ç»“æ„å¼æ—¶æœ‰çº¢æ¡†æ ‡è®°</li>
        </ul>
        <h4>Tips</h4>
        <ul type="circle">
            <li>æˆªå›¾å¿«æ·é”®: QQ(Ctrl+Alt+A), å¾®ä¿¡(Alt+A)</li>
            <li>åªæˆªå–ä¸€ä¸ªç»“æ„å¼æ—¶ï¼Œè¯†åˆ«å‡†ç¡®ç‡æœ€é«˜</li>
            <li>è¯†åˆ«å¤±è´¥æ—¶ï¼Œå°è¯•æ”¾å¤§æ–‡çŒ®åå†æˆªå›¾è¯†åˆ«</li>
            <li>å•å‡»æ–‡æœ¬æ¡†å³è‡ªåŠ¨å¤åˆ¶</li>
            <li>ä¼šè‡ªåŠ¨å¤åˆ¶ç¬¬ä¸€ä¸ªMOLåˆ°å‰ªåˆ‡æ¿</li>
            <li>ChemDrawä¸­Ctrl+Shift+Kå¿«é€Ÿæ ¼å¼åŒ–ç»“æ„å¼, å¯å¤šæ¬¡ä½¿ç”¨</li>
        </ul>
        <h4>Todo</h4>
        <ul type="circle">
            <li>åŠ ä¸ªç½‘é¡µç‰ˆçš„ç»“æ„å¼ç¼–è¾‘å™¨</li>
        </ul>
    </div>
</div>

</body>

</html>
