/*! MolView JavaScript Base libraries build on 2020-07-30 */

Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");function t(){}function n(){return r.apply(this instanceof t&&e?this:e,i.concat(Array.prototype.slice.call(arguments)))}var i=Array.prototype.slice.call(arguments,1),r=this;return t.prototype=this.prototype,n.prototype=new t,n}),function(e){for(var t,n,i={},r=function(){},o="memory".split(","),a="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",");t=o.pop();)e[t]=e[t]||i;for(;n=a.pop();)e[n]=e[n]||r}(this.console=this.console||{}),function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(T,e){function t(e,t){return t.toUpperCase()}var n=[],w=T.document,u=n.slice,m=n.concat,s=n.push,r=n.indexOf,i={},o=i.toString,p=i.hasOwnProperty,g={},C=function(e,t){return new C.fn.init(e,t)},a=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,l=/^-ms-/,c=/-([\da-z])/gi;function h(e){var t=!!e&&"length"in e&&e.length,n=C.type(e);return"function"!==n&&!C.isWindow(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}C.fn=C.prototype={jquery:"2.2.4",constructor:C,selector:"",length:0,toArray:function(){return u.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:u.call(this)},pushStack:function(e){var t=C.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e){return C.each(this,e)},map:function(n){return this.pushStack(C.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(u.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:n.sort,splice:n.splice},C.extend=C.fn.extend=function(){var e,t,n,i,r,o,a=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"==typeof a||C.isFunction(a)||(a={}),s===l&&(a=this,s--);s<l;s++)if(null!=(e=arguments[s]))for(t in e)n=a[t],a!==(i=e[t])&&(c&&i&&(C.isPlainObject(i)||(r=C.isArray(i)))?(o=r?(r=!1,n&&C.isArray(n)?n:[]):n&&C.isPlainObject(n)?n:{},a[t]=C.extend(c,o,i)):void 0!==i&&(a[t]=i));return a},C.extend({expando:"jQuery"+("2.2.4"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===C.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){var t=e&&e.toString();return!C.isArray(e)&&0<=t-parseFloat(t)+1},isPlainObject:function(e){var t;if("object"!==C.type(e)||e.nodeType||C.isWindow(e))return!1;if(e.constructor&&!p.call(e,"constructor")&&!p.call(e.constructor.prototype||{},"isPrototypeOf"))return!1;for(t in e);return void 0===t||p.call(e,t)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?i[o.call(e)]||"object":typeof e},globalEval:function(e){var t,n=eval;(e=C.trim(e))&&(1===e.indexOf("use strict")?((t=w.createElement("script")).text=e,w.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(l,"ms-").replace(c,t)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var n,i=0;if(h(e))for(n=e.length;i<n&&!1!==t.call(e[i],i,e[i]);i++);else for(i in e)if(!1===t.call(e[i],i,e[i]))break;return e},trim:function(e){return null==e?"":(e+"").replace(a,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(h(Object(e))?C.merge(n,"string"==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:r.call(t,e,n)},merge:function(e,t){for(var n=+t.length,i=0,r=e.length;i<n;i++)e[r++]=t[i];return e.length=r,e},grep:function(e,t,n){for(var i=[],r=0,o=e.length,a=!n;r<o;r++)!t(e[r],r)!=a&&i.push(e[r]);return i},map:function(e,t,n){var i,r,o=0,a=[];if(h(e))for(i=e.length;o<i;o++)null!=(r=t(e[o],o,n))&&a.push(r);else for(o in e)null!=(r=t(e[o],o,n))&&a.push(r);return m.apply([],a)},guid:1,proxy:function(e,t){var n,i,r;return"string"==typeof t&&(n=e[t],t=e,e=n),C.isFunction(e)?(i=u.call(arguments,2),(r=function(){return e.apply(t||this,i.concat(u.call(arguments)))}).guid=e.guid=e.guid||C.guid++,r):void 0},now:Date.now,support:g}),"function"==typeof Symbol&&(C.fn[Symbol.iterator]=n[Symbol.iterator]),C.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){i["[object "+t+"]"]=t.toLowerCase()});var f=function(n){function h(e,t,n){var i="0x"+t-65536;return i!=i||n?t:i<0?String.fromCharCode(65536+i):String.fromCharCode(i>>10|55296,1023&i|56320)}function r(){E()}var e,p,b,o,a,m,f,g,x,l,c,E,T,s,w,v,u,d,_,C="sizzle"+ +new Date,y=n.document,S=0,i=0,D=re(),R=re(),A=re(),M=function(e,t){return e===t&&(c=!0),0},L={}.hasOwnProperty,t=[],H=t.pop,F=t.push,P=t.push,N=t.slice,k=function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},I="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",O="[\\x20\\t\\r\\n\\f]",B="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",z="\\["+O+"*("+B+")(?:"+O+"*([*^$|!~]?=)"+O+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+B+"))|)"+O+"*\\]",j=":("+B+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+z+")*)|.*)\\)|)",U=new RegExp(O+"+","g"),V=new RegExp("^"+O+"+|((?:^|[^\\\\])(?:\\\\.)*)"+O+"+$","g"),W=new RegExp("^"+O+"*,"+O+"*"),G=new RegExp("^"+O+"*([>+~]|"+O+")"+O+"*"),q=new RegExp("="+O+"*([^\\]'\"]*?)"+O+"*\\]","g"),X=new RegExp(j),$=new RegExp("^"+B+"$"),Y={ID:new RegExp("^#("+B+")"),CLASS:new RegExp("^\\.("+B+")"),TAG:new RegExp("^("+B+"|[*])"),ATTR:new RegExp("^"+z),PSEUDO:new RegExp("^"+j),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+O+"*(even|odd|(([+-]|)(\\d*)n|)"+O+"*(?:([+-]|)"+O+"*(\\d+)|))"+O+"*\\)|)","i"),bool:new RegExp("^(?:"+I+")$","i"),needsContext:new RegExp("^"+O+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+O+"*((?:-\\d)?\\d*)"+O+"*\\)|)(?=[^-]|$)","i")},J=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=/'|\\/g,ne=new RegExp("\\\\([\\da-f]{1,6}"+O+"?|("+O+")|.)","ig");try{P.apply(t=N.call(y.childNodes),y.childNodes),t[y.childNodes.length].nodeType}catch(e){P={apply:t.length?function(e,t){F.apply(e,N.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}function ie(e,t,n,i){var r,o,a,s,l,c,u,h,f=t&&t.ownerDocument,d=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==d&&9!==d&&11!==d)return n;if(!i&&((t?t.ownerDocument||t:y)!==T&&E(t),t=t||T,w)){if(11!==d&&(c=K.exec(e)))if(r=c[1]){if(9===d){if(!(a=t.getElementById(r)))return n;if(a.id===r)return n.push(a),n}else if(f&&(a=f.getElementById(r))&&_(t,a)&&a.id===r)return n.push(a),n}else{if(c[2])return P.apply(n,t.getElementsByTagName(e)),n;if((r=c[3])&&p.getElementsByClassName&&t.getElementsByClassName)return P.apply(n,t.getElementsByClassName(r)),n}if(p.qsa&&!A[e+" "]&&(!v||!v.test(e))){if(1!==d)f=t,h=e;else if("object"!==t.nodeName.toLowerCase()){for((s=t.getAttribute("id"))?s=s.replace(te,"\\$&"):t.setAttribute("id",s=C),o=(u=m(e)).length,l=$.test(s)?"#"+s:"[id='"+s+"']";o--;)u[o]=l+" "+pe(u[o]);h=u.join(","),f=ee.test(e)&&fe(t.parentNode)||t}if(h)try{return P.apply(n,f.querySelectorAll(h)),n}catch(e){}finally{s===C&&t.removeAttribute("id")}}}return g(e.replace(V,"$1"),t,n,i)}function re(){var n=[];function i(e,t){return n.push(e+" ")>b.cacheLength&&delete i[n.shift()],i[e+" "]=t}return i}function oe(e){return e[C]=!0,e}function ae(e){var t=T.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function se(e,t){for(var n=e.split("|"),i=n.length;i--;)b.attrHandle[n[i]]=t}function le(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||1<<31)-(~e.sourceIndex||1<<31);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function ce(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ue(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}function he(a){return oe(function(o){return o=+o,oe(function(e,t){for(var n,i=a([],e.length,o),r=i.length;r--;)e[n=i[r]]&&(e[n]=!(t[n]=e[n]))})})}function fe(e){return e&&void 0!==e.getElementsByTagName&&e}for(e in p=ie.support={},a=ie.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},E=ie.setDocument=function(e){var t,n,i=e?e.ownerDocument||e:y;return i!==T&&9===i.nodeType&&i.documentElement&&(s=(T=i).documentElement,w=!a(T),(n=T.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",r,!1):n.attachEvent&&n.attachEvent("onunload",r)),p.attributes=ae(function(e){return e.className="i",!e.getAttribute("className")}),p.getElementsByTagName=ae(function(e){return e.appendChild(T.createComment("")),!e.getElementsByTagName("*").length}),p.getElementsByClassName=Q.test(T.getElementsByClassName),p.getById=ae(function(e){return s.appendChild(e).id=C,!T.getElementsByName||!T.getElementsByName(C).length}),p.getById?(b.find.ID=function(e,t){if(void 0!==t.getElementById&&w){var n=t.getElementById(e);return n?[n]:[]}},b.filter.ID=function(e){var t=e.replace(ne,h);return function(e){return e.getAttribute("id")===t}}):(delete b.find.ID,b.filter.ID=function(e){var n=e.replace(ne,h);return function(e){var t=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===n}}),b.find.TAG=p.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):p.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],r=0,o=t.getElementsByTagName(e);if("*"!==e)return o;for(;n=o[r++];)1===n.nodeType&&i.push(n);return i},b.find.CLASS=p.getElementsByClassName&&function(e,t){return void 0!==t.getElementsByClassName&&w?t.getElementsByClassName(e):void 0},u=[],v=[],(p.qsa=Q.test(T.querySelectorAll))&&(ae(function(e){s.appendChild(e).innerHTML="<a id='"+C+"'></a><select id='"+C+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]="+O+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||v.push("\\["+O+"*(?:value|"+I+")"),e.querySelectorAll("[id~="+C+"-]").length||v.push("~="),e.querySelectorAll(":checked").length||v.push(":checked"),e.querySelectorAll("a#"+C+"+*").length||v.push(".#.+[+~]")}),ae(function(e){var t=T.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&v.push("name"+O+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(p.matchesSelector=Q.test(d=s.matches||s.webkitMatchesSelector||s.mozMatchesSelector||s.oMatchesSelector||s.msMatchesSelector))&&ae(function(e){p.disconnectedMatch=d.call(e,"div"),d.call(e,"[s!='']:x"),u.push("!=",j)}),v=v.length&&new RegExp(v.join("|")),u=u.length&&new RegExp(u.join("|")),t=Q.test(s.compareDocumentPosition),_=t||Q.test(s.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},M=t?function(e,t){if(e===t)return c=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!p.sortDetached&&t.compareDocumentPosition(e)===n?e===T||e.ownerDocument===y&&_(y,e)?-1:t===T||t.ownerDocument===y&&_(y,t)?1:l?k(l,e)-k(l,t):0:4&n?-1:1)}:function(e,t){if(e===t)return c=!0,0;var n,i=0,r=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!r||!o)return e===T?-1:t===T?1:r?-1:o?1:l?k(l,e)-k(l,t):0;if(r===o)return le(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)s.unshift(n);for(;a[i]===s[i];)i++;return i?le(a[i],s[i]):a[i]===y?-1:s[i]===y?1:0}),T},ie.matches=function(e,t){return ie(e,null,null,t)},ie.matchesSelector=function(e,t){if((e.ownerDocument||e)!==T&&E(e),t=t.replace(q,"='$1']"),p.matchesSelector&&w&&!A[t+" "]&&(!u||!u.test(t))&&(!v||!v.test(t)))try{var n=d.call(e,t);if(n||p.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return 0<ie(t,T,null,[e]).length},ie.contains=function(e,t){return(e.ownerDocument||e)!==T&&E(e),_(e,t)},ie.attr=function(e,t){(e.ownerDocument||e)!==T&&E(e);var n=b.attrHandle[t.toLowerCase()],i=n&&L.call(b.attrHandle,t.toLowerCase())?n(e,t,!w):void 0;return void 0!==i?i:p.attributes||!w?e.getAttribute(t):(i=e.getAttributeNode(t))&&i.specified?i.value:null},ie.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ie.uniqueSort=function(e){var t,n=[],i=0,r=0;if(c=!p.detectDuplicates,l=!p.sortStable&&e.slice(0),e.sort(M),c){for(;t=e[r++];)t===e[r]&&(i=n.push(r));for(;i--;)e.splice(n[i],1)}return l=null,e},o=ie.getText=function(e){var t,n="",i=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[i++];)n+=o(t);return n},(b=ie.selectors={cacheLength:50,createPseudo:oe,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ne,h),e[3]=(e[3]||e[4]||e[5]||"").replace(ne,h),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ie.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ie.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return Y.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=m(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ne,h).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=D[e+" "];return t||(t=new RegExp("(^|"+O+")"+e+"("+O+"|$)"))&&D(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(n,i,r){return function(e){var t=ie.attr(e,n);return null==t?"!="===i:!i||(t+="","="===i?t===r:"!="===i?t!==r:"^="===i?r&&0===t.indexOf(r):"*="===i?r&&-1<t.indexOf(r):"$="===i?r&&t.slice(-r.length)===r:"~="===i?-1<(" "+t.replace(U," ")+" ").indexOf(r):"|="===i&&(t===r||t.slice(0,r.length+1)===r+"-"))}},CHILD:function(p,e,t,m,g){var v="nth"!==p.slice(0,3),_="last"!==p.slice(-4),y="of-type"===e;return 1===m&&0===g?function(e){return!!e.parentNode}:function(e,t,n){var i,r,o,a,s,l,c=v!=_?"nextSibling":"previousSibling",u=e.parentNode,h=y&&e.nodeName.toLowerCase(),f=!n&&!y,d=!1;if(u){if(v){for(;c;){for(a=e;a=a[c];)if(y?a.nodeName.toLowerCase()===h:1===a.nodeType)return!1;l=c="only"===p&&!l&&"nextSibling"}return!0}if(l=[_?u.firstChild:u.lastChild],_&&f){for(d=(s=(i=(r=(o=(a=u)[C]||(a[C]={}))[a.uniqueID]||(o[a.uniqueID]={}))[p]||[])[0]===S&&i[1])&&i[2],a=s&&u.childNodes[s];a=++s&&a&&a[c]||(d=s=0)||l.pop();)if(1===a.nodeType&&++d&&a===e){r[p]=[S,s,d];break}}else if(f&&(d=s=(i=(r=(o=(a=e)[C]||(a[C]={}))[a.uniqueID]||(o[a.uniqueID]={}))[p]||[])[0]===S&&i[1]),!1===d)for(;(a=++s&&a&&a[c]||(d=s=0)||l.pop())&&((y?a.nodeName.toLowerCase()!==h:1!==a.nodeType)||!++d||(f&&((r=(o=a[C]||(a[C]={}))[a.uniqueID]||(o[a.uniqueID]={}))[p]=[S,d]),a!==e)););return(d-=g)===m||d%m==0&&0<=d/m}}},PSEUDO:function(e,o){var t,a=b.pseudos[e]||b.setFilters[e.toLowerCase()]||ie.error("unsupported pseudo: "+e);return a[C]?a(o):1<a.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?oe(function(e,t){for(var n,i=a(e,o),r=i.length;r--;)e[n=k(e,i[r])]=!(t[n]=i[r])}):function(e){return a(e,0,t)}):a}},pseudos:{not:oe(function(e){var i=[],r=[],s=f(e.replace(V,"$1"));return s[C]?oe(function(e,t,n,i){for(var r,o=s(e,null,i,[]),a=e.length;a--;)(r=o[a])&&(e[a]=!(t[a]=r))}):function(e,t,n){return i[0]=e,s(i,null,n,r),i[0]=null,!r.pop()}}),has:oe(function(t){return function(e){return 0<ie(t,e).length}}),contains:oe(function(t){return t=t.replace(ne,h),function(e){return-1<(e.textContent||e.innerText||o(e)).indexOf(t)}}),lang:oe(function(n){return $.test(n||"")||ie.error("unsupported lang: "+n),n=n.replace(ne,h).toLowerCase(),function(e){var t;do{if(t=w?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===s},focus:function(e){return e===T.activeElement&&(!T.hasFocus||T.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return Z.test(e.nodeName)},input:function(e){return J.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:he(function(){return[0]}),last:he(function(e,t){return[t-1]}),eq:he(function(e,t,n){return[n<0?n+t:n]}),even:he(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:he(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:he(function(e,t,n){for(var i=n<0?n+t:n;0<=--i;)e.push(i);return e}),gt:he(function(e,t,n){for(var i=n<0?n+t:n;++i<t;)e.push(i);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=ce(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=ue(e);function de(){}function pe(e){for(var t=0,n=e.length,i="";t<n;t++)i+=e[t].value;return i}function me(s,e,t){var l=e.dir,c=t&&"parentNode"===l,u=i++;return e.first?function(e,t,n){for(;e=e[l];)if(1===e.nodeType||c)return s(e,t,n)}:function(e,t,n){var i,r,o,a=[S,u];if(n){for(;e=e[l];)if((1===e.nodeType||c)&&s(e,t,n))return!0}else for(;e=e[l];)if(1===e.nodeType||c){if((i=(r=(o=e[C]||(e[C]={}))[e.uniqueID]||(o[e.uniqueID]={}))[l])&&i[0]===S&&i[1]===u)return a[2]=i[2];if((r[l]=a)[2]=s(e,t,n))return!0}}}function ge(r){return 1<r.length?function(e,t,n){for(var i=r.length;i--;)if(!r[i](e,t,n))return!1;return!0}:r[0]}function ve(e,t,n,i,r){for(var o,a=[],s=0,l=e.length,c=null!=t;s<l;s++)(o=e[s])&&(n&&!n(o,i,r)||(a.push(o),c&&t.push(s)));return a}function _e(d,p,m,g,v,e){return g&&!g[C]&&(g=_e(g)),v&&!v[C]&&(v=_e(v,e)),oe(function(e,t,n,i){var r,o,a,s=[],l=[],c=t.length,u=e||function(e,t,n){for(var i=0,r=t.length;i<r;i++)ie(e,t[i],n);return n}(p||"*",n.nodeType?[n]:n,[]),h=!d||!e&&p?u:ve(u,s,d,n,i),f=m?v||(e?d:c||g)?[]:t:h;if(m&&m(h,f,n,i),g)for(r=ve(f,l),g(r,[],n,i),o=r.length;o--;)(a=r[o])&&(f[l[o]]=!(h[l[o]]=a));if(e){if(v||d){if(v){for(r=[],o=f.length;o--;)(a=f[o])&&r.push(h[o]=a);v(null,f=[],r,i)}for(o=f.length;o--;)(a=f[o])&&-1<(r=v?k(e,a):s[o])&&(e[r]=!(t[r]=a))}}else f=ve(f===t?f.splice(c,f.length):f),v?v(null,t,f,i):P.apply(t,f)})}function ye(e){for(var r,t,n,i=e.length,o=b.relative[e[0].type],a=o||b.relative[" "],s=o?1:0,l=me(function(e){return e===r},a,!0),c=me(function(e){return-1<k(r,e)},a,!0),u=[function(e,t,n){var i=!o&&(n||t!==x)||((r=t).nodeType?l:c)(e,t,n);return r=null,i}];s<i;s++)if(t=b.relative[e[s].type])u=[me(ge(u),t)];else{if((t=b.filter[e[s].type].apply(null,e[s].matches))[C]){for(n=++s;n<i&&!b.relative[e[n].type];n++);return _e(1<s&&ge(u),1<s&&pe(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(V,"$1"),t,s<n&&ye(e.slice(s,n)),n<i&&ye(e=e.slice(n)),n<i&&pe(e))}u.push(t)}return ge(u)}function be(g,v){function e(e,t,n,i,r){var o,a,s,l=0,c="0",u=e&&[],h=[],f=x,d=e||y&&b.find.TAG("*",r),p=S+=null==f?1:Math.random()||.1,m=d.length;for(r&&(x=t===T||t||r);c!==m&&null!=(o=d[c]);c++){if(y&&o){for(a=0,t||o.ownerDocument===T||(E(o),n=!w);s=g[a++];)if(s(o,t||T,n)){i.push(o);break}r&&(S=p)}_&&((o=!s&&o)&&l--,e&&u.push(o))}if(l+=c,_&&c!==l){for(a=0;s=v[a++];)s(u,h,t,n);if(e){if(0<l)for(;c--;)u[c]||h[c]||(h[c]=H.call(i));h=ve(h)}P.apply(i,h),r&&!e&&0<h.length&&1<l+v.length&&ie.uniqueSort(i)}return r&&(S=p,x=f),u}var _=0<v.length,y=0<g.length;return _?oe(e):e}return de.prototype=b.filters=b.pseudos,b.setFilters=new de,m=ie.tokenize=function(e,t){var n,i,r,o,a,s,l,c=R[e+" "];if(c)return t?0:c.slice(0);for(a=e,s=[],l=b.preFilter;a;){for(o in n&&!(i=W.exec(a))||(i&&(a=a.slice(i[0].length)||a),s.push(r=[])),n=!1,(i=G.exec(a))&&(n=i.shift(),r.push({value:n,type:i[0].replace(V," ")}),a=a.slice(n.length)),b.filter)!(i=Y[o].exec(a))||l[o]&&!(i=l[o](i))||(n=i.shift(),r.push({value:n,type:o,matches:i}),a=a.slice(n.length));if(!n)break}return t?a.length:a?ie.error(e):R(e,s).slice(0)},f=ie.compile=function(e,t){var n,i=[],r=[],o=A[e+" "];if(!o){for(n=(t=t||m(e)).length;n--;)(o=ye(t[n]))[C]?i.push(o):r.push(o);(o=A(e,be(r,i))).selector=e}return o},g=ie.select=function(e,t,n,i){var r,o,a,s,l,c="function"==typeof e&&e,u=!i&&m(e=c.selector||e);if(n=n||[],1===u.length){if(2<(o=u[0]=u[0].slice(0)).length&&"ID"===(a=o[0]).type&&p.getById&&9===t.nodeType&&w&&b.relative[o[1].type]){if(!(t=(b.find.ID(a.matches[0].replace(ne,h),t)||[])[0]))return n;c&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(r=Y.needsContext.test(e)?0:o.length;r--&&(a=o[r],!b.relative[s=a.type]);)if((l=b.find[s])&&(i=l(a.matches[0].replace(ne,h),ee.test(o[0].type)&&fe(t.parentNode)||t))){if(o.splice(r,1),!(e=i.length&&pe(o)))return P.apply(n,i),n;break}}return(c||f(e,u))(i,t,!w,n,!t||ee.test(e)&&fe(t.parentNode)||t),n},p.sortStable=C.split("").sort(M).join("")===C,p.detectDuplicates=!!c,E(),p.sortDetached=ae(function(e){return 1&e.compareDocumentPosition(T.createElement("div"))}),ae(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||se("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),p.attributes&&ae(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||se("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),ae(function(e){return null==e.getAttribute("disabled")})||se(I,function(e,t,n){var i;return n?void 0:!0===e[t]?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),ie}(T);C.find=f,C.expr=f.selectors,C.expr[":"]=C.expr.pseudos,C.uniqueSort=C.unique=f.uniqueSort,C.text=f.getText,C.isXMLDoc=f.isXML,C.contains=f.contains;function d(e,t,n){for(var i=[],r=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&C(e).is(n))break;i.push(e)}return i}function v(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}var _=C.expr.match.needsContext,y=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,b=/^.[^:#\[\.,]*$/;function x(e,n,i){if(C.isFunction(n))return C.grep(e,function(e,t){return!!n.call(e,t,e)!==i});if(n.nodeType)return C.grep(e,function(e){return e===n!==i});if("string"==typeof n){if(b.test(n))return C.filter(n,e,i);n=C.filter(n,e)}return C.grep(e,function(e){return-1<r.call(n,e)!==i})}C.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?C.find.matchesSelector(i,e)?[i]:[]:C.find.matches(e,C.grep(t,function(e){return 1===e.nodeType}))},C.fn.extend({find:function(e){var t,n=this.length,i=[],r=this;if("string"!=typeof e)return this.pushStack(C(e).filter(function(){for(t=0;t<n;t++)if(C.contains(r[t],this))return!0}));for(t=0;t<n;t++)C.find(e,r[t],i);return(i=this.pushStack(1<n?C.unique(i):i)).selector=this.selector?this.selector+" "+e:e,i},filter:function(e){return this.pushStack(x(this,e||[],!1))},not:function(e){return this.pushStack(x(this,e||[],!0))},is:function(e){return!!x(this,"string"==typeof e&&_.test(e)?C(e):e||[],!1).length}});var E,S=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(C.fn.init=function(e,t,n){var i,r;if(!e)return this;if(n=n||E,"string"!=typeof e)return e.nodeType?(this.context=this[0]=e,this.length=1,this):C.isFunction(e)?void 0!==n.ready?n.ready(e):e(C):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),C.makeArray(e,this));if(!(i="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:S.exec(e))||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof C?t[0]:t,C.merge(this,C.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:w,!0)),y.test(i[1])&&C.isPlainObject(t))for(i in t)C.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return(r=w.getElementById(i[2]))&&r.parentNode&&(this.length=1,this[0]=r),this.context=w,this.selector=e,this}).prototype=C.fn,E=C(w);var D=/^(?:parents|prev(?:Until|All))/,R={children:!0,contents:!0,next:!0,prev:!0};function A(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}C.fn.extend({has:function(e){var t=C(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(C.contains(this,t[e]))return!0})},closest:function(e,t){for(var n,i=0,r=this.length,o=[],a=_.test(e)||"string"!=typeof e?C(e,t||this.context):0;i<r;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&C.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?C.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?r.call(C(e),this[0]):r.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(C.uniqueSort(C.merge(this.get(),C(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),C.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return d(e,"parentNode")},parentsUntil:function(e,t,n){return d(e,"parentNode",n)},next:function(e){return A(e,"nextSibling")},prev:function(e){return A(e,"previousSibling")},nextAll:function(e){return d(e,"nextSibling")},prevAll:function(e){return d(e,"previousSibling")},nextUntil:function(e,t,n){return d(e,"nextSibling",n)},prevUntil:function(e,t,n){return d(e,"previousSibling",n)},siblings:function(e){return v((e.parentNode||{}).firstChild,e)},children:function(e){return v(e.firstChild)},contents:function(e){return e.contentDocument||C.merge([],e.childNodes)}},function(i,r){C.fn[i]=function(e,t){var n=C.map(this,r,e);return"Until"!==i.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=C.filter(t,n)),1<this.length&&(R[i]||C.uniqueSort(n),D.test(i)&&n.reverse()),this.pushStack(n)}});var M,L=/\S+/g;function H(){w.removeEventListener("DOMContentLoaded",H),T.removeEventListener("load",H),C.ready()}C.Callbacks=function(i){var e,n;i="string"==typeof i?(e=i,n={},C.each(e.match(L)||[],function(e,t){n[t]=!0}),n):C.extend({},i);function r(){for(s=i.once,a=o=!0;c.length;u=-1)for(t=c.shift();++u<l.length;)!1===l[u].apply(t[0],t[1])&&i.stopOnFalse&&(u=l.length,t=!1);i.memory||(t=!1),o=!1,s&&(l=t?[]:"")}var o,t,a,s,l=[],c=[],u=-1,h={add:function(){return l&&(t&&!o&&(u=l.length-1,c.push(t)),function n(e){C.each(e,function(e,t){C.isFunction(t)?i.unique&&h.has(t)||l.push(t):t&&t.length&&"string"!==C.type(t)&&n(t)})}(arguments),t&&!o&&r()),this},remove:function(){return C.each(arguments,function(e,t){for(var n;-1<(n=C.inArray(t,l,n));)l.splice(n,1),n<=u&&u--}),this},has:function(e){return e?-1<C.inArray(e,l):0<l.length},empty:function(){return l=l&&[],this},disable:function(){return s=c=[],l=t="",this},disabled:function(){return!l},lock:function(){return s=c=[],t||(l=t=""),this},locked:function(){return!!s},fireWith:function(e,t){return s||(t=[e,(t=t||[]).slice?t.slice():t],c.push(t),o||r()),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!a}};return h},C.extend({Deferred:function(e){var o=[["resolve","done",C.Callbacks("once memory"),"resolved"],["reject","fail",C.Callbacks("once memory"),"rejected"],["notify","progress",C.Callbacks("memory")]],r="pending",a={state:function(){return r},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var r=arguments;return C.Deferred(function(i){C.each(o,function(e,t){var n=C.isFunction(r[e])&&r[e];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&C.isFunction(e.promise)?e.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[t[0]+"With"](this===a?i.promise():this,n?[e]:arguments)})}),r=null}).promise()},promise:function(e){return null!=e?C.extend(e,a):a}},s={};return a.pipe=a.then,C.each(o,function(e,t){var n=t[2],i=t[3];a[t[1]]=n.add,i&&n.add(function(){r=i},o[1^e][2].disable,o[2][2].lock),s[t[0]]=function(){return s[t[0]+"With"](this===s?a:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){function t(t,n,i){return function(e){n[t]=this,i[t]=1<arguments.length?u.call(arguments):e,i===r?c.notifyWith(n,i):--l||c.resolveWith(n,i)}}var r,n,i,o=0,a=u.call(arguments),s=a.length,l=1!==s||e&&C.isFunction(e.promise)?s:0,c=1===l?e:C.Deferred();if(1<s)for(r=new Array(s),n=new Array(s),i=new Array(s);o<s;o++)a[o]&&C.isFunction(a[o].promise)?a[o].promise().progress(t(o,n,r)).done(t(o,i,a)).fail(c.reject):--l;return l||c.resolveWith(i,a),c.promise()}}),C.fn.ready=function(e){return C.ready.promise().done(e),this},C.extend({isReady:!1,readyWait:1,holdReady:function(e){e?C.readyWait++:C.ready(!0)},ready:function(e){(!0===e?--C.readyWait:C.isReady)||((C.isReady=!0)!==e&&0<--C.readyWait||(M.resolveWith(w,[C]),C.fn.triggerHandler&&(C(w).triggerHandler("ready"),C(w).off("ready"))))}}),C.ready.promise=function(e){return M||(M=C.Deferred(),"complete"===w.readyState||"loading"!==w.readyState&&!w.documentElement.doScroll?T.setTimeout(C.ready):(w.addEventListener("DOMContentLoaded",H),T.addEventListener("load",H))),M.promise(e)},C.ready.promise();function F(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType}var P=function(e,t,n,i,r,o,a){var s=0,l=e.length,c=null==n;if("object"===C.type(n))for(s in r=!0,n)P(e,t,s,n[s],!0,o,a);else if(void 0!==i&&(r=!0,C.isFunction(i)||(a=!0),c&&(t=a?(t.call(e,i),null):(c=t,function(e,t,n){return c.call(C(e),n)})),t))for(;s<l;s++)t(e[s],n,a?i:i.call(e[s],s,t(e[s],n)));return r?e:c?t.call(e):l?t(e[0],n):o};function N(){this.expando=C.expando+N.uid++}N.uid=1,N.prototype={register:function(e,t){var n=t||{};return e.nodeType?e[this.expando]=n:Object.defineProperty(e,this.expando,{value:n,writable:!0,configurable:!0}),e[this.expando]},cache:function(e){if(!F(e))return{};var t=e[this.expando];return t||(t={},F(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var i,r=this.cache(e);if("string"==typeof t)r[t]=n;else for(i in t)r[i]=t[i];return r},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][t]},access:function(e,t,n){var i;return void 0===t||t&&"string"==typeof t&&void 0===n?void 0!==(i=this.get(e,t))?i:this.get(e,C.camelCase(t)):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,i,r,o=e[this.expando];if(void 0!==o){if(void 0===t)this.register(e);else{n=(i=C.isArray(t)?t.concat(t.map(C.camelCase)):(r=C.camelCase(t),t in o?[t,r]:(i=r)in o?[i]:i.match(L)||[])).length;for(;n--;)delete o[i[n]]}void 0!==t&&!C.isEmptyObject(o)||(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!C.isEmptyObject(t)}};var k=new N,I=new N,O=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,B=/[A-Z]/g;function z(e,t,n){var i;if(void 0===n&&1===e.nodeType)if(i="data-"+t.replace(B,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(i))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:O.test(n)?C.parseJSON(n):n)}catch(e){}I.set(e,t,n)}else n=void 0;return n}C.extend({hasData:function(e){return I.hasData(e)||k.hasData(e)},data:function(e,t,n){return I.access(e,t,n)},removeData:function(e,t){I.remove(e,t)},_data:function(e,t,n){return k.access(e,t,n)},_removeData:function(e,t){k.remove(e,t)}}),C.fn.extend({data:function(i,e){var t,n,r,o=this[0],a=o&&o.attributes;if(void 0!==i)return"object"==typeof i?this.each(function(){I.set(this,i)}):P(this,function(t){var e,n;if(o&&void 0===t){if(void 0!==(e=I.get(o,i)||I.get(o,i.replace(B,"-$&").toLowerCase())))return e;if(n=C.camelCase(i),void 0!==(e=I.get(o,n)))return e;if(void 0!==(e=z(o,n,void 0)))return e}else n=C.camelCase(i),this.each(function(){var e=I.get(this,n);I.set(this,n,t),-1<i.indexOf("-")&&void 0!==e&&I.set(this,i,t)})},null,e,1<arguments.length,null,!0);if(this.length&&(r=I.get(o),1===o.nodeType&&!k.get(o,"hasDataAttrs"))){for(t=a.length;t--;)a[t]&&(0===(n=a[t].name).indexOf("data-")&&(n=C.camelCase(n.slice(5)),z(o,n,r[n])));k.set(o,"hasDataAttrs",!0)}return r},removeData:function(e){return this.each(function(){I.remove(this,e)})}}),C.extend({queue:function(e,t,n){var i;return e?(t=(t||"fx")+"queue",i=k.get(e,t),n&&(!i||C.isArray(n)?i=k.access(e,t,C.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=C.queue(e,t),i=n.length,r=n.shift(),o=C._queueHooks(e,t);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===t&&n.unshift("inprogress"),delete o.stop,r.call(e,function(){C.dequeue(e,t)},o)),!i&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return k.get(e,n)||k.access(e,n,{empty:C.Callbacks("once memory").add(function(){k.remove(e,[t+"queue",n])})})}}),C.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?C.queue(this[0],t):void 0===n?this:this.each(function(){var e=C.queue(this,t,n);C._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&C.dequeue(this,t)})},dequeue:function(e){return this.each(function(){C.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){function n(){--r||o.resolveWith(a,[a])}var i,r=1,o=C.Deferred(),a=this,s=this.length;for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)(i=k.get(a[s],e+"queueHooks"))&&i.empty&&(r++,i.empty.add(n));return n(),o.promise(t)}});function j(e,t){return e=t||e,"none"===C.css(e,"display")||!C.contains(e.ownerDocument,e)}var U=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,V=new RegExp("^(?:([+-])=|)("+U+")([a-z%]*)$","i"),W=["Top","Right","Bottom","Left"];function G(e,t,n,i){var r,o=1,a=20,s=i?function(){return i.cur()}:function(){return C.css(e,t,"")},l=s(),c=n&&n[3]||(C.cssNumber[t]?"":"px"),u=(C.cssNumber[t]||"px"!==c&&+l)&&V.exec(C.css(e,t));if(u&&u[3]!==c)for(c=c||u[3],n=n||[],u=+l||1;u/=o=o||".5",C.style(e,t,u+c),o!==(o=s()/l)&&1!==o&&--a;);return n&&(u=+u||+l||0,r=n[1]?u+(n[1]+1)*n[2]:+n[2],i&&(i.unit=c,i.start=u,i.end=r)),r}var q=/^(?:checkbox|radio)$/i,X=/<([\w:-]+)/,$=/^$|\/(?:java|ecma)script/i,Y={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function J(e,t){var n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&C.nodeName(e,t)?C.merge([e],n):n}function Z(e,t){for(var n=0,i=e.length;n<i;n++)k.set(e[n],"globalEval",!t||k.get(t[n],"globalEval"))}Y.optgroup=Y.option,Y.tbody=Y.tfoot=Y.colgroup=Y.caption=Y.thead,Y.th=Y.td;var Q,K,ee=/<|&#?\w+;/;function te(e,t,n,i,r){for(var o,a,s,l,c,u,h=t.createDocumentFragment(),f=[],d=0,p=e.length;d<p;d++)if((o=e[d])||0===o)if("object"===C.type(o))C.merge(f,o.nodeType?[o]:o);else if(ee.test(o)){for(a=a||h.appendChild(t.createElement("div")),s=(X.exec(o)||["",""])[1].toLowerCase(),l=Y[s]||Y._default,a.innerHTML=l[1]+C.htmlPrefilter(o)+l[2],u=l[0];u--;)a=a.lastChild;C.merge(f,a.childNodes),(a=h.firstChild).textContent=""}else f.push(t.createTextNode(o));for(h.textContent="",d=0;o=f[d++];)if(i&&-1<C.inArray(o,i))r&&r.push(o);else if(c=C.contains(o.ownerDocument,o),a=J(h.appendChild(o),"script"),c&&Z(a),n)for(u=0;o=a[u++];)$.test(o.type||"")&&n.push(o);return h}Q=w.createDocumentFragment().appendChild(w.createElement("div")),(K=w.createElement("input")).setAttribute("type","radio"),K.setAttribute("checked","checked"),K.setAttribute("name","t"),Q.appendChild(K),g.checkClone=Q.cloneNode(!0).cloneNode(!0).lastChild.checked,Q.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!Q.cloneNode(!0).lastChild.defaultValue;var ne=/^key/,ie=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,re=/^([^.]*)(?:\.(.+)|)/;function oe(){return!0}function ae(){return!1}function se(){try{return w.activeElement}catch(e){}}function le(e,t,n,i,r,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(i=i||n,n=void 0),t)le(e,s,n,i,t[s],o);return e}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),!1===r)r=ae;else if(!r)return e;return 1===o&&(a=r,(r=function(e){return C().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=C.guid++)),e.each(function(){C.event.add(this,t,r,i,n)})}C.event={global:{},add:function(t,e,n,i,r){var o,a,s,l,c,u,h,f,d,p,m,g=k.get(t);if(g)for(n.handler&&(n=(o=n).handler,r=o.selector),n.guid||(n.guid=C.guid++),(l=g.events)||(l=g.events={}),(a=g.handle)||(a=g.handle=function(e){return void 0!==C&&C.event.triggered!==e.type?C.event.dispatch.apply(t,arguments):void 0}),c=(e=(e||"").match(L)||[""]).length;c--;)d=m=(s=re.exec(e[c])||[])[1],p=(s[2]||"").split(".").sort(),d&&(h=C.event.special[d]||{},d=(r?h.delegateType:h.bindType)||d,h=C.event.special[d]||{},u=C.extend({type:d,origType:m,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&C.expr.match.needsContext.test(r),namespace:p.join(".")},o),(f=l[d])||((f=l[d]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,i,p,a)||t.addEventListener&&t.addEventListener(d,a)),h.add&&(h.add.call(t,u),u.handler.guid||(u.handler.guid=n.guid)),r?f.splice(f.delegateCount++,0,u):f.push(u),C.event.global[d]=!0)},remove:function(e,t,n,i,r){var o,a,s,l,c,u,h,f,d,p,m,g=k.hasData(e)&&k.get(e);if(g&&(l=g.events)){for(c=(t=(t||"").match(L)||[""]).length;c--;)if(d=m=(s=re.exec(t[c])||[])[1],p=(s[2]||"").split(".").sort(),d){for(h=C.event.special[d]||{},f=l[d=(i?h.delegateType:h.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=f.length;o--;)u=f[o],!r&&m!==u.origType||n&&n.guid!==u.guid||s&&!s.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(f.splice(o,1),u.selector&&f.delegateCount--,h.remove&&h.remove.call(e,u));a&&!f.length&&(h.teardown&&!1!==h.teardown.call(e,p,g.handle)||C.removeEvent(e,d,g.handle),delete l[d])}else for(d in l)C.event.remove(e,d+t[c],n,i,!0);C.isEmptyObject(l)&&k.remove(e,"handle events")}},dispatch:function(e){e=C.event.fix(e);var t,n,i,r,o,a=[],s=u.call(arguments),l=(k.get(this,"events")||{})[e.type]||[],c=C.event.special[e.type]||{};if((s[0]=e).delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,e)){for(a=C.event.handlers.call(this,e,l),t=0;(r=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!e.isImmediatePropagationStopped();)e.rnamespace&&!e.rnamespace.test(o.namespace)||(e.handleObj=o,e.data=o.data,void 0!==(i=((C.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,s))&&!1===(e.result=i)&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,i,r,o,a=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&("click"!==e.type||isNaN(e.button)||e.button<1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==e.type)){for(i=[],n=0;n<s;n++)void 0===i[r=(o=t[n]).selector+" "]&&(i[r]=o.needsContext?-1<C(r,this).index(l):C.find(r,this,null,[l]).length),i[r]&&i.push(o);i.length&&a.push({elem:l,handlers:i})}return s<t.length&&a.push({elem:this,handlers:t.slice(s)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,r,o=t.button;return null==e.pageX&&null!=t.clientX&&(i=(n=e.target.ownerDocument||w).documentElement,r=n.body,e.pageX=t.clientX+(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i&&i.clientLeft||r&&r.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||r&&r.scrollTop||0)-(i&&i.clientTop||r&&r.clientTop||0)),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0),e}},fix:function(e){if(e[C.expando])return e;var t,n,i,r=e.type,o=e,a=this.fixHooks[r];for(a||(this.fixHooks[r]=a=ie.test(r)?this.mouseHooks:ne.test(r)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,e=new C.Event(o),t=i.length;t--;)e[n=i[t]]=o[n];return e.target||(e.target=w),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==se()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===se()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&C.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return C.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},C.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},C.Event=function(e,t){return this instanceof C.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?oe:ae):this.type=e,t&&C.extend(this,t),this.timeStamp=e&&e.timeStamp||C.now(),void(this[C.expando]=!0)):new C.Event(e,t)},C.Event.prototype={constructor:C.Event,isDefaultPrevented:ae,isPropagationStopped:ae,isImmediatePropagationStopped:ae,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=oe,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=oe,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=oe,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},C.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,r){C.event.special[e]={delegateType:r,bindType:r,handle:function(e){var t,n=e.relatedTarget,i=e.handleObj;return n&&(n===this||C.contains(this,n))||(e.type=i.origType,t=i.handler.apply(this,arguments),e.type=r),t}}}),C.fn.extend({on:function(e,t,n,i){return le(this,e,t,n,i)},one:function(e,t,n,i){return le(this,e,t,n,i,1)},off:function(e,t,n){var i,r;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,C(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=ae),this.each(function(){C.event.remove(this,e,n,t)});for(r in e)this.off(r,t,e[r]);return this}});var ce=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,ue=/<script|<style|<link/i,he=/checked\s*(?:[^=]|=\s*.checked.)/i,fe=/^true\/(.*)/,de=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function pe(e,t){return C.nodeName(e,"table")&&C.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function me(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function ge(e){var t=fe.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function ve(e,t){var n,i,r,o,a,s,l,c;if(1===t.nodeType){if(k.hasData(e)&&(o=k.access(e),a=k.set(t,o),c=o.events))for(r in delete a.handle,a.events={},c)for(n=0,i=c[r].length;n<i;n++)C.event.add(t,r,c[r][n]);I.hasData(e)&&(s=I.access(e),l=C.extend({},s),I.set(t,l))}}function _e(n,i,r,o){i=m.apply([],i);var e,t,a,s,l,c,u=0,h=n.length,f=h-1,d=i[0],p=C.isFunction(d);if(p||1<h&&"string"==typeof d&&!g.checkClone&&he.test(d))return n.each(function(e){var t=n.eq(e);p&&(i[0]=d.call(this,e,t.html())),_e(t,i,r,o)});if(h&&(t=(e=te(i,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(s=(a=C.map(J(e,"script"),me)).length;u<h;u++)l=e,u!==f&&(l=C.clone(l,!0,!0),s&&C.merge(a,J(l,"script"))),r.call(n[u],l,u);if(s)for(c=a[a.length-1].ownerDocument,C.map(a,ge),u=0;u<s;u++)l=a[u],$.test(l.type||"")&&!k.access(l,"globalEval")&&C.contains(c,l)&&(l.src?C._evalUrl&&C._evalUrl(l.src):C.globalEval(l.textContent.replace(de,"")))}return n}function ye(e,t,n){for(var i,r=t?C.filter(t,e):e,o=0;null!=(i=r[o]);o++)n||1!==i.nodeType||C.cleanData(J(i)),i.parentNode&&(n&&C.contains(i.ownerDocument,i)&&Z(J(i,"script")),i.parentNode.removeChild(i));return e}C.extend({htmlPrefilter:function(e){return e.replace(ce,"<$1></$2>")},clone:function(e,t,n){var i,r,o,a,s,l,c,u=e.cloneNode(!0),h=C.contains(e.ownerDocument,e);if(!(g.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||C.isXMLDoc(e)))for(a=J(u),i=0,r=(o=J(e)).length;i<r;i++)s=o[i],l=a[i],"input"===(c=l.nodeName.toLowerCase())&&q.test(s.type)?l.checked=s.checked:"input"!==c&&"textarea"!==c||(l.defaultValue=s.defaultValue);if(t)if(n)for(o=o||J(e),a=a||J(u),i=0,r=o.length;i<r;i++)ve(o[i],a[i]);else ve(e,u);return 0<(a=J(u,"script")).length&&Z(a,!h&&J(e,"script")),u},cleanData:function(e){for(var t,n,i,r=C.event.special,o=0;void 0!==(n=e[o]);o++)if(F(n)){if(t=n[k.expando]){if(t.events)for(i in t.events)r[i]?C.event.remove(n,i):C.removeEvent(n,i,t.handle);n[k.expando]=void 0}n[I.expando]&&(n[I.expando]=void 0)}}}),C.fn.extend({domManip:_e,detach:function(e){return ye(this,e,!0)},remove:function(e){return ye(this,e)},text:function(e){return P(this,function(e){return void 0===e?C.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return _e(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||pe(this,e).appendChild(e)})},prepend:function(){return _e(this,arguments,function(e){var t;1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(t=pe(this,e)).insertBefore(e,t.firstChild)})},before:function(){return _e(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return _e(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(C.cleanData(J(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return C.clone(this,e,t)})},html:function(e){return P(this,function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!ue.test(e)&&!Y[(X.exec(e)||["",""])[1].toLowerCase()]){e=C.htmlPrefilter(e);try{for(;n<i;n++)1===(t=this[n]||{}).nodeType&&(C.cleanData(J(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return _e(this,arguments,function(e){var t=this.parentNode;C.inArray(this,n)<0&&(C.cleanData(J(this)),t&&t.replaceChild(e,this))},n)}}),C.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){C.fn[e]=function(e){for(var t,n=[],i=C(e),r=i.length-1,o=0;o<=r;o++)t=o===r?this:this.clone(!0),C(i[o])[a](t),s.apply(n,t.get());return this.pushStack(n)}});var be,xe={HTML:"block",BODY:"block"};function Ee(e,t){var n=C(t.createElement(e)).appendTo(t.body),i=C.css(n[0],"display");return n.detach(),i}function Te(e){var t=w,n=xe[e];return n||("none"!==(n=Ee(e,t))&&n||((t=(be=(be||C("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentDocument).write(),t.close(),n=Ee(e,t),be.detach()),xe[e]=n),n}function we(e,t,n,i){var r,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];for(o in r=n.apply(e,i||[]),t)e.style[o]=a[o];return r}var Ce,Se,De,Re,Ae,Me,Le=/^margin/,He=new RegExp("^("+U+")(?!px)[a-z%]+$","i"),Fe=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=T),t.getComputedStyle(e)},Pe=w.documentElement;function Ne(){Me.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",Me.innerHTML="",Pe.appendChild(Ae);var e=T.getComputedStyle(Me);Ce="1%"!==e.top,Re="2px"===e.marginLeft,Se="4px"===e.width,Me.style.marginRight="50%",De="4px"===e.marginRight,Pe.removeChild(Ae)}function ke(e,t,n){var i,r,o,a,s=e.style;return""!==(a=(n=n||Fe(e))?n.getPropertyValue(t)||n[t]:void 0)&&void 0!==a||C.contains(e.ownerDocument,e)||(a=C.style(e,t)),n&&!g.pixelMarginRight()&&He.test(a)&&Le.test(t)&&(i=s.width,r=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=i,s.minWidth=r,s.maxWidth=o),void 0!==a?a+"":a}function Ie(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}Ae=w.createElement("div"),(Me=w.createElement("div")).style&&(Me.style.backgroundClip="content-box",Me.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle="content-box"===Me.style.backgroundClip,Ae.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",Ae.appendChild(Me),C.extend(g,{pixelPosition:function(){return Ne(),Ce},boxSizingReliable:function(){return null==Se&&Ne(),Se},pixelMarginRight:function(){return null==Se&&Ne(),De},reliableMarginLeft:function(){return null==Se&&Ne(),Re},reliableMarginRight:function(){var e,t=Me.appendChild(w.createElement("div"));return t.style.cssText=Me.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",t.style.marginRight=t.style.width="0",Me.style.width="1px",Pe.appendChild(Ae),e=!parseFloat(T.getComputedStyle(t).marginRight),Pe.removeChild(Ae),Me.removeChild(t),e}}));var Oe=/^(none|table(?!-c[ea]).+)/,Be={position:"absolute",visibility:"hidden",display:"block"},ze={letterSpacing:"0",fontWeight:"400"},je=["Webkit","O","Moz","ms"],Ue=w.createElement("div").style;function Ve(e){if(e in Ue)return e;for(var t=e[0].toUpperCase()+e.slice(1),n=je.length;n--;)if((e=je[n]+t)in Ue)return e}function We(e,t,n){var i=V.exec(t);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):t}function Ge(e,t,n,i,r){for(var o=n===(i?"border":"content")?4:"width"===t?1:0,a=0;o<4;o+=2)"margin"===n&&(a+=C.css(e,n+W[o],!0,r)),i?("content"===n&&(a-=C.css(e,"padding"+W[o],!0,r)),"margin"!==n&&(a-=C.css(e,"border"+W[o]+"Width",!0,r))):(a+=C.css(e,"padding"+W[o],!0,r),"padding"!==n&&(a+=C.css(e,"border"+W[o]+"Width",!0,r)));return a}function qe(e,t,n){var i=!0,r="width"===t?e.offsetWidth:e.offsetHeight,o=Fe(e),a="border-box"===C.css(e,"boxSizing",!1,o);if(r<=0||null==r){if(((r=ke(e,t,o))<0||null==r)&&(r=e.style[t]),He.test(r))return r;i=a&&(g.boxSizingReliable()||r===e.style[t]),r=parseFloat(r)||0}return r+Ge(e,t,n||(a?"border":"content"),i,o)+"px"}function Xe(e,t){for(var n,i,r,o=[],a=0,s=e.length;a<s;a++)(i=e[a]).style&&(o[a]=k.get(i,"olddisplay"),n=i.style.display,t?(o[a]||"none"!==n||(i.style.display=""),""===i.style.display&&j(i)&&(o[a]=k.access(i,"olddisplay",Te(i.nodeName)))):(r=j(i),"none"===n&&r||k.set(i,"olddisplay",r?n:C.css(i,"display"))));for(a=0;a<s;a++)(i=e[a]).style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?o[a]||"":"none"));return e}function $e(e,t,n,i,r){return new $e.prototype.init(e,t,n,i,r)}C.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=ke(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,a,s=C.camelCase(t),l=e.style;return t=C.cssProps[s]||(C.cssProps[s]=Ve(s)||s),a=C.cssHooks[t]||C.cssHooks[s],void 0===n?a&&"get"in a&&void 0!==(r=a.get(e,!1,i))?r:l[t]:("string"===(o=typeof n)&&(r=V.exec(n))&&r[1]&&(n=G(e,t,r),o="number"),void(null!=n&&n==n&&("number"===o&&(n+=r&&r[3]||(C.cssNumber[s]?"":"px")),g.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,i))||(l[t]=n))))}},css:function(e,t,n,i){var r,o,a,s=C.camelCase(t);return t=C.cssProps[s]||(C.cssProps[s]=Ve(s)||s),(a=C.cssHooks[t]||C.cssHooks[s])&&"get"in a&&(r=a.get(e,!0,n)),void 0===r&&(r=ke(e,t,i)),"normal"===r&&t in ze&&(r=ze[t]),""===n||n?(o=parseFloat(r),!0===n||isFinite(o)?o||0:r):r}}),C.each(["height","width"],function(e,a){C.cssHooks[a]={get:function(e,t,n){return t?Oe.test(C.css(e,"display"))&&0===e.offsetWidth?we(e,Be,function(){return qe(e,a,n)}):qe(e,a,n):void 0},set:function(e,t,n){var i,r=n&&Fe(e),o=n&&Ge(e,a,n,"border-box"===C.css(e,"boxSizing",!1,r),r);return o&&(i=V.exec(t))&&"px"!==(i[3]||"px")&&(e.style[a]=t,t=C.css(e,a)),We(0,t,o)}}}),C.cssHooks.marginLeft=Ie(g.reliableMarginLeft,function(e,t){return t?(parseFloat(ke(e,"marginLeft"))||e.getBoundingClientRect().left-we(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px":void 0}),C.cssHooks.marginRight=Ie(g.reliableMarginRight,function(e,t){return t?we(e,{display:"inline-block"},ke,[e,"marginRight"]):void 0}),C.each({margin:"",padding:"",border:"Width"},function(r,o){C.cssHooks[r+o]={expand:function(e){for(var t=0,n={},i="string"==typeof e?e.split(" "):[e];t<4;t++)n[r+W[t]+o]=i[t]||i[t-2]||i[0];return n}},Le.test(r)||(C.cssHooks[r+o].set=We)}),C.fn.extend({css:function(e,t){return P(this,function(e,t,n){var i,r,o={},a=0;if(C.isArray(t)){for(i=Fe(e),r=t.length;a<r;a++)o[t[a]]=C.css(e,t[a],!1,i);return o}return void 0!==n?C.style(e,t,n):C.css(e,t)},e,t,1<arguments.length)},show:function(){return Xe(this,!0)},hide:function(){return Xe(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){j(this)?C(this).show():C(this).hide()})}}),(C.Tween=$e).prototype={constructor:$e,init:function(e,t,n,i,r,o){this.elem=e,this.prop=n,this.easing=r||C.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=o||(C.cssNumber[n]?"":"px")},cur:function(){var e=$e.propHooks[this.prop];return e&&e.get?e.get(this):$e.propHooks._default.get(this)},run:function(e){var t,n=$e.propHooks[this.prop];return this.options.duration?this.pos=t=C.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):$e.propHooks._default.set(this),this}},$e.prototype.init.prototype=$e.prototype,$e.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=C.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){C.fx.step[e.prop]?C.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[C.cssProps[e.prop]]&&!C.cssHooks[e.prop]?e.elem[e.prop]=e.now:C.style(e.elem,e.prop,e.now+e.unit)}}},$e.propHooks.scrollTop=$e.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},C.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},C.fx=$e.prototype.init,C.fx.step={};var Ye,Je,Ze,Qe,Ke,et=/^(?:toggle|show|hide)$/,tt=/queueHooks$/;function nt(){return T.setTimeout(function(){Ye=void 0}),Ye=C.now()}function it(e,t){var n,i=0,r={height:e};for(t=t?1:0;i<4;i+=2-t)r["margin"+(n=W[i])]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function rt(e,t,n){for(var i,r=(ot.tweeners[t]||[]).concat(ot.tweeners["*"]),o=0,a=r.length;o<a;o++)if(i=r[o].call(n,t,e))return i}function ot(o,e,t){var n,a,i=0,r=ot.prefilters.length,s=C.Deferred().always(function(){delete l.elem}),l=function(){if(a)return!1;for(var e=Ye||nt(),t=Math.max(0,c.startTime+c.duration-e),n=1-(t/c.duration||0),i=0,r=c.tweens.length;i<r;i++)c.tweens[i].run(n);return s.notifyWith(o,[c,n,t]),n<1&&r?t:(s.resolveWith(o,[c]),!1)},c=s.promise({elem:o,props:C.extend({},e),opts:C.extend(!0,{specialEasing:{},easing:C.easing._default},t),originalProperties:e,originalOptions:t,startTime:Ye||nt(),duration:t.duration,tweens:[],createTween:function(e,t){var n=C.Tween(o,c.opts,e,t,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(n),n},stop:function(e){var t=0,n=e?c.tweens.length:0;if(a)return this;for(a=!0;t<n;t++)c.tweens[t].run(1);return e?(s.notifyWith(o,[c,1,0]),s.resolveWith(o,[c,e])):s.rejectWith(o,[c,e]),this}}),u=c.props;for(function(e,t){var n,i,r,o,a;for(n in e)if(r=t[i=C.camelCase(n)],o=e[n],C.isArray(o)&&(r=o[1],o=e[n]=o[0]),n!==i&&(e[i]=o,delete e[n]),(a=C.cssHooks[i])&&"expand"in a)for(n in o=a.expand(o),delete e[i],o)n in e||(e[n]=o[n],t[n]=r);else t[i]=r}(u,c.opts.specialEasing);i<r;i++)if(n=ot.prefilters[i].call(c,o,u,c.opts))return C.isFunction(n.stop)&&(C._queueHooks(c.elem,c.opts.queue).stop=C.proxy(n.stop,n)),n;return C.map(u,rt,c),C.isFunction(c.opts.start)&&c.opts.start.call(o,c),C.fx.timer(C.extend(l,{elem:o,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}C.Animation=C.extend(ot,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return G(n.elem,e,V.exec(t),n),n}]},tweener:function(e,t){for(var n,i=0,r=(e=C.isFunction(e)?(t=e,["*"]):e.match(L)).length;i<r;i++)n=e[i],ot.tweeners[n]=ot.tweeners[n]||[],ot.tweeners[n].unshift(t)},prefilters:[function(t,e,n){var i,r,o,a,s,l,c,u=this,h={},f=t.style,d=t.nodeType&&j(t),p=k.get(t,"fxshow");for(i in n.queue||(null==(s=C._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,u.always(function(){u.always(function(){s.unqueued--,C.queue(t,"fx").length||s.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],"inline"===("none"===(c=C.css(t,"display"))?k.get(t,"olddisplay")||Te(t.nodeName):c)&&"none"===C.css(t,"float")&&(f.display="inline-block")),n.overflow&&(f.overflow="hidden",u.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]})),e)if(r=e[i],et.exec(r)){if(delete e[i],o=o||"toggle"===r,r===(d?"hide":"show")){if("show"!==r||!p||void 0===p[i])continue;d=!0}h[i]=p&&p[i]||C.style(t,i)}else c=void 0;if(C.isEmptyObject(h))"inline"===("none"===c?Te(t.nodeName):c)&&(f.display=c);else for(i in p?"hidden"in p&&(d=p.hidden):p=k.access(t,"fxshow",{}),o&&(p.hidden=!d),d?C(t).show():u.done(function(){C(t).hide()}),u.done(function(){var e;for(e in k.remove(t,"fxshow"),h)C.style(t,e,h[e])}),h)a=rt(d?p[i]:0,i,u),i in p||(p[i]=a.start,d&&(a.end=a.start,a.start="width"===i||"height"===i?1:0))}],prefilter:function(e,t){t?ot.prefilters.unshift(e):ot.prefilters.push(e)}}),C.speed=function(e,t,n){var i=e&&"object"==typeof e?C.extend({},e):{complete:n||!n&&t||C.isFunction(e)&&e,duration:e,easing:n&&t||t&&!C.isFunction(t)&&t};return i.duration=C.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in C.fx.speeds?C.fx.speeds[i.duration]:C.fx.speeds._default,null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){C.isFunction(i.old)&&i.old.call(this),i.queue&&C.dequeue(this,i.queue)},i},C.fn.extend({fadeTo:function(e,t,n,i){return this.filter(j).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(t,e,n,i){function r(){var e=ot(this,C.extend({},t),a);(o||k.get(this,"finish"))&&e.stop(!0)}var o=C.isEmptyObject(t),a=C.speed(e,n,i);return r.finish=r,o||!1===a.queue?this.each(r):this.queue(a.queue,r)},stop:function(r,e,o){function a(e){var t=e.stop;delete e.stop,t(o)}return"string"!=typeof r&&(o=e,e=r,r=void 0),e&&!1!==r&&this.queue(r||"fx",[]),this.each(function(){var e=!0,t=null!=r&&r+"queueHooks",n=C.timers,i=k.get(this);if(t)i[t]&&i[t].stop&&a(i[t]);else for(t in i)i[t]&&i[t].stop&&tt.test(t)&&a(i[t]);for(t=n.length;t--;)n[t].elem!==this||null!=r&&n[t].queue!==r||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||C.dequeue(this,r)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=k.get(this),n=t[a+"queue"],i=t[a+"queueHooks"],r=C.timers,o=n?n.length:0;for(t.finish=!0,C.queue(this,a,[]),i&&i.stop&&i.stop.call(this,!0),e=r.length;e--;)r[e].elem===this&&r[e].queue===a&&(r[e].anim.stop(!0),r.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),C.each(["toggle","show","hide"],function(e,i){var r=C.fn[i];C.fn[i]=function(e,t,n){return null==e||"boolean"==typeof e?r.apply(this,arguments):this.animate(it(i,!0),e,t,n)}}),C.each({slideDown:it("show"),slideUp:it("hide"),slideToggle:it("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,i){C.fn[e]=function(e,t,n){return this.animate(i,e,t,n)}}),C.timers=[],C.fx.tick=function(){var e,t=0,n=C.timers;for(Ye=C.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||C.fx.stop(),Ye=void 0},C.fx.timer=function(e){C.timers.push(e),e()?C.fx.start():C.timers.pop()},C.fx.interval=13,C.fx.start=function(){Je=Je||T.setInterval(C.fx.tick,C.fx.interval)},C.fx.stop=function(){T.clearInterval(Je),Je=null},C.fx.speeds={slow:600,fast:200,_default:400},C.fn.delay=function(i,e){return i=C.fx&&C.fx.speeds[i]||i,e=e||"fx",this.queue(e,function(e,t){var n=T.setTimeout(e,i);t.stop=function(){T.clearTimeout(n)}})},Ze=w.createElement("input"),Qe=w.createElement("select"),Ke=Qe.appendChild(w.createElement("option")),Ze.type="checkbox",g.checkOn=""!==Ze.value,g.optSelected=Ke.selected,Qe.disabled=!0,g.optDisabled=!Ke.disabled,(Ze=w.createElement("input")).value="t",Ze.type="radio",g.radioValue="t"===Ze.value;var at,st=C.expr.attrHandle;C.fn.extend({attr:function(e,t){return P(this,C.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){C.removeAttr(this,e)})}}),C.extend({attr:function(e,t,n){var i,r,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?C.prop(e,t,n):(1===o&&C.isXMLDoc(e)||(t=t.toLowerCase(),r=C.attrHooks[t]||(C.expr.match.bool.test(t)?at:void 0)),void 0!==n?null===n?void C.removeAttr(e,t):r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:(e.setAttribute(t,n+""),n):r&&"get"in r&&null!==(i=r.get(e,t))?i:null==(i=C.find.attr(e,t))?void 0:i)},attrHooks:{type:{set:function(e,t){if(!g.radioValue&&"radio"===t&&C.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,i,r=0,o=t&&t.match(L);if(o&&1===e.nodeType)for(;n=o[r++];)i=C.propFix[n]||n,C.expr.match.bool.test(n)&&(e[i]=!1),e.removeAttribute(n)}}),at={set:function(e,t,n){return!1===t?C.removeAttr(e,n):e.setAttribute(n,n),n}},C.each(C.expr.match.bool.source.match(/\w+/g),function(e,t){var o=st[t]||C.find.attr;st[t]=function(e,t,n){var i,r;return n||(r=st[t],st[t]=i,i=null!=o(e,t,n)?t.toLowerCase():null,st[t]=r),i}});var lt=/^(?:input|select|textarea|button)$/i,ct=/^(?:a|area)$/i;C.fn.extend({prop:function(e,t){return P(this,C.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[C.propFix[e]||e]})}}),C.extend({prop:function(e,t,n){var i,r,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&C.isXMLDoc(e)||(t=C.propFix[t]||t,r=C.propHooks[t]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:e[t]=n:r&&"get"in r&&null!==(i=r.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=C.find.attr(e,"tabindex");return t?parseInt(t,10):lt.test(e.nodeName)||ct.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),g.optSelected||(C.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),C.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){C.propFix[this.toLowerCase()]=this});var ut=/[\t\r\n\f]/g;function ht(e){return e.getAttribute&&e.getAttribute("class")||""}C.fn.extend({addClass:function(t){var e,n,i,r,o,a,s,l=0;if(C.isFunction(t))return this.each(function(e){C(this).addClass(t.call(this,e,ht(this)))});if("string"==typeof t&&t)for(e=t.match(L)||[];n=this[l++];)if(r=ht(n),i=1===n.nodeType&&(" "+r+" ").replace(ut," ")){for(a=0;o=e[a++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");r!==(s=C.trim(i))&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,i,r,o,a,s,l=0;if(C.isFunction(t))return this.each(function(e){C(this).removeClass(t.call(this,e,ht(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(L)||[];n=this[l++];)if(r=ht(n),i=1===n.nodeType&&(" "+r+" ").replace(ut," ")){for(a=0;o=e[a++];)for(;-1<i.indexOf(" "+o+" ");)i=i.replace(" "+o+" "," ");r!==(s=C.trim(i))&&n.setAttribute("class",s)}return this},toggleClass:function(r,t){var o=typeof r;return"boolean"==typeof t&&"string"==o?t?this.addClass(r):this.removeClass(r):C.isFunction(r)?this.each(function(e){C(this).toggleClass(r.call(this,e,ht(this),t),t)}):this.each(function(){var e,t,n,i;if("string"==o)for(t=0,n=C(this),i=r.match(L)||[];e=i[t++];)n.hasClass(e)?n.removeClass(e):n.addClass(e);else void 0!==r&&"boolean"!=o||((e=ht(this))&&k.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",!e&&!1!==r&&k.get(this,"__className__")||""))})},hasClass:function(e){for(var t,n=0,i=" "+e+" ";t=this[n++];)if(1===t.nodeType&&-1<(" "+ht(t)+" ").replace(ut," ").indexOf(i))return!0;return!1}});var ft=/\r/g,dt=/[\x20\t\r\n\f]+/g;C.fn.extend({val:function(n){var i,e,r,t=this[0];return arguments.length?(r=C.isFunction(n),this.each(function(e){var t;1===this.nodeType&&(null==(t=r?n.call(this,e,C(this).val()):n)?t="":"number"==typeof t?t+="":C.isArray(t)&&(t=C.map(t,function(e){return null==e?"":e+""})),(i=C.valHooks[this.type]||C.valHooks[this.nodeName.toLowerCase()])&&"set"in i&&void 0!==i.set(this,t,"value")||(this.value=t))})):t?(i=C.valHooks[t.type]||C.valHooks[t.nodeName.toLowerCase()])&&"get"in i&&void 0!==(e=i.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(ft,""):null==e?"":e:void 0}}),C.extend({valHooks:{option:{get:function(e){var t=C.find.attr(e,"value");return null!=t?t:C.trim(C.text(e)).replace(dt," ")}},select:{get:function(e){for(var t,n,i=e.options,r=e.selectedIndex,o="select-one"===e.type||r<0,a=o?null:[],s=o?r+1:i.length,l=r<0?s:o?r:0;l<s;l++)if(((n=i[l]).selected||l===r)&&(g.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!C.nodeName(n.parentNode,"optgroup"))){if(t=C(n).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var n,i,r=e.options,o=C.makeArray(t),a=r.length;a--;)((i=r[a]).selected=-1<C.inArray(C.valHooks.option.get(i),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),C.each(["radio","checkbox"],function(){C.valHooks[this]={set:function(e,t){return C.isArray(t)?e.checked=-1<C.inArray(C(e).val(),t):void 0}},g.checkOn||(C.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var pt=/^(?:focusinfocus|focusoutblur)$/;C.extend(C.event,{trigger:function(e,t,n,i){var r,o,a,s,l,c,u=[n||w],h=p.call(e,"type")?e.type:e,f=p.call(e,"namespace")?e.namespace.split("."):[],d=o=n=n||w;if(3!==n.nodeType&&8!==n.nodeType&&!pt.test(h+C.event.triggered)&&(-1<h.indexOf(".")&&(h=(f=h.split(".")).shift(),f.sort()),s=h.indexOf(":")<0&&"on"+h,(e=e[C.expando]?e:new C.Event(h,"object"==typeof e&&e)).isTrigger=i?2:3,e.namespace=f.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:C.makeArray(t,[e]),c=C.event.special[h]||{},i||!c.trigger||!1!==c.trigger.apply(n,t))){if(!i&&!c.noBubble&&!C.isWindow(n)){for(a=c.delegateType||h,pt.test(a+h)||(d=d.parentNode);d;d=d.parentNode)u.push(d),o=d;o===(n.ownerDocument||w)&&u.push(o.defaultView||o.parentWindow||T)}for(r=0;(d=u[r++])&&!e.isPropagationStopped();)e.type=1<r?a:c.bindType||h,(l=(k.get(d,"events")||{})[e.type]&&k.get(d,"handle"))&&l.apply(d,t),(l=s&&d[s])&&l.apply&&F(d)&&(e.result=l.apply(d,t),!1===e.result&&e.preventDefault());return e.type=h,i||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(u.pop(),t)||!F(n)||s&&C.isFunction(n[h])&&!C.isWindow(n)&&((o=n[s])&&(n[s]=null),n[C.event.triggered=h](),C.event.triggered=void 0,o&&(n[s]=o)),e.result}},simulate:function(e,t,n){var i=C.extend(new C.Event,n,{type:e,isSimulated:!0});C.event.trigger(i,null,t)}}),C.fn.extend({trigger:function(e,t){return this.each(function(){C.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?C.event.trigger(e,t,n,!0):void 0}}),C.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,n){C.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}}),C.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),g.focusin="onfocusin"in T,g.focusin||C.each({focus:"focusin",blur:"focusout"},function(n,i){function r(e){C.event.simulate(i,e.target,C.event.fix(e))}C.event.special[i]={setup:function(){var e=this.ownerDocument||this,t=k.access(e,i);t||e.addEventListener(n,r,!0),k.access(e,i,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this,t=k.access(e,i)-1;t?k.access(e,i,t):(e.removeEventListener(n,r,!0),k.remove(e,i))}}});var mt=T.location,gt=C.now(),vt=/\?/;C.parseJSON=function(e){return JSON.parse(e+"")},C.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new T.DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||C.error("Invalid XML: "+e),t};var _t=/#.*$/,yt=/([?&])_=[^&]*/,bt=/^(.*?):[ \t]*([^\r\n]*)$/gm,xt=/^(?:GET|HEAD)$/,Et=/^\/\//,Tt={},wt={},Ct="*/".concat("*"),St=w.createElement("a");function Dt(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,i=0,r=e.toLowerCase().match(L)||[];if(C.isFunction(t))for(;n=r[i++];)"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function Rt(t,r,o,a){var s={},l=t===wt;function c(e){var i;return s[e]=!0,C.each(t[e]||[],function(e,t){var n=t(r,o,a);return"string"!=typeof n||l||s[n]?l?!(i=n):void 0:(r.dataTypes.unshift(n),c(n),!1)}),i}return c(r.dataTypes[0])||!s["*"]&&c("*")}function At(e,t){var n,i,r=C.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((r[n]?e:i=i||{})[n]=t[n]);return i&&C.extend(!0,e,i),e}St.href=mt.href,C.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:mt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(mt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ct,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":C.parseJSON,"text xml":C.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?At(At(e,C.ajaxSettings),t):At(C.ajaxSettings,e)},ajaxPrefilter:Dt(Tt),ajaxTransport:Dt(wt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var u,h,f,n,d,i,p,r,m=C.ajaxSetup({},t),g=m.context||m,v=m.context&&(g.nodeType||g.jquery)?C(g):C.event,_=C.Deferred(),y=C.Callbacks("once memory"),b=m.statusCode||{},o={},a={},x=0,s="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(2===x){if(!n)for(n={};t=bt.exec(f);)n[t[1].toLowerCase()]=t[2];t=n[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===x?f:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return x||(e=a[n]=a[n]||e,o[e]=t),this},overrideMimeType:function(e){return x||(m.mimeType=e),this},statusCode:function(e){var t;if(e)if(x<2)for(t in e)b[t]=[b[t],e[t]];else E.always(e[E.status]);return this},abort:function(e){var t=e||s;return u&&u.abort(t),l(0,t),this}};if(_.promise(E).complete=y.add,E.success=E.done,E.error=E.fail,m.url=((e||m.url||mt.href)+"").replace(_t,"").replace(Et,mt.protocol+"//"),m.type=t.method||t.type||m.method||m.type,m.dataTypes=C.trim(m.dataType||"*").toLowerCase().match(L)||[""],null==m.crossDomain){i=w.createElement("a");try{i.href=m.url,i.href=i.href,m.crossDomain=St.protocol+"//"+St.host!=i.protocol+"//"+i.host}catch(e){m.crossDomain=!0}}if(m.data&&m.processData&&"string"!=typeof m.data&&(m.data=C.param(m.data,m.traditional)),Rt(Tt,m,t,E),2===x)return E;for(r in(p=C.event&&m.global)&&0==C.active++&&C.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!xt.test(m.type),h=m.url,m.hasContent||(m.data&&(h=m.url+=(vt.test(h)?"&":"?")+m.data,delete m.data),!1===m.cache&&(m.url=yt.test(h)?h.replace(yt,"$1_="+gt++):h+(vt.test(h)?"&":"?")+"_="+gt++)),m.ifModified&&(C.lastModified[h]&&E.setRequestHeader("If-Modified-Since",C.lastModified[h]),C.etag[h]&&E.setRequestHeader("If-None-Match",C.etag[h])),(m.data&&m.hasContent&&!1!==m.contentType||t.contentType)&&E.setRequestHeader("Content-Type",m.contentType),E.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+Ct+"; q=0.01":""):m.accepts["*"]),m.headers)E.setRequestHeader(r,m.headers[r]);if(m.beforeSend&&(!1===m.beforeSend.call(g,E,m)||2===x))return E.abort();for(r in s="abort",{success:1,error:1,complete:1})E[r](m[r]);if(u=Rt(wt,m,t,E)){if(E.readyState=1,p&&v.trigger("ajaxSend",[E,m]),2===x)return E;m.async&&0<m.timeout&&(d=T.setTimeout(function(){E.abort("timeout")},m.timeout));try{x=1,u.send(o,l)}catch(e){if(!(x<2))throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,n,i){var r,o,a,s,l,c=t;2!==x&&(x=2,d&&T.clearTimeout(d),u=void 0,f=i||"",E.readyState=0<e?4:0,r=200<=e&&e<300||304===e,n&&(s=function(e,t,n){for(var i,r,o,a,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(r in s)if(s[r]&&s[r].test(i)){l.unshift(r);break}if(l[0]in n)o=l[0];else{for(r in n){if(!l[0]||e.converters[r+" "+l[0]]){o=r;break}a=a||r}o=o||a}return o?(o!==l[0]&&l.unshift(o),n[o]):void 0}(m,E,n)),s=function(e,t,n,i){var r,o,a,s,l,c={},u=e.dataTypes.slice();if(u[1])for(a in e.converters)c[a.toLowerCase()]=e.converters[a];for(o=u.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=u.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(!(a=c[l+" "+o]||c["* "+o]))for(r in c)if((s=r.split(" "))[1]===o&&(a=c[l+" "+s[0]]||c["* "+s[0]])){!0===a?a=c[r]:!0!==c[r]&&(o=s[0],u.unshift(s[1]));break}if(!0!==a)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}(m,s,E,r),r?(m.ifModified&&((l=E.getResponseHeader("Last-Modified"))&&(C.lastModified[h]=l),(l=E.getResponseHeader("etag"))&&(C.etag[h]=l)),204===e||"HEAD"===m.type?c="nocontent":304===e?c="notmodified":(c=s.state,o=s.data,r=!(a=s.error))):(a=c,!e&&c||(c="error",e<0&&(e=0))),E.status=e,E.statusText=(t||c)+"",r?_.resolveWith(g,[o,c,E]):_.rejectWith(g,[E,c,a]),E.statusCode(b),b=void 0,p&&v.trigger(r?"ajaxSuccess":"ajaxError",[E,m,r?o:a]),y.fireWith(g,[E,c]),p&&(v.trigger("ajaxComplete",[E,m]),--C.active||C.event.trigger("ajaxStop")))}return E},getJSON:function(e,t,n){return C.get(e,t,n,"json")},getScript:function(e,t){return C.get(e,void 0,t,"script")}}),C.each(["get","post"],function(e,r){C[r]=function(e,t,n,i){return C.isFunction(t)&&(i=i||n,n=t,t=void 0),C.ajax(C.extend({url:e,type:r,dataType:i,data:t,success:n},C.isPlainObject(e)&&e))}}),C._evalUrl=function(e){return C.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},C.fn.extend({wrapAll:function(t){var e;return C.isFunction(t)?this.each(function(e){C(this).wrapAll(t.call(this,e))}):(this[0]&&(e=C(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(n){return C.isFunction(n)?this.each(function(e){C(this).wrapInner(n.call(this,e))}):this.each(function(){var e=C(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=C.isFunction(t);return this.each(function(e){C(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(){return this.parent().each(function(){C.nodeName(this,"body")||C(this).replaceWith(this.childNodes)}).end()}}),C.expr.filters.hidden=function(e){return!C.expr.filters.visible(e)},C.expr.filters.visible=function(e){return 0<e.offsetWidth||0<e.offsetHeight||0<e.getClientRects().length};var Mt=/%20/g,Lt=/\[\]$/,Ht=/\r?\n/g,Ft=/^(?:submit|button|image|reset|file)$/i,Pt=/^(?:input|select|textarea|keygen)/i;function Nt(n,e,i,r){var t;if(C.isArray(e))C.each(e,function(e,t){i||Lt.test(n)?r(n,t):Nt(n+"["+("object"==typeof t&&null!=t?e:"")+"]",t,i,r)});else if(i||"object"!==C.type(e))r(n,e);else for(t in e)Nt(n+"["+t+"]",e[t],i,r)}C.param=function(e,t){function n(e,t){t=C.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)}var i,r=[];if(void 0===t&&(t=C.ajaxSettings&&C.ajaxSettings.traditional),C.isArray(e)||e.jquery&&!C.isPlainObject(e))C.each(e,function(){n(this.name,this.value)});else for(i in e)Nt(i,e[i],t,n);return r.join("&").replace(Mt,"+")},C.fn.extend({serialize:function(){return C.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=C.prop(this,"elements");return e?C.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!C(this).is(":disabled")&&Pt.test(this.nodeName)&&!Ft.test(e)&&(this.checked||!q.test(e))}).map(function(e,t){var n=C(this).val();return null==n?null:C.isArray(n)?C.map(n,function(e){return{name:t.name,value:e.replace(Ht,"\r\n")}}):{name:t.name,value:n.replace(Ht,"\r\n")}}).get()}}),C.ajaxSettings.xhr=function(){try{return new T.XMLHttpRequest}catch(e){}};var kt={0:200,1223:204},It=C.ajaxSettings.xhr();g.cors=!!It&&"withCredentials"in It,g.ajax=It=!!It,C.ajaxTransport(function(r){var o,a;return g.cors||It&&!r.crossDomain?{send:function(e,t){var n,i=r.xhr();if(i.open(r.type,r.url,r.async,r.username,r.password),r.xhrFields)for(n in r.xhrFields)i[n]=r.xhrFields[n];for(n in r.mimeType&&i.overrideMimeType&&i.overrideMimeType(r.mimeType),r.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)i.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=a=i.onload=i.onerror=i.onabort=i.onreadystatechange=null,"abort"===e?i.abort():"error"===e?"number"!=typeof i.status?t(0,"error"):t(i.status,i.statusText):t(kt[i.status]||i.status,i.statusText,"text"!==(i.responseType||"text")||"string"!=typeof i.responseText?{binary:i.response}:{text:i.responseText},i.getAllResponseHeaders()))}},i.onload=o(),a=i.onerror=o("error"),void 0!==i.onabort?i.onabort=a:i.onreadystatechange=function(){4===i.readyState&&T.setTimeout(function(){o&&a()})},o=o("abort");try{i.send(r.hasContent&&r.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}:void 0}),C.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return C.globalEval(e),e}}}),C.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),C.ajaxTransport("script",function(n){var i,r;if(n.crossDomain)return{send:function(e,t){i=C("<script>").prop({charset:n.scriptCharset,src:n.url}).on("load error",r=function(e){i.remove(),r=null,e&&t("error"===e.type?404:200,e.type)}),w.head.appendChild(i[0])},abort:function(){r&&r()}}});var Ot=[],Bt=/(=)\?(?=&|$)|\?\?/;C.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Ot.pop()||C.expando+"_"+gt++;return this[e]=!0,e}}),C.ajaxPrefilter("json jsonp",function(e,t,n){var i,r,o,a=!1!==e.jsonp&&(Bt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Bt.test(e.data)&&"data");return a||"jsonp"===e.dataTypes[0]?(i=e.jsonpCallback=C.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Bt,"$1"+i):!1!==e.jsonp&&(e.url+=(vt.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return o||C.error(i+" was not called"),o[0]},e.dataTypes[0]="json",r=T[i],T[i]=function(){o=arguments},n.always(function(){void 0===r?C(T).removeProp(i):T[i]=r,e[i]&&(e.jsonpCallback=t.jsonpCallback,Ot.push(i)),o&&C.isFunction(r)&&r(o[0]),o=r=void 0}),"script"):void 0}),C.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||w;var i=y.exec(e),r=!n&&[];return i?[t.createElement(i[1])]:(i=te([e],t,r),r&&r.length&&C(r).remove(),C.merge([],i.childNodes))};var zt=C.fn.load;function jt(e){return C.isWindow(e)?e:9===e.nodeType&&e.defaultView}C.fn.load=function(e,t,n){if("string"!=typeof e&&zt)return zt.apply(this,arguments);var i,r,o,a=this,s=e.indexOf(" ");return-1<s&&(i=C.trim(e.slice(s)),e=e.slice(0,s)),C.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(r="POST"),0<a.length&&C.ajax({url:e,type:r||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(i?C("<div>").append(C.parseHTML(e)).find(i):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},C.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){C.fn[t]=function(e){return this.on(t,e)}}),C.expr.filters.animated=function(t){return C.grep(C.timers,function(e){return t===e.elem}).length},C.offset={setOffset:function(e,t,n){var i,r,o,a,s,l,c=C.css(e,"position"),u=C(e),h={};"static"===c&&(e.style.position="relative"),s=u.offset(),o=C.css(e,"top"),l=C.css(e,"left"),r=("absolute"===c||"fixed"===c)&&-1<(o+l).indexOf("auto")?(a=(i=u.position()).top,i.left):(a=parseFloat(o)||0,parseFloat(l)||0),C.isFunction(t)&&(t=t.call(e,n,C.extend({},s))),null!=t.top&&(h.top=t.top-s.top+a),null!=t.left&&(h.left=t.left-s.left+r),"using"in t?t.using.call(e,h):u.css(h)}},C.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){C.offset.setOffset(this,t,e)});var e,n,i=this[0],r={top:0,left:0},o=i&&i.ownerDocument;return o?(e=o.documentElement,C.contains(e,i)?(r=i.getBoundingClientRect(),n=jt(o),{top:r.top+n.pageYOffset-e.clientTop,left:r.left+n.pageXOffset-e.clientLeft}):r):void 0},position:function(){if(this[0]){var e,t,n=this[0],i={top:0,left:0};return"fixed"===C.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),C.nodeName(e[0],"html")||(i=e.offset()),i.top+=C.css(e[0],"borderTopWidth",!0),i.left+=C.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-C.css(n,"marginTop",!0),left:t.left-i.left-C.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===C.css(e,"position");)e=e.offsetParent;return e||Pe})}}),C.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,r){var o="pageYOffset"===r;C.fn[t]=function(e){return P(this,function(e,t,n){var i=jt(e);return void 0===n?i?i[r]:e[t]:void(i?i.scrollTo(o?i.pageXOffset:n,o?n:i.pageYOffset):e[t]=n)},t,e,arguments.length)}}),C.each(["top","left"],function(e,n){C.cssHooks[n]=Ie(g.pixelPosition,function(e,t){return t?(t=ke(e,n),He.test(t)?C(e).position()[n]+"px":t):void 0})}),C.each({Height:"height",Width:"width"},function(o,a){C.each({padding:"inner"+o,content:a,"":"outer"+o},function(i,e){C.fn[e]=function(e,t){var n=arguments.length&&(i||"boolean"!=typeof e),r=i||(!0===e||!0===t?"margin":"border");return P(this,function(e,t,n){var i;return C.isWindow(e)?e.document.documentElement["client"+o]:9===e.nodeType?(i=e.documentElement,Math.max(e.body["scroll"+o],i["scroll"+o],e.body["offset"+o],i["offset"+o],i["client"+o])):void 0===n?C.css(e,t,r):C.style(e,t,n,r)},a,n?e:void 0,n,null)}})}),C.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},size:function(){return this.length}}),C.fn.andSelf=C.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return C});var Ut=T.jQuery,Vt=T.$;return C.noConflict=function(e){return T.$===C&&(T.$=Vt),e&&T.jQuery===C&&(T.jQuery=Ut),C},e||(T.jQuery=T.$=C),C}),function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(f,e){function s(e){var t=e.length,n=K.type(e);return"function"!==n&&!K.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e))}function t(e,n,i){if(K.isFunction(n))return K.grep(e,function(e,t){return!!n.call(e,t,e)!==i});if(n.nodeType)return K.grep(e,function(e){return e===n!==i});if("string"==typeof n){if(Et.test(n))return K.filter(n,e,i);n=K.filter(n,e)}return K.grep(e,function(e){return 0<=K.inArray(e,n)!==i})}function n(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function i(){wt.addEventListener?(wt.removeEventListener("DOMContentLoaded",r,!1),f.removeEventListener("load",r,!1)):(wt.detachEvent("onreadystatechange",r),f.detachEvent("onload",r))}function r(){!wt.addEventListener&&"load"!==event.type&&"complete"!==wt.readyState||(i(),K.ready())}function l(e,t,n){if(void 0===n&&1===e.nodeType)if(n="data-"+t.replace(Nt,"-$1").toLowerCase(),"string"==typeof(n=e.getAttribute(n))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:Pt.test(n)?K.parseJSON(n):n)}catch(e){}K.data(e,t,n)}else n=void 0;return n}function c(e){for(var t in e)if(("data"!==t||!K.isEmptyObject(e[t]))&&"toJSON"!==t)return;return 1}function o(e,t,n,i){if(K.acceptData(e)){var r=K.expando,o=e.nodeType,a=o?K.cache:e,s=o?e[r]:e[r]&&r;if(s&&a[s]&&(i||a[s].data)||void 0!==n||"string"!=typeof t)return a[s=s||(o?e[r]=V.pop()||K.guid++:r)]||(a[s]=o?{}:{toJSON:K.noop}),"object"!=typeof t&&"function"!=typeof t||(i?a[s]=K.extend(a[s],t):a[s].data=K.extend(a[s].data,t)),e=a[s],i||(e.data||(e.data={}),e=e.data),void 0!==n&&(e[K.camelCase(t)]=n),"string"==typeof t?null==(n=e[t])&&(n=e[K.camelCase(t)]):n=e,n}}function a(e,t,n){if(K.acceptData(e)){var i,r,o=e.nodeType,a=o?K.cache:e,s=o?e[K.expando]:K.expando;if(a[s]){if(t&&(i=n?a[s]:a[s].data)){for((r=(t=K.isArray(t)?t.concat(K.map(t,K.camelCase)):t in i?[t]:(t=K.camelCase(t))in i?[t]:t.split(" ")).length);r--;)delete i[t[r]];if(n?!c(i):!K.isEmptyObject(i))return}if(!n&&(delete a[s].data,!c(a[s])))return;o?K.cleanData([e],!0):Q.deleteExpando||a!=a.window?delete a[s]:a[s]=null}}}function u(){return!0}function h(){return!1}function d(){try{return wt.activeElement}catch(e){}}function p(e){var t=Qt.split("|");if((e=e.createDocumentFragment()).createElement)for(;t.length;)e.createElement(t.pop());return e}function m(e,t){var n,i,r=0,o=typeof e.getElementsByTagName!==Ht?e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!==Ht?e.querySelectorAll(t||"*"):void 0;if(!o)for(o=[],n=e.childNodes||e;null!=(i=n[r]);r++)!t||K.nodeName(i,t)?o.push(i):K.merge(o,m(i,t));return void 0===t||t&&K.nodeName(e,t)?K.merge([e],o):o}function g(e){zt.test(e.type)&&(e.defaultChecked=e.checked)}function v(e,t){return K.nodeName(e,"table")&&K.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function _(e){return e.type=(null!==K.find.attr(e,"type"))+"/"+e.type,e}function y(e){var t=un.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function b(e,t){for(var n,i=0;null!=(n=e[i]);i++)K._data(n,"globalEval",!t||K._data(t[i],"globalEval"))}function x(e,t){if(1===t.nodeType&&K.hasData(e)){var n,i,r=K._data(e),o=K._data(t,r),a=r.events;if(a)for(n in delete o.handle,o.events={},a)for(r=0,i=a[n].length;r<i;r++)K.event.add(t,n,a[n][r]);o.data&&(o.data=K.extend({},o.data))}}function E(e,t){var n=K(t.createElement(e)).appendTo(t.body),i=f.getDefaultComputedStyle?f.getDefaultComputedStyle(n[0]).display:K.css(n[0],"display");return n.detach(),i}function T(e){var t=wt,n=vn[e];return n||("none"!==(n=E(e,t))&&n||((t=((pn=(pn||K("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentWindow||pn[0].contentDocument).document).write(),t.close(),n=E(e,t),pn.detach()),vn[e]=n),n}function w(t,n){return{get:function(){var e=t();if(null!=e){if(!e)return(this.get=n).apply(this,arguments);delete this.get}}}}function C(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),i=t,r=zn.length;r--;)if((t=zn[r]+n)in e)return t;return i}function S(e,t){for(var n,i,r,o=[],a=0,s=e.length;a<s;a++)(i=e[a]).style&&(o[a]=K._data(i,"olddisplay"),n=i.style.display,t?(o[a]||"none"!==n||(i.style.display=""),""===i.style.display&&kt(i)&&(o[a]=K._data(i,"olddisplay",T(i.nodeName)))):!o[a]&&(r=kt(i),n&&"none"!==n||!r)&&K._data(i,"olddisplay",r?n:K.css(i,"display")));for(a=0;a<s;a++)!(i=e[a]).style||t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?o[a]||"":"none");return e}function D(e,t,n){return(e=kn.exec(t))?Math.max(0,e[1]-(n||0))+(e[2]||"px"):t}function R(e,t,n,i,r){t=n===(i?"border":"content")?4:"width"===t?1:0;for(var o=0;t<4;t+=2)"margin"===n&&(o+=K.css(e,n+Ot[t],!0,r)),i?("content"===n&&(o-=K.css(e,"padding"+Ot[t],!0,r)),"margin"!==n&&(o-=K.css(e,"border"+Ot[t]+"Width",!0,r))):(o+=K.css(e,"padding"+Ot[t],!0,r),"padding"!==n&&(o+=K.css(e,"border"+Ot[t]+"Width",!0,r)));return o}function A(e,t,n){var i=!0,r="width"===t?e.offsetWidth:e.offsetHeight,o=yn(e),a=Q.boxSizing()&&"border-box"===K.css(e,"boxSizing",!1,o);if(r<=0||null==r){if(((r=bn(e,t,o))<0||null==r)&&(r=e.style[t]),En.test(r))return r;i=a&&(Q.boxSizingReliable()||r===e.style[t]),r=parseFloat(r)||0}return r+R(e,t,n||(a?"border":"content"),i,o)+"px"}function M(e,t,n,i,r){return new M.prototype.init(e,t,n,i,r)}function L(){return setTimeout(function(){jn=void 0}),jn=K.now()}function H(e,t){var n,i={height:e},r=0;for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=Ot[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function F(e,t,n){for(var i,r=(Xn[t]||[]).concat(Xn["*"]),o=0,a=r.length;o<a;o++)if(i=r[o].call(n,t,e))return i}function P(r,e,t){var n,o,i,a,s,l,c=0,u=qn.length,h=K.Deferred().always(function(){delete f.elem}),f=function(){if(o)return!1;for(var e=jn||L(),t=1-((e=Math.max(0,d.startTime+d.duration-e))/d.duration||0),n=0,i=d.tweens.length;n<i;n++)d.tweens[n].run(t);return h.notifyWith(r,[d,t,e]),t<1&&i?e:(h.resolveWith(r,[d]),!1)},d=h.promise({elem:r,props:K.extend({},e),opts:K.extend(!0,{specialEasing:{}},t),originalProperties:e,originalOptions:t,startTime:jn||L(),duration:t.duration,tweens:[],createTween:function(e,t){var n=K.Tween(r,d.opts,e,t,d.opts.specialEasing[e]||d.opts.easing);return d.tweens.push(n),n},stop:function(e){var t=0,n=e?d.tweens.length:0;if(o)return this;for(o=!0;t<n;t++)d.tweens[t].run(1);return e?h.resolveWith(r,[d,e]):h.rejectWith(r,[d,e]),this}});for(n in e=d.props,t=d.opts.specialEasing,e)if(a=t[i=K.camelCase(n)],s=e[n],K.isArray(s)&&(a=s[1],s=e[n]=s[0]),n!==i&&(e[i]=s,delete e[n]),(l=K.cssHooks[i])&&"expand"in l)for(n in s=l.expand(s),delete e[i],s)n in e||(e[n]=s[n],t[n]=a);else t[i]=a;for(;c<u;c++)if(n=qn[c].call(d,r,e,d.opts))return n;return K.map(e,F,d),K.isFunction(d.opts.start)&&d.opts.start.call(r,d),K.fx.timer(K.extend(f,{elem:r,anim:d,queue:d.opts.queue})),d.progress(d.opts.progress).done(d.opts.done,d.opts.complete).fail(d.opts.fail).always(d.opts.always)}function N(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,i=0,r=e.toLowerCase().match(At)||[];if(K.isFunction(t))for(;n=r[i++];)"+"===n.charAt(0)?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function k(t,r,o,a){function s(e){var i;return l[e]=!0,K.each(t[e]||[],function(e,t){var n=t(r,o,a);return"string"!=typeof n||c||l[n]?c?!(i=n):void 0:(r.dataTypes.unshift(n),s(n),!1)}),i}var l={},c=t===xi;return s(r.dataTypes[0])||!l["*"]&&s("*")}function I(e,t){var n,i,r=K.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((r[i]?e:n=n||{})[i]=t[i]);return n&&K.extend(!0,e,n),e}function O(n,e,i,r){var t;if(K.isArray(e))K.each(e,function(e,t){i||wi.test(n)?r(n,t):O(n+"["+("object"==typeof t?e:"")+"]",t,i,r)});else if(i||"object"!==K.type(e))r(n,e);else for(t in e)O(n+"["+t+"]",e[t],i,r)}function B(e){try{return e?new f.ActiveXObject("Microsoft.XMLHTTP"):new f.XMLHttpRequest}catch(e){}}function z(){try{return new f.XMLHttpRequest}catch(e){}}function j(e){return K.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}function U(e,t){return t.toUpperCase()}var V=[],W=V.slice,G=V.concat,q=V.push,X=V.indexOf,$={},Y=$.toString,J=$.hasOwnProperty,Z="".trim,Q={},K=function(e,t){return new K.fn.init(e,t)},ee=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,te=/^-ms-/,ne=/-([\da-z])/gi;K.fn=K.prototype={jquery:"1.11.0",constructor:K,selector:"",length:0,toArray:function(){return W.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:W.call(this)},pushStack:function(e){return(e=K.merge(this.constructor(),e)).prevObject=this,e.context=this.context,e},each:function(e,t){return K.each(this,e,t)},map:function(n){return this.pushStack(K.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(W.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length;return e=+e+(e<0?t:0),this.pushStack(0<=e&&e<t?[this[e]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:q,sort:V.sort,splice:V.splice},K.extend=K.fn.extend=function(){var e,t,n,i,r,o=arguments[0]||{},a=1,s=arguments.length,l=!1;for("boolean"==typeof o&&(l=o,o=arguments[a]||{},a++),"object"==typeof o||K.isFunction(o)||(o={}),a===s&&(o=this,a--);a<s;a++)if(null!=(r=arguments[a]))for(i in r)e=o[i],o!==(n=r[i])&&(l&&n&&(K.isPlainObject(n)||(t=K.isArray(n)))?(e=t?(t=!1,e&&K.isArray(e)?e:[]):e&&K.isPlainObject(e)?e:{},o[i]=K.extend(l,e,n)):void 0!==n&&(o[i]=n));return o},K.extend({expando:"jQuery"+("1.11.0"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw Error(e)},noop:function(){},isFunction:function(e){return"function"===K.type(e)},isArray:Array.isArray||function(e){return"array"===K.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return 0<=e-parseFloat(e)},isEmptyObject:function(e){for(var t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==K.type(e)||e.nodeType||K.isWindow(e))return!1;try{if(e.constructor&&!J.call(e,"constructor")&&!J.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(Q.ownLast)for(t in e)return J.call(e,t);for(t in e);return void 0===t||J.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?$[Y.call(e)]||"object":typeof e},globalEval:function(e){e&&K.trim(e)&&(f.execScript||function(e){f.eval.call(f,e)})(e)},camelCase:function(e){return e.replace(te,"ms-").replace(ne,U)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var i=0,r=e.length,o=s(e);if(n){if(o)for(;i<r&&!1!==(o=t.apply(e[i],n));i++);else for(i in e)if(!1===(o=t.apply(e[i],n)))break}else if(o)for(;i<r&&!1!==(o=t.call(e[i],i,e[i]));i++);else for(i in e)if(!1===(o=t.call(e[i],i,e[i])))break;return e},trim:Z&&!Z.call("\ufeff ")?function(e){return null==e?"":Z.call(e)}:function(e){return null==e?"":(e+"").replace(ee,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(s(Object(e))?K.merge(n,"string"==typeof e?[e]:e):q.call(n,e)),n},inArray:function(e,t,n){var i;if(t){if(X)return X.call(t,e,n);for(i=t.length,n=n?n<0?Math.max(0,i+n):n:0;n<i;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,t){for(var n=+t.length,i=0,r=e.length;i<n;)e[r++]=t[i++];if(n!=n)for(;void 0!==t[i];)e[r++]=t[i++];return e.length=r,e},grep:function(e,t,n){for(var i=[],r=0,o=e.length,a=!n;r<o;r++)(n=!t(e[r],r))!==a&&i.push(e[r]);return i},map:function(e,t,n){var i,r=0,o=e.length,a=[];if(s(e))for(;r<o;r++)null!=(i=t(e[r],r,n))&&a.push(i);else for(r in e)null!=(i=t(e[r],r,n))&&a.push(i);return G.apply([],a)},guid:1,proxy:function(e,t){var n,i;if("string"==typeof t&&(i=e[t],t=e,e=i),K.isFunction(e))return n=W.call(arguments,2),(i=function(){return e.apply(t||this,n.concat(W.call(arguments)))}).guid=e.guid=e.guid||K.guid++,i},now:function(){return+new Date},support:Q}),K.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){$["[object "+t+"]"]=t.toLowerCase()});function ie(e,t,n,i){var r,o,a,s,l,c;if((t?t.ownerDocument||t:ze)!==Se&&Ce(t),n=n||[],!e||"string"!=typeof e)return n;if(1!==(s=(t=t||Se).nodeType)&&9!==s)return[];if(Re&&!i){if(r=mt.exec(e))if(a=r[1]){if(9===s){if(!(o=t.getElementById(a))||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&He(t,o)&&o.id===a)return n.push(o),n}else{if(r[2])return Ke.apply(n,t.getElementsByTagName(e)),n;if((a=r[3])&&ve.getElementsByClassName&&t.getElementsByClassName)return Ke.apply(n,t.getElementsByClassName(a)),n}if(ve.qsa&&(!Ae||!Ae.test(e))){if(o=r=Be,a=t,l=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(s=Ne(e),(r=t.getAttribute("id"))?o=r.replace(vt,"\\$&"):t.setAttribute("id",o),o="[id='"+o+"'] ",a=s.length;a--;)s[a]=o+ke(s[a]);a=gt.test(e)&&Pe(t.parentNode)||t,l=s.join(",")}if(l)try{return Ke.apply(n,a.querySelectorAll(l)),n}catch(e){}finally{r||t.removeAttribute("id")}}}e:{if(e=e.replace(ot,"$1"),o=Ne(e),!i&&1===o.length){if(2<(r=o[0]=o[0].slice(0)).length&&"ID"===(c=r[0]).type&&ve.getById&&9===t.nodeType&&Re&&_e.relative[r[1].type]){if(!(t=(_e.find.ID(c.matches[0].replace(_t,yt),t)||[])[0])){c=n;break e}e=e.slice(r.shift().value.length)}for(s=ht.needsContext.test(e)?0:r.length;s--&&(c=r[s],!_e.relative[a=c.type]);)if((a=_e.find[a])&&(i=a(c.matches[0].replace(_t,yt),gt.test(r[0].type)&&Pe(t.parentNode)||t))){if(r.splice(s,1),e=i.length&&ke(r))break;Ke.apply(n,i),c=n;break e}}xe(e,o)(i,t,!Re,n,gt.test(e)&&Pe(t.parentNode)||t),c=n}return c}function re(){function n(e,t){return i.push(e+" ")>_e.cacheLength&&delete n[i.shift()],n[e+" "]=t}var i=[];return n}function oe(e){return e[Be]=!0,e}function ae(e){var t=Se.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t)}}function se(e,t){for(var n=e.split("|"),i=e.length;i--;)_e.attrHandle[n[i]]=t}function le(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||$e)-(~e.sourceIndex||$e);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function ce(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ue(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}function he(a){return oe(function(o){return o=+o,oe(function(e,t){for(var n,i=a([],e.length,o),r=i.length;r--;)e[n=i[r]]&&(e[n]=!(t[n]=e[n]))})})}function fe(){}function de(a,e,t){var s=e.dir,l=t&&"parentNode"===s,c=Ue++;return e.first?function(e,t,n){for(;e=e[s];)if(1===e.nodeType||l)return a(e,t,n)}:function(e,t,n){var i,r,o=[je,c];if(n){for(;e=e[s];)if((1===e.nodeType||l)&&a(e,t,n))return!0}else for(;e=e[s];)if(1===e.nodeType||l){if((i=(r=e[Be]||(e[Be]={}))[s])&&i[0]===je&&i[1]===c)return o[2]=i[2];if((r[s]=o)[2]=a(e,t,n))return!0}}}function pe(r){return 1<r.length?function(e,t,n){for(var i=r.length;i--;)if(!r[i](e,t,n))return!1;return!0}:r[0]}function me(e,t,n,i,r){for(var o,a=[],s=0,l=e.length,c=null!=t;s<l;s++)(o=e[s])&&(n&&!n(o,i,r)||(a.push(o),c&&t.push(s)));return a}var ge,ve,_e,ye,be,xe,Ee,Te,we,Ce,Se,De,Re,Ae,Me,Le,He,Fe=f,Pe=function(e){return e&&typeof e.getElementsByTagName!==Xe&&e},Ne=function(e,t){var n,i,r,o,a,s,l;if(a=We[e+" "])return t?0:a.slice(0);for(a=e,s=[],l=_e.preFilter;a;){for(o in n&&!(i=at.exec(a))||(i&&(a=a.slice(i[0].length)||a),s.push(r=[])),n=!1,(i=st.exec(a))&&(n=i.shift(),r.push({value:n,type:i[0].replace(ot," ")}),a=a.slice(n.length)),_e.filter)!(i=ht[o].exec(a))||l[o]&&!(i=l[o](i))||(n=i.shift(),r.push({value:n,type:o,matches:i}),a=a.slice(n.length));if(!n)break}return t?a.length:a?ie.error(e):We(e,s).slice(0)},ke=function(e){for(var t=0,n=e.length,i="";t<n;t++)i+=e[t].value;return i},Ie=function(p,m,g,v,_,e){return v&&!v[Be]&&(v=Ie(v)),_&&!_[Be]&&(_=Ie(_,e)),oe(function(e,t,n,i){var r,o,a,s=[],l=[],c=t.length;if(!(a=e)){a=m||"*";for(var u=n.nodeType?[n]:n,h=[],f=0,d=u.length;f<d;f++)ie(a,u[f],h);a=h}if(a=!p||!e&&m?a:me(a,s,p,n,i),u=g?_||(e?p:c||v)?[]:t:a,g&&g(a,u,n,i),v)for(r=me(u,l),v(r,[],n,i),n=r.length;n--;)(o=r[n])&&(u[l[n]]=!(a[l[n]]=o));if(e){if(_||p){if(_){for(r=[],n=u.length;n--;)(o=u[n])&&r.push(a[n]=o);_(null,u=[],r,i)}for(n=u.length;n--;)(o=u[n])&&-1<(r=_?tt.call(e,o):s[n])&&(e[r]=!(t[r]=o))}}else u=me(u===t?u.splice(c,u.length):u),_?_(null,t,u,i):Ke.apply(t,u)})},Oe=function(e){for(var i,t,n=e.length,r=_e.relative[e[0].type],o=r||_e.relative[" "],a=r?1:0,s=de(function(e){return e===i},o,!0),l=de(function(e){return-1<tt.call(i,e)},o,!0),c=[function(e,t,n){return!r&&(n||t!==Ee)||((i=t).nodeType?s:l)(e,t,n)}];a<n;a++)if(o=_e.relative[e[a].type])c=[de(pe(c),o)];else{if((o=_e.filter[e[a].type].apply(null,e[a].matches))[Be]){for(t=++a;t<n&&!_e.relative[e[t].type];t++);return Ie(1<a&&pe(c),1<a&&ke(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(ot,"$1"),o,a<t&&Oe(e.slice(a,t)),t<n&&Oe(e=e.slice(t)),t<n&&ke(e))}c.push(o)}return pe(c)},Be="sizzle"+-new Date,ze=Fe.document,je=0,Ue=0,Ve=re(),We=re(),Ge=re(),qe=function(e,t){return e===t&&(we=!0),0},Xe="undefined",$e=-2147483648,Ye={}.hasOwnProperty,Je=[],Ze=Je.pop,Qe=Je.push,Ke=Je.push,et=Je.slice,tt=Je.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e)return t;return-1},nt="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w#"),it="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)[\\x20\\t\\r\\n\\f]*(?:([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+nt+")|)|)[\\x20\\t\\r\\n\\f]*\\]",rt=":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+it.replace(3,8)+")*)|.*)\\)|)",ot=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),at=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,st=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,lt=RegExp("=[\\x20\\t\\r\\n\\f]*([^\\]'\"]*?)[\\x20\\t\\r\\n\\f]*\\]","g"),ct=RegExp(rt),ut=RegExp("^"+nt+"$"),ht={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:RegExp("^("+"(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:RegExp("^"+it),PSEUDO:RegExp("^"+rt),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},ft=/^(?:input|select|textarea|button)$/i,dt=/^h\d$/i,pt=/^[^{]+\{\s*\[native \w/,mt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,gt=/[+~]/,vt=/'|\\/g,_t=RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)","ig"),yt=function(e,t,n){return(e="0x"+t-65536)!=e||n?t:e<0?String.fromCharCode(65536+e):String.fromCharCode(e>>10|55296,1023&e|56320)};try{Ke.apply(Je=et.call(ze.childNodes),ze.childNodes),Je[ze.childNodes.length].nodeType}catch(e){Ke={apply:Je.length?function(e,t){Qe.apply(e,et.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}for(ge in ve=ie.support={},be=ie.isXML=function(e){return!!(e=e&&(e.ownerDocument||e).documentElement)&&"HTML"!==e.nodeName},Ce=ie.setDocument=function(e){var s=e?e.ownerDocument||e:ze;return e=s.defaultView,s!==Se&&9===s.nodeType&&s.documentElement?(De=(Se=s).documentElement,Re=!be(s),e&&e!==e.top&&(e.addEventListener?e.addEventListener("unload",function(){Ce()},!1):e.attachEvent&&e.attachEvent("onunload",function(){Ce()})),ve.attributes=ae(function(e){return e.className="i",!e.getAttribute("className")}),ve.getElementsByTagName=ae(function(e){return e.appendChild(s.createComment("")),!e.getElementsByTagName("*").length}),ve.getElementsByClassName=pt.test(s.getElementsByClassName)&&ae(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),ve.getById=ae(function(e){return De.appendChild(e).id=Be,!s.getElementsByName||!s.getElementsByName(Be).length}),ve.getById?(_e.find.ID=function(e,t){if(typeof t.getElementById!==Xe&&Re){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},_e.filter.ID=function(e){var t=e.replace(_t,yt);return function(e){return e.getAttribute("id")===t}}):(delete _e.find.ID,_e.filter.ID=function(e){var t=e.replace(_t,yt);return function(e){return(e=typeof e.getAttributeNode!==Xe&&e.getAttributeNode("id"))&&e.value===t}}),_e.find.TAG=ve.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!==Xe)return t.getElementsByTagName(e)}:function(e,t){var n,i=[],r=0,o=t.getElementsByTagName(e);if("*"!==e)return o;for(;n=o[r++];)1===n.nodeType&&i.push(n);return i},_e.find.CLASS=ve.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!==Xe&&Re)return t.getElementsByClassName(e)},Me=[],Ae=[],(ve.qsa=pt.test(s.querySelectorAll))&&(ae(function(e){e.innerHTML="<select t=''><option selected=''></option></select>",e.querySelectorAll("[t^='']").length&&Ae.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),e.querySelectorAll("[selected]").length||Ae.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)"),e.querySelectorAll(":checked").length||Ae.push(":checked")}),ae(function(e){var t=s.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&Ae.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?="),e.querySelectorAll(":enabled").length||Ae.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),Ae.push(",.*:")})),(ve.matchesSelector=pt.test(Le=De.webkitMatchesSelector||De.mozMatchesSelector||De.oMatchesSelector||De.msMatchesSelector))&&ae(function(e){ve.disconnectedMatch=Le.call(e,"div"),Le.call(e,"[s!='']:x"),Me.push("!=",rt)}),Ae=Ae.length&&RegExp(Ae.join("|")),Me=Me.length&&RegExp(Me.join("|")),He=(e=pt.test(De.compareDocumentPosition))||pt.test(De.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},qe=e?function(e,t){if(e===t)return we=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!ve.sortDetached&&t.compareDocumentPosition(e)===n?e===s||e.ownerDocument===ze&&He(ze,e)?-1:t===s||t.ownerDocument===ze&&He(ze,t)?1:Te?tt.call(Te,e)-tt.call(Te,t):0:4&n?-1:1)}:function(e,t){if(e===t)return we=!0,0;var n=0,i=e.parentNode,r=t.parentNode,o=[e],a=[t];if(!i||!r)return e===s?-1:t===s?1:i?-1:r?1:Te?tt.call(Te,e)-tt.call(Te,t):0;if(i===r)return le(e,t);for(i=e;i=i.parentNode;)o.unshift(i);for(i=t;i=i.parentNode;)a.unshift(i);for(;o[n]===a[n];)n++;return n?le(o[n],a[n]):o[n]===ze?-1:a[n]===ze?1:0},s):Se},ie.matches=function(e,t){return ie(e,null,null,t)},ie.matchesSelector=function(e,t){if((e.ownerDocument||e)!==Se&&Ce(e),t=t.replace(lt,"='$1']"),ve.matchesSelector&&Re&&(!Me||!Me.test(t))&&(!Ae||!Ae.test(t)))try{var n=Le.call(e,t);if(n||ve.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return 0<ie(t,Se,null,[e]).length},ie.contains=function(e,t){return(e.ownerDocument||e)!==Se&&Ce(e),He(e,t)},ie.attr=function(e,t){(e.ownerDocument||e)!==Se&&Ce(e);var n=_e.attrHandle[t.toLowerCase()];return void 0!==(n=n&&Ye.call(_e.attrHandle,t.toLowerCase())?n(e,t,!Re):void 0)?n:ve.attributes||!Re?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},ie.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},ie.uniqueSort=function(e){var t,n=[],i=0,r=0;if(we=!ve.detectDuplicates,Te=!ve.sortStable&&e.slice(0),e.sort(qe),we){for(;t=e[r++];)t===e[r]&&(i=n.push(r));for(;i--;)e.splice(n[i],1)}return Te=null,e},ye=ie.getText=function(e){var t,n="",i=0;if(t=e.nodeType){if(1===t||9===t||11===t){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=ye(e)}else if(3===t||4===t)return e.nodeValue}else for(;t=e[i++];)n+=ye(t);return n},(_e=ie.selectors={cacheLength:50,createPseudo:oe,match:ht,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(_t,yt),e[3]=(e[4]||e[5]||"").replace(_t,yt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ie.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ie.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return ht.CHILD.test(e[0])?null:(e[3]&&void 0!==e[4]?e[2]=e[4]:n&&ct.test(n)&&(t=Ne(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(_t,yt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=Ve[e+" "];return t||(t=RegExp("(^|[\\x20\\t\\r\\n\\f])"+e+"([\\x20\\t\\r\\n\\f]|$)"))&&Ve(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==Xe&&e.getAttribute("class")||"")})},ATTR:function(t,n,i){return function(e){return null==(e=ie.attr(e,t))?"!="===n:!n||(e+="","="===n?e===i:"!="===n?e!==i:"^="===n?i&&0===e.indexOf(i):"*="===n?i&&-1<e.indexOf(i):"$="===n?i&&e.slice(-i.length)===i:"~="===n?-1<(" "+e+" ").indexOf(i):"|="===n&&(e===i||e.slice(0,i.length+1)===i+"-"))}},CHILD:function(u,e,t,h,f){var d="nth"!==u.slice(0,3),p="last"!==u.slice(-4),m="of-type"===e;return 1===h&&0===f?function(e){return!!e.parentNode}:function(e,t,n){var i,r,o,a,s;t=d!=p?"nextSibling":"previousSibling";var l=e.parentNode,c=m&&e.nodeName.toLowerCase();if(n=!n&&!m,l){if(d){for(;t;){for(r=e;r=r[t];)if(m?r.nodeName.toLowerCase()===c:1===r.nodeType)return!1;s=t="only"===u&&!s&&"nextSibling"}return!0}if(s=[p?l.firstChild:l.lastChild],p&&n){for(a=(i=(n=l[Be]||(l[Be]={}))[u]||[])[0]===je&&i[1],o=i[0]===je&&i[2],r=a&&l.childNodes[a];r=++a&&r&&r[t]||(o=a=0)||s.pop();)if(1===r.nodeType&&++o&&r===e){n[u]=[je,a,o];break}}else if(n&&(i=(e[Be]||(e[Be]={}))[u])&&i[0]===je)o=i[1];else for(;(r=++a&&r&&r[t]||(o=a=0)||s.pop())&&((m?r.nodeName.toLowerCase()!==c:1!==r.nodeType)||!++o||(n&&((r[Be]||(r[Be]={}))[u]=[je,o]),r!==e)););return(o-=f)===h||0==o%h&&0<=o/h}}},PSEUDO:function(e,o){var t,a=_e.pseudos[e]||_e.setFilters[e.toLowerCase()]||ie.error("unsupported pseudo: "+e);return a[Be]?a(o):1<a.length?(t=[e,e,"",o],_e.setFilters.hasOwnProperty(e.toLowerCase())?oe(function(e,t){for(var n,i=a(e,o),r=i.length;r--;)e[n=tt.call(e,i[r])]=!(t[n]=i[r])}):function(e){return a(e,0,t)}):a}},pseudos:{not:oe(function(e){var i=[],r=[],o=xe(e.replace(ot,"$1"));return o[Be]?oe(function(e,t,n,i){i=o(e,null,i,[]);for(var r=e.length;r--;)(n=i[r])&&(e[r]=!(t[r]=n))}):function(e,t,n){return i[0]=e,o(i,null,n,r),!r.pop()}}),has:oe(function(t){return function(e){return 0<ie(t,e).length}}),contains:oe(function(t){return function(e){return-1<(e.textContent||e.innerText||ye(e)).indexOf(t)}}),lang:oe(function(n){return ut.test(n||"")||ie.error("unsupported lang: "+n),n=n.replace(_t,yt).toLowerCase(),function(e){var t;do{if(t=Re?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=Fe.location&&Fe.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===De},focus:function(e){return e===Se.activeElement&&(!Se.hasFocus||Se.hasFocus())&&!(!e.type&&!e.href&&!~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!_e.pseudos.empty(e)},header:function(e){return dt.test(e.nodeName)},input:function(e){return ft.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:he(function(){return[0]}),last:he(function(e,t){return[t-1]}),eq:he(function(e,t,n){return[n<0?n+t:n]}),even:he(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:he(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:he(function(e,t,n){for(t=n<0?n+t:n;0<=--t;)e.push(t);return e}),gt:he(function(e,t,n){for(n=n<0?n+t:n;++n<t;)e.push(n);return e})}}).pseudos.nth=_e.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})_e.pseudos[ge]=ce(ge);for(ge in{submit:!0,reset:!0})_e.pseudos[ge]=ue(ge);fe.prototype=_e.filters=_e.pseudos,_e.setFilters=new fe,xe=ie.compile=function(e,t){var g=[],v=[],n=Ge[e+" "];if(!n){for(i=(t=t||Ne(e)).length;i--;)(n=Oe(t[i]))[Be]?g.push(n):v.push(n);var _=0<g.length,y=0<v.length,i=function(e,t,n,i,r){var o,a,s,l=0,c="0",u=e&&[],h=[],f=Ee,d=e||y&&_e.find.TAG("*",r),p=je+=null==f?1:Math.random()||.1,m=d.length;for(r&&(Ee=t!==Se&&t);c!==m&&null!=(o=d[c]);c++){if(y&&o){for(a=0;s=v[a++];)if(s(o,t,n)){i.push(o);break}r&&(je=p)}_&&((o=!s&&o)&&l--,e&&u.push(o))}if(l+=c,_&&c!==l){for(a=0;s=g[a++];)s(u,h,t,n);if(e){if(0<l)for(;c--;)u[c]||h[c]||(h[c]=Ze.call(i));h=me(h)}Ke.apply(i,h),r&&!e&&0<h.length&&1<l+g.length&&ie.uniqueSort(i)}return r&&(je=p,Ee=f),u};i=_?oe(i):i,n=Ge(e,i)}return n},ve.sortStable=Be.split("").sort(qe).join("")===Be,ve.detectDuplicates=!!we,Ce(),ve.sortDetached=ae(function(e){return 1&e.compareDocumentPosition(Se.createElement("div"))}),ae(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||se("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),ve.attributes&&ae(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||se("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ae(function(e){return null==e.getAttribute("disabled")})||se("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(e,t,n){var i;if(!n)return!0===e[t]?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),K.find=ie,K.expr=ie.selectors,K.expr[":"]=K.expr.pseudos,K.unique=ie.uniqueSort,K.text=ie.getText,K.isXMLDoc=ie.isXML,K.contains=ie.contains;var bt=K.expr.match.needsContext,xt=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Et=/^.[^:#\[\.,]*$/;K.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?K.find.matchesSelector(i,e)?[i]:[]:K.find.matches(e,K.grep(t,function(e){return 1===e.nodeType}))},K.fn.extend({find:function(e){var t,n=[],i=this,r=i.length;if("string"!=typeof e)return this.pushStack(K(e).filter(function(){for(t=0;t<r;t++)if(K.contains(i[t],this))return!0}));for(t=0;t<r;t++)K.find(e,i[t],n);return(n=this.pushStack(1<r?K.unique(n):n)).selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(t(this,e||[],!1))},not:function(e){return this.pushStack(t(this,e||[],!0))},is:function(e){return!!t(this,"string"==typeof e&&bt.test(e)?K(e):e||[],!1).length}});var Tt,wt=f.document,Ct=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(K.fn.init=function(e,t){var n,i;if(!e)return this;if("string"!=typeof e)return e.nodeType?(this.context=this[0]=e,this.length=1,this):K.isFunction(e)?void 0!==Tt.ready?Tt.ready(e):e(K):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),K.makeArray(e,this));if(!(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&3<=e.length?[null,e,null]:Ct.exec(e))||!n[1]&&t)return!t||t.jquery?(t||Tt).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof K?t[0]:t,K.merge(this,K.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:wt,!0)),xt.test(n[1])&&K.isPlainObject(t))for(n in t)K.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n])}else{if((i=wt.getElementById(n[2]))&&i.parentNode){if(i.id!==n[2])return Tt.find(e);this.length=1,this[0]=i}this.context=wt,this.selector=e}return this}).prototype=K.fn,Tt=K(wt);var St=/^(?:parents|prev(?:Until|All))/,Dt={children:!0,contents:!0,next:!0,prev:!0};K.extend({dir:function(e,t,n){var i=[];for(e=e[t];e&&9!==e.nodeType&&(void 0===n||1!==e.nodeType||!K(e).is(n));)1===e.nodeType&&i.push(e),e=e[t];return i},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}}),K.fn.extend({has:function(e){var t,n=K(e,this),i=n.length;return this.filter(function(){for(t=0;t<i;t++)if(K.contains(this,n[t]))return!0})},closest:function(e,t){for(var n,i=0,r=this.length,o=[],a=bt.test(e)||"string"!=typeof e?K(e,t||this.context):0;i<r;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&K.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?K.unique(o):o)},index:function(e){return e?"string"==typeof e?K.inArray(this[0],K(e)):K.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(K.unique(K.merge(this.get(),K(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),K.each({parent:function(e){return(e=e.parentNode)&&11!==e.nodeType?e:null},parents:function(e){return K.dir(e,"parentNode")},parentsUntil:function(e,t,n){return K.dir(e,"parentNode",n)},next:function(e){return n(e,"nextSibling")},prev:function(e){return n(e,"previousSibling")},nextAll:function(e){return K.dir(e,"nextSibling")},prevAll:function(e){return K.dir(e,"previousSibling")},nextUntil:function(e,t,n){return K.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return K.dir(e,"previousSibling",n)},siblings:function(e){return K.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return K.sibling(e.firstChild)},contents:function(e){return K.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:K.merge([],e.childNodes)}},function(i,r){K.fn[i]=function(e,t){var n=K.map(this,r,e);return"Until"!==i.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=K.filter(t,n)),1<this.length&&(Dt[i]||(n=K.unique(n)),St.test(i)&&(n=n.reverse())),this.pushStack(n)}});var Rt,At=/\S+/g,Mt={};K.Callbacks=function(r){var e,n;"string"==typeof r?(e=Mt[r])||(n=Mt[e=r]={},K.each(e.match(At)||[],function(e,t){n[t]=!0}),e=n):e=K.extend({},r);var i,t,o,a,s,l,c=[],u=!(r=e).once&&[],h=function(e){for(t=r.memory&&e,o=!0,s=l||0,l=0,a=c.length,i=!0;c&&s<a;s++)if(!1===c[s].apply(e[0],e[1])&&r.stopOnFalse){t=!1;break}i=!1,c&&(u?u.length&&h(u.shift()):t?c=[]:f.disable())},f={add:function(){var e;return c&&(e=c.length,function i(e){K.each(e,function(e,t){var n=K.type(t);"function"===n?r.unique&&f.has(t)||c.push(t):t&&t.length&&"string"!==n&&i(t)})}(arguments),i?a=c.length:t&&(l=e,h(t))),this},remove:function(){return c&&K.each(arguments,function(e,t){for(var n;-1<(n=K.inArray(t,c,n));)c.splice(n,1),i&&(n<=a&&a--,n<=s&&s--)}),this},has:function(e){return e?-1<K.inArray(e,c):!(!c||!c.length)},empty:function(){return c=[],a=0,this},disable:function(){return c=u=t=void 0,this},disabled:function(){return!c},lock:function(){return u=void 0,t||f.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!c||o&&!u||(t=[e,(t=t||[]).slice?t.slice():t],i?u.push(t):h(t)),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},K.extend({Deferred:function(e){var o=[["resolve","done",K.Callbacks("once memory"),"resolved"],["reject","fail",K.Callbacks("once memory"),"rejected"],["notify","progress",K.Callbacks("memory")]],r="pending",a={state:function(){return r},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var r=arguments;return K.Deferred(function(i){K.each(o,function(e,t){var n=K.isFunction(r[e])&&r[e];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&K.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[t[0]+"With"](this===a?i.promise():this,n?[e]:arguments)})}),r=null}).promise()},promise:function(e){return null!=e?K.extend(e,a):a}},s={};return a.pipe=a.then,K.each(o,function(e,t){var n=t[2],i=t[3];a[t[1]]=n.add,i&&n.add(function(){r=i},o[1^e][2].disable,o[2][2].lock),s[t[0]]=function(){return s[t[0]+"With"](this===s?a:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){function t(t,n,i){return function(e){n[t]=this,i[t]=1<arguments.length?W.call(arguments):e,i===r?c.notifyWith(n,i):--l||c.resolveWith(n,i)}}var r,n,i,o=0,a=W.call(arguments),s=a.length,l=1!==s||e&&K.isFunction(e.promise)?s:0,c=1===l?e:K.Deferred();if(1<s)for(r=Array(s),n=Array(s),i=Array(s);o<s;o++)a[o]&&K.isFunction(a[o].promise)?a[o].promise().done(t(o,i,a)).fail(c.reject).progress(t(o,n,r)):--l;return l||c.resolveWith(i,a),c.promise()}}),K.fn.ready=function(e){return K.ready.promise().done(e),this},K.extend({isReady:!1,readyWait:1,holdReady:function(e){e?K.readyWait++:K.ready(!0)},ready:function(e){if(!(!0===e?--K.readyWait:K.isReady)){if(!wt.body)return setTimeout(K.ready);(K.isReady=!0)!==e&&0<--K.readyWait||(Rt.resolveWith(wt,[K]),K.fn.trigger&&K(wt).trigger("ready").off("ready"))}}}),K.ready.promise=function(e){if(!Rt)if(Rt=K.Deferred(),"complete"===wt.readyState)setTimeout(K.ready);else if(wt.addEventListener)wt.addEventListener("DOMContentLoaded",r,!1),f.addEventListener("load",r,!1);else{wt.attachEvent("onreadystatechange",r),f.attachEvent("onload",r);var n=!1;try{n=null==f.frameElement&&wt.documentElement}catch(e){}n&&n.doScroll&&function t(){if(!K.isReady){try{n.doScroll("left")}catch(e){return setTimeout(t,50)}i(),K.ready()}}()}return Rt.promise(e)};var Lt,Ht="undefined";for(Lt in K(Q))break;Q.ownLast="0"!==Lt,Q.inlineBlockNeedsLayout=!1,K(function(){var e,t,n=wt.getElementsByTagName("body")[0];n&&((e=wt.createElement("div")).style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",t=wt.createElement("div"),n.appendChild(e).appendChild(t),typeof t.style.zoom!==Ht&&(t.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1",Q.inlineBlockNeedsLayout=3===t.offsetWidth)&&(n.style.zoom=1),n.removeChild(e))});var Ft=wt.createElement("div");if(null==Q.deleteExpando){Q.deleteExpando=!0;try{delete Ft.test}catch(e){Q.deleteExpando=!1}}K.acceptData=function(e){var t=K.noData[(e.nodeName+" ").toLowerCase()],n=+e.nodeType||1;return(1===n||9===n)&&(!t||!0!==t&&e.getAttribute("classid")===t)};var Pt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Nt=/([A-Z])/g;K.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return!!(e=e.nodeType?K.cache[e[K.expando]]:e[K.expando])&&!c(e)},data:function(e,t,n){return o(e,t,n)},removeData:function(e,t){return a(e,t)},_data:function(e,t,n){return o(e,t,n,!0)},_removeData:function(e,t){return a(e,t,!0)}}),K.fn.extend({data:function(e,t){var n,i,r,o=this[0],a=o&&o.attributes;if(void 0!==e)return"object"==typeof e?this.each(function(){K.data(this,e)}):1<arguments.length?this.each(function(){K.data(this,e,t)}):o?l(o,e,K.data(o,e)):void 0;if(this.length&&(r=K.data(o),1===o.nodeType&&!K._data(o,"parsedAttrs"))){for(n=a.length;n--;)0===(i=a[n].name).indexOf("data-")&&l(o,i=K.camelCase(i.slice(5)),r[i]);K._data(o,"parsedAttrs",!0)}return r},removeData:function(e){return this.each(function(){K.removeData(this,e)})}}),K.extend({queue:function(e,t,n){var i;if(e)return t=(t||"fx")+"queue",i=K._data(e,t),n&&(!i||K.isArray(n)?i=K._data(e,t,K.makeArray(n)):i.push(n)),i||[]},dequeue:function(e,t){t=t||"fx";var n=K.queue(e,t),i=n.length,r=n.shift(),o=K._queueHooks(e,t);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===t&&n.unshift("inprogress"),delete o.stop,r.call(e,function(){K.dequeue(e,t)},o)),!i&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return K._data(e,n)||K._data(e,n,{empty:K.Callbacks("once memory").add(function(){K._removeData(e,t+"queue"),K._removeData(e,n)})})}}),K.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?K.queue(this[0],t):void 0===n?this:this.each(function(){var e=K.queue(this,t,n);K._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&K.dequeue(this,t)})},dequeue:function(e){return this.each(function(){K.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){function n(){--r||o.resolveWith(a,[a])}var i,r=1,o=K.Deferred(),a=this,s=this.length;for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)(i=K._data(a[s],e+"queueHooks"))&&i.empty&&(r++,i.empty.add(n));return n(),o.promise(t)}});function kt(e,t){return e=t||e,"none"===K.css(e,"display")||!K.contains(e.ownerDocument,e)}var It=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ot=["Top","Right","Bottom","Left"],Bt=K.access=function(e,t,n,i,r,o,a){var s=0,l=e.length,c=null==n;if("object"===K.type(n))for(s in r=!0,n)K.access(e,t,s,n[s],!0,o,a);else if(void 0!==i&&(r=!0,K.isFunction(i)||(a=!0),c&&(t=a?(t.call(e,i),null):(c=t,function(e,t,n){return c.call(K(e),n)})),t))for(;s<l;s++)t(e[s],n,a?i:i.call(e[s],s,t(e[s],n)));return r?e:c?t.call(e):l?t(e[0],n):o},zt=/^(?:checkbox|radio)$/i,jt=wt.createDocumentFragment(),Ut=wt.createElement("div"),Vt=wt.createElement("input");if(Ut.setAttribute("className","t"),Ut.innerHTML="  <link/><table></table><a href='/a'>a</a>",Q.leadingWhitespace=3===Ut.firstChild.nodeType,Q.tbody=!Ut.getElementsByTagName("tbody").length,Q.htmlSerialize=!!Ut.getElementsByTagName("link").length,Q.html5Clone="<:nav></:nav>"!==wt.createElement("nav").cloneNode(!0).outerHTML,Vt.type="checkbox",Vt.checked=!0,jt.appendChild(Vt),Q.appendChecked=Vt.checked,Ut.innerHTML="<textarea>x</textarea>",Q.noCloneChecked=!!Ut.cloneNode(!0).lastChild.defaultValue,jt.appendChild(Ut),Ut.innerHTML="<input type='radio' checked='checked' name='t'/>",Q.checkClone=Ut.cloneNode(!0).cloneNode(!0).lastChild.checked,Q.noCloneEvent=!0,Ut.attachEvent&&(Ut.attachEvent("onclick",function(){Q.noCloneEvent=!1}),Ut.cloneNode(!0).click()),null==Q.deleteExpando){Q.deleteExpando=!0;try{delete Ut.test}catch(e){Q.deleteExpando=!1}}var Wt,Gt,jt=Ut=Vt=null,qt=wt.createElement("div");for(Wt in{submit:!0,change:!0,focusin:!0})Gt="on"+Wt,(Q[Wt+"Bubbles"]=Gt in f)||(qt.setAttribute(Gt,"t"),Q[Wt+"Bubbles"]=!1===qt.attributes[Gt].expando);var Xt=/^(?:input|select|textarea)$/i,$t=/^key/,Yt=/^(?:mouse|contextmenu)|click/,Jt=/^(?:focusinfocus|focusoutblur)$/,Zt=/^([^.]*)(?:\.(.+)|)$/;K.event={global:{},add:function(e,t,n,i,r){var o,a,s,l,c,u,h,f,d;if(s=K._data(e)){for(n.handler&&(n=(l=n).handler,r=l.selector),n.guid||(n.guid=K.guid++),(a=s.events)||(a=s.events={}),(c=s.handle)||((c=s.handle=function(e){return typeof K===Ht||e&&K.event.triggered===e.type?void 0:K.event.dispatch.apply(c.elem,arguments)}).elem=e),s=(t=(t||"").match(At)||[""]).length;s--;)f=u=(o=Zt.exec(t[s])||[])[1],d=(o[2]||"").split(".").sort(),f&&(o=K.event.special[f]||{},f=(r?o.delegateType:o.bindType)||f,o=K.event.special[f]||{},u=K.extend({type:f,origType:u,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&K.expr.match.needsContext.test(r),namespace:d.join(".")},l),(h=a[f])||((h=a[f]=[]).delegateCount=0,o.setup&&!1!==o.setup.call(e,i,d,c)||(e.addEventListener?e.addEventListener(f,c,!1):e.attachEvent&&e.attachEvent("on"+f,c))),o.add&&(o.add.call(e,u),u.handler.guid||(u.handler.guid=n.guid)),r?h.splice(h.delegateCount++,0,u):h.push(u),K.event.global[f]=!0);e=null}},remove:function(e,t,n,i,r){var o,a,s,l,c,u,h,f,d,p,m,g=K.hasData(e)&&K._data(e);if(g&&(u=g.events)){for(c=(t=(t||"").match(At)||[""]).length;c--;)if(d=m=(s=Zt.exec(t[c])||[])[1],p=(s[2]||"").split(".").sort(),d){for(h=K.event.special[d]||{},f=u[d=(i?h.delegateType:h.bindType)||d]||[],s=s[2]&&RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=f.length;o--;)a=f[o],!r&&m!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||i&&i!==a.selector&&("**"!==i||!a.selector)||(f.splice(o,1),a.selector&&f.delegateCount--,h.remove&&h.remove.call(e,a));l&&!f.length&&(h.teardown&&!1!==h.teardown.call(e,p,g.handle)||K.removeEvent(e,d,g.handle),delete u[d])}else for(d in u)K.event.remove(e,d+t[c],n,i,!0);K.isEmptyObject(u)&&(delete g.handle,K._removeData(e,"events"))}},trigger:function(e,t,n,i){var r,o,a,s,l=[n||wt],c=J.call(e,"type")?e.type:e,u=J.call(e,"namespace")?e.namespace.split("."):[],h=r=n=n||wt;if(3!==n.nodeType&&8!==n.nodeType&&!Jt.test(c+K.event.triggered)&&(0<=c.indexOf(".")&&(c=(u=c.split(".")).shift(),u.sort()),o=c.indexOf(":")<0&&"on"+c,(e=e[K.expando]?e:new K.Event(c,"object"==typeof e&&e)).isTrigger=i?2:3,e.namespace=u.join("."),e.namespace_re=e.namespace?RegExp("(^|\\.)"+u.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:K.makeArray(t,[e]),u=K.event.special[c]||{},i||!u.trigger||!1!==u.trigger.apply(n,t))){if(!i&&!u.noBubble&&!K.isWindow(n)){for(a=u.delegateType||c,Jt.test(a+c)||(h=h.parentNode);h;h=h.parentNode)l.push(h),r=h;r===(n.ownerDocument||wt)&&l.push(r.defaultView||r.parentWindow||f)}for(s=0;(h=l[s++])&&!e.isPropagationStopped();)e.type=1<s?a:u.bindType||c,(r=(K._data(h,"events")||{})[e.type]&&K._data(h,"handle"))&&r.apply(h,t),(r=o&&h[o])&&r.apply&&K.acceptData(h)&&(e.result=r.apply(h,t),!1===e.result&&e.preventDefault());if(e.type=c,!i&&!e.isDefaultPrevented()&&(!u._default||!1===u._default.apply(l.pop(),t))&&K.acceptData(n)&&o&&n[c]&&!K.isWindow(n)){(r=n[o])&&(n[o]=null),K.event.triggered=c;try{n[c]()}catch(e){}K.event.triggered=void 0,r&&(n[o]=r)}return e.result}},dispatch:function(e){e=K.event.fix(e);var t,n,i,r=[],o=W.call(arguments),a=(K._data(this,"events")||{})[e.type]||[],s=K.event.special[e.type]||{};if((o[0]=e).delegateTarget=this,!s.preDispatch||!1!==s.preDispatch.call(this,e)){for(r=K.event.handlers.call(this,e,a),a=0;(n=r[a++])&&!e.isPropagationStopped();)for(e.currentTarget=n.elem,i=0;(t=n.handlers[i++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(t.namespace)||(e.handleObj=t,e.data=t.data,void 0!==(t=((K.event.special[t.origType]||{}).handle||t.handler).apply(n.elem,o))&&!1===(e.result=t)&&(e.preventDefault(),e.stopPropagation()));return s.postDispatch&&s.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,i,r,o,a=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==e.type)){for(r=[],o=0;o<s;o++)void 0===r[n=(i=t[o]).selector+" "]&&(r[n]=i.needsContext?0<=K(n,this).index(l):K.find(n,this,null,[l]).length),r[n]&&r.push(i);r.length&&a.push({elem:l,handlers:r})}return s<t.length&&a.push({elem:this,handlers:t.slice(s)}),a},fix:function(e){if(e[K.expando])return e;var t,n,i=e.type,r=e,o=this.fixHooks[i];for(o||(this.fixHooks[i]=o=Yt.test(i)?this.mouseHooks:$t.test(i)?this.keyHooks:{}),n=o.props?this.props.concat(o.props):this.props,e=new K.Event(r),i=n.length;i--;)e[t=n[i]]=r[t];return e.target||(e.target=r.srcElement||wt),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,o.filter?o.filter(e,r):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,r=t.button,o=t.fromElement;return null==e.pageX&&null!=t.clientX&&(i=(n=e.target.ownerDocument||wt).documentElement,n=n.body,e.pageX=t.clientX+(i&&i.scrollLeft||n&&n.scrollLeft||0)-(i&&i.clientLeft||n&&n.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||n&&n.scrollTop||0)-(i&&i.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&o&&(e.relatedTarget=o===e.target?t.toElement:o),e.which||void 0===r||(e.which=1&r?1:2&r?3:4&r?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==d()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===d()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(K.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(e){return K.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,i){e=K.extend(new K.Event,n,{type:e,isSimulated:!0,originalEvent:{}}),i?K.event.trigger(e,null,t):K.event.dispatch.call(t,e),e.isDefaultPrevented()&&n.preventDefault()}},K.removeEvent=wt.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){t="on"+t,e.detachEvent&&(typeof e[t]===Ht&&(e[t]=null),e.detachEvent(t,n))},K.Event=function(e,t){if(!(this instanceof K.Event))return new K.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&(!1===e.returnValue||e.getPreventDefault&&e.getPreventDefault())?u:h):this.type=e,t&&K.extend(this,t),this.timeStamp=e&&e.timeStamp||K.now(),this[K.expando]=!0},K.Event.prototype={isDefaultPrevented:h,isPropagationStopped:h,isImmediatePropagationStopped:h,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=u,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=u,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=u,this.stopPropagation()}},K.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,r){K.event.special[e]={delegateType:r,bindType:r,handle:function(e){var t,n=e.relatedTarget,i=e.handleObj;return n&&(n===this||K.contains(this,n))||(e.type=i.origType,t=i.handler.apply(this,arguments),e.type=r),t}}}),Q.submitBubbles||(K.event.special.submit={setup:function(){if(K.nodeName(this,"form"))return!1;K.event.add(this,"click._submit keypress._submit",function(e){e=e.target,(e=K.nodeName(e,"input")||K.nodeName(e,"button")?e.form:void 0)&&!K._data(e,"submitBubbles")&&(K.event.add(e,"submit._submit",function(e){e._submit_bubble=!0}),K._data(e,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&K.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(K.nodeName(this,"form"))return!1;K.event.remove(this,"._submit")}}),Q.changeBubbles||(K.event.special.change={setup:function(){if(Xt.test(this.nodeName))return"checkbox"!==this.type&&"radio"!==this.type||(K.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),K.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),K.event.simulate("change",this,e,!0)})),!1;K.event.add(this,"beforeactivate._change",function(e){e=e.target,Xt.test(e.nodeName)&&!K._data(e,"changeBubbles")&&(K.event.add(e,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||K.event.simulate("change",this.parentNode,e,!0)}),K._data(e,"changeBubbles",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments)},teardown:function(){return K.event.remove(this,"._change"),!Xt.test(this.nodeName)}}),Q.focusinBubbles||K.each({focus:"focusin",blur:"focusout"},function(n,i){function r(e){K.event.simulate(i,e.target,K.event.fix(e),!0)}K.event.special[i]={setup:function(){var e=this.ownerDocument||this,t=K._data(e,i);t||e.addEventListener(n,r,!0),K._data(e,i,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this,t=K._data(e,i)-1;t?K._data(e,i,t):(e.removeEventListener(n,r,!0),K._removeData(e,i))}}}),K.fn.extend({on:function(e,t,n,i,r){var o,a;if("object"==typeof e){for(o in"string"!=typeof t&&(n=n||t,t=void 0),e)this.on(o,t,n,e[o],r);return this}if(null==n&&null==i?(i=t,n=t=void 0):null==i&&("string"==typeof t?(i=n,n=void 0):(i=n,n=t,t=void 0)),!1===i)i=h;else if(!i)return this;return 1===r&&(a=i,(i=function(e){return K().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=K.guid++)),this.each(function(){K.event.add(this,e,i,n,t)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,t,n){var i;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,K(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=h),this.each(function(){K.event.remove(this,e,n,t)});for(i in e)this.off(i,t,e[i]);return this},trigger:function(e,t){return this.each(function(){K.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return K.event.trigger(e,t,n,!0)}});var Qt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Kt=/ jQuery\d+="(?:null|\d+)"/g,en=RegExp("<(?:"+Qt+")[\\s/>]","i"),tn=/^\s+/,nn=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rn=/<([\w:]+)/,on=/<tbody/i,an=/<|&#?\w+;/,sn=/<(?:script|style|link)/i,ln=/checked\s*(?:[^=]|=\s*.checked.)/i,cn=/^$|\/(?:java|ecma)script/i,un=/^true\/(.*)/,hn=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,fn={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:Q.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},dn=p(wt).appendChild(wt.createElement("div"));fn.optgroup=fn.option,fn.tbody=fn.tfoot=fn.colgroup=fn.caption=fn.thead,fn.th=fn.td,K.extend({clone:function(e,t,n){var i,r,o,a,s,l=K.contains(e.ownerDocument,e);if(Q.html5Clone||K.isXMLDoc(e)||!en.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(dn.innerHTML=e.outerHTML,dn.removeChild(o=dn.firstChild)),!(Q.noCloneEvent&&Q.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||K.isXMLDoc(e)))for(i=m(o),s=m(e),a=0;null!=(r=s[a]);++a)if(i[a]){var c=i[a],u=void 0,h=void 0,f=void 0;if(1===c.nodeType){if(u=c.nodeName.toLowerCase(),!Q.noCloneEvent&&c[K.expando]){for(h in(f=K._data(c)).events)K.removeEvent(c,h,f.handle);c.removeAttribute(K.expando)}"script"===u&&c.text!==r.text?(_(c).text=r.text,y(c)):"object"===u?(c.parentNode&&(c.outerHTML=r.outerHTML),Q.html5Clone&&r.innerHTML&&!K.trim(c.innerHTML)&&(c.innerHTML=r.innerHTML)):"input"===u&&zt.test(r.type)?(c.defaultChecked=c.checked=r.checked,c.value!==r.value&&(c.value=r.value)):"option"===u?c.defaultSelected=c.selected=r.defaultSelected:"input"!==u&&"textarea"!==u||(c.defaultValue=r.defaultValue)}}if(t)if(n)for(s=s||m(e),i=i||m(o),a=0;null!=(r=s[a]);a++)x(r,i[a]);else x(e,o);return 0<(i=m(o,"script")).length&&b(i,!l&&m(e,"script")),o},buildFragment:function(e,t,n,i){for(var r,o,a,s,l,c,u=e.length,h=p(t),f=[],d=0;d<u;d++)if((o=e[d])||0===o)if("object"===K.type(o))K.merge(f,o.nodeType?[o]:o);else if(an.test(o)){for(a=a||h.appendChild(t.createElement("div")),s=(rn.exec(o)||["",""])[1].toLowerCase(),c=fn[s]||fn._default,a.innerHTML=c[1]+o.replace(nn,"<$1></$2>")+c[2],r=c[0];r--;)a=a.lastChild;if(!Q.leadingWhitespace&&tn.test(o)&&f.push(t.createTextNode(tn.exec(o)[0])),!Q.tbody)for(r=(o="table"!==s||on.test(o)?"<table>"!==c[1]||on.test(o)?0:a:a.firstChild)&&o.childNodes.length;r--;)K.nodeName(l=o.childNodes[r],"tbody")&&!l.childNodes.length&&o.removeChild(l);for(K.merge(f,a.childNodes),a.textContent="";a.firstChild;)a.removeChild(a.firstChild);a=h.lastChild}else f.push(t.createTextNode(o));for(a&&h.removeChild(a),Q.appendChecked||K.grep(m(f,"input"),g),d=0;o=f[d++];)if((!i||-1===K.inArray(o,i))&&(e=K.contains(o.ownerDocument,o),a=m(h.appendChild(o),"script"),e&&b(a),n))for(r=0;o=a[r++];)cn.test(o.type||"")&&n.push(o);return h},cleanData:function(e,t){for(var n,i,r,o,a=0,s=K.expando,l=K.cache,c=Q.deleteExpando,u=K.event.special;null!=(n=e[a]);a++)if((t||K.acceptData(n))&&(o=(r=n[s])&&l[r])){if(o.events)for(i in o.events)u[i]?K.event.remove(n,i):K.removeEvent(n,i,o.handle);l[r]&&(delete l[r],c?delete n[s]:typeof n.removeAttribute!==Ht?n.removeAttribute(s):n[s]=null,V.push(r))}}}),K.fn.extend({text:function(e){return Bt(this,function(e){return void 0===e?K.text(this):this.empty().append((this[0]&&this[0].ownerDocument||wt).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||v(this,e).appendChild(e)})},prepend:function(){return this.domManip(arguments,function(e){var t;1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(t=v(this,e)).insertBefore(e,t.firstChild)})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,i=e?K.filter(e,this):this,r=0;null!=(n=i[r]);r++)t||1!==n.nodeType||K.cleanData(m(n)),n.parentNode&&(t&&K.contains(n.ownerDocument,n)&&b(m(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&K.cleanData(m(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&K.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return K.clone(this,e,t)})},html:function(e){return Bt(this,function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e)return 1===t.nodeType?t.innerHTML.replace(Kt,""):void 0;if("string"==typeof e&&!sn.test(e)&&(Q.htmlSerialize||!en.test(e))&&(Q.leadingWhitespace||!tn.test(e))&&!fn[(rn.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(nn,"<$1></$2>");try{for(;n<i;n++)1===(t=this[n]||{}).nodeType&&(K.cleanData(m(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,function(e){t=this.parentNode,K.cleanData(m(this)),t&&t.replaceChild(e,this)}),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(n,i){n=G.apply([],n);var e,t,r,o,a=0,s=this.length,l=this,c=s-1,u=n[0],h=K.isFunction(u);if(h||1<s&&"string"==typeof u&&!Q.checkClone&&ln.test(u))return this.each(function(e){var t=l.eq(e);h&&(n[0]=u.call(this,e,t.html())),t.domManip(n,i)});if(s&&(e=(o=K.buildFragment(n,this[0].ownerDocument,!1,this)).firstChild,1===o.childNodes.length&&(o=e),e)){for(t=(r=K.map(m(o,"script"),_)).length;a<s;a++)e=o,a!==c&&(e=K.clone(e,!0,!0),t&&K.merge(r,m(e,"script"))),i.call(this[a],e,a);if(t)for(o=r[r.length-1].ownerDocument,K.map(r,y),a=0;a<t;a++)e=r[a],cn.test(e.type||"")&&!K._data(e,"globalEval")&&K.contains(o,e)&&(e.src?K._evalUrl&&K._evalUrl(e.src):K.globalEval((e.text||e.textContent||e.innerHTML||"").replace(hn,"")));o=e=null}return this}}),K.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,o){K.fn[e]=function(e){for(var t=0,n=[],i=K(e),r=i.length-1;t<=r;t++)e=t===r?this:this.clone(!0),K(i[t])[o](e),q.apply(n,e.get());return this.pushStack(n)}});var pn,mn,gn,vn={},_n=wt.createElement("div");_n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",(mn=_n.getElementsByTagName("a")[0]).style.cssText="float:left;opacity:.5",Q.opacity=/^0.5/.test(mn.style.opacity),Q.cssFloat=!!mn.style.cssFloat,_n.style.backgroundClip="content-box",_n.cloneNode(!0).style.backgroundClip="",Q.clearCloneStyle="content-box"===_n.style.backgroundClip,mn=_n=null,Q.shrinkWrapBlocks=function(){var e,t,n;if(null==gn){if(!(e=wt.getElementsByTagName("body")[0]))return;t=wt.createElement("div"),n=wt.createElement("div"),e.appendChild(t).appendChild(n),gn=!1,typeof n.style.zoom!==Ht&&(n.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0;width:1px;padding:1px;zoom:1",n.innerHTML="<div></div>",n.firstChild.style.width="5px",gn=3!==n.offsetWidth),e.removeChild(t)}return gn};var yn,bn,xn=/^margin/,En=RegExp("^("+It+")(?!px)[a-z%]+$","i"),Tn=/^(top|right|bottom|left)$/;f.getComputedStyle?(yn=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)},bn=function(e,t,n){var i,r=e.style,o=(n=n||yn(e))?n.getPropertyValue(t)||n[t]:void 0;return n&&(""!==o||K.contains(e.ownerDocument,e)||(o=K.style(e,t)),En.test(o)&&xn.test(t)&&(e=r.width,t=r.minWidth,i=r.maxWidth,r.minWidth=r.maxWidth=r.width=o,o=n.width,r.width=e,r.minWidth=t,r.maxWidth=i)),void 0===o?o:o+""}):wt.documentElement.currentStyle&&(yn=function(e){return e.currentStyle},bn=function(e,t,n){var i,r,o=e.style,a=(n=n||yn(e))?n[t]:void 0;return null==a&&o&&o[t]&&(a=o[t]),En.test(a)&&!Tn.test(t)&&(n=o.left,(r=(i=e.runtimeStyle)&&i.left)&&(i.left=e.currentStyle.left),o.left="fontSize"===t?"1em":a,a=o.pixelLeft+"px",o.left=n,r&&(i.left=r)),void 0===a?a:a+""||"auto"});function wn(){var e,t,n=wt.getElementsByTagName("body")[0];n&&(e=wt.createElement("div"),t=wt.createElement("div"),e.style.cssText=Hn,n.appendChild(e).appendChild(t),t.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%",K.swap(n,null!=n.style.zoom?{zoom:1}:{},function(){Dn=4===t.offsetWidth}),Mn=!(An=!(Rn=!0)),f.getComputedStyle&&(An="1%"!==(f.getComputedStyle(t,null)||{}).top,Rn="4px"===(f.getComputedStyle(t,null)||{width:"4px"}).width),n.removeChild(e),t=n=null)}var Cn,Sn,Dn,Rn,An,Mn,Ln=wt.createElement("div"),Hn="border:0;width:0;height:0;position:absolute;top:0;left:-9999px";Ln.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",(Cn=Ln.getElementsByTagName("a")[0]).style.cssText="float:left;opacity:.5",Q.opacity=/^0.5/.test(Cn.style.opacity),Q.cssFloat=!!Cn.style.cssFloat,Ln.style.backgroundClip="content-box",Ln.cloneNode(!0).style.backgroundClip="",Q.clearCloneStyle="content-box"===Ln.style.backgroundClip,Cn=Ln=null,K.extend(Q,{reliableHiddenOffsets:function(){if(null!=Sn)return Sn;var e,t,n=wt.createElement("div"),i=wt.getElementsByTagName("body")[0];return i?(n.setAttribute("className","t"),n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",(e=wt.createElement("div")).style.cssText=Hn,i.appendChild(e).appendChild(n),n.innerHTML="<table><tr><td></td><td>t</td></tr></table>",(n=n.getElementsByTagName("td"))[0].style.cssText="padding:0;margin:0;border:0;display:none",t=0===n[0].offsetHeight,n[0].style.display="",n[1].style.display="none",Sn=t&&0===n[0].offsetHeight,i.removeChild(e),Sn):void 0},boxSizing:function(){return null==Dn&&wn(),Dn},boxSizingReliable:function(){return null==Rn&&wn(),Rn},pixelPosition:function(){return null==An&&wn(),An},reliableMarginRight:function(){var e,t,n,i;if(null==Mn&&f.getComputedStyle){if(!(e=wt.getElementsByTagName("body")[0]))return;t=wt.createElement("div"),n=wt.createElement("div"),t.style.cssText=Hn,e.appendChild(t).appendChild(n),(i=n.appendChild(wt.createElement("div"))).style.cssText=n.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0",i.style.marginRight=i.style.width="0",n.style.width="1px",Mn=!parseFloat((f.getComputedStyle(i,null)||{}).marginRight),e.removeChild(t)}return Mn}}),K.swap=function(e,t,n,i){var r,o={};for(r in t)o[r]=e.style[r],e.style[r]=t[r];for(r in n=n.apply(e,i||[]),t)e.style[r]=o[r];return n};var Fn=/alpha\([^)]*\)/i,Pn=/opacity\s*=\s*([^)]*)/,Nn=/^(none|table(?!-c[ea]).+)/,kn=RegExp("^("+It+")(.*)$","i"),In=RegExp("^([+-])=("+It+")","i"),On={position:"absolute",visibility:"hidden",display:"block"},Bn={letterSpacing:0,fontWeight:400},zn=["Webkit","O","Moz","ms"];K.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=bn(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:Q.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,a,s=K.camelCase(t),l=e.style;if(t=K.cssProps[s]||(K.cssProps[s]=C(l,s)),a=K.cssHooks[t]||K.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(r=a.get(e,!1,i))?r:l[t];if("string"===(o=typeof n)&&(r=In.exec(n))&&(n=(r[1]+1)*r[2]+parseFloat(K.css(e,t)),o="number"),null!=n&&n==n&&("number"!==o||K.cssNumber[s]||(n+="px"),Q.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),!(a&&"set"in a&&void 0===(n=a.set(e,n,i)))))try{l[t]="",l[t]=n}catch(e){}}},css:function(e,t,n,i){var r,o=K.camelCase(t);return t=K.cssProps[o]||(K.cssProps[o]=C(e.style,o)),(o=K.cssHooks[t]||K.cssHooks[o])&&"get"in o&&(r=o.get(e,!0,n)),void 0===r&&(r=bn(e,t,i)),"normal"===r&&t in Bn&&(r=Bn[t]),""===n||n?(e=parseFloat(r),!0===n||K.isNumeric(e)?e||0:r):r}}),K.each(["height","width"],function(e,r){K.cssHooks[r]={get:function(e,t,n){if(t)return 0===e.offsetWidth&&Nn.test(K.css(e,"display"))?K.swap(e,On,function(){return A(e,r,n)}):A(e,r,n)},set:function(e,t,n){var i=n&&yn(e);return D(e,t,n?R(e,r,n,Q.boxSizing()&&"border-box"===K.css(e,"boxSizing",!1,i),i):0)}}}),Q.opacity||(K.cssHooks.opacity={get:function(e,t){return Pn.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,i=e.currentStyle,r=K.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=i&&i.filter||n.filter||"";((n.zoom=1)<=t||""===t)&&""===K.trim(o.replace(Fn,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||i&&!i.filter)||(n.filter=Fn.test(o)?o.replace(Fn,r):o+" "+r)}}),K.cssHooks.marginRight=w(Q.reliableMarginRight,function(e,t){if(t)return K.swap(e,{display:"inline-block"},bn,[e,"marginRight"])}),K.each({margin:"",padding:"",border:"Width"},function(i,r){K.cssHooks[i+r]={expand:function(e){var t=0,n={};for(e="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+Ot[t]+r]=e[t]||e[t-2]||e[0];return n}},xn.test(i)||(K.cssHooks[i+r].set=D)}),K.fn.extend({css:function(e,t){return Bt(this,function(e,t,n){var i,r={},o=0;if(K.isArray(t)){for(n=yn(e),i=t.length;o<i;o++)r[t[o]]=K.css(e,t[o],!1,n);return r}return void 0!==n?K.style(e,t,n):K.css(e,t)},e,t,1<arguments.length)},show:function(){return S(this,!0)},hide:function(){return S(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){kt(this)?K(this).show():K(this).hide()})}}),(K.Tween=M).prototype={constructor:M,init:function(e,t,n,i,r,o){this.elem=e,this.prop=n,this.easing=r||"swing",this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=o||(K.cssNumber[n]?"":"px")},cur:function(){var e=M.propHooks[this.prop];return e&&e.get?e.get(this):M.propHooks._default.get(this)},run:function(e){var t,n=M.propHooks[this.prop];return this.pos=t=this.options.duration?K.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):M.propHooks._default.set(this),this}},M.prototype.init.prototype=M.prototype,M.propHooks={_default:{get:function(e){return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(e=K.css(e.elem,e.prop,""))&&"auto"!==e?e:0:e.elem[e.prop]},set:function(e){K.fx.step[e.prop]?K.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[K.cssProps[e.prop]]||K.cssHooks[e.prop])?K.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},M.propHooks.scrollTop=M.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},K.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},K.fx=M.prototype.init,K.fx.step={};var jn,Un,Vn=/^(?:toggle|show|hide)$/,Wn=RegExp("^(?:([+-])=|)("+It+")([a-z%]*)$","i"),Gn=/queueHooks$/,qn=[function(t,e,n){var i,r,o,a,s,l,c=this,u={},h=t.style,f=t.nodeType&&kt(t),d=K._data(t,"fxshow");for(i in n.queue||(null==(a=K._queueHooks(t,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,c.always(function(){c.always(function(){a.unqueued--,K.queue(t,"fx").length||a.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],r=K.css(t,"display"),l=T(t.nodeName),"none"===r&&(r=l),"inline"===r&&"none"===K.css(t,"float")&&(Q.inlineBlockNeedsLayout&&"inline"!==l?h.zoom=1:h.display="inline-block")),n.overflow&&(h.overflow="hidden",Q.shrinkWrapBlocks()||c.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),e)if(r=e[i],Vn.exec(r)){if(delete e[i],o=o||"toggle"===r,r===(f?"hide":"show")){if("show"!==r||!d||void 0===d[i])continue;f=!0}u[i]=d&&d[i]||K.style(t,i)}if(!K.isEmptyObject(u))for(i in d?"hidden"in d&&(f=d.hidden):d=K._data(t,"fxshow",{}),o&&(d.hidden=!f),f?K(t).show():c.done(function(){K(t).hide()}),c.done(function(){var e;for(e in K._removeData(t,"fxshow"),u)K.style(t,e,u[e])}),u)e=F(f?d[i]:0,i,c),i in d||(d[i]=e.start,f&&(e.end=e.start,e.start="width"===i||"height"===i?1:0))}],Xn={"*":[function(e,t){var n=this.createTween(e,t),i=n.cur(),r=Wn.exec(t),o=r&&r[3]||(K.cssNumber[e]?"":"px"),a=(K.cssNumber[e]||"px"!==o&&+i)&&Wn.exec(K.css(n.elem,e)),s=1,l=20;if(a&&a[3]!==o)for(o=o||a[3],r=r||[],a=+i||1;a/=s=s||".5",K.style(n.elem,e,a+o),s!==(s=n.cur()/i)&&1!==s&&--l;);return r&&(a=n.start=+a||+i||0,n.unit=o,n.end=r[1]?a+(r[1]+1)*r[2]:+r[2]),n}]};K.Animation=K.extend(P,{tweener:function(e,t){for(var n,i=0,r=(e=K.isFunction(e)?(t=e,["*"]):e.split(" ")).length;i<r;i++)n=e[i],Xn[n]=Xn[n]||[],Xn[n].unshift(t)},prefilter:function(e,t){t?qn.unshift(e):qn.push(e)}}),K.speed=function(e,t,n){var i=e&&"object"==typeof e?K.extend({},e):{complete:n||!n&&t||K.isFunction(e)&&e,duration:e,easing:n&&t||t&&!K.isFunction(t)&&t};return i.duration=K.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in K.fx.speeds?K.fx.speeds[i.duration]:K.fx.speeds._default,null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){K.isFunction(i.old)&&i.old.call(this),i.queue&&K.dequeue(this,i.queue)},i},K.fn.extend({fadeTo:function(e,t,n,i){return this.filter(kt).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(t,e,n,i){var r=K.isEmptyObject(t),o=K.speed(e,n,i);return(e=function(){var e=P(this,K.extend({},t),o);(r||K._data(this,"finish"))&&e.stop(!0)}).finish=e,r||!1===o.queue?this.each(e):this.queue(o.queue,e)},stop:function(r,e,o){function a(e){var t=e.stop;delete e.stop,t(o)}return"string"!=typeof r&&(o=e,e=r,r=void 0),e&&!1!==r&&this.queue(r||"fx",[]),this.each(function(){var e=!0,t=null!=r&&r+"queueHooks",n=K.timers,i=K._data(this);if(t)i[t]&&i[t].stop&&a(i[t]);else for(t in i)i[t]&&i[t].stop&&Gn.test(t)&&a(i[t]);for(t=n.length;t--;)n[t].elem!==this||null!=r&&n[t].queue!==r||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||K.dequeue(this,r)})},finish:function(o){return!1!==o&&(o=o||"fx"),this.each(function(){var e=K._data(this),t=e[o+"queue"],n=e[o+"queueHooks"],i=K.timers,r=t?t.length:0;for(e.finish=!0,K.queue(this,o,[]),n&&n.stop&&n.stop.call(this,!0),n=i.length;n--;)i[n].elem===this&&i[n].queue===o&&(i[n].anim.stop(!0),i.splice(n,1));for(n=0;n<r;n++)t[n]&&t[n].finish&&t[n].finish.call(this);delete e.finish})}}),K.each(["toggle","show","hide"],function(e,i){var r=K.fn[i];K.fn[i]=function(e,t,n){return null==e||"boolean"==typeof e?r.apply(this,arguments):this.animate(H(i,!0),e,t,n)}}),K.each({slideDown:H("show"),slideUp:H("hide"),slideToggle:H("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,i){K.fn[e]=function(e,t,n){return this.animate(i,e,t,n)}}),K.timers=[],K.fx.tick=function(){var e,t=K.timers,n=0;for(jn=K.now();n<t.length;n++)(e=t[n])()||t[n]!==e||t.splice(n--,1);t.length||K.fx.stop(),jn=void 0},K.fx.timer=function(e){K.timers.push(e),e()?K.fx.start():K.timers.pop()},K.fx.interval=13,K.fx.start=function(){Un=Un||setInterval(K.fx.tick,K.fx.interval)},K.fx.stop=function(){clearInterval(Un),Un=null},K.fx.speeds={slow:600,fast:200,_default:400},K.fn.delay=function(i,e){return i=K.fx&&K.fx.speeds[i]||i,this.queue(e||"fx",function(e,t){var n=setTimeout(e,i);t.stop=function(){clearTimeout(n)}})};var $n,Yn,Jn,Zn,Qn=wt.createElement("div");Qn.setAttribute("className","t"),Qn.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",$n=Qn.getElementsByTagName("a")[0],Zn=(Jn=wt.createElement("select")).appendChild(wt.createElement("option")),Yn=Qn.getElementsByTagName("input")[0],$n.style.cssText="top:1px",Q.getSetAttribute="t"!==Qn.className,Q.style=/top/.test($n.getAttribute("style")),Q.hrefNormalized="/a"===$n.getAttribute("href"),Q.checkOn=!!Yn.value,Q.optSelected=Zn.selected,Q.enctype=!!wt.createElement("form").enctype,Jn.disabled=!0,Q.optDisabled=!Zn.disabled,(Yn=wt.createElement("input")).setAttribute("value",""),Q.input=""===Yn.getAttribute("value"),Yn.value="t",Yn.setAttribute("type","radio"),Q.radioValue="t"===Yn.value;var Kn=/\r/g;K.fn.extend({val:function(t){var n,e,i,r=this[0];return arguments.length?(i=K.isFunction(t),this.each(function(e){1!==this.nodeType||(null==(e=i?t.call(this,e,K(this).val()):t)?e="":"number"==typeof e?e+="":K.isArray(e)&&(e=K.map(e,function(e){return null==e?"":e+""})),(n=K.valHooks[this.type]||K.valHooks[this.nodeName.toLowerCase()])&&"set"in n&&void 0!==n.set(this,e,"value"))||(this.value=e)})):r?(n=K.valHooks[r.type]||K.valHooks[r.nodeName.toLowerCase()])&&"get"in n&&void 0!==(e=n.get(r,"value"))?e:"string"==typeof(e=r.value)?e.replace(Kn,""):null==e?"":e:void 0}}),K.extend({valHooks:{option:{get:function(e){var t=K.find.attr(e,"value");return null!=t?t:K.text(e)}},select:{get:function(e){for(var t,n=e.options,i=e.selectedIndex,r=(e="select-one"===e.type||i<0)?null:[],o=e?i+1:n.length,a=i<0?o:e?i:0;a<o;a++)if(((t=n[a]).selected||a===i)&&(Q.optDisabled?!t.disabled:null===t.getAttribute("disabled"))&&(!t.parentNode.disabled||!K.nodeName(t.parentNode,"optgroup"))){if(t=K(t).val(),e)return t;r.push(t)}return r},set:function(e,t){for(var n,i,r=e.options,o=K.makeArray(t),a=r.length;a--;)if(i=r[a],0<=K.inArray(K.valHooks.option.get(i),o))try{i.selected=n=!0}catch(e){i.scrollHeight}else i.selected=!1;return n||(e.selectedIndex=-1),r}}}}),K.each(["radio","checkbox"],function(){K.valHooks[this]={set:function(e,t){if(K.isArray(t))return e.checked=0<=K.inArray(K(e).val(),t)}},Q.checkOn||(K.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var ei,ti,ni=K.expr.attrHandle,ii=/^(?:checked|selected)$/i,ri=Q.getSetAttribute,oi=Q.input;K.fn.extend({attr:function(e,t){return Bt(this,K.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){K.removeAttr(this,e)})}}),K.extend({attr:function(e,t,n){var i,r,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o){if(typeof e.getAttribute===Ht)return K.prop(e,t,n);if(1===o&&K.isXMLDoc(e)||(t=t.toLowerCase(),i=K.attrHooks[t]||(K.expr.match.bool.test(t)?ti:ei)),void 0===n)return!(i&&"get"in i&&null!==(r=i.get(e,t)))&&null==(r=K.find.attr(e,t))?void 0:r;if(null!==n)return i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n);K.removeAttr(e,t)}},removeAttr:function(e,t){var n,i,r=0,o=t&&t.match(At);if(o&&1===e.nodeType)for(;n=o[r++];)i=K.propFix[n]||n,K.expr.match.bool.test(n)?oi&&ri||!ii.test(n)?e[i]=!1:e[K.camelCase("default-"+n)]=e[i]=!1:K.attr(e,n,""),e.removeAttribute(ri?n:i)},attrHooks:{type:{set:function(e,t){if(!Q.radioValue&&"radio"===t&&K.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),ti={set:function(e,t,n){return!1===t?K.removeAttr(e,n):oi&&ri||!ii.test(n)?e.setAttribute(!ri&&K.propFix[n]||n,n):e[K.camelCase("default-"+n)]=e[n]=!0,n}},K.each(K.expr.match.bool.source.match(/\w+/g),function(e,t){var o=ni[t]||K.find.attr;ni[t]=oi&&ri||!ii.test(t)?function(e,t,n){var i,r;return n||(r=ni[t],ni[t]=i,i=null!=o(e,t,n)?t.toLowerCase():null,ni[t]=r),i}:function(e,t,n){if(!n)return e[K.camelCase("default-"+t)]?t.toLowerCase():null}}),oi&&ri||(K.attrHooks.value={set:function(e,t,n){if(!K.nodeName(e,"input"))return ei&&ei.set(e,t,n);e.defaultValue=t}}),ri||(ei={set:function(e,t,n){var i=e.getAttributeNode(n);if(i||e.setAttributeNode(i=e.ownerDocument.createAttribute(n)),i.value=t+="","value"===n||t===e.getAttribute(n))return t}},ni.id=ni.name=ni.coords=function(e,t,n){var i;if(!n)return(i=e.getAttributeNode(t))&&""!==i.value?i.value:null},K.valHooks.button={get:function(e,t){var n=e.getAttributeNode(t);if(n&&n.specified)return n.value},set:ei.set},K.attrHooks.contenteditable={set:function(e,t,n){ei.set(e,""!==t&&t,n)}},K.each(["width","height"],function(e,n){K.attrHooks[n]={set:function(e,t){if(""===t)return e.setAttribute(n,"auto"),t}}})),Q.style||(K.attrHooks.style={get:function(e){return e.style.cssText||void 0},set:function(e,t){return e.style.cssText=t+""}});var ai=/^(?:input|select|textarea|button|object)$/i,si=/^(?:a|area)$/i;K.fn.extend({prop:function(e,t){return Bt(this,K.prop,e,t,1<arguments.length)},removeProp:function(e){return e=K.propFix[e]||e,this.each(function(){try{this[e]=void 0,delete this[e]}catch(e){}})}}),K.extend({propFix:{for:"htmlFor",class:"className"},prop:function(e,t,n){var i,r,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return(o=1!==o||!K.isXMLDoc(e))&&(t=K.propFix[t]||t,r=K.propHooks[t]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:e[t]=n:r&&"get"in r&&null!==(i=r.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=K.find.attr(e,"tabindex");return t?parseInt(t,10):ai.test(e.nodeName)||si.test(e.nodeName)&&e.href?0:-1}}}}),Q.hrefNormalized||K.each(["href","src"],function(e,t){K.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),Q.optSelected||(K.propHooks.selected={get:function(e){return(e=e.parentNode)&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}}),K.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),function(){K.propFix[this.toLowerCase()]=this}),Q.enctype||(K.propFix.enctype="encoding");var li=/[\t\r\n\f]/g;K.fn.extend({addClass:function(t){var e,n,i,r,o=0,a=this.length,s="string"==typeof t&&t;if(K.isFunction(t))return this.each(function(e){K(this).addClass(t.call(this,e,this.className))});if(s)for(s=(t||"").match(At)||[];o<a;o++)if(n=1===(e=this[o]).nodeType&&(e.className?(" "+e.className+" ").replace(li," "):" ")){for(r=0;i=s[r++];)n.indexOf(" "+i+" ")<0&&(n+=i+" ");n=K.trim(n),e.className!==n&&(e.className=n)}return this},removeClass:function(t){var e,n,i,r,o=0,a=this.length,s=0===arguments.length||"string"==typeof t&&t;if(K.isFunction(t))return this.each(function(e){K(this).removeClass(t.call(this,e,this.className))});if(s)for(s=(t||"").match(At)||[];o<a;o++)if(n=1===(e=this[o]).nodeType&&(e.className?(" "+e.className+" ").replace(li," "):"")){for(r=0;i=s[r++];)for(;0<=n.indexOf(" "+i+" ");)n=n.replace(" "+i+" "," ");n=t?K.trim(n):"",e.className!==n&&(e.className=n)}return this},toggleClass:function(r,t){var o=typeof r;return"boolean"==typeof t&&"string"==o?t?this.addClass(r):this.removeClass(r):K.isFunction(r)?this.each(function(e){K(this).toggleClass(r.call(this,e,this.className,t),t)}):this.each(function(){if("string"==o)for(var e,t=0,n=K(this),i=r.match(At)||[];e=i[t++];)n.hasClass(e)?n.removeClass(e):n.addClass(e);else o!==Ht&&"boolean"!=o||(this.className&&K._data(this,"__className__",this.className),this.className=!this.className&&!1!==r&&K._data(this,"__className__")||"")})},hasClass:function(e){e=" "+e+" ";for(var t=0,n=this.length;t<n;t++)if(1===this[t].nodeType&&0<=(" "+this[t].className+" ").replace(li," ").indexOf(e))return!0;return!1}}),K.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,n){K.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}}),K.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var ci=K.now(),ui=/\?/,hi=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;K.parseJSON=function(e){if(f.JSON&&f.JSON.parse)return f.JSON.parse(e+"");var r,o=null,t=K.trim(e+"");return t&&!K.trim(t.replace(hi,function(e,t,n,i){return r&&t&&(o=0),0===o?e:(r=n||t,o+=!i-!n,"")}))?Function("return "+t)():K.error("Invalid JSON: "+e)},K.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{f.DOMParser?t=(new DOMParser).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e))}catch(e){t=void 0}return t&&t.documentElement&&!t.getElementsByTagName("parsererror").length||K.error("Invalid XML: "+e),t};var fi,di,pi=/#.*$/,mi=/([?&])_=[^&]*/,gi=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,vi=/^(?:GET|HEAD)$/,_i=/^\/\//,yi=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,bi={},xi={},Ei="*/".concat("*");try{di=location.href}catch(e){(di=wt.createElement("a")).href="",di=di.href}fi=yi.exec(di.toLowerCase())||[],K.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:di,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(fi[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ei,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":K.parseJSON,"text xml":K.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?I(I(e,K.ajaxSettings),t):I(K.ajaxSettings,e)},ajaxPrefilter:N(bi),ajaxTransport:N(xi),ajax:function(e,t){function n(e,t,n,i){var r,o,a,s=t;if(2!==A){if(A=2,b&&clearTimeout(b),E=void 0,y=i||"",M.readyState=0<e?4:0,i=200<=e&&e<300||304===e,n){for(var l,c,u,h,f=M,d=(a=T).contents,p=a.dataTypes;"*"===p[0];)p.shift(),void 0===c&&(c=a.mimeType||f.getResponseHeader("Content-Type"));if(c)for(h in d)if(d[h]&&d[h].test(c)){p.unshift(h);break}if(p[0]in n)u=p[0];else{for(h in n){if(!p[0]||a.converters[h+" "+p[0]]){u=h;break}l=l||h}u=u||l}a=u?(u!==p[0]&&p.unshift(u),n[u]):void 0}e:{l=a,c=M,u=i;var m,g,v,f={};if((d=(n=T).dataTypes.slice())[1])for(g in n.converters)f[g.toLowerCase()]=n.converters[g];for(h=d.shift();h;)if(n.responseFields[h]&&(c[n.responseFields[h]]=l),!v&&u&&n.dataFilter&&(l=n.dataFilter(l,n.dataType)),v=h,h=d.shift())if("*"===h)h=v;else if("*"!==v&&v!==h){if(!(g=f[v+" "+h]||f["* "+h]))for(m in f)if((a=m.split(" "))[1]===h&&(g=f[v+" "+a[0]]||f["* "+a[0]])){!0===g?g=f[m]:!0!==f[m]&&(h=a[0],d.unshift(a[1]));break}if(!0!==g)if(g&&n.throws)l=g(l);else try{l=g(l)}catch(e){a={state:"parsererror",error:g?e:"No conversion from "+v+" to "+h};break e}}a={state:"success",data:l}}i?(T.ifModified&&((s=M.getResponseHeader("Last-Modified"))&&(K.lastModified[_]=s),(s=M.getResponseHeader("etag"))&&(K.etag[_]=s)),204===e||"HEAD"===T.type?s="nocontent":304===e?s="notmodified":(s=a.state,r=a.data,i=!(o=a.error))):(o=s,!e&&s||(s="error",e<0&&(e=0))),M.status=e,M.statusText=(t||s)+"",i?S.resolveWith(w,[r,s,M]):S.rejectWith(w,[M,s,o]),M.statusCode(R),R=void 0,x&&C.trigger(i?"ajaxSuccess":"ajaxError",[M,T,i?r:o]),D.fireWith(w,[M,s]),x&&(C.trigger("ajaxComplete",[M,T]),--K.active||K.event.trigger("ajaxStop"))}}"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,r,_,y,b,x,E,o,T=K.ajaxSetup({},t),w=T.context||T,C=T.context&&(w.nodeType||w.jquery)?K(w):K.event,S=K.Deferred(),D=K.Callbacks("once memory"),R=T.statusCode||{},a={},s={},A=0,l="canceled",M={readyState:0,getResponseHeader:function(e){var t;if(2===A){if(!o)for(o={};t=gi.exec(y);)o[t[1].toLowerCase()]=t[2];t=o[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===A?y:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return A||(e=s[n]=s[n]||e,a[e]=t),this},overrideMimeType:function(e){return A||(T.mimeType=e),this},statusCode:function(e){var t;if(e)if(A<2)for(t in e)R[t]=[R[t],e[t]];else M.always(e[M.status]);return this},abort:function(e){return e=e||l,E&&E.abort(e),n(0,e),this}};if(S.promise(M).complete=D.add,M.success=M.done,M.error=M.fail,T.url=((e||T.url||di)+"").replace(pi,"").replace(_i,fi[1]+"//"),T.type=t.method||t.type||T.method||T.type,T.dataTypes=K.trim(T.dataType||"*").toLowerCase().match(At)||[""],null==T.crossDomain&&(i=yi.exec(T.url.toLowerCase()),T.crossDomain=!(!i||i[1]===fi[1]&&i[2]===fi[2]&&(i[3]||("http:"===i[1]?"80":"443"))===(fi[3]||("http:"===fi[1]?"80":"443")))),T.data&&T.processData&&"string"!=typeof T.data&&(T.data=K.param(T.data,T.traditional)),k(bi,T,t,M),2===A)return M;for(r in(x=T.global)&&0==K.active++&&K.event.trigger("ajaxStart"),T.type=T.type.toUpperCase(),T.hasContent=!vi.test(T.type),_=T.url,T.hasContent||(T.data&&(_=T.url+=(ui.test(_)?"&":"?")+T.data,delete T.data),!1===T.cache&&(T.url=mi.test(_)?_.replace(mi,"$1_="+ci++):_+(ui.test(_)?"&":"?")+"_="+ci++)),T.ifModified&&(K.lastModified[_]&&M.setRequestHeader("If-Modified-Since",K.lastModified[_]),K.etag[_]&&M.setRequestHeader("If-None-Match",K.etag[_])),(T.data&&T.hasContent&&!1!==T.contentType||t.contentType)&&M.setRequestHeader("Content-Type",T.contentType),M.setRequestHeader("Accept",T.dataTypes[0]&&T.accepts[T.dataTypes[0]]?T.accepts[T.dataTypes[0]]+("*"!==T.dataTypes[0]?", "+Ei+"; q=0.01":""):T.accepts["*"]),T.headers)M.setRequestHeader(r,T.headers[r]);if(T.beforeSend&&(!1===T.beforeSend.call(w,M,T)||2===A))return M.abort();for(r in l="abort",{success:1,error:1,complete:1})M[r](T[r]);if(E=k(xi,T,t,M)){M.readyState=1,x&&C.trigger("ajaxSend",[M,T]),T.async&&0<T.timeout&&(b=setTimeout(function(){M.abort("timeout")},T.timeout));try{A=1,E.send(a,n)}catch(e){if(!(A<2))throw e;n(-1,e)}}else n(-1,"No Transport");return M},getJSON:function(e,t,n){return K.get(e,t,n,"json")},getScript:function(e,t){return K.get(e,void 0,t,"script")}}),K.each(["get","post"],function(e,r){K[r]=function(e,t,n,i){return K.isFunction(t)&&(i=i||n,n=t,t=void 0),K.ajax({url:e,type:r,dataType:i,data:t,success:n})}}),K.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){K.fn[t]=function(e){return this.on(t,e)}}),K._evalUrl=function(e){return K.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},K.fn.extend({wrapAll:function(t){return K.isFunction(t)?this.each(function(e){K(this).wrapAll(t.call(this,e))}):(this[0]&&(e=K(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)),this);var e},wrapInner:function(n){return K.isFunction(n)?this.each(function(e){K(this).wrapInner(n.call(this,e))}):this.each(function(){var e=K(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=K.isFunction(t);return this.each(function(e){K(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(){return this.parent().each(function(){K.nodeName(this,"body")||K(this).replaceWith(this.childNodes)}).end()}}),K.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!Q.reliableHiddenOffsets()&&"none"===(e.style&&e.style.display||K.css(e,"display"))},K.expr.filters.visible=function(e){return!K.expr.filters.hidden(e)};var Ti=/%20/g,wi=/\[\]$/,Ci=/\r?\n/g,Si=/^(?:submit|button|image|reset|file)$/i,Di=/^(?:input|select|textarea|keygen)/i;K.param=function(e,t){function n(e,t){t=K.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)}var i,r=[];if(void 0===t&&(t=K.ajaxSettings&&K.ajaxSettings.traditional),K.isArray(e)||e.jquery&&!K.isPlainObject(e))K.each(e,function(){n(this.name,this.value)});else for(i in e)O(i,e[i],t,n);return r.join("&").replace(Ti,"+")},K.fn.extend({serialize:function(){return K.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=K.prop(this,"elements");return e?K.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!K(this).is(":disabled")&&Di.test(this.nodeName)&&!Si.test(e)&&(this.checked||!zt.test(e))}).map(function(e,t){var n=K(this).val();return null==n?null:K.isArray(n)?K.map(n,function(e){return{name:t.name,value:e.replace(Ci,"\r\n")}}):{name:t.name,value:n.replace(Ci,"\r\n")}}).get()}}),K.ajaxSettings.xhr=void 0!==f.ActiveXObject?function(){var e;if(!(e=!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&z()))e:{try{e=new f.ActiveXObject("Microsoft.XMLHTTP");break e}catch(e){}e=void 0}return e}:z,K.ajaxSettings.xhr=void 0===f.ActiveXObject?B:function(){return(this.url==wt.location||0==this.url.indexOf("http")||!this.isLocal)&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&B()||B(1)};var Ri=0,Ai={},Mi=K.ajaxSettings.xhr();f.ActiveXObject&&K(f).on("unload",function(){for(var e in Ai)Ai[e](void 0,!0)}),Q.cors=!!Mi&&"withCredentials"in Mi,(Mi=Q.ajax=!!Mi)&&K.ajaxTransport(function(l){var c;if(!l.crossDomain||Q.cors)return{send:function(e,o){var t,a=l.xhr(),s=++Ri;if(a.open(l.type,l.url,l.async,l.username,l.password),l.xhrFields)for(t in l.xhrFields)a[t]=l.xhrFields[t];for(t in l.mimeType&&a.overrideMimeType&&a.overrideMimeType(l.mimeType),l.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)void 0!==e[t]&&a.setRequestHeader(t,e[t]+"");a.send(l.hasContent&&l.data||null),c=function(e,t){var n,i,r;if(c&&(t||4===a.readyState))if(delete Ai[s],c=void 0,a.onreadystatechange=K.noop,t)4!==a.readyState&&a.abort();else{r={},n=a.status,"string"==typeof a.responseText&&(r.text=a.responseText);try{i=a.statusText}catch(e){i=""}n||!l.isLocal||l.crossDomain?1223===n&&(n=204):n=r.text?200:404}r&&o(n,i,r,a.getAllResponseHeaders())},l.async?4===a.readyState?setTimeout(c):a.onreadystatechange=Ai[s]=c:c()},abort:function(){c&&c(void 0,!0)}}}),K.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return K.globalEval(e),e}}}),K.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),K.ajaxTransport("script",function(t){if(t.crossDomain){var i,r=wt.head||K("head")[0]||wt.documentElement;return{send:function(e,n){(i=wt.createElement("script")).async=!0,t.scriptCharset&&(i.charset=t.scriptCharset),i.src=t.url,i.onload=i.onreadystatechange=function(e,t){!t&&i.readyState&&!/loaded|complete/.test(i.readyState)||(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),i=null,t||n(200,"success"))},r.insertBefore(i,r.firstChild)},abort:function(){i&&i.onload(void 0,!0)}}}});var Li=[],Hi=/(=)\?(?=&|$)|\?\?/;K.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Li.pop()||K.expando+"_"+ci++;return this[e]=!0,e}}),K.ajaxPrefilter("json jsonp",function(e,t,n){var i,r,o,a=!1!==e.jsonp&&(Hi.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Hi.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return i=e.jsonpCallback=K.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Hi,"$1"+i):!1!==e.jsonp&&(e.url+=(ui.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return o||K.error(i+" was not called"),o[0]},e.dataTypes[0]="json",r=f[i],f[i]=function(){o=arguments},n.always(function(){f[i]=r,e[i]&&(e.jsonpCallback=t.jsonpCallback,Li.push(i)),o&&K.isFunction(r)&&r(o[0]),o=r=void 0}),"script"}),K.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||wt;var i=xt.exec(e);return n=!n&&[],i?[t.createElement(i[1])]:(i=K.buildFragment([e],t,n),n&&n.length&&K(n).remove(),K.merge([],i.childNodes))};var Fi=K.fn.load;K.fn.load=function(e,t,n){if("string"!=typeof e&&Fi)return Fi.apply(this,arguments);var i,r,o,a=this,s=e.indexOf(" ");return 0<=s&&(i=e.slice(s,e.length),e=e.slice(0,s)),K.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(o="POST"),0<a.length&&K.ajax({url:e,type:o,dataType:"html",data:t}).done(function(e){r=arguments,a.html(i?K("<div>").append(K.parseHTML(e)).find(i):e)}).complete(n&&function(e,t){a.each(n,r||[e.responseText,t,e])}),this},K.expr.filters.animated=function(t){return K.grep(K.timers,function(e){return t===e.elem}).length};var Pi=f.document.documentElement;K.offset={setOffset:function(e,t,n){var i,r,o,a=K.css(e,"position"),s=K(e),l={};"static"===a&&(e.style.position="relative"),o=s.offset(),r=K.css(e,"top"),i=K.css(e,"left"),i=("absolute"===a||"fixed"===a)&&-1<K.inArray("auto",[r,i])?(r=(i=s.position()).top,i.left):(r=parseFloat(r)||0,parseFloat(i)||0),K.isFunction(t)&&(t=t.call(e,n,o)),null!=t.top&&(l.top=t.top-o.top+r),null!=t.left&&(l.left=t.left-o.left+i),"using"in t?t.using.call(e,l):s.css(l)}},K.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){K.offset.setOffset(this,t,e)});var e,n,i={top:0,left:0},r=(n=this[0])&&n.ownerDocument;return r?(e=r.documentElement,K.contains(e,n)?(typeof n.getBoundingClientRect!==Ht&&(i=n.getBoundingClientRect()),n=j(r),{top:i.top+(n.pageYOffset||e.scrollTop)-(e.clientTop||0),left:i.left+(n.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}):i):void 0},position:function(){if(this[0]){var e,t,n={top:0,left:0},i=this[0];return"fixed"===K.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),K.nodeName(e[0],"html")||(n=e.offset()),n.top+=K.css(e[0],"borderTopWidth",!0),n.left+=K.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-K.css(i,"marginTop",!0),left:t.left-n.left-K.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Pi;e&&!K.nodeName(e,"html")&&"static"===K.css(e,"position");)e=e.offsetParent;return e||Pi})}}),K.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,r){var o=/Y/.test(r);K.fn[t]=function(e){return Bt(this,function(e,t,n){var i=j(e);if(void 0===n)return i?r in i?i[r]:i.document.documentElement[t]:e[t];i?i.scrollTo(o?K(i).scrollLeft():n,o?n:K(i).scrollTop()):e[t]=n},t,e,arguments.length,null)}}),K.each(["top","left"],function(e,n){K.cssHooks[n]=w(Q.pixelPosition,function(e,t){if(t)return t=bn(e,n),En.test(t)?K(e).position()[n]+"px":t})}),K.each({Height:"height",Width:"width"},function(o,a){K.each({padding:"inner"+o,content:a,"":"outer"+o},function(r,e){K.fn[e]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return Bt(this,function(e,t,n){return K.isWindow(e)?e.document.documentElement["client"+o]:9===e.nodeType?(t=e.documentElement,Math.max(e.body["scroll"+o],t["scroll"+o],e.body["offset"+o],t["offset"+o],t["client"+o])):void 0===n?K.css(e,t,i):K.style(e,t,n,i)},a,n?e:void 0,n,null)}})}),K.fn.size=function(){return this.length},K.fn.andSelf=K.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return K});var Ni=f.jQuery,ki=f.$;return K.noConflict=function(e){return f.$===K&&(f.$=ki),e&&f.jQuery===K&&(f.jQuery=Ni),K},typeof e===Ht&&(f.jQuery=f.$=K),K}),function(e){function t(e){try{return e?new window.ActiveXObject("Microsoft.XMLHTTP"):new window.XMLHttpRequest}catch(e){}}e.ajaxSettings.xhr=void 0===window.ActiveXObject?t:function(){return(this.url==document.location||0==this.url.indexOf("http")||!this.isLocal)&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&t()||t(1)},e.ajaxTransport("+script",function(t){var i,r=document.head||jQuery("head")[0]||document.documentElement;return{send:function(e,n){i=document.createElement("script"),t.scriptCharset&&(i.charset=t.scriptCharset),i.src=t.url,i.onload=i.onreadystatechange=function(e,t){!t&&i.readyState&&!/loaded|complete/.test(i.readyState)||(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),i=null,t||n(200,"success"))},r.insertBefore(i,r.firstChild)},abort:function(){i&&i.onload(void 0,!0)}}}),e.extend(e.support,{iecors:!!window.XDomainRequest}),e.support.iecors?e.ajaxTransport(function(i){return{send:function(e,t){var n=new window.XDomainRequest;n.onload=function(){t(200,"OK",{text:n.responseText},{"Content-Type":n.contentType})},i.xhrFields&&(n.onerror=i.xhrFields.error,n.ontimeout=i.xhrFields.timeout),n.open(i.type,i.url),n.send(i.hasContent&&i.data||null)},abort:function(){xdr.abort()}}}):(e.ajaxSetup({accepts:{binary:"text/plain; charset=x-user-defined"},responseFields:{binary:"response"}}),e.ajaxTransport("binary",function(a){var s;return{send:function(e,r){var o=a.xhr();o.open(a.type,a.url,a.async);var t=!1;try{o.hasOwnProperty("responseType")&&(o.responseType="arraybuffer",t=!0)}catch(e){}try{!t&&o.overrideMimeType&&o.overrideMimeType("text/plain; charset=x-user-defined")}catch(e){}a.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");try{for(var n in e)o.setRequestHeader(n,e[n])}catch(e){}o.send(a.hasContent&&a.data||null),s=function(){var e=o.status,t="",n=o.getAllResponseHeaders(),i={};try{if(s&&4===o.readyState){s=void 0;try{i.text="string"==typeof o.responseText?o.responseText:null}catch(e){}try{i.binary=o.response}catch(e){}try{t=o.statusText}catch(e){t=""}e||!a.isLocal||a.crossDomain?1223===e&&(e=204):e=i.text?200:404,r(e,t,i,n)}}catch(e){alert(e),r(-1,e)}},a.async?4===o.readyState?setTimeout(s):o.onreadystatechange=s:s()},abort:function(){}}}))}(jQuery),function(o,a,s){function t(e,n){function t(t){o(i).each(function(){self.Jmol&&(0<=n.indexOf("mouseup")||0<=n.indexOf("touchend"))&&Jmol._setMouseOwner(null);var e=o(this);this===t.target||e.has(t.target).length||e.triggerHandler(n,[t.target,t])})}n=n||e+s;var i=o(),r=e+"."+n+"-special-event";o.event.special[n]={setup:function(){1===(i=i.add(this)).length&&o(a).bind(r,t)},teardown:function(){self.Jmol&&Jmol._setMouseOwner(null),0===(i=i.not(this)).length&&o(a).unbind(r)},add:function(e){var n=e.handler;e.handler=function(e,t){e.target=t,n.apply(this,arguments)}}}}o.map("click mousemove mouseup touchmove touchend".split(" "),function(e){t(e)}),t("focusin","focus"+s),t("focusout","blur"+s)}(jQuery,document,"outjsmol"),"undefined"==typeof jQuery&&alert("Note -- JSmoljQuery is required for JSmol, but it's not defined."),self.Jmol||(Jmol={}),Jmol._version||(Jmol=function(e){var t={_version:"$Date: 2019-06-08 00:17:46 -0500 (Sat, 08 Jun 2019) $",_alertNoBinary:!0,_allowedJmolSize:[25,2048,300],_appletCssClass:"",_appletCssText:"",_fileCache:null,_jarFile:null,_j2sPath:null,_use:null,_j2sLoadMonitorOpacity:90,_applets:{},_asynchronous:!0,_ajaxQueue:[],_persistentMenu:!1,_getZOrders:t=function(e){return{rear:e++,header:e++,main:e++,image:e++,front:e++,fileOpener:e++,coverImage:e++,dialog:e++,menu:e+9e4,console:e+91e3,consoleImage:e+91001,monitorZIndex:e+99999}},_z:t(Jmol.z||9e3),_debugCode:!0,_debugCore:!1,db:{_databasePrefixes:"$=:",_fileLoadScript:";if (_loadScript = '' && defaultLoadScript == '' && _filetype == 'Pdb') { select protein or nucleic;cartoons Only;color structure; select * };",_nciLoadScript:";n = ({molecule=1}.length < {molecule=2}.length ? 2 : 1); select molecule=n;display selected;center selected;",_pubChemLoadScript:"",_DirectDatabaseCalls:{"cactus.nci.nih.gov":null,".x3dna.org":null,"rruff.geo.arizona.edu":null,".rcsb.org":null,"ftp.wwpdb.org":null,"pdbe.org":null,"materialsproject.org":null,".ebi.ac.uk":null,"pubchem.ncbi.nlm.nih.gov":null,"www.nmrdb.org/tools/jmol/predict.php":null,$:"https://cactus.nci.nih.gov/chemical/structure/%FILENCI/file?format=sdf&get3d=True",$$:"https://cactus.nci.nih.gov/chemical/structure/%FILENCI/file?format=sdf","=":"https://files.rcsb.org/download/%FILE.pdb","*":"https://www.ebi.ac.uk/pdbe/entry-files/download/%FILE.cif","==":"https://files.rcsb.org/ligands/download/%FILE.cif",":":"https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/%FILE/SDF?record_type=3d"},_restQueryUrl:"http://www.rcsb.org/pdb/rest/search",_restQueryXml:"<orgPdbQuery><queryType>org.pdb.query.simple.AdvancedKeywordQuery</queryType><description>Text Search</description><keywords>QUERY</keywords></orgPdbQuery>",_restReportUrl:"http://www.pdb.org/pdb/rest/customReport?pdbids=IDLIST&customReportColumns=structureId,structureTitle"},_debugAlert:!1,_document:e,_isXHTML:!1,_lastAppletID:null,_mousePageX:null,_mouseOwner:null,_serverUrl:"https://your.server.here/jsmol.php",_syncId:(""+Math.random()).substring(3),_touching:!1,_XhtmlElement:null,_XhtmlAppendChild:!1};for(var n in e=e.location.href.toLowerCase(),t._debugCore=0<=e.indexOf("j2sdebugcore"),t._httpProto=0==e.indexOf("https")?"https://":"http://",t._isFile=0==e.indexOf("file:"),t._isFile&&$.ajaxSetup({mimeType:"text/plain"}),t._ajaxTestSite=t._httpProto+"google.com",e=t._isFile||0==e.indexOf("http://localhost")||0==e.indexOf("http://127."),t._tracker=!e&&"https://chemapps.stolaf.edu/jmol/JmolTracker.php?id=UA-45940799-1",t._isChrome=0<=navigator.userAgent.toLowerCase().indexOf("chrome"),t._isSafari=!t._isChrome&&0<=navigator.userAgent.toLowerCase().indexOf("safari"),t._isMsie=void 0!==window.ActiveXObject,t._isEdge=0<=navigator.userAgent.indexOf("Edge/"),t._useDataURI=!t._isSafari&&!t._isMsie&&!t._isEdge,window.requestAnimationFrame||(window.requestAnimationFrame=window.setTimeout),Jmol)t[n]=Jmol[n];return t}(document,Jmol)),function(a,m){a.__$=m,m(document).ready(function(){a._document=null}),a.$=function(e,t){return null==e&&alert(t+arguments.callee.caller.toString()),m(t?"#"+e._id+"_"+t:e)},a._$=function(e){return"string"==typeof e?m("#"+e):e},a.$ajax=function(e){return a._ajaxCall=e.url,e.cache="NO"!=e.cache,e.url=a._fixProtocol(e.url),m.ajax(e)},a._fixProtocol=function(e){return 0<=e.indexOf("get3d=True")&&(e=e.replace(/get3d\=True/,"get3d=true")),0==e.indexOf("http://www.rcsb.org/pdb/files/")&&e.indexOf("/ligand/")<0?"http://files.rcsb.org/view/"+e.substring(30).replace(/\.gz/,""):0==e.indexOf("http://")&&("https://"==a._httpProto||0<e.indexOf(".gov/")||0==e.indexOf("http://www.materialsproject"))?"https"+e.substring(4):e},a._getNCIInfo=function(e,t){return a._getFileData("https://cactus.nci.nih.gov/chemical/structure/"+e+"/"+("name"==t?"names":t))},a.$appEvent=function(e,t,n,i){(e=a.$(e,t)).off(n)&&i&&e.on(n,i)},a.$resize=function(e){return m(window).resize(e)},a.$after=function(e,t){return m(e).after(t)},a.$append=function(e,t){return m(e).append(t)},a.$bind=function(e,t,n){return n?m(e).bind(t,n):m(e).unbind(t)},a.$closest=function(e,t){return m(e).closest(t)},a.$get=function(e,t){return m(e).get(t)},a.$documentOff=function(e,t){return m(document).off(e,"#"+t)},a.$documentOn=function(e,t,n){return m(document).on(e,"#"+t,n)},a.$getAncestorDiv=function(e,t){return m("div."+t+":has(#"+e+")")[0]},a.$supportsIECrossDomainScripting=function(){return m.support.iecors},a.$attr=function(e,t,n){return a._$(e).attr(t,n)},a.$css=function(e,t){return a._$(e).css(t)},a.$find=function(e,t){return a._$(e).find(t)},a.$focus=function(e){return a._$(e).focus()},a.$html=function(e,t){return a._$(e).html(t)},a.$offset=function(e){return a._$(e).offset()},a.$windowOn=function(e,t){return m(window).on(e,t)},a.$prop=function(e,t,n){var i=a._$(e);return 3==arguments.length?i.prop(t,n):i.prop(t)},a.$remove=function(e){return a._$(e).remove()},a.$scrollTo=function(e,t){var n=a._$(e);return n.scrollTop(t<0?n[0].scrollHeight:t)},a.$setEnabled=function(e,t){return a._$(e).attr("disabled",t?null:"disabled")},a.$getSize=function(e){return[(e=a._$(e)).width(),e.height()]},a.$setSize=function(e,t,n){return a._$(e).width(t).height(n)},a.$is=function(e,t){return a._$(e).is(t)},a.$setVisible=function(e,t){var n=a._$(e);return t?n.show():n.hide()},a.$submit=function(e){return a._$(e).submit()},a.$val=function(e,t){var n=a._$(e);return 1==arguments.length?n.val():n.val(t)},a._clearVars=function(){delete jQuery,delete m,delete a,delete SwingController,delete J,delete JM,delete JS,delete JSV,delete JU,delete JV,delete java,delete javajs,delete Clazz,delete c$};var l=document,h=window,e={},j;e.ua=navigator.userAgent.toLowerCase();e:{j=["linux","unix","mac","win"];for(var t=j.length;t--;)if(-1!=e.ua.indexOf(j[t])){j=j[t];break e}j="unknown"}e.os=j,e.browser=function(){for(var t=e.ua,n="konqueror webkit omniweb opera webtv icab msie mozilla".split(" "),i=0;i<n.length;i++)if(0<=t.indexOf(n[i]))return n[i];return"unknown"},e.browserName=e.browser(),e.browserVersion=parseFloat(e.ua.substring(e.ua.indexOf(e.browserName)+e.browserName.length+1)),e.supportsXhr2=function(){return m.support.cors||m.support.iecors},e.allowDestroy="msie"!=e.browserName,e.allowHTML5="msie"!=e.browserName||navigator.appVersion.indexOf("MSIE 8")<0,e.getDefaultLanguage=function(){return navigator.language||navigator.userLanguage||"en-US"},e._webGLtest=0,e.supportsWebGL=function(){var e;return a.featureDetection._webGLtest||(a.featureDetection._webGLtest=h.WebGLRenderingContext&&((e=l.createElement("canvas")).getContext("webgl")||e.getContext("experimental-webgl"))?1:-1),0<a.featureDetection._webGLtest},e.supportsLocalization=function(){for(var e=l.getElementsByTagName("meta"),t=e.length;0<=--t;)if(0<=e[t].outerHTML.toLowerCase().indexOf("utf-8"))return!0;return!1},e.supportsJava=function(){return a.featureDetection._javaEnabled||(a.featureDetection._javaEnabled=a._isMsie?navigator.javaEnabled()?1:-1:!navigator.javaEnabled()||navigator.mimeTypes&&!navigator.mimeTypes["application/x-java-applet"]?-1:1),0<a.featureDetection._javaEnabled},e.compliantBrowser=function(){var t=!!l.getElementById,n=e.os;return("opera"==e.browserName&&e.browserVersion<=7.54&&"mac"==n||"webkit"==e.browserName&&e.browserVersion<125.12||"msie"==e.browserName&&"mac"==n||"konqueror"==e.browserName&&e.browserVersion<=3.3)&&(t=!1),t},e.isFullyCompliant=function(){return e.compliantBrowser()&&e.supportsJava()},e.useIEObject="win"==e.os&&"msie"==e.browserName&&5.5<=e.browserVersion,e.useHtml4Object="mozilla"==e.browserName&&5<=e.browserVersion||"opera"==e.browserName&&8<=e.browserVersion||"webkit"==e.browserName,e.hasFileReader=h.File&&h.FileReader,a.featureDetection=e,a._ajax=function(e){if(!e.async)return a.$ajax(e).responseText;a._ajaxQueue.push(e),1==a._ajaxQueue.length&&a._ajaxDone()},a._ajaxDone=function(){var e=a._ajaxQueue.shift();e&&a.$ajax(e)},a._grabberOptions=[["$","NCI(small molecules)"],[":","PubChem(small molecules)"],["=","RCSB(macromolecules)"],["*","PDBe(macromolecules)"]],a._getGrabberOptions=function(e){if(0==a._grabberOptions.length)return"";var t='<input type="text" id="ID_query" onfocus="jQuery(this).select()" onkeypress="if(13==event.which){Jmol._applets[\'ID\']._search();return false}" size="32" value="" />',n='<button id="ID_submit" onclick="Jmol._applets[\'ID\']._search()">Search</button></nobr>';1==a._grabberOptions.length?(t="<nobr>"+t+'<span style="display:none">',n="</span>"+n):t+="<br /><nobr>";for(var t=t+'<select id="ID_select">',i=0;i<a._grabberOptions.length;i++)var r=a._grabberOptions[i],t=t+('<option value="'+r[0]+'" '+(0==i?"selected":"")+">"+r[1])+"</option>";return"<br />"+(t=(t+"</select>"+n).replace(/ID/g,e._id))},a._getScriptForDatabase=function(e){return"$"==e?a.db._nciLoadScript:":"==e?a.db._pubChemLoadScript:a.db._fileLoadScript},a._setInfo=function(e,t,n){var i=[],r="";if(0==n.indexOf("ERROR"))r=n;else switch(t){case"=":for(t=n.split("<dimStructure.structureId>"),i=["<table>"],n=1;n<t.length;n++)i.push('<tr><td valign=top><a href="javascript:Jmol.search('+e._id+",'="+t[n].substring(0,4)+"')\">"+t[n].substring(0,4)+"</a></td>"),i.push("<td>"+t[n].split("Title>")[1].split("</")[0]+"</td></tr>");i.push("</table>"),r=t.length-1+" matches";break;case"$":case":":break;default:return}e._infoHeader=r,e._info=i.join(""),e._showInfo(!0)},a._loadSuccess=function(e,t){t&&(a._ajaxDone(),t(e))},a._loadError=function(e){a._ajaxDone(),a.say("Error connecting to server: "+a._ajaxCall),null!=e&&e()},a._isDatabaseCall=function(e){return 0<=a.db._databasePrefixes.indexOf(e.substring(0,1))},a._getDirectDatabaseCall=function(e,t){if(t&&!a.featureDetection.supportsXhr2())return e;var n=2,i=e.substring(0,n),r=a.db._DirectDatabaseCalls[i]||a.db._DirectDatabaseCalls[i=e.substring(0,--n)];return r&&(e=0<=(e=":"==i?(i=e.toLowerCase(),isNaN(parseInt(e.substring(1)))?0==i.indexOf(":smiles:")?(r+="?POST?smiles="+e.substring(8),"smiles"):0==i.indexOf(":cid:")?"cid/"+e.substring(5):(0==i.indexOf(":name:")?e=e.substring(5):0==i.indexOf(":cas:")&&(e=e.substring(4)),"name/"+encodeURIComponent(e.substring(n))):"cid/"+e.substring(1)):encodeURIComponent(e.substring(n))).indexOf(".mmtf")?"https://mmtf.rcsb.org/v1.0/full/"+e.replace(/\.mmtf/,""):0<=r.indexOf("FILENCI")?(e=e.replace(/\%2F/g,"/"),r.replace(/\%FILENCI/,e)):r.replace(/\%FILE/,e)),e},a._getRawDataFromServer=function(e,t,n,i,r,o){return e="?call=getRawDataFromDatabase&database="+e+(0<=t.indexOf("?POST?")?"?POST?":"")+"&query="+encodeURIComponent(t)+(r?"&encoding=base64":"")+(o?"":"&script="+encodeURIComponent(a._getScriptForDatabase(e))),a._contactServer(e,n,i)},a._checkFileName=function(e,t,n){return a._isDatabaseCall(t)&&(n&&a._setQueryTerm(e,t),t=a._getDirectDatabaseCall(t,!0),a._isDatabaseCall(t)&&(t=a._getDirectDatabaseCall(t,!1),n&&(n[0]=!0))),t},a._checkCache=function(e,t,n){if(e._cacheFiles&&a._fileCache&&!t.endsWith(".js")){if(e=a._fileCache[t])return System.out.println("using "+e.length+" bytes of cached data for "+t),n(e),null;n=function(e,t){n(a._fileCache[e]=t)}}return n},a.playAudio=function(e){a.playAudio(null,e)},a.playAudio=function(e,n){var t=n.get?function(e){return n.get(e)}:null,i=n.put?function(e,t){return n.put(e,t)}:null,r=t?t("audioFile"):n,o=t&&t("audioPlayer"),a=document.createElement("audio");i&&i("audioElement",a);var s=null;o&&(s=function(e){o.processUpdate(e)},o.myClip={open:function(){s("open")},start:function(){a.play(),s("start")},loop:function(e){a.loop=0!=e},stop:function(){a.pause()},close:function(){s("close")},setMicrosecondPosition:function(e){a.currentTime=e/1e6}}),a.controls="true",a.src=r,t&&t("loop")&&(a.loop="true"),s&&(a.addEventListener("pause",function(){s("pause")}),a.addEventListener("play",function(){s("play")}),a.addEventListener("playing",function(){s("playing")}),a.addEventListener("ended",function(){s("ended")}),s("open"))},a._loadFileData=function(e,t,n,i){var r=[];t=a._checkFileName(e,t,r),n=a._checkCache(e,t,n),r[0]?a._getRawDataFromServer("_",t,n,i):(e={type:"GET",dataType:"text",url:t,async:a._asynchronous,success:function(e){a._loadSuccess(e,n)},error:function(){a._loadError(i)}},a._checkAjaxPost(e),a._ajax(e))},a._getInfoFromDatabase=function(t,n,i){if("===="!=n)return i="?call=getInfoFromDatabase&database="+n+"&query="+encodeURIComponent(i),a._contactServer(i,function(e){a._setInfo(t,n,e)});var e=a.db._restQueryXml.replace(/QUERY/,i),e={dataType:"text",type:"POST",contentType:"application/x-www-form-urlencoded",url:a.db._restQueryUrl,data:encodeURIComponent(e)+"&req=browser",success:function(e){a._ajaxDone(),a._extractInfoFromRCSB(t,n,i,e)},error:function(){a._loadError(null)},async:a._asynchronous};return a._ajax(e)},a._extractInfoFromRCSB=function(t,n,e,i){var r,o=i.length/5;0!=o&&4==e.length&&1!=o&&(e=e.toUpperCase(),0<(r=i.indexOf(e))&&0<="123456789".indexOf(e.substring(0,1))&&(i=e+","+i.substring(0,r)+i.substring(r+5)),50<o&&(i=i.substring(0,250)),i=i.replace(/\n/g,","),i=a._restReportUrl.replace(/IDLIST/,i),a._loadFileData(t,i,function(e){a._setInfo(t,n,e)}))},a._checkAjaxPost=function(e){var t=e.url.indexOf("?POST?");0<t&&(e.data=e.url.substring(t+6),e.url=e.url.substring(0,t),e.type="POST",e.contentType="application/x-www-form-urlencoded")},a._contactServer=function(e,t,n){return e={dataType:"text",type:"GET",url:a._serverUrl+e,success:function(e){a._loadSuccess(e,t)},error:function(){a._loadError(n)},async:!!t&&a._asynchronous},a._checkAjaxPost(e),a._ajax(e)},a._setQueryTerm=function(e,t){if(t&&e._hasOptions&&"http://"!=t.substring(0,7)){if(a._isDatabaseCall(t)){var n=t.substring(0,1);(t=t.substring(1)).substring(0,1)==n&&0<="=$".indexOf(n)&&(t=t.substring(1));var i=a._getElement(e,"select");if(i&&i.options)for(var r=0;r<i.options.length;r++)i[r].value==n&&(i[r].selected=!0)}a.$val(a.$(e,"query"),t)}},a._search=function(e,t,n){1<arguments.length||(t=null),a._setQueryTerm(e,t),0==(t=t||a.$val(a.$(e,"query"))).indexOf("!")?e._script(t.substring(1)):(t=t&&t.replace(/\"/g,""),e._showInfo(!1),a._searchMol(e,t,n,!0))},a._searchMol=function(e,t,n,i){var r;a._isDatabaseCall(t)?(r=t.substring(0,1),t=t.substring(1)):r=e._hasOptions?a.$val(a.$(e,"select")):"$","="==r&&3==t.length&&(t="="+t);var o,s=r+t;!t||s.indexOf("?")<0&&s==e._thisJmolModel||(e._thisJmolModel=s,i&&null!=e._viewSet&&null!=(o=a.View.__findView(e._viewSet,{chemID:s}))?a.View.__setView(o,e,!1):("$"==r||":"==r?e._jmolFileType="MOL":"="==r&&(e._jmolFileType="PDB"),e._searchDatabase(t,r,n)))},a._searchDatabase=function(e,t,n,i){return e._showInfo(!1),0<=t.indexOf("?")?(a._getInfoFromDatabase(e,n,t.split("?")[0]),!0):!!a.db._DirectDatabaseCalls[n]&&(e._loadFile(n+t,i),!0)},a._syncBinaryOK="?",a._canSyncBinary=function(t){if(a._isAsync)return!0;if(self.VBArray)return a._syncBinaryOK=!1;if("?"!=a._syncBinaryOK)return a._syncBinaryOK;a._syncBinaryOK=!0;try{var e=new window.XMLHttpRequest;e.open("text",a._ajaxTestSite,!1),e.hasOwnProperty("responseType")?e.responseType="arraybuffer":e.overrideMimeType&&e.overrideMimeType("text/plain; charset=x-user-defined")}catch(e){return System.out.println("JSmolCore.js: synchronous binary file transfer is requested but not available"),a._alertNoBinary&&!t&&alert("JSmolCore.js: synchronous binary file transfer is requested but not available"),a._syncBinaryOK=!1}return!0},a._binaryTypes="mmtf .gz .bz2 .jpg .gif .png .zip .jmol .bin .smol .spartan .pmb .mrc .map .ccp4 .dn6 .delphi .omap .pse .dcd .uk/pdbe/densities/".split(" "),a.isBinaryUrl=function(e){for(var t=a._binaryTypes.length;0<=--t;)if(0<=e.indexOf(a._binaryTypes[t]))return!0;return!1},a._getFileData=function(e,t,n){var i=a.isBinaryUrl(e);(r=0<=e.indexOf(".gz")&&0<=e.indexOf("rcsb.org"))&&(e=e.replace(/\.gz/,""),i=!1);var r=i&&!t&&!a._canSyncBinary(r),o=0<=e.indexOf("?POST?");0==e.indexOf("file:/")&&0!=e.indexOf("file:///")&&(e="file://"+e.substring(5));var s=e.indexOf("://")<0||0==e.indexOf(document.location.protocol)&&0<=e.indexOf(document.location.host),l="https://"==a._httpProto&&0==e.indexOf("http://"),c=a._isDirectCall(e);!c&&0<=e.indexOf("?ALLOWSORIGIN?")&&(c=!0,e=e.replace(/\?ALLOWSORIGIN\?/,""));var u,h=!s&&a.$supportsIECrossDomainScripting(),f=null;return l||r||!s&&!c||!t&&h?f=a._getRawDataFromServer("_",e,t,t,r,!0):(e=e.replace(/file:\/\/\/\//,"file://"),u={dataType:i?"binary":"text",async:!!t},o?(u.type="POST",u.url=e.split("?POST?")[0],u.data=e.split("?POST?")[1]):(u.type="GET",u.url=e),t&&(u.success=function(){t(a._xhrReturn(u.xhr))},u.error=function(){t(u.xhr.statusText)}),u.xhr=a.$ajax(u),t||(f=a._xhrReturn(u.xhr))),n?(null==f&&(f="",i=!1),(i=i&&a._canSyncBinary(!0))?a._strToBytes(f):JU.SB.newS(f)):f},a._xhrReturn=function(e){return!e.responseText||self.Clazz&&Clazz.instanceOf(e.response,self.ArrayBuffer)?e.response||e.statusText:e.responseText},a._isDirectCall=function(e){if(0<=e.indexOf("?ALLOWSORIGIN?"))return!0;for(var t in a.db._DirectDatabaseCalls)if(0<=t.indexOf(".")&&0<=e.indexOf(t))return!0;return!1},a._cleanFileData=function(e){return 0<=e.indexOf("\r")&&0<=e.indexOf("\n")?e.replace(/\r\n/g,"\n"):0<=e.indexOf("\r")?e.replace(/\r/g,"\n"):e},a._getFileType=function(e){var t=e.substring(0,1);return"$"==t||":"==t?"MOL":"="==t?"="==e.substring(1,2)?"LCIF":"PDB":(e=e.split(".").pop().toUpperCase()).substring(0,Math.min(e.length,3))},a._getZ=function(e,t){return e&&e._z&&e._z[t]||a._z[t]},a._incrZ=function(e,t){return e&&e._z&&++e._z[t]||++a._z[t]},a._hideLocalFileReader=function(e){e._localReader&&a.$setVisible(e._localReader,!1),e._readingLocal=!1,a.setCursor(e,0)},a.loadFileFromDialog=function(e){a.loadFileAsynchronously(null,e,null,null)},a.loadFileAsynchronously=function(n,i,t,r){if(t&&0!=t.indexOf("?")){var o=t;t=a._checkFileName(i,t);var e=function(e){a._setData(n,t,o,e,r,i)},e=a._checkCache(i,t,e);return 0<=t.indexOf("|")&&(t=t.split("|")[0]),null==e?null:a._getFileData(t,e)}if(!a.featureDetection.hasFileReader)return n?n.setData("Local file reading is not enabled in your browser",null,null,r,i):alert("Local file reading is not enabled in your browser");i._localReader||(e='<div id="ID" style="z-index:'+a._getZ(i,"fileOpener")+';position:absolute;background:#E0E0E0;left:10px;top:10px"><div style="margin:5px 5px 5px 5px;"><button id="ID_loadurl">URL</button><input type="file" id="ID_files" /><button id="ID_loadfile">load</button><button id="ID_cancel">cancel</button></div><div>',a.$after("#"+i._id+"_appletdiv",e.replace(/ID/g,i._id+"_localReader")),i._localReader=a.$(i,"localReader")),a.$appEvent(i,"localReader_loadurl","click"),a.$appEvent(i,"localReader_loadurl","click",function(){var e=prompt("Enter a URL");e&&(a._hideLocalFileReader(i,0),a._setData(null,e,e,null,r,i))}),a.$appEvent(i,"localReader_loadfile","click"),a.$appEvent(i,"localReader_loadfile","click",function(){var t=a.$(i,"localReader_files")[0].files[0],e=new FileReader;e.onloadend=function(e){e.target.readyState==FileReader.DONE&&(a._hideLocalFileReader(i,0),a._setData(n,t.name,t.name,e.target.result,r,i))};try{e.readAsArrayBuffer(t)}catch(e){alert("You must select a file first.")}}),a.$appEvent(i,"localReader_cancel","click"),a.$appEvent(i,"localReader_cancel","click",function(){a._hideLocalFileReader(i),n&&n.setData("#CANCELED#",null,null,r,i)}),a.$setVisible(i._localReader,!0),i._readingLocal=!0},a._setData=function(e,t,n,i,r,o){null!=(i=i&&a._strToBytes(i))&&(null==e||0<=t.indexOf(".jdx"))&&a.Cache.put("cache://"+t,i),null==e?o._applet.openFileAsyncSpecial(null==i?t:"cache://"+t,1):e.setData(t,n,i,r)},a.doAjax=function(e,t,n){return e=e.toString(),n?0!=e.indexOf("http://")&&0!=e.indexOf("https://")?a._saveFile(e,n):(e={async:!1,url:e,type:"POST",data:"string"==typeof data?n:";base64,"+(JU||J.util).Base64.getBase64(n).toString(),processData:!1},a.$ajax(e).responseText):(t&&(e+="?POST?"+t),a._getFileData(e,null,!0))},a._saveFile=function(e,t,n,i){if(a._localFileSaveFunction&&a._localFileSaveFunction(e,t))return"OK";e=e.substring(e.lastIndexOf("/")+1),n=n||(0<=e.indexOf(".pdf")?"application/pdf":0<=e.indexOf(".png")?"image/png":0<=e.indexOf(".gif")?"image/gif":0<=e.indexOf(".jpg")?"image/jpg":"");var r="string"==typeof t;return t=r&&0<=t.indexOf(";base64,")?t.split(";base64,")[1]:(JU||J.util).Base64.getBase64(r?t.getBytes("UTF-8"):t).toString(),i=i||"base64",(r=a._serverUrl)&&0<=r.indexOf("your.server")&&(r=""),a._useDataURI||!r?((i=document.createElement("a")).href="data:"+n+";base64,"+t,i.type=n||"text/plain;charset=utf-8",i.download=e,i.target="_blank",m("body").append(i),i.click(),i.remove()):(a._formdiv||(a.$after("body",'<div id="__jsmolformdiv__" style="display:none">\t\t\t\t\t\t<form id="__jsmolform__" method="post" target="_blank" action="">\t\t\t\t\t\t<input name="call" value="saveFile"/>\t\t\t\t\t\t<input id="__jsmolmimetype__" name="mimetype" value=""/>\t\t\t\t\t\t<input id="__jsmolencoding__" name="encoding" value=""/>\t\t\t\t\t\t<input id="__jsmolfilename__" name="filename" value=""/>\t\t\t\t\t\t<textarea id="__jsmoldata__" name="data"></textarea>\t\t\t\t\t\t</form>\t\t\t\t\t\t</div>'),a._formdiv="__jsmolform__"),a.$attr(a._formdiv,"action",r+"?"+(new Date).getMilliseconds()),a.$val("__jsmoldata__",t),a.$val("__jsmolfilename__",e),a.$val("__jsmolmimetype__",n),a.$val("__jsmolencoding__",i),a.$submit("__jsmolform__"),a.$val("__jsmoldata__",""),a.$val("__jsmolfilename__","")),"OK"},a._strToBytes=function(e){if(Clazz.instanceOf(e,self.ArrayBuffer))return Clazz.newByteArray(-1,e);for(var t=Clazz.newByteArray(e.length,0),n=e.length;0<=--n;)t[n]=255&e.charCodeAt(n);return t},a._setConsoleDiv=function(e){self.Clazz&&Clazz.setConsoleDiv(e)},a._registerApplet=function(e,t){return window[e]=a._applets[e]=a._applets[e+"__"+a._syncId+"__"]=t},a._readyCallback=function(e,t,n,i,r){e=e.split("_object")[0];var o=a._applets[e];(n=n.booleanValue?n.booleanValue():n)&&(o._appletPanel=r||i,o._applet=i),a._track(o)._readyCallback(e,t,n)},a._getWrapper=function(e,t){var n,i,r,o,s=t?(i="",e._coverImage&&(i=' onclick="Jmol.coverApplet(ID, false)" title="'+e._coverTitle+'"',n='<image id="ID_coverclickgo" src="'+e._makeLiveImage+'" style="width:25px;height:25px;position:absolute;bottom:10px;left:10px;z-index:'+a._getZ(e,"coverImage")+';opacity:0.5;"'+i+" />",i='<div id="ID_coverdiv" style="background-color:red;z-index:'+a._getZ(e,"coverImage")+';width:100%;height:100%;display:inline;position:absolute;top:0px;left:0px"><image id="ID_coverimage" src="'+e._coverImage+'" style="width:100%;height:100%"'+i+"/>"+n+"</div>"),n=e._isJava?"":'<image id="ID_waitimage" src="'+e._j2sPath+'/img/cursor_wait.gif" style="display:none;position:absolute;bottom:10px;left:10px;z-index:'+a._getZ(e,"coverImage")+';" />',s=a._appletCssText.replace(/\'/g,'"'),r=e._getSpinner&&e._getSpinner(),e._spinner=r=r&&"none"!=r?"background-image:url("+r+"); background-repeat:no-repeat; background-position:center;":"",s=r+(0<=s.indexOf('style="')?s.split('style="')[1]:'" '+s),s='...<div id="ID_appletinfotablediv" style="width:Wpx;height:Hpx;position:relative;font-size:14px;text-align:left">IMG WAIT......<div id="ID_appletdiv" style="z-index:'+a._getZ(e,"header")+";width:100%;height:100%;position:absolute;top:0px;left:0px;"+s+">",r=e._height,o=e._width,("string"!=typeof r||r.indexOf("%")<0)&&(r+="px"),("string"!=typeof o||o.indexOf("%")<0)&&(o+="px"),s.replace(/IMG/,i).replace(/WAIT/,n).replace(/Hpx/g,r).replace(/Wpx/g,o)):'......</div>......<div id="ID_2dappletdiv" style="position:absolute;width:100%;height:100%;overflow:hidden;display:none"></div>......<div id="ID_infotablediv" style="width:100%;height:100%;position:absolute;top:0px;left:0px">.........<div id="ID_infoheaderdiv" style="height:20px;width:100%;background:yellow;display:none"><span id="ID_infoheaderspan"></span><span id="ID_infocheckboxspan" style="position:absolute;text-align:right;right:1px;"><a href="javascript:Jmol.showInfo(ID,false)">[x]</a></span></div>.........<div id="ID_infodiv" style="position:absolute;top:20px;bottom:0px;width:100%;height:100%;overflow:auto"></div>......</div>...</div>';return s.replace(/\.\.\./g,"").replace(/[\n\r]/g,"").replace(/ID/g,e._id)},a._hideLoadingSpinner=function(e){e._spinner&&a.$css(a.$(e,"appletdiv"),{"background-image":""})},a._documentWrite=function(e){var t;return a._document&&(a._isXHTML&&!a._XhtmlElement&&(t=document.getElementsByTagName("script"),a._XhtmlElement=t.item(t.length-1),a._XhtmlAppendChild=!1),a._XhtmlElement?a._domWrite(e):a._document.write(e)),e},a._domWrite=function(e){for(var t=[0];t[0]<e.length;){var n=a._getDomElement(e,t);if(!n)break;a._XhtmlAppendChild?a._XhtmlElement.appendChild(n):a._XhtmlElement.parentNode.insertBefore(n,_jmol.XhtmlElement)}},a._getDomElement=function(e,t){var n=document.createElement("span");return n.innerHTML=e,t[0]=e.length,n},a._setObject=function(e,t,n){for(var i in e._id=t,e.__Info={},n.z&&n.zIndexBase&&(a._z=a._getZOrders(n.zIndexBase)),n)e.__Info[i]=n[i];(e._z=n.z)||n.zIndexBase&&(e._z=e.__Info.z=a._getZOrders(n.zIndexBase)),e._width=n.width,e._height=n.height,e._noscript=!e._isJava&&n.noscript,e._console=n.console,e._cacheFiles=!!n.cacheFiles,e._viewSet=null==n.viewSet||e._isJava?null:"Set"+n.viewSet,null!=e._viewSet&&(a.View.__init(e),e._currentView=null),!a._fileCache&&e._cacheFiles&&(a._fileCache={}),e._console||(e._console=e._id+"_infodiv"),"none"==e._console&&(e._console=null),e._color=n.color?n.color.replace(/0x/,"#"):"#FFFFFF",e._disableInitialConsole=n.disableInitialConsole,e._noMonitor=n.disableJ2SLoadMonitor,a._j2sPath&&(n.j2sPath=a._j2sPath),e._j2sPath=n.j2sPath,e._coverImage=n.coverImage,e._makeLiveImage=n.makeLiveImage||n.j2sPath+"/img/play_make_live.jpg",e._isCovered=!!e._coverImage,e._deferApplet=n.deferApplet||e._isCovered&&e._isJava,e._deferUncover=n.deferUncover&&!e._isJava,e._coverScript=n.coverScript,e._coverTitle=n.coverTitle,e._coverTitle||(e._coverTitle=e._deferApplet?"activate 3D model":"3D model is loading..."),e._containerWidth=e._width+(e._width==parseFloat(e._width)?"px":""),e._containerHeight=e._height+(e._height==parseFloat(e._height)?"px":""),e._info="",e._infoHeader=e._jmolType+' "'+e._id+'"',e._hasOptions=n.addSelectionOptions,e._defaultModel=n.defaultModel,e._readyScript=n.script?n.script:"",e._readyFunction=n.readyFunction,e._coverImage&&!e._deferApplet&&(e._readyScript+=";javascript "+t+"._displayCoverImage(false)"),e._src=n.src},a._addDefaultInfo=function(e,t){for(var n in t)void 0===e[n]&&(e[n]=t[n]);a._use&&(e.use=a._use),0<=e.use.indexOf("SIGNED")&&(e.jarFile.indexOf("Signed")<0&&(e.jarFile=e.jarFile.replace(/Applet/,"AppletSigned")),e.use=e.use.replace(/SIGNED/,"JAVA"),e.isSigned=!0)},a._syncedApplets=[],a._syncedCommands=[],a._syncedReady=[],a._syncReady=!1,a._isJmolJSVSync=!1,a._setReady=function(e){a._syncedReady[e]=1;for(var t=0,n=0;n<a._syncedApplets.length;n++){if(a._syncedApplets[n]==e._id)a._syncedApplets[n]=e,a._syncedReady[n]=1;else if(!a._syncedReady[n])continue;t++}t==a._syncedApplets.length&&a._setSyncReady()},a._setDestroy=function(e){a.featureDetection.allowDestroy&&a.$windowOn("beforeunload",function(){a._destroy(e)})},a._destroy=function(e){try{e._appletPanel&&e._appletPanel.destroy(),e._applet=null,a._unsetMouse(e._canvas),e._canvas=null;for(var t=0,n=0;n<a._syncedApplets.length;n++)a._syncedApplets[n]==e&&(a._syncedApplets[n]=null),a._syncedApplets[n]&&t++;0<t||a._clearVars()}catch(e){}},a._setSyncReady=function(){a._syncReady=!0;for(var e="",t=0;t<a._syncedApplets.length;t++)a._syncedCommands[t]&&(e+="Jmol.script(Jmol._syncedApplets["+t+"], Jmol._syncedCommands["+t+"]);");setTimeout(e,50)},a._mySyncCallback=function(e,t){if(app=a._applets[e],!app._viewSet){if(!a._syncReady||!a._isJmolJSVSync)return 1;for(var n=0;n<a._syncedApplets.length;n++)0<=t.indexOf(a._syncedApplets[n]._syncKeyword)&&a._syncedApplets[n]._syncScript(t);return 0}a.View.updateFromSync(app,t)},a._getElement=function(e,t){return document.getElementById(e._id+"_"+t)||{}},a._evalJSON=function(e,t){if(!(e+=""))return[];if("{"!=e.charAt(0))return 0<=e.indexOf(" | ")&&(e=e.replace(/\ \|\ /g,"\n")),e;var n=new Function("return "+e)();return n?t&&null!=n[t]?n[t]:n:null},a._sortMessages=function(e){if(!e||"object"!=typeof e)return[];for(var t=[],n=e.length-1;0<=n;n--)for(var i=0,r=e[n].length;i<r;i++)t[t.length]=e[n][i];return 0!=t.length?t.sort(function(e,t){return e[0]<t[0]?1:e[0]>t[0]?-1:0}):void 0},a._setMouseOwner=function(e,t){null==e||t?a._mouseOwner=e:a._mouseOwner==e&&(a._mouseOwner=null)},a._jsGetMouseModifiers=function(e){var t=0;switch(e.button){case 0:t=16;break;case 1:t=8;break;case 2:t=4}return e.shiftKey&&(t+=1),e.altKey&&(t+=8),e.ctrlKey&&(t+=2),t},a._jsGetXY=function(e,t){if(!e.applet._ready||a._touching&&t.type.indexOf("touch")<0)return!1;var n,i=a.$offset(e.id),r=t.originalEvent;return t.pageX||(t.pageX=r.pageX),t.pageY||(t.pageY=r.pageY),a._mousePageX=t.pageX,a._mousePageY=t.pageY,i=r.targetTouches&&r.targetTouches[0]?(n=r.targetTouches[0].pageX-i.left,r.targetTouches[0].pageY-i.top):r.changedTouches?(n=r.changedTouches[0].pageX-i.left,r.changedTouches[0].pageY-i.top):(n=t.pageX-i.left,t.pageY-i.top),null==n?null:[Math.round(n),Math.round(i),a._jsGetMouseModifiers(t)]},a.setCursor=function(e,t){if(!e._isJava&&!e._readingLocal){var n;switch(t){case 1:n="crosshair";break;case 3:n="wait",a.$setVisible(a.$(e,"waitimage"),!0);break;case 8:n="ns-resize";break;case 12:n="grab";break;case 13:n="move";break;default:a.$setVisible(a.$(e,"waitimage"),!1),n="default"}e._canvas.style.cursor=n}},a._gestureUpdate=function(e,t){t.stopPropagation(),t.preventDefault();var n=t.originalEvent;switch(t.type){case"touchstart":a._touching=!0;break;case"touchend":a._touching=!1}if(!n.touches||2!=n.touches.length)return!1;switch(t.type){case"touchstart":e._touches=[[],[]];break;case"touchmove":var i=a.$offset(e.id),r=e._touches[0],o=e._touches[1];r.push([n.touches[0].pageX-i.left,n.touches[0].pageY-i.top]),o.push([n.touches[1].pageX-i.left,n.touches[1].pageY-i.top]),3<(n=r.length)&&(r.shift(),o.shift()),2<=n&&e.applet._processGesture(e._touches)}return!0},a._jsSetMouse=function(i){function r(e){return!e.target||0<=(""+e.target.className).indexOf("swingjs-ui")}a.$bind(i,"mousedown touchstart",function(e){if(r(e))return!0;a._setMouseOwner(i,!0),e.stopPropagation();var t=e.target["data-UI"];if(t&&t.handleJSEvent(i,501,e)||e.preventDefault(),i.isDragging=!0,"touchstart"==e.type&&a._gestureUpdate(i,e))return!!t;a._setConsoleDiv(i.applet._console);var n=a._jsGetXY(i,e);return n&&(2!=e.button&&a.Swing.hideMenus(i.applet),i.applet._processEvent(501,n)),!!t}),a.$bind(i,"mouseup touchend",function(e){if(r(e))return!0;a._setMouseOwner(null),e.stopPropagation();var t=e.target["data-UI"];return t&&t.handleJSEvent(i,502,e)||e.preventDefault(),i.isDragging=!1,"touchend"==e.type&&a._gestureUpdate(i,e)||(e=a._jsGetXY(i,e))&&i.applet._processEvent(502,e),!!t}),a.$bind(i,"mousemove touchmove",function(e){return!!r(e)||(a._mouseOwner&&a._mouseOwner!=i&&a._mouseOwner.isDragging?!a._mouseOwner.mouseMove||(a._mouseOwner.mouseMove(e),!1):a._drag(i,e))}),a._drag=function(e,t){if(t.stopPropagation(),t.preventDefault(),"touchmove"==t.type&&a._gestureUpdate(e,t))return!1;var n=a._jsGetXY(e,t);if(!n)return!1;e.isDragging||(n[2]=0);var i=t.target["data-UI"];return!e.isdragging||i&&i.handleJSEvent(e,506,t),e.applet._processEvent(e.isDragging?506:503,n),!!i},a.$bind(i,"DOMMouseScroll mousewheel",function(e){if(r(e))return!0;e.stopPropagation(),e.preventDefault(),i.isDragging=!1;var t=(t=e.originalEvent).detail?t.detail:("mac"==a.featureDetection.os?1:-1)*t.wheelDelta;return e=a._jsGetMouseModifiers(e),i.applet._processEvent(507,[t<0?-1:1,0,e]),!1}),a.$bind(i,"contextmenu",function(){return!1}),a.$bind(i,"mouseout",function(e){return!!r(e)||(a._mouseOwner&&!a._mouseOwner.mouseMove&&a._setMouseOwner(null),i.applet._appletPanel&&i.applet._appletPanel.startHoverWatcher(!1),a._jsGetXY(i,e),!1)}),a.$bind(i,"mouseenter",function(e){return!!r(e)||(i.applet._appletPanel&&i.applet._appletPanel.startHoverWatcher(!0),0===e.buttons||0===e.which?(i.isDragging=!1,(e=a._jsGetXY(i,e))&&(i.applet._processEvent(504,e),i.applet._processEvent(502,e)),!1):void 0)}),a.$bind(i,"mousemoveoutjsmol",function(e,t,n){return!!r(n)||(i==a._mouseOwner&&i.isDragging?a._drag(i,n):void 0)}),i.applet._is2D&&a.$resize(function(){i.applet&&i.applet._resize()}),a.$bind("body","mouseup touchend",function(e){if(r(e))return!0;i.applet&&(i.isDragging=!1),a._setMouseOwner(null)})},a._jsUnsetMouse=function(e){e.applet=null,a.$bind(e,"mousedown touchstart mousemove touchmove mouseup touchend DOMMouseScroll mousewheel contextmenu mouseout mouseenter",null),a._setMouseOwner(null)},a.Swing={count:0,menuInitialized:0,menuCounter:0,htDialogs:{}};var s=a.Swing,u;SwingController=s,s.setDraggable=function(e){(e=e.prototype).setContainer||(e.setContainer=function(e){((this.container=e).obj=this).ignoreMouse=this.isDragging=!1;var t=this;e.bind("mousedown touchstart",function(e){return t.ignoreMouse?!(t.ignoreMouse=!1):(a._setMouseOwner(t,!0),t.isDragging=!0,t.pageX=e.pageX,t.pageY=e.pageY,!1)}),e.bind("mousemove touchmove",function(e){if(t.isDragging&&a._mouseOwner==t)return t.mouseMove(e),!1}),e.bind("mouseup touchend",function(e){t.mouseUp(e),a._setMouseOwner(null)})},e.mouseUp=function(e){if(this.isDragging&&a._mouseOwner==this)return this.pageX0+=e.pageX-this.pageX,this.pageY0+=e.pageY-this.pageY,this.isDragging=!1;a._setMouseOwner(null)},e.setPosition=function(){var e;null===a._mousePageX&&(e=a.$offset(this.applet._id+"_"+(this.applet._is2D?"canvas2d":"canvas")),a._mousePageX=e.left,a._mousePageY=e.top),this.pageX0=a._mousePageX,this.pageY0=a._mousePageY,this.container.css({top:a._mousePageY+"px",left:a._mousePageX+"px"})},e.mouseMove=function(e){var t;this.isDragging&&a._mouseOwner==this&&(this.timestamp=System.currentTimeMillis(),t=this.pageX0+(e.pageX-this.pageX),e=this.pageY0+(e.pageY-this.pageY),a._mousePageX=t,a._mousePageY=e,this.container.css({top:e+"px",left:t+"px"}))},e.dragBind=function(e){var i;this.applet._ignoreMouse=!e,this.container.unbind("mousemoveoutjsmol"),this.container.unbind("touchmoveoutjsmol"),this.container.unbind("mouseupoutjsmol"),this.container.unbind("touchendoutjsmol"),a._setMouseOwner(null),e&&((i=this).container.bind("mousemoveoutjsmol touchmoveoutjsmol",function(e,t,n){i.mouseMove(n)}),this.container.bind("mouseupoutjsmol touchendoutjsmol",function(e,t,n){i.mouseUp(n)}))})},s.JSDialog=function(){},s.setDraggable(s.JSDialog),s.getScreenDimensions=function(e){e.width=m(window).width(),e.height=m(window).height()},s.dispose=function(e){a.$remove(e.id+"_mover"),delete s.htDialogs[e.id],e.container.obj.dragBind(!1)},s.register=function(e,t){e.id=t+ ++s.count,s.htDialogs[e.id]=e},s.setDialog=function(e){a._setMouseOwner(null),a.$remove(e.id);var t,n=e.id+"_mover",i=a._$(n);i[0]?(i.html(e.html),t=i[0].jd):(a.$after("body","<div id='"+n+"' style='position:absolute;left:0px;top:0px;'>"+e.html+"</div>"),t=new s.JSDialog,i=a._$(n),e.container=i,t.applet=e.manager.vwr.html5Applet,t.setContainer(i),t.dialog=e,t.setPosition(),t.dragBind(!0),i[0].jd=t),a.$bind("#"+e.id+" .JButton","mousedown touchstart",function(){t.ignoreMouse=!0}),a.$bind("#"+e.id+" .JComboBox","mousedown touchstart",function(){t.ignoreMouse=!0}),a.$bind("#"+e.id+" .JCheckBox","mousedown touchstart",function(){t.ignoreMouse=!0}),a.$bind("#"+e.id+" .JTextField","mousedown touchstart",function(){t.ignoreMouse=!0}),a.$bind("#"+e.id+" .JTable","mousedown touchstart",function(){t.ignoreMouse=!0}),a.$bind("#"+e.id+" .JScrollPane","mousedown touchstart",function(){t.ignoreMouse=!0}),a.$bind("#"+e.id+" .JEditorPane","mousedown touchstart",function(){t.ignoreMouse=!0})},s.setSelected=function(e){a.$prop(e.id,"checked",!!e.selected)},s.setSelectedIndex=function(e){a.$prop(e.id,"selectedIndex",e.selectedIndex)},s.setText=function(e){a.$prop(e.id,"value",e.text)},s.setVisible=function(e){a.$setVisible(e.id,e._visible)},s.setEnabled=function(e){a.$setEnabled(e.id,e.enabled)},s.click=function(e,t){var n=s.htDialogs[e.id];if(n){var i=n.toString();if(0<=i.indexOf("JCheck"))n.selected=e.checked;else if(0<=i.indexOf("JCombo"))n.selectedIndex=e.selectedIndex;else if(null!=n.text&&(n.text=e.value,t&&13!=(t.charCode||t.keyCode)))return}(i=s.htDialogs[a.$getAncestorDiv(e.id,"JDialog").id]).manager.actionPerformed(n?n.name:i.registryKey+"/"+e.id)},s.setFront=function(e){var t=e.manager.vwr.html5Applet;e.zIndex!=a._getZ(t,"dialog")&&(e.zIndex=a._incrZ(t,"dialog")),e.container&&((e.container[0]||e.container).style.zIndex=e.zIndex)},s.hideMenus=function(e){if(e=e._menus)for(var t in e)e[t]._visible&&s.hideMenu(e[t])},s.windowClosing=function(e){(e=s.htDialogs[a.$getAncestorDiv(e.id,"JDialog").id]).registryKey?e.manager.processWindowClosing(e.registryKey):e.dispose()},a._track=function(e){if(a._tracker){try{var t='<iframe style="display:none" width="0" height="0" frameborder="0" tabindex="-1" src="'+a._tracker+"&applet="+e._jmolType+"&version="+a._version+"&appver="+a.___JmolVersion+"&url="+encodeURIComponent(document.location.href)+'"></iframe>';a.$after("body",t)}catch(e){}delete a._tracker}return e},a.getProfile=function(e){if(self.Clazz&&self.JSON)return u||Clazz._startProfiling(u=0==arguments.length||e),Clazz.getProfile()},a._getInChIKey=function(e,t){0<=t.indexOf("MOL=")&&t.split("MOL=")[1].split('"')},a._getAttr=function(e,t){var n=e.indexOf(t+"=");return 0<=n&&0<=(n=e.indexOf('"',n))?e.substring(n+1,e.indexOf('"',n+1)):null},a.User={viewUpdatedCallback:null},a.View={count:0,applets:{},sets:{}},function(b){b.resetView=function(e,t){if(t){if(t._viewSet){var n=a.View.applets[t._viewSet];for(e in n)e!=t&&a.View.resetView(e)}}else e&&(e._reset(),a.View.updateView(e))},b.updateView=function(e,t){null!=e._viewSet&&((t=t||{}).chemID||(e._searchQuery=null),t.data||(t.data="N/A"),t.type=e._viewType,null==(e._currentView=b.__findView(e._viewSet,t))&&(e._currentView=b.__createViewSet(e._viewSet,t.chemID,t.viewID||t.chemID)),e._currentView[t.type].data=t.data,e._currentView[t.type].smiles=e._getSmiles(),a.User.viewUpdatedCallback&&a.User.viewUpdatedCallback(e,"updateView"),b.__setView(e._currentView,e,!1))},b.updateFromSync=function(c,d){c._updateMsg=d;var e=a._getAttr(d,"sourceID")||a._getAttr(d,"file");if(e){var j=b.__findView(c._viewSet,{viewID:e});if(null==j)return a.updateView(c,d);j!=c._currentView&&b.__setView(j,c,!0);var h=(e=a._getAttr(d,"atoms"))&&0<=d.indexOf("selectionhalos ON")?eval("["+e+"]"):[];setTimeout(function(){c._currentView==j&&b.updateAtomPick(c,h)},10),a.User.viewUpdatedCallback&&a.User.viewUpdatedCallback(c,"updateFromSync")}},b.updateAtomPick=function(e,t){var n=e._currentView;if(null!=n){for(var i in n)"info"!=i&&n[i].applet!=e&&n[i].applet._updateAtomPick(t);a.User.viewUpdatedCallback&&a.User.viewUpdatedCallback(e,"updateAtomPick")}},b.dumpViews=function(e){var t=b.sets[e];if(t){var n="View set "+e+":\n";for(var i in e=b.applets[e])n+="\napplet "+e[i]._id+" currentView="+(e[i]._currentView?e[i]._currentView.info.viewID:null);for(i=t.length;0<=--i;){var r,o,n=n+("\n\n<b>view="+i+" viewID="+(e=t[i]).info.viewID+" chemID="+e.info.chemID)+"</b>\n";for(o in e)"info"!=o&&(n+="\nview="+i+" type="+o+" applet="+((r=e[o]).applet?r.applet._id:null)+" SMILES="+r.smiles+"\n atomMap="+JSON.stringify(r.atomMap)+"\n data=\n"+r.data+"\n")}return n}},b.__init=function(e){var t=e._viewSet,n=b.applets;n[t]||(n[t]={}),n[t][e._viewType]=e},b.__findView=function(e,t){var n=b.sets[e];null==n&&(n=b.sets[e]=[]);for(var i=n.length;0<=--i;){var r=n[i];if(t.viewID){if(r.info.viewID==t.viewID)return r}else{if(null!=t.chemID&&t.chemID==r.info.chemID)return r;for(var o in r)if("info"!=o&&(null!=t.data&&null!=r[o].data?t.data==r[o].data:t.type==o))return r}}return null},b.__createViewSet=function(e,t,n){for(var i in b.count++,t={info:{chemID:t,viewID:n||"model_"+b.count}},a._applets)(n=a._applets[i])._viewSet==e&&(t[n._viewType]={applet:n,data:null});return b.sets[e].push(t),t},b.__setView=function(e,t,n){for(var i in e)if("info"!=i){var r=e[i],o=r.applet,a=n||null!=o&&"<modified>"==o._molData;if(null!=o&&(o!=t||a)){var s=null==r.data,l=null!=o._currentView;if(o._currentView=e,(!l||!(e[i].data==r.data&&!s&!a))&&(o._loadModelFromView(e),s))break}}}}(a.View),a.Cache={fileCache:{}},a.Cache.get=function(e){return a.Cache.fileCache[e]},a.Cache.put=function(e,t){a.Cache.fileCache[e]=t},a.Cache.setDragDrop=function(r){a.$appEvent(r,"appletdiv","dragover",function(e){(e=e.originalEvent).stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}),a.$appEvent(r,"appletdiv","drop",function(n){var e=n.originalEvent;e.stopPropagation(),e.preventDefault();var i=e.dataTransfer.files[0];if(null==i)try{0!=(i=""+e.dataTransfer.getData("text")).indexOf("file:/")&&0!=i.indexOf("http:/")&&0!=i.indexOf("https:/")||r._scriptLoad(i)}catch(e){}else(e=new FileReader).onloadend=function(e){var t;e.target.readyState==FileReader.DONE&&(t="cache://DROP_"+i.name,e=Clazz.newByteArray(-1,e.target.result),t.endsWith(".spt")||r._appletPanel.cacheFileByName("cache://DROP_*",!1),"JSV"==r._viewType||t.endsWith(".jdx")?a.Cache.put(t,e):r._appletPanel.cachePut(t,e),!(e=a._jsGetXY(r._canvas,n))||r._appletPanel.setStatusDragDropped&&!r._appletPanel.setStatusDragDropped(0,e[0],e[1],t)||r._appletPanel.openFileAsyncSpecial(t,1))},e.readAsArrayBuffer(i)})}}(Jmol,jQuery),Jmol._debugCode=!1,function(u){u._isAsync=!1,u._asyncCallbacks={};function t(e){i?c():(i=!0,LoadClazz(),e._noMonitor&&(Clazz._LoaderProgressMonitor.showStatus=function(){}),LoadClazz=null,e.__Info.uncompressed&&Clazz.loadClass(),Clazz._Loader.onGlobalLoaded=function(){Clazz._LoaderProgressMonitor.showStatus("Application loaded.",!0),u._debugCode&&u.haveCore||(u.haveCore=!0,c())},Clazz._Loader.loadPackageClasspath("java",null,!0,c))}function n(e,t){Clazz._Loader.loadClass(t,function(){c()})}var i=!(u._coreFiles=[]),r=[],o=[],a=0,s=[],l=[],c=function(e){arguments.length||(e=!0),delete a;for(var t,n;0<o.length&&"done"==(t=o[0])[4];)o.shift();0!=o.length&&(u._isAsync||e?(t.push("done"),n="JSmol exec "+t[0]._id+" "+t[3]+" "+t[2],self.System&&System.out.println(n),self.console,r.push(n),t[1](t[0],t[2])):setTimeout(c,10))};u.showExecLog=function(){return r.join("\n")},u._addExec=function(e){e[1]||(e[1]=n);var t="JSmol load "+e[0]._id+" "+e[3];self.console,r.push(t),o.push(e)},u._addCoreFile=function(e,t,n){if(e=e.toLowerCase().split(".")[0],!(0<=s.join("").indexOf(e))){if(s.push(e),s.sort(),u._coreFiles=[t+"/core/core"+s.join("")+".z.js"],n=n&&n.split(" "))for(e=0;e<n.length;e++)l.join("").indexOf(n[e])<0&&l.push(t+"/core/core"+n[e]+".z.js");for(e=0;e<l.length;e++)u._coreFiles.push(l[e])}},u._Canvas2D=function(e,t,n,i){return this._uniqueId=(""+Math.random()).substring(3),this._id=e,this._is2D=!0,this._isJava=!1,this._jmolType="Jmol._Canvas2D ("+n+")",this._isLayered=t._isLayered||!1,this._isSwing=t._isSwing||!1,this._isJSV=t._isJSV||!1,this._isAstex=t._isAstex||!1,this._platform=t._platform||"",i?this:((window[e]=this)._createCanvas(e,t),!u._document||this._deferApplet||this._init(),this)},u._setAppletParams=function(e,t,n,i){for(var r in n)(!e||0<=e.indexOf(";"+r.toLowerCase()+";"))&&(null==n[r]||"language"==r&&!u.featureDetection.supportsLocalization()||(i?t.put(r,!0===n[r]?Boolean.TRUE:!1===n[r]?Boolean.FALSE:n[r]):t[r]=n[r]))},u._jsSetPrototype=function(e){return e._init=function(){this._setupJS(),this._showInfo(!0),this._disableInitialConsole&&this._showInfo(!1)},e._createCanvas=function(e,t,n){u._setObject(this,e,t),n&&(this._GLmol=n,(this._GLmol.applet=this)._GLmol.id=this._id),n=u._getWrapper(this,!0),this._deferApplet||(u._document?(u._documentWrite(n),this._newCanvas(!1),n=""):(this._deferApplet=!0,n+='<script type="text/javascript">'+e+"._cover(false)<\/script>")),n+=u._getWrapper(this,!1),t.addSelectionOptions&&(n+=u._getGrabberOptions(this)),u._debugAlert&&!u._document&&alert(n),this._code=u._documentWrite(n)},e._newCanvas=function(e){this._is2D?this._createCanvas2d(e):this._GLmol.create()},e._getHtml5Canvas=function(){return this._canvas},e._getWidth=function(){return this._canvas.width},e._getHeight=function(){return this._canvas.height},e._getContentLayer=function(){return u.$(this,"contentLayer")[0]},e._repaintNow=function(){u.repaint(this,!1)},e._createCanvas2d=function(){var e=u.$(this,"appletdiv");try{e[0].removeChild(this._canvas),this._canvas.frontLayer&&e[0].removeChild(this._canvas.frontLayer),this._canvas.rearLayer&&e[0].removeChild(this._canvas.rearLayer),this._canvas.contentLayer&&e[0].removeChild(this._canvas.contentLayer),u._jsUnsetMouse(this._mouseInterface)}catch(e){}var t,n=Math.round(e.width()),i=Math.round(e.height()),r=document.createElement("canvas");((r.applet=this)._canvas=r).style.width="100%",r.style.height="100%",r.width=n,r.height=i,r.id=this._id+"_canvas2d",e.append(r),u._$(r.id).css({"z-index":u._getZ(this,"main")}),this._isLayered?(t=document.createElement("div"),(r.contentLayer=t).id=this._id+"_contentLayer",e.append(t),u._$(t.id).css({zIndex:u._getZ(this,"image"),position:"absolute",left:"0px",top:"0px",width:(this._isSwing?n:0)+"px",height:(this._isSwing?i:0)+"px",overflow:"hidden"}),this._isSwing?((e=document.createElement("div")).id=this._id+"_swingdiv",u._$(this._id+"_appletinfotablediv").append(e),u._$(e.id).css({zIndex:u._getZ(this,"rear"),position:"absolute",left:"0px",top:"0px",width:n+"px",height:i+"px",overflow:"hidden"}),this._mouseInterface=r.contentLayer,r.contentLayer.applet=this):this._mouseInterface=this._getLayer("front",e,n,i,!1)):this._mouseInterface=r,u._jsSetMouse(this._mouseInterface)},e._getLayer=function(e,t,n,i,r){var o=document.createElement("canvas");return(this._canvas[e+"Layer"]=o).style.width="100%",o.style.height="100%",o.id=this._id+"_"+e+"Layer",o.width=n,o.height=i,t.append(o),o.applet=this,u._$(o.id).css({background:r?"rgb(0,0,0,1)":"rgb(0,0,0,0.001)","z-index":u._getZ(this,e),position:"absolute",left:"0px",top:"0px",overflow:"hidden"}),o},e._setupJS=function(){window["j2s.lib"]={base:this._j2sPath+"/",alias:".",console:this._console,monitorZIndex:u._getZ(this,"monitorZIndex")},0==o.length&&u._addExec([this,t,null,"loadClazz"]),this._addCoreFiles(),u._addExec([this,this.__startAppletJS,null,"start applet"]),this._isSigned=!0,this._ready=!1,this._applet=null,this._canScript=function(){return!0},this._savedOrientations=[],a&&clearTimeout(a),a=setTimeout(c,100)},e.__startAppletJS=function(e){0==u._version.indexOf("$Date: ")&&(u._version=(u._version.substring(7)+" -").split(" -")[0]+" (JSmol/j2s)");var t=Clazz._4Name("java.util.Hashtable").newInstance();u._setAppletParams(e._availableParams,t,e.__Info,!0),t.put("appletReadyCallback","Jmol._readyCallback"),t.put("applet",!0),t.put("name",e._id),t.put("syncId",u._syncId),u._isAsync&&t.put("async",!0),e._color&&t.put("bgcolor",e._color),e._startupScript&&t.put("script",e._startupScript),u._syncedApplets.length&&t.put("synccallback","Jmol._mySyncCallback"),t.put("signedApplet","true"),t.put("platform",e._platform),e._is2D&&t.put("display",e._id+"_canvas2d"),t.put("documentBase",document.location.href);var n,i=e._j2sPath+"/";i.indexOf("://")<0&&(n=document.location.href.split("#")[0].split("?")[0].split("/"),0==i.indexOf("/")?n=[n[0],i.substring(1)]:n[n.length-1]=i,i=n.join("/")),t.put("codePath",i),u._registerApplet(e._id,e);try{e._newApplet(t)}catch(e){return void System.out.println((u._isAsync?"normal async abort from ":"")+e)}e._jsSetScreenDimensions(),c()},e._restoreState||(e._restoreState=function(){}),e._jsSetScreenDimensions=function(){var e;this._appletPanel&&(e=u._getElement(this,this._is2D?"canvas2d":"canvas"),this._appletPanel.setScreenDimension(e.width,e.height))},e._show=function(e){u.$setVisible(u.$(this,"appletdiv"),e),e&&u.repaint(this,!0)},e._canScript=function(){return!0},e.equals=function(e){return this==e},e.clone=function(){return this},e.hashCode=function(){return parseInt(this._uniqueId)},e._processGesture=function(e){return this._appletPanel.processTwoPointGesture(e)},e._processEvent=function(e,t){this._appletPanel.processMouseEvent(e,t[0],t[1],t[2],System.currentTimeMillis())},e._resize=function(){var e="__resizeTimeout_"+this._id;u[e]&&clearTimeout(u[e]);var t=this;u[e]=setTimeout(function(){u.repaint(t,!0),u[e]=null},100)},e},u.repaint=function(e,t){var n,i;e&&e._appletPanel&&(i=u.$(e,"appletdiv"),n=Math.round(i.width()),i=Math.round(i.height()),!e._is2D||e._canvas.width==n&&e._canvas.height==i||(e._newCanvas(!0),e._appletPanel.setDisplay(e._canvas)),e._appletPanel.setScreenDimension(n,i),n=function(){e._appletPanel.paint?e._appletPanel.paint(null):e._appletPanel.update(null)},t?requestAnimationFrame(n):n())},u.loadImage=function(e,t,n,i,r,o){var a="echo_"+t+n+(i?"_"+i.length:""),s=u.getHiddenCanvas(e.vwr.html5Applet,a,0,0,!1,!0);if(null==s){if(null==o){if(o=new Image,null==i)return o.onload=function(){u.loadImage(e,t,n,null,r,o)},o.src=n,null;System.out.println("Jsmol.js Jmol.loadImage using data URI for "+a),o.src="string"==typeof i?i:"data:"+JU.Rdr.guessMimeTypeForBytes(i)+";base64,"+JU.Base64.getBase64(i)}var l=o.width,c=o.height;"webgl"==t&&(l/=2,c/=2),(s=u.getHiddenCanvas(e.vwr.html5Applet,a,l,c,!0,!1)).imageWidth=l,s.imageHeight=c,s.id=a,s.image=o,u.setCanvasImage(s,l,c)}else System.out.println("Jsmol.js Jmol.loadImage reading cached image for "+a);return null==i?r(s,n):s},u._canvasCache={},u.getHiddenCanvas=function(e,t,n,i,r,o){return t=e._id+"_"+t,e=u._canvasCache[t],o||!r&&e&&e.width==n&&e.height==i||((e=document.createElement("canvas")).width=e.style.width=n,e.height=e.style.height=i,e.id=t,u._canvasCache[t]=e),e},u.setCanvasImage=function(e,t,n){e.buf32=null,e.width=t,e.height=n,e.getContext("2d").drawImage(e.image,0,0,e.image.width,e.image.height,0,0,t,n)},u.applyFunc=function(e,t){return e(t)}}(Jmol),function(l,c){l._Applet=function(e,r,t){return(window[e]=this)._jmolType="Jmol._Applet"+(r.isSigned?" (signed)":""),this._viewType="Jmol",this._isJava=!0,this._syncKeyword="Select:",this._availableParams=";progressbar;progresscolor;boxbgcolor;boxfgcolor;allowjavascript;boxmessage;\t\t\t\t\t\t\t\t\t;messagecallback;pickcallback;animframecallback;appletreadycallback;atommovedcallback;\t\t\t\t\t\t\t\t\t;echocallback;evalcallback;hovercallback;language;loadstructcallback;measurecallback;\t\t\t\t\t\t\t\t\t;minimizationcallback;resizecallback;scriptcallback;statusform;statustext;statustextarea;\t\t\t\t\t\t\t\t\t;synccallback;usecommandthread;syncid;appletid;startupscript;menufile;",t||(this._isSigned=r.isSigned,this._readyFunction=r.readyFunction,this._ready=!1,this._isJava=!0,this._isInfoVisible=!1,this._applet=null,this._memoryLimit=r.memoryLimit||512,this._canScript=function(){return!0},this._savedOrientations=[],this._initialize=function(e,t){var n,i=!1;l._jarFile&&(t=l._jarFile),this._jarFile&&(0<=(n=this._jarFile).indexOf("/")?(alert("This web page URL is requesting that the applet used be "+n+". This is a possible security risk, particularly if the applet is signed, because signed applets can read and write files on your local machine or network."),"yes"==prompt("Do you want to use applet "+n+"? ","yes or no")?(e=n.substring(0,n.lastIndexOf("/")),t=n.substring(n.lastIndexOf("/")+1)):i=!0):t=n,this_isSigned=r.isSigned=0<=t.indexOf("Signed")),this._jarPath=r.jarPath=e||".",this._jarFile=r.jarFile="string"==typeof t?t:(t?"JmolAppletSigned":"JmolApplet")+"0.jar",i&&alert("The web page URL was ignored. Continuing using "+this._jarFile+' in directory "'+this._jarPath+'"'),null==l.controls||l.controls._onloadResetForms()},this._create(e,r)),this};var u=l._Applet,t=l._Applet.prototype;u._get=function(e,t,n){n=n||!1,t=t||{},l._addDefaultInfo(t,{color:"#FFFFFF",width:300,height:300,addSelectionOptions:!1,serverURL:"http://your.server.here/jsmol.php",defaultModel:"",script:null,src:null,readyFunction:null,use:"HTML5",jarPath:"java",jarFile:"JmolApplet0.jar",isSigned:!1,j2sPath:"j2s",coverImage:null,makeLiveImage:null,coverTitle:"",coverCommand:"",deferApplet:!1,deferUncover:!1,disableJ2SLoadMonitor:!1,disableInitialConsole:!0,debug:!1}),l._debugAlert=t.debug,t.serverURL&&(l._serverUrl=t.serverURL);for(var i=!1,r=null,o=t.use.toUpperCase().split("#")[0].split(" "),a=0;a<o.length;a++){switch(o[a]){case"JAVA":i=!0,l.featureDetection.supportsJava()&&(r=new u(e,t,n));break;case"WEBGL":r=u._getCanvas(e,t,n,!0);break;case"HTML5":l.featureDetection.allowHTML5?r=u._getCanvas(e,t,n,!1):o.push("JAVA")}if(null!=r)break}return null==r&&(n||!i?r={_jmolType:"none"}:i&&(r=new u(e,t))),n?r:l._registerApplet(e,r)},u._getCanvas=function(e,t,n,i){return t._isLayered=!1,t._platform="J.awtjs2d.Platform",i&&l.featureDetection.supportsWebGL()?(l._Canvas3D.prototype=l.GLmol.extendApplet(l._jsSetPrototype(new u(e,t,!0))),new l._Canvas3D(e,t,"Jmol",n)):i?null:(l._Canvas2D.prototype=l._jsSetPrototype(new u(e,t,!0)),new l._Canvas2D(e,t,"Jmol",n))},u._noJavaMsg="Either you do not have Java applets enabled in your web<br />browser or your browser is blocking this applet.<br />\t\t\tCheck the warning message from your browser and/or enable Java applets in<br />\t\t\tyour web browser preferences, or install the Java Runtime Environment from <a href='http://www.java.com'>www.java.com</a>",u._setCommonMethods=function(e){e._showInfo=t._showInfo,e._search=t._search,e._getName=t._getName,e._readyCallback=t._readyCallback},u._createApplet=function(e,t,n){e._initialize(t.jarPath,t.jarFile);var i=e._jarFile;l._isFile&&(i=i.replace(/0\.jar/,".jar"));var r=' style="width:'+(r=0<=e._containerWidth.indexOf("px")?e._containerWidth:"100%")+";height:"+(o=0<=e._containerHeight.indexOf("px")?e._containerHeight:"100%")+'" ',o="name='"+e._id+"_object' id='"+e._id+"_object' \n"+r+"\n";n.codebase=e._jarPath,n.codePath=n.codebase+"/",n.codePath.indexOf("://")<0&&((s=c.location.href.split("#")[0].split("?")[0].split("/"))[s.length-1]=n.codePath,n.codePath=s.join("/")),n.archive=i,n.mayscript="true",n.java_arguments="-Xmx"+Math.round(t.memoryLimit||e._memoryLimit)+"m",n.permissions=e._isSigned?"all-permissions":"sandbox",n.documentLocation=c.location.href,n.documentBase=c.location.href.split("#")[0].split("?")[0],n.jarPath=t.jarPath,l._syncedApplets.length&&(n.synccallback="Jmol._mySyncCallback"),e._startupScript&&(n.script=e._startupScript);var a,s="\n";for(a in n)n[a]&&(s+="  <param name='"+a+"' value='"+n[a]+"' />\n");s=l.featureDetection.useIEObject||l.featureDetection.useHtml4Object?"<object "+o+(l.featureDetection.useIEObject?" classid='clsid:8AD9C840-044E-11D1-B3E9-00805F499D93' codebase='http://java.sun.com/update/1.6.0/jinstall-6u22-windows-i586.cab'>":" type='application/x-java-applet'>")+s+"<p style='background-color:yellow;"+r.split('"')[1]+";text-align:center;vertical-align:middle;'>\n"+u._noJavaMsg+"</p></object>\n":"<applet "+o+" code='"+n.code+"' codebase='"+e._jarPath+"' archive='"+i+"' mayscript='true'>\n"+s+"<table bgcolor='yellow'><tr><td align='center' valign='middle' "+r+">\n"+u._noJavaMsg+"</td></tr></table></applet>\n",e._deferApplet&&(e._javaCode=s,s=""),s=l._getWrapper(e,!0)+s+l._getWrapper(e,!1)+(t.addSelectionOptions?l._getGrabberOptions(e):""),l._debugAlert&&alert(s),e._code=l._documentWrite(s)},t._newApplet=function(e){return this._is2D||e.put("script",(e.get("script")||"")+";set multipleBondSpacing 0.35;"),this._viewerOptions=e,new J.appletjs.Jmol(e)},t._addCoreFiles=function(){l._addCoreFile("jmol",this._j2sPath,this.__Info.preloadCore),this._is2D||l._addExec([this,null,"J.export.JSExporter","load JSExporter"]),l._debugCode&&l._addExec([this,null,"J.appletjs.Jmol","load Jmol"])},t._create=function(e,t){l._setObject(this,e,t);var n,i={syncId:l._syncId,progressbar:"true",progresscolor:"blue",boxbgcolor:this._color||"black",boxfgcolor:"white",boxmessage:"Downloading JmolApplet ...",script:this._color?'background "'+this._color+'"':"",code:"JmolApplet.class"};l._setAppletParams(this._availableParams,i,t),t.inlineModel?(n=(n=t.inlineModel).replace(/\r|\n|\r\n/g,0<=n.indexOf("|")?"\\/n":"|").replace(/'/g,"&#39;"),l._debugAlert&&alert("inline model:\n"+n)):n="",i.loadInline=n,i.appletReadyCallback="Jmol._readyCallback",l._syncedApplets.length&&(i.synccallback="Jmol._mySyncCallback"),i.java_arguments="-Xmx"+Math.round(t.memoryLimit||this._memoryLimit)+"m",this._initialize(t.jarPath,t.jarFile),u._createApplet(this,t,i)},t._restoreState=function(e,t){System.out.println("\n\nasynchronous restore state for "+e+" "+t);var n=this,i=n._applet&&n._applet.viewer;switch(t){case"setOptions":return function(){n.__startAppletJS(n)};case"render":return function(){setTimeout(function(){i.refresh(2)},10)};default:switch(e){case"J.shape.Balls":case"J.shape.Sticks":case"J.shape.Frank":return null}if(i&&i.isScriptExecuting&&i.isScriptExecuting()){if(l._asyncCallbacks[e])return System.out.println("...ignored"),1;var r=i.getEvalContextAndHoldQueue(i.eval),o=r.pc-1;return r.asyncID=e,l._asyncCallbacks[e]=function(e){r.pc=e,System.out.println("sc.asyncID="+r.asyncID+" sc.pc = "+r.pc),i.eval.resumeEval(r)},i.eval.pc=i.eval.pcEnd,System.out.println("setting resume for pc="+r.pc+" "+e+" to "+l._asyncCallbacks[e]+"//"),function(){System.out.println("resuming "+e+" "+l._asyncCallbacks[e]),l._asyncCallbacks[e](o)}}return System.out.println(e+"?????????????????????"+t),function(){setTimeout(function(){i.refresh(2)},10)}}},t._notifyAudioEnded=function(e){this._applet.notifyAudioEnded(e)},t._readyCallback=function(e,t,n){n&&(l._setDestroy(this),this._ready=!0,e=this._readyScript,this._defaultModel?l._search(this,this._defaultModel,e?";"+e:""):e?this._script(e):this._src&&this._script('load "'+this._src+'"'),this._showInfo(!0),this._showInfo(!1),l.Cache.setDragDrop(this),this._readyFunction&&this._readyFunction(this),l._setReady(this),(e=this._2dapplet)&&e._isEmbedded&&e._ready&&e.__Info.visible&&(this._show2d(!0),this._show2d(!1),this._show2d(!0)),l._hideLoadingSpinner(this))},t._showInfo=function(e){var t;e&&this._2dapplet&&this._2dapplet._show(!1),l.$html(l.$(this,"infoheaderspan"),this._infoHeader),this._info&&l.$html(l.$(this,"infodiv"),this._info),!this._isInfoVisible!=!e&&(this._isInfoVisible=e,this._isJava&&(t=e?2:"100%",l.$setSize(l.$(this,"appletdiv"),t,t)),l.$setVisible(l.$(this,"infotablediv"),e),l.$setVisible(l.$(this,"infoheaderdiv"),e),this._show(!e))},t._show2d=function(e){this._2dapplet._show2d(e),this._2dapplet._isEmbedded&&(this._showInfo(!1),this._show(!e),this._2dapplet.__showContainer(!0,!0))},t._getSpinner=function(){return this.__Info.appletLoadingImage||this._j2sPath+"/img/JSmol_spinner.gif"},t._getAtomCorrelation=function(e,t){var n=this._evaluate("{*}.count");if(0!=n){this._loadMolData(e,"atommap = compare({1.1} {2.1} 'MAP' "+(t?"":"'H'")+"); zap 2.1",!0);for(var i=this._evaluate("atommap"),r=[],o=[],a=0;a<i.length;a++){var s=i[a];r[s[0]+1]=s[1]-n+1,o[s[1]-n+1]=s[0]+1}return{fromJmol:r,toJmol:o}}},t._show=function(e){var t=e?"100%":2;l.$setSize(l.$(this,"object"),t,t),this._isJava||l.$setVisible(l.$(this,"appletdiv"),e)},t._clearConsole=function(){this._console==this._id+"_infodiv"&&(this.info=""),self.Clazz&&(l._setConsoleDiv(this._console),Clazz.Console.clear())},t._addScript=function(e){return this._readyScript||(this.readyScript=""),this._readyScript&&(this._readyScript+=";"),this._readyScript+=e,!0},t._script=function(e){if(!this._ready)return this._addScript(e);l._setConsoleDiv(this._console),l._hideLocalFileReader(this),this._applet.script(e)},t._syncScript=function(e){this._applet.syncScript(e)},t._scriptCheck=function(e){return this._ready&&this._applet.scriptCheck(e)},t._scriptWait=function(e,t){var n=this._scriptWaitAsArray(e),i="";if(!t)for(var r=n.length;0<=--r;)for(var o=0,a=n[r].length;o<a;o++)i+=n[r][o]+"\n";return i},t._scriptEcho=function(e){for(var t="",n=(e=this._scriptWaitAsArray(e)).length;0<=--n;)for(var i=e[n].length;0<=--i;)"scriptEcho"==e[n][i][1]&&(t+=e[n][i][3]+"\n");return t.replace(/ \| /g,"\n")},t._scriptMessage=function(e){for(var t="",n=(e=this._scriptWaitAsArray(e)).length;0<=--n;)for(var i=e[n].length;0<=--i;)"scriptStatus"==e[n][i][1]&&(t+=e[n][i][3]+"\n");return t.replace(/ \| /g,"\n")},t._scriptWaitOutput=function(e){var t="";try{e&&(t+=this._applet.scriptWaitOutput(e))}catch(e){}return t},t._scriptWaitAsArray=function(e){var t="";try{if(this._getStatus("scriptEcho,scriptMessage,scriptStatus,scriptError"),e&&(t+=this._applet.scriptWait(e),"object"==typeof(t=l._evalJSON(t,"jmolStatus"))))return t}catch(e){}return[[t]]},t._getStatus=function(e){return l._sortMessages(this._getPropertyAsArray("jmolStatus",e))},t._getPropertyAsArray=function(e,t){return l._evalJSON(this._getPropertyAsJSON(e,t),e)},t._getPropertyAsString=function(e,t){return null==t&&(t=""),this._applet.getPropertyAsString(e,t)+""},t._getPropertyAsJSON=function(e,t){null==t&&(t="");try{return this._applet.getPropertyAsJSON(e,t)+""}catch(e){return""}},t._getPropertyAsJavaObject=function(e,t){return null==t&&(t=""),this._applet.getProperty(e,t)},t._evaluate=function(e){return null!=e||(e=""),this._getPropertyAsArray("variableInfo",e)},t._evaluateDEPRECATED=function(e){var t=(e=""+this._getPropertyAsJavaObject("evaluate",e)).replace(/\-*\d+/,"");return""!=t||isNaN(parseInt(e))?""!=(t=e.replace(/\-*\d*\.\d*/,""))||isNaN(parseFloat(e))?e:parseFloat(e):parseInt(e)},t._saveOrientation=function(e){return this._savedOrientations[e]=this._getPropertyAsArray("orientationInfo","info").moveTo},t._restoreOrientation=function(e){return(e=this._savedOrientations[e])&&""!=e?this._scriptWait(e):e.replace(/1\.0/,"0")},t._restoreOrientationDelayed=function(e,t){arguments.length<1&&(t=1);var n=this._savedOrientations[e];return n&&""!=n?this._scriptWait(n):n.replace(/1\.0/,t)},t._resizeApplet=function(e){function t(e,t){var n=""+e;return 0==n.length?t?"":l._allowedJmolSize[2]:n.indexOf("%")==n.length-1?n:(e=parseFloat(e))<=1&&0<e?100*e+"%":(isNaN(e=Math.floor(e))?l._allowedJmolSize[2]:e<l._allowedJmolSize[0]?l._allowedJmolSize[0]:e>l._allowedJmolSize[1]?l._allowedJmolSize[1]:e)+(t||"")}var n;"object"==typeof e&&null!=e?(n=e[0]||e.width,e=e[1]||e.height):n=e,n=[t(n,"px"),t(e,"px")],(e=l._getElement(this,"appletinfotablediv")).style.width=n[0],e.style.height=n[1],this._containerWidth=n[0],this._containerHeight=n[1],this._is2D&&l.repaint(this,!0)},t._search=function(e,t){l._search(this,e,t)},t._searchDatabase=function(e,t,n){if(this._2dapplet&&this._2dapplet._isEmbedded&&!l.$(this,"appletdiv:visible")[0])return this._2dapplet._searchDatabase(e,t,n);this._showInfo(!1),0<=e.indexOf("?")?l._getInfoFromDatabase(this,t,e.split("?")[0]):(n=n||l._getScriptForDatabase(t),e=t+e,this._currentView=null,this._searchQuery=e,this._loadFile(e,n,e))},t._loadFile=function(e,t,n){var i;this._showInfo(!1),t=t||"",this._thisJmolModel=""+Math.random(),this._fileName=e,this._scriptLoad(e,t)||(i=this,l._loadFileData(this,e,function(e){i.__loadModel(e,t,n)},function(){i.__loadModel(null)}))},t._scriptLoad=function(e,t){t=t||"";var n=this._isJava||!this._noscript;return n&&this._script("zap;set echo middle center;echo Retrieving data..."),!(!this._isSigned||null!=this._viewSet)&&(n?this._script('load async "'+e+'";'+t):this._applet.openFile(e),this._checkDeferred(""),!0)},t.__loadModel=function(e,t,n){null!=e&&(null!=this._viewSet&&(t=t||"",t+=";if ({*}.molecule.max > 1 || {*}.modelindex.max > 0){ delete molecule > 1 or modelindex > 0;x = getProperty('extractModel',{*});load inline @x};"),!t&&this._noscript?this._applet.loadInlineString(e,"",!1):this._loadMolData(e,t,!1),null!=this._viewSet&&l.View.updateView(this,{chemID:n,data:e}))},t._loadMolData=function(e,t,n){t=t||"",n=n?"append":"model",this._applet.scriptWait('load DATA "'+n+'"'+e+'\nEND "'+n+'" ;'+t)},t._loadModelFromView=function(e){var t=(this._currentView=e).Jmol;null!=t.data?this.__loadModel(t.data,null,e.info.chemID):null!=e.info.chemID?l._searchMol(this,e.info.chemID,null,!1):(t=e.JME)&&t.applet._show2d(!1,this)},t._reset=function(){this._scriptWait("zap",!0)},t._updateView=function(){null!=this._viewSet&&this._applet&&(chemID=""+this._getPropertyAsJavaObject("variableInfo","script('show chemical inchiKey')"),chemID=chemID.length<36?null:chemID.substring(36).split("\n")[0],l.View.updateView(this,{chemID:chemID,data:""+this._getPropertyAsJavaObject("evaluate","extractModel","{visible}")}))},t._atomPickedCallback=function(e,t){var n;t<0||(n=[t+1],l.View.updateAtomPick(this,n),this._updateAtomPick(n))},t._updateAtomPick=function(e){this._script(0==e.length?"select none":"select on visible and (@"+e.join(",@")+")")},t._isDeferred=function(){return!this._canvas&&this._cover&&this._isCovered&&this._deferApplet},t._checkDeferred=function(e){return!!this._isDeferred()&&(this._coverScript=e,this._cover(!1),!0)},t._cover=function(e){e||!this._deferApplet?this._displayCoverImage(e):(e=this._coverScript?this._coverScript:"",this._coverScript="",this._deferUncover&&(e+=";refresh;javascript "+this._id+"._displayCoverImage(false)"),this._script(e,!0),this._deferUncover&&"activate 3D model"==this._coverTitle&&(l._getElement(this,"coverimage").title="3D model is loading..."),this._isJava||this._newCanvas(!1),this._defaultModel&&l._search(this,this._defaultModel),this._showInfo(!1),this._deferUncover||this._displayCoverImage(!1),this._isJava&&l.$html(l.$(this,"appletdiv"),this._javaCode),this._init&&this._init())},t._displayCoverImage=function(e){this._coverImage&&this._isCovered!=e&&(this._isCovered=e,l._getElement(this,"coverdiv").style.display=e?"block":"none")},t._getSmiles=function(){return this._evaluate("{visible}.find('SMILES')")},t._getMol=function(){return this._evaluate("getProperty('ExtractModel',{visible})")},t._getMol2D=function(){return this._evaluate("script('select visible;show chemical sdf')")},l.jmolSmiles=function(e){return e._getSmiles()}}(Jmol,document),function(f){var d=f.controls={_hasResetForms:!1,_scripts:[""],_checkboxMasters:{},_checkboxItems:{},_actions:{},_buttonCount:0,_checkboxCount:0,_radioGroupCount:0,_radioCount:0,_linkCount:0,_cmdCount:0,_menuCount:0,_previousOnloadHandler:null,_control:null,_element:null,_appletCssClass:null,_appletCssText:"",_buttonCssClass:null,_buttonCssText:"",_checkboxCssClass:null,_checkboxCssText:"",_radioCssClass:null,_radioCssText:"",_linkCssClass:null,_linkCssText:"",_menuCssClass:null,_menuCssText:""};d._addScript=function(e,t){var n=d._scripts.length;return d._scripts[n]=[e,t],n},d._getIdForControl=function(e,t){return"string"==typeof e?e:t&&e._canScript&&!e._canScript(t)?null:e._id},d._radio=function(e,t,n,i,r,o,a,s){var l=d._getIdForControl(e,t);return null==l?null:(++d._radioCount,null!=o&&null!=o||(o="jmolRadioGroup"+(d._radioGroupCount-1)),t?(null!=a&&null!=a||(a="jmolRadio"+(d._radioCount-1)),null!=n&&null!=n||(n=t.substring(0,32)),r=r||"",e="</span>",d._actions[a]=d._addScript(l,t),t='<span id="span_'+a+'"'+(s?' title="'+s+'"':"")+"><input name='"+o+"' id='"+a+"' type='radio' onclick='Jmol.controls._click(this);return true;' onmouseover='Jmol.controls._mouseOver(this);return true;' onmouseout='Jmol.controls._mouseOut()' "+(i?"checked='true' ":"")+d._radioCssText+" />",0<=n.toLowerCase().indexOf("<td>")&&(t+=e,e=""),t+'<label for="'+a+'">'+n+"</label>"+e+r):"")},d._scriptExecute=function(e,t){var n=f._applets[t[0]],i=t[1];"object"==typeof i?i[0](e,i,n):"function"==typeof i?i(n):f.script(n,i)},d.__checkScript=function(e,t){var n=0<=t.value.indexOf("JSCONSOLE ")||""===e._scriptCheck(t.value);return t.style.color=n?"black":"red",n},d.__getCmd=function(e,t){var n;t._cmds&&t._cmds.length&&(n=t._cmds[t._cmdpt=(t._cmdpt+t._cmds.length+e)%t._cmds.length],setTimeout(function(){t.value=n},10),t._cmdadd=1,t._cmddir=e)},d._commandKeyPress=function(e,t,n){e=13==e?13:window.event?window.event.keyCode:e?e.keyCode||e.which:0;var i=document.getElementById(t),r=f._applets[n];switch(e){case 13:return t=i.value,d._scriptExecute(i,[n,t]),i._cmds||(i._cmds=[],i._cmddir=0,i._cmdpt=-1,i._cmdadd=0),t&&0==i._cmdadd?(++i._cmdpt,i._cmds.splice(i._cmdpt,0,t),i._cmdadd=0,i._cmddir=0):i._cmdadd=0,i.value="",!1;case 27:return setTimeout(function(){i.value=""},20),!1;case 38:d.__getCmd(-1,i);break;case 40:d.__getCmd(1,i);break;default:i._cmdadd=0}return setTimeout(function(){d.__checkScript(r,i)},20),!0},d._click=function(e,t){d._element=e,1==arguments.length&&(t=d._actions[e.id]),d._scriptExecute(e,d._scripts[t])},d._menuSelected=function(e){var t=e.value;if(null!=t)d._scriptExecute(e,d._scripts[t]);else{if("number"==typeof(t=e.length))for(var n=0;n<t;++n)if(e[n].selected)return void d._click(e[n],e[n].value);alert("?Que? menu selected bug #8734")}},d._cbNotifyMaster=function(e){var t,n,i=!0,r=!0,o=!1;for(n in e.chkGroup)(t=e.chkGroup[n]).checked?r=!1:i=!1,t.indeterminate&&(o=!0);t=e.chkMaster,i?t.checked=!0:r?t.checked=!1:o=!0,t.indeterminate=o,(e=d._checkboxItems[t.id])&&(t=e.chkMaster)&&d._cbNotifyMaster(d._checkboxMasters[t.id])},d._cbNotifyGroup=function(e,t){for(var n in e.chkGroup){var i=e.chkGroup[n];i.checked!=t&&(i.checked=t,d._cbClick(i)),d._checkboxMasters[i.id]&&d._cbNotifyGroup(d._checkboxMasters[i.id],t)}},d._cbSetCheckboxGroup=function(e,t,n){var i=e;"number"==typeof i&&(i="jmolCheckbox"+i),(e=document.getElementById(i))||alert("jmolSetCheckboxGroup: master checkbox not found: "+i);var r=d._checkboxMasters[i]={};for(r.chkMaster=e,r.chkGroup={},e=i="string"==typeof t?(t=n,1):0;e<t.length;e++)"number"==typeof(i=t[e])&&(i="jmolCheckbox"+i),(n=document.getElementById(i))||alert("jmolSetCheckboxGroup: group checkbox not found: "+i),r.chkGroup[i]=n,d._checkboxItems[i]=r},d._cbClick=function(e){d._control=e;var t=d._actions[e.id][0],n=d._actions[e.id][1];d._click(e,e.checked?t:n),d._checkboxMasters[e.id]&&d._cbNotifyGroup(d._checkboxMasters[e.id],e.checked),d._checkboxItems[e.id]&&d._cbNotifyMaster(d._checkboxItems[e.id])},d._cbOver=function(e){var t=d._actions[e.id][0],n=d._actions[e.id][1];window.status=d._scripts[e.checked?n:t]},d._mouseOver=function(e,t){1==arguments.length&&(t=d._actions[e.id]),window.status=d._scripts[t]},d._mouseOut=function(){return window.status=" ",!0},d._onloadResetForms=function(){d._hasResetForms||(d._hasResetForms=!0,d._previousOnloadHandler=window.onload,window.onload=function(){if(0<d._buttonCount+d._checkboxCount+d._menuCount+d._radioCount+d._radioGroupCount)for(var e=document.forms,t=e.length;0<=--t;)e[t].reset();d._previousOnloadHandler&&d._previousOnloadHandler()})},d._getButton=function(e,t,n,i,r){return null==(e=d._getIdForControl(e,t))?"":(null!=i&&null!=i||(i="jmolButton"+d._buttonCount),null!=n&&null!=n||(n=t.substring(0,32)),++d._buttonCount,d._actions[i]=d._addScript(e,t),t='<span id="span_'+i+'"'+(r?' title="'+r+'"':"")+"><input type='button' name='"+i+"' id='"+i+"' value='"+n+"' onclick='Jmol.controls._click(this)' onmouseover='Jmol.controls._mouseOver(this);return true' onmouseout='Jmol.controls._mouseOut()' "+d._buttonCssText+" /></span>",f._debugAlert&&alert(t),f._documentWrite(t))},d._getCheckbox=function(e,t,n,i,r,o,a){var s=d._getIdForControl(e,t);if(null!=s&&(s=d._getIdForControl(e,n)),null==s)return"";if(null!=o&&null!=o||(o="jmolCheckbox"+d._checkboxCount),++d._checkboxCount,null==t||null==t||null==n||null==n)alert("jmolCheckbox requires two scripts");else{if(null!=i&&null!=i)return d._actions[o]=[d._addScript(s,t),d._addScript(s,n)],e="</span>",r='<span id="span_'+o+'"'+(a?' title="'+a+'"':"")+"><input type='checkbox' name='"+o+"' id='"+o+"' onclick='Jmol.controls._cbClick(this)' onmouseover='Jmol.controls._cbOver(this);return true' onmouseout='Jmol.controls._mouseOut()' "+(r?"checked='true' ":"")+d._checkboxCssText+" />",0<=i.toLowerCase().indexOf("<td>")&&(r+=e,e=""),r+='<label for="'+o+'">'+i+"</label>"+e,f._debugAlert&&alert(r),f._documentWrite(r);alert("jmolCheckbox requires a label")}},d._getCommandInput=function(e,t,n,i,r,o){return null==(e=d._getIdForControl(e,"x"))?"":(null!=i&&null!=i||(i="jmolCmd"+d._cmdCount),null!=t&&null!=t||(t="Execute"),null!=n&&!isNaN(n)||(n=60),null!=o||(o="help"),++d._cmdCount,t='<span id="span_'+i+'"'+(r?' title="'+r+'"':"")+"><input name='"+i+"' id='"+i+"' size='"+n+"' onkeydown='return Jmol.controls._commandKeyPress(event,\""+i+'","'+e+"\")' value='"+o+"'/><input  type='button' name='"+i+"Btn' id='"+i+"Btn' value = '"+t+"' onclick='Jmol.controls._commandKeyPress(13,\""+i+'","'+e+"\")' /></span>",f._debugAlert&&alert(t),f._documentWrite(t))},d._getLink=function(e,t,n,i,r){return null==(e=d._getIdForControl(e,t))?"":(null!=i&&null!=i||(i="jmolLink"+d._linkCount),null!=n&&null!=n||(n=t.substring(0,32)),++d._linkCount,n='<span id="span_'+i+'"'+(r?' title="'+r+'"':"")+"><a name='"+i+"' id='"+i+"' href='javascript:Jmol.controls._click(null,"+(t=d._addScript(e,t))+");' onmouseover='Jmol.controls._mouseOver(null,"+t+");return true;' onmouseout='Jmol.controls._mouseOut()' "+d._linkCssText+">"+n+"</a></span>",f._debugAlert&&alert(n),f._documentWrite(n))},d._getMenu=function(e,t,n,i,r){var o=d._getIdForControl(e,null);if(null!=i&&null!=i||(i="jmolMenu"+d._menuCount),++d._menuCount,null!=(o=typeof t)&&"object"==o&&t.length){var a=t.length;for("number"!=typeof n||1==n?n=null:n<0&&(n=a),n='<span id="span_'+i+'"'+(r?' title="'+r+'"':"")+"><select name='"+i+"' id='"+i+"' onChange='Jmol.controls._menuSelected(this)'"+(n?" size='"+n+"' ":"")+d._menuCssText+">",i=0;i<a;++i){var s=t[i],l=null,c=r=null;if("object"==(o=typeof s)&&null!=s?(l=s[0],r=s[1],c=s[2]):l=r=s,null==(o=d._getIdForControl(e,l)))return"";null==r&&(r=l),"#optgroup"==l?n+="<optgroup label='"+r+"'>":"#optgroupEnd"==l?n+="</optgroup>":n+="<option value='"+(o=d._addScript(o,l))+(c?"' selected='true'>":"'>")+r+"</option>"}return n+="</select></span>",f._debugAlert&&alert(n),f._documentWrite(n)}},d._getRadio=function(e,t,n,i,r,o,a,s){return 0==d._radioGroupCount&&++d._radioGroupCount,o=o||"jmolRadioGroup"+(d._radioGroupCount-1),null==(e=d._radio(e,t,n,i,r,o,a||o+"_"+d._radioCount,s||0))?"":(f._debugAlert&&alert(e),f._documentWrite(e))},d._getRadioGroup=function(e,t,n,i,r,o){if("object"==(c=typeof t)&&null!=c&&t.length){null!=n&&null!=n||(n="&#xa0; ");var a=t.length;++d._radioGroupCount,i=i||"jmolRadioGroup"+(d._radioGroupCount-1);for(var s="<span id='"+(r||i)+"'>",l=0;l<a;++l){l==a-1&&(n="");var c,u=t[l],h=null,s="object"==(c=typeof u)?s+(h=d._radio(e,u[0],u[1],u[2],n,i,3<u.length?u[3]:(r||i)+"_"+l,4<u.length?u[4]:0,o)):s+(h=d._radio(e,u,null,null,n,i,(r||i)+"_"+l,o));if(null==h)return""}return s+="</span>",f._debugAlert&&alert(s),f._documentWrite(s)}alert("invalid arrayOfRadioButtons")}}(Jmol),function(l){function e(e){return e="&"+e+"=",decodeURI(("&"+document.location.search.substring(1)+e).split(e)[1].split("&")[0])}l._j2sPath=e("_J2S"),l._jarFile=e("_JAR"),l._use=e("_USE"),l.getVersion=function(){return l._jmolInfo.version},l.getApplet=function(e,t,n){return l._Applet._get(e,t,n)},l.getJMEApplet=function(e,t,n,i){return l._JMEApplet._get(e,t,n,i)},l.getJSVApplet=function(e,t,n){return l._JSVApplet._get(e,t,n)},l.loadFile=function(e,t,n){e._loadFile(t,n)},l.script=function(e,t){e._checkDeferred(t)||e._script(t)},l.scriptCheck=function(e,t){return e&&e._scriptCheck&&e._ready&&e._scriptCheck(t)},l.scriptWait=function(e,t){return e._scriptWait(t)},l.scriptEcho=function(e,t){return e._scriptEcho(t)},l.scriptMessage=function(e,t){return e._scriptMessage(t)},l.scriptWaitOutput=function(e,t){return e._scriptWait(t)},l.scriptWaitAsArray=function(e,t){return e._scriptWaitAsArray(t)},l.search=function(e,t,n){e._search(t,n)},l.evaluateVar=function(e,t){return e._evaluate(t)},l.evaluate=function(e,t){return e._evaluateDEPRECATED(t)},l.getAppletHtml=function(e,t){var n;return t&&(n=l._document,l._document=null,e=l.getApplet(e,t),l._document=n),e._code},l.getPropertyAsArray=function(e,t,n){return e._getPropertyAsArray(t,n)},l.getPropertyAsJavaObject=function(e,t,n){return e._getPropertyAsJavaObject(t,n)},l.getPropertyAsJSON=function(e,t,n){return e._getPropertyAsJSON(t,n)},l.getPropertyAsString=function(e,t,n){return e._getPropertyAsString(t,n)},l.getStatus=function(e,t){return e._getStatus(t)},l.resizeApplet=function(e,t){return e._resizeApplet(t)},l.restoreOrientation=function(e,t){return e._restoreOrientation(t)},l.restoreOrientationDelayed=function(e,t,n){return e._restoreOrientationDelayed(t,n)},l.saveOrientation=function(e,t){return e._saveOrientation(t)},l.say=function(e){alert(e)},l.clearConsole=function(e){e._clearConsole()},l.getInfo=function(e){return e._info},l.setInfo=function(e,t,n){e._info=t,2<arguments.length&&e._showInfo(n)},l.showInfo=function(e,t){e._showInfo(t)},l.show2d=function(e,t){e._show2d(t)},l.jmolBr=function(){return l._documentWrite("<br>")},l.jmolButton=function(e,t,n,i,r){return l.controls._getButton(e,t,n,i,r)},l.jmolCheckbox=function(e,t,n,i,r,o,a){return l.controls._getCheckbox(e,t,n,i,r,o,a)},l.jmolCommandInput=function(e,t,n,i,r,o){return l.controls._getCommandInput(e,t,n,i,r,o)},l.jmolHtml=function(e){return l._documentWrite(e)},l.jmolLink=function(e,t,n,i,r){return l.controls._getLink(e,t,n,i,r)},l.jmolMenu=function(e,t,n,i,r){return l.controls._getMenu(e,t,n,i,r)},l.jmolRadio=function(e,t,n,i,r,o,a,s){return l.controls._getRadio(e,t,n,i,r,o,a,s)},l.jmolRadioGroup=function(e,t,n,i,r,o){return l.controls._getRadioGroup(e,t,n,i,r,o)},l.setCheckboxGroup=function(e,t){l.controls._cbSetCheckboxGroup(e,t,arguments)},l.setDocument=function(e){l._document=e},l.setXHTML=function(e){l._isXHTML=!0,l._XhtmlElement=null,l._XhtmlAppendChild=!1,e&&(l._XhtmlElement=document.getElementById(e),l._XhtmlAppendChild=!0)},l.setAppletCss=function(e,t){null!=e&&(l._appletCssClass=e),l._appletCssText=t?t+" ":e?'class="'+e+'" ':""},l.setButtonCss=function(e,t){null!=e&&(l.controls._buttonCssClass=e),l.controls._buttonCssText=t?t+" ":e?'class="'+e+'" ':""},l.setCheckboxCss=function(e,t){null!=e&&(l.controls._checkboxCssClass=e),l.controls._checkboxCssText=t?t+" ":e?'class="'+e+'" ':""},l.setRadioCss=function(e,t){null!=e&&(l.controls._radioCssClass=e),l.controls._radioCssText=t?t+" ":e?'class="'+e+'" ':""},l.setLinkCss=function(e,t){null!=e&&(l.controls._linkCssClass=e),l.controls._linkCssText=t?t+" ":e?'class="'+e+'" ':""},l.setMenuCss=function(e,t){null!=e&&(l.controls._menuCssClass=e),l.controls._menuCssText=t?t+" ":e?'class="'+e+'" ':""},l.setAppletSync=function(e,t,n){l._syncedApplets=e,l._syncedCommands=t,l._syncedReady={},l._isJmolJSVSync=n},l.setGrabberOptions=function(e){l._grabberOptions=e},l.setAppletHtml=function(e,t){e._code&&(l.$html(t,e._code),e._init&&!e._deferApplet&&e._init())},l.coverApplet=function(e,t){e._cover&&e._cover(t)},l.setFileCaching=function(e,t){e?e._cacheFiles=t:l.fileCache=t?{}:null},l.resetView=function(e,t){l.View.resetView(e,t)},l.updateView=function(e,t,n){e._updateView(t,n)},l.getChemicalInfo=function(e,t,n){return t=t||"name","string"!=typeof e&&(e=e._getSmiles()),l._getNCIInfo(e,t,n)},l.saveImage=function(e,t,n){switch(t=(t||"png").toLowerCase(),(n=n||e.id+"."+t.toLowerCase()).indexOf(".")<0&&(n+="."+t),e._viewType){case"Jmol":return e._script('write PNGJ "'+n+'"');case"JSV":if("PDF"==t)return e._script("write PDF");break;case"JME":return e._script("print")}l._saveFile(n,e._canvas.toDataURL("image/png"))}}(Jmol),LoadClazz=function(){c$=null,window["j2s.clazzloaded"]||(window["j2s.clazzloaded"]=!1),window["j2s.clazzloaded"]||(window["j2s.clazzloaded"]=!0,window["j2s.object.native"]=!0,Clazz={_isQuiet:!1,_debugging:!1},function(a,m){try{a._debugging=0<=document.location.href.indexOf("j2sdebug")}catch(e){}var h=["j2s.clazzloaded","j2s.object.native"];a.setGlobal=function(e,t){h.push(e),window[e]=t},a.getGlobals=function(){return h.sort().join("\n")},a.setConsoleDiv=function(e){window["j2s.lib"]&&(window["j2s.lib"].console=e)};var e=null;a._startProfiling=function(t){e=t&&self.JSON?{}:null},NullObject=function(){},a._supportsNativeObject=window["j2s.object.native"],a._supportsNativeObject?(a._O=function(){},a._O.__CLASS_NAME__="Object",a._O.getClass=function(){return a._O}):a._O=Object,a.Console={},a.dateToString=Date.prototype.toString,a._hashCode=0;var j=a._O.prototype;j.equals=function(e){return this==e},j.hashCode=function(){return this._$hashcode||(this._$hashcode=++a._hashCode)},j.getClass=function(){return a.getClass(this)},j.clone=function(){return a.clone(this)},a.clone=function(e){var t,n=e instanceof Array?Array(e.length):new e.constructor;for(t in e)n[t]=e[t];return n},j.finalize=function(){},j.notify=function(){},j.notifyAll=function(){},j.wait=function(){},j.to$tring=Object.prototype.toString,j.toString=function(){return this.__CLASS_NAME__?"["+this.__CLASS_NAME__+" object]":this.to$tring.apply(this,arguments)},a._extendedObjectMethods="equals hashCode getClass clone finalize notify notifyAll wait to$tring toString".split(" "),a.extendJO=function(e,t){if(t&&(e.__CLASS_NAME__=e.prototype.__CLASS_NAME__=t),a._supportsNativeObject)for(var n=0;n<a._extendedObjectMethods.length;n++){var i=a._extendedObjectMethods[n];e.prototype[i]=a._O.prototype[i]}},a.extractClassName=function(e){return 0<=(e=e.substring(1,e.length-1)).indexOf("Array")?"Array":0<=e.indexOf("object ")?e.substring(7):e},a.getClassName=function(e,t){if(null==e)return"NullObject";if(e instanceof a.CastedNull)return e.clazzName;switch(typeof e){case"number":return"n";case"boolean":return"b";case"string":return"String";case"function":if(e.__CLASS_NAME__)return t?e.__CLASS_NAME__:"Class";var n=e.toString();if((i=n.indexOf("function"))<0)return"["==n.charAt(0)?a.extractClassName(n):n.replace(/[^a-zA-Z0-9]/g,"");var i=i+8,r=n.indexOf("(",i);if(r<0)break;return 0<=(n=n.substring(i,r)).indexOf("Array")?"Array":"anonymous"==(n=n.replace(/^\s+/,"").replace(/\s+$/,""))||""==n?"Function":n;case"object":if(e.__CLASS_NAME__)return e.__CLASS_NAME__;if(!e.constructor)break;if(!e.constructor.__CLASS_NAME__){if(e instanceof Number)return"Number";if(e instanceof Boolean)return"Boolean";if(e instanceof Array||e.BYTES_PER_ELEMENT)return"Array";if("["==(n=e.toString()).charAt(0))return a.extractClassName(n)}return a.getClassName(e.constructor,!0)}return"Object"},a.getClass=function(e){if(!e)return a._O;if("function"==typeof e)return e;if(e instanceof a.CastedNull)e=e.clazzName;else switch(typeof e){case"string":return String;case"object":if(!e.__CLASS_NAME__)return e.constructor||a._O;e=e.__CLASS_NAME__;break;default:return e.constructor}return a.evalType(e,!0)};var t=function(e,t){for(var n=0;n<a.innerFunctionNames.length;n++)if(t==a.innerFunctionNames[n]&&a._innerFunctions[t]===e[t])return!0;return!1},s=function(){};a.inheritArgs=new s,a.inheritClass=function(e,n,i){for(var r in n)"b$"==r||"prototype"==r||"superClazz"==r||"__CLASS_NAME__"==r||"implementz"==r||t(n,r)||(e[r]=n[r]);a.unloadedClasses[a.getClassName(e,!0)]||(e.prototype=i||(n!==Number?new n(a.inheritArgs):new Number)),e.superClazz=n,e.prototype.__CLASS_NAME__=e.__CLASS_NAME__},a.implementOf=function(e,t){if(2<=arguments.length){e.implementz||(e.implementz=[]);var n=e.implementz;if(2==arguments.length){if("function"==typeof t)n.push(t),u(e,t);else if(t instanceof Array)for(var i=0;i<t.length;i++)n.push(t[i]),u(e,t[i])}else for(i=1;i<arguments.length;i++)n.push(arguments[i]),u(e,arguments[i])}};var u=function(e,n){for(var i in n)"b$"==i||"prototype"==i||"superClazz"==i||"__CLASS_NAME__"==i||"implementz"==i||"function"==typeof n[i]&&t(n,i)||(e[i]=e.prototype[i]=n[i])};a.extendInterface=a.implementOf,a.equalsOrExtendsLevel=function(e,t){if(e===t)return 0;if(e.implementz)for(var n=e.implementz,i=0;i<n.length;i++){var r=a.equalsOrExtendsLevel(n[i],t);if(0<=r)return r+1}return-1},a.getInheritedLevel=function(e,t){if(e===t)return 0;var n="string"==typeof e;if(n&&("void"==e||"unknown"==e))return-1;var i="string"==typeof t;if(i&&("void"==t||"unknown"==t))return-1;if(e===(n?"NullObject":NullObject))switch(t){case"n":case"b":return-1;case Number:case Boolean:case NullObject:break;default:return 0}if(n&&(e=a.evalType(e)),i&&(t=a.evalType(t)),!t||!e)return-1;for(n=0,i=e;i!==t&&n<10;){if(i.implementz)for(var r=i.implementz,o=0;o<r.length;o++){var s=a.equalsOrExtendsLevel(r[o],t);if(0<=s)return n+s+1}if(!(i=i.superClazz))return t===Object||t===a._O?n+1.5:-1;n++}return n},a.instanceOf=function(e,t){return null!=e&&t&&(e==t||e instanceof t||0<=a.getInheritedLevel(a.getClassName(e),t))},a.superCall=function(e,t,n,i){var r=null,o=-1,s=e[n];if(s)if(s.claxxOwner)s.claxxOwner!==t&&(r=s);else if(s.stacks||s.lastClaxxRef&&s.lastClaxxRef.prototype[n]&&s.lastClaxxRef.prototype[n].stacks)for(var l=s.stacks,o=(l=l||s.lastClaxxRef.prototype[n].stacks).length;0<=--o;){if(t===l[o]){r=0<o?l[--o].prototype[n]:l[0].prototype[n]["\\unknown"];break}if(0<a.getInheritedLevel(t,l[o])){r=l[o].prototype[n];break}}else r=s;if(r)return 0==o&&"construct"==n&&(t=s.stacks)&&!t[0].superClazz&&t[0].con$truct&&t[0].con$truct.apply(e,[]),r.apply(e,i||[]);"construct"!=n&&(a.alert(["j2slib","no class found",i.typeString]),fb(e,t,n,a.getParamsType(i).typeString))},a.superConstructor=function(e,t,n){a.superCall(e,t,"construct",n),t.con$truct&&t.con$truct.apply(e,[])},a.CastedNull=function(e){this.clazzName=e?e instanceof String?e:e instanceof Function?a.getClassName(e,!0):""+e:"Object",this.toString=function(){return null},this.valueOf=function(){return null}},a.castNullAs=function(e){return new a.CastedNull(e)},a._initializingException=!1,a._callingStackTraces=[];var b=function(){this.toString=function(){return"J2S MethodException"}},c,j,q,I,B;try{null.hello()}catch(e){j=function(e,t,n){n=n||"[^\\s]+";var i=e.indexOf(t);return e=e.substring(0,i)+n+e.substring(i+t.length),RegExp("^"+e+"$")},c=/Opera[\/\s](\d+\.\d+)/.test(navigator.userAgent)?(j=e.message.indexOf(":"),q=e.message.indexOf(":",j+2),I=e.message.substr(j+1,q-j-20),function(e){return-1!=e.message.indexOf(I)}):-1!=navigator.userAgent.toLowerCase().indexOf("webkit")?(B=j(e.message,"hello"),function(e){return B.test(e.message)}):(B=j(e.message,"$$o$$"),function(e){return B.test(e.message)})}a.exceptionOf=function(e,t){return e.__CLASS_NAME__?a.instanceOf(e,t):(e.getMessage||(e.getMessage=function(){return e+(e.stack?"\n"+e.stack:"")}),e.printStackTrace||(e.printStackTrace=function(){}),t==Error?!((""+e).indexOf("Error")<0)&&(System.out.println(a.getStackTrace()),!0):t==Exception||t==Throwable||t==NullPointerException&&c(e))},a.getStackTrace=function(e){var t="\n",n=arguments.callee,i=(e=e||25)<0;i&&(e=-e);try{for(var r=0;r<e&&(n=n.caller);r++){var o=n.toString?n.toString().substring(0,n.toString().indexOf("{")):"<native method>",t=t+(r+" "+(n.exName?(n.claxxOwner?n.claxxOwner.__CLASS_NAME__+".":"")+n.exName+o.replace(/function /,""):o))+"\n";if(n==n.caller){t+="<recursing>\n";break}if(i)for(var a=n.arguments,s=0;s<a.length;s++){var l=""+a[s];60<l.length&&(l=l.substring(0,60)+"..."),t+=" args["+s+"]="+l.replace(/\s+/g," ")+"\n"}}}catch(e){}return t},a.makeConstructor=function(e,t,n){a.defineMethod(e,"construct",t,n),e.con$truct&&(e.con$truct.index=e.con$truct.stacks.length)},a.overrideConstructor=function(e,t,n){a.overrideMethod(e,"construct",t,n),e.con$truct&&(e.con$truct.index=e.con$truct.stacks.length)},a.defineMethod=function(t,n,i,r){i.exName=n,r=Ea(r);var o=t.prototype,s=o[n];if(a._Loader._checkLoad&&E(t,n,r),!s||s.claxxOwner===t&&s.funParams==r)return i.funParams=r,i.claxxOwner=t,i.exClazz=t,o[n]=i;var l=null,c=s.stacks;if(c||(c=[],(l=s).claxxOwner&&(c[0]=l.claxxOwner)),!s.stacks||s.claxxReference!==t){for(++Q,(s=function(){e:{var t=arguments.callee.claxxReference,n=arguments.callee.methodName,i=arguments;fx=this[n];var r,o=a.getParamsType(i);if(!fx)try{System.out.println(a.getStackTrace(5))}catch(e){}if(e&&(r=t.__CLASS_NAME__+" "+n+" ",U.indexOf(r)<0&&(U+=r+"\n"),e[r]||(e[r]=0),e[r]++),fx.lastParams==o.typeString&&fx.lastClaxxRef===t){if(o.hasCastedNull)for(t=[],n=0;n<i.length;n++)t[n]=i[n]instanceof a.CastedNull?null:i[n];else t=i;i=fx.lastMethod?fx.lastMethod.apply(this,t):null}else{fx.lastParams=o.typeString,fx.lastClaxxRef=t;for(var s=!1,l=(r=(r=fx.stacks)||t.prototype[n].stacks).length;0<=--l;)if(s||r[l]===t){var c=r[l].prototype[n],u=o,s=i,h=fx,f=[],d=!0,p=void 0;for(p in c)if(92==p.charCodeAt(0)){(g=p.substring(1).split("\\")).length==u.length&&f.push(g),d=!1}else if(d&&"funParams"==p&&c.funParams){(g=(p=c.funParams).substring(1).split("\\")).length==u.length&&(f[0]=g);break}if(p=void 0,!(p=0==f.length)){p=void 0;for(var p=[],m=f.length,g=0;g<m;g++){for(var v=[],_=!0,y=f[g].length,x=0;x<y;x++)if(v[x]=a.getInheritedLevel(u[x],f[g][x]),v[x]<0){_=!1;break}_&&(v[u.length]=g,p.push(v))}if(0==p.length)p=null;else{for(m=p[0],g=1;g<p.length;g++){for(v=!0,x=0;x<u.length;x++)if(m[x]<p[g][x]){v=!1;break}v&&(m=p[g])}p=f[m[u.length]].join("\\")}p=!(f=p)}if(p)s=new b;else{if(c=d?c:c["\\"+f],d=null,u.hasCastedNull)for(d=[],u=0;u<s.length;u++)d[u]=s[u]instanceof a.CastedNull?null:s[u];else d=s;s=(h.lastMethod=c).apply(this,d)}if(!(s instanceof b)){i=s;break e}s=!0}"construct"!=n&&fb(this,t,n,o.typeString),i=void 0}}return i}).methodName=n,s.claxxReference=t,s=o[n]=s,n=[],o=0;o<c.length;o++)n[o]=c[o];s.stacks=n}return c=s.stacks,rb(c,t)<0&&c.push(t),l&&(l.claxxOwner===t?((s[l.funParams]=l).claxxOwner=null,l.funParams=null):l.claxxOwner||(s["\\unknown"]=l)),i.exClazz=t,s[r]=i,s},duplicatedMethods={};var E=function(e,t,n){var i=e.prototype[t];i&&(i.claxxOwner||i.claxxReference)===e&&(key=e.__CLASS_NAME__+"."+t+n,(e=duplicatedMethods[key])?(t="Warning! Duplicate method found for "+key,System.out.println(t),a.alert(t),duplicatedMethods[key]=e+1):duplicatedMethods[key]=1)};a.showDuplicates=function(e){var t,n="",i=duplicatedMethods,r=0;for(t in i)1<i[t]&&(n+=i[t]+"\t"+t+"\n",r++);n="Duplicates: "+r+"\n\n"+n,System.out.println(n),e||alert(n)};var rb=function(e,t){if(e&&t)for(var n=e.length;0<=--n;)if(e[n]===t)return n;return-1},Ya=function(e,t){var n=rb(e,t);if(0<=n){for(var i=e.length-1;n<i;n++)e[n]=e[n+1];return e.length--,!0}},Ea=function(e){return e?e.replace(/~([NABSO])/g,function(e,t){switch(t){case"N":return"n";case"B":return"b";case"S":return"String";case"O":return"Object";case"A":return"Array"}return"Unknown"}).replace(/\s+/g,"").replace(/^|,/g,"\\").replace(/\$/g,"org.eclipse.s"):"\\void"};a.overrideMethod=function(e,t,n,i){return n.exName=t,i=Ea(i),a._Loader._checkLoad&&E(e,t,i),n.funParams=i,(n.claxxOwner=e).prototype[t]=n};var U="";a.getProfile=function(){var t="";if(e){var n,t=[];for(n in e){var i=""+e[n];t.push("        ".substring(i.length)+i+"\t"+n)}t=t.sort().reverse().join("\r\n"),e={}}return t},a.getParamsType=function(e){var t=e.length;switch(t){case 0:var n=["void"];return n.typeString="\\void",n;case 1:switch(typeof obj){case"number":return(n=["n"]).typeString="\\n",n;case"boolean":return(n=["b"]).typeString="\\b",n}}if((n=[]).hasCastedNull=!1,e)for(var i=0;i<t;i++)n[i]=a.getClassName(e[i]),e[i]instanceof a.CastedNull&&(n.hasCastedNull=!0);return n.typeString="\\"+n.join("\\"),n};var Q=0;a.allPackage={},a.allClasses={},a.lastPackageName=null,a.lastPackage=null,a.unloadedClasses=[],a.declarePackage=function(e){if(a.lastPackageName==e)return a.lastPackage;if(e&&e.length){for(var t=e.split(/\./),n=a.allPackage,i=0;i<t.length;i++)n[t[i]]||(n[t[i]]={__PKG_NAME__:n.__PKG_NAME__?n.__PKG_NAME__+"."+t[i]:t[i]},0==i&&a.setGlobal(t[i],n[t[i]])),n=n[t[i]];return a.lastPackageName=e,a.lastPackage=n}},a.evalType=function(e,t){if(-1!=(n=e.lastIndexOf("."))){var n,i=e.substring(0,n);return(i=a.declarePackage(i))[n=e.substring(n+1)]}if(t)return window[e];switch(e){case"string":return String;case"number":return Number;case"object":return a._O;case"boolean":return Boolean;case"function":return Function;case"void":case"undefined":case"unknown":return e;case"NullObject":return NullObject;default:return window[e]}},a.defineType=function(e,t,n,i){if((r=a.unloadedClasses[e])&&(t=r),-1!=(r=e.lastIndexOf("."))){var r,o=e.substring(0,r);if((o=a.declarePackage(o))[r=e.substring(r+1)])return o[r];o[r]=t}else{if(window[e])return window[e];a.setGlobal(e,t)}return a.decorateAsType(t,e,n,i),e=a._innerFunctions,t.defineMethod=e.defineMethod,t.defineStaticMethod=e.defineStaticMethod,t.makeConstructor=e.makeConstructor,t};var Fa=!1;-1!=navigator.userAgent.indexOf("Safari")&&(j=navigator.userAgent,q=j.indexOf("Version/"),-1!=q&&(j=j.substring(q+8),Fa=4<=parseFloat(j))),a.instantialize=function(e,t){if(!t||!(1==t.length&&t[0]&&t[0]instanceof s)){if(e instanceof Number&&(e.valueOf=function(){return this}),Fa){for(var n=[],i=0;i<t.length;i++)n[i]=t[i];t=n}(n=e.construct)?e.con$truct?e.getClass().superClazz?n.claxxOwner&&n.claxxOwner===e.getClass()||n.stacks&&n.stacks[n.stacks.length-1]==e.getClass()?n.apply(e,t):(n.claxxOwner&&!n.claxxOwner.superClazz&&n.claxxOwner.con$truct?n.claxxOwner.con$truct.apply(e,[]):n.stacks&&1==n.stacks.length&&!n.stacks[0].superClazz&&n.stacks[0].con$truct.apply(e,[]),n.apply(e,t),e.con$truct.apply(e,[])):(e.con$truct.apply(e,[]),n.apply(e,t)):n.apply(e,t):e.con$truct&&e.con$truct.apply(e,[])}},a.innerFunctionNames="isInstance equals hashCode getName getCanonicalName getClassLoader getResource getResourceAsStream defineMethod defineStaticMethod makeConstructor".split(" "),a._innerFunctions={isInstance:function(e){return a.instanceOf(e,this)},equals:function(e){return this===e},hashCode:function(){return this.getName().hashCode()},toString:function(){return"class "+this.getName()},getName:function(){return a.getClassName(this,!0)},getCanonicalName:function(){return this.__CLASS_NAME__},getClassLoader:function(){var e=this.__CLASS_NAME__,t=(n=a._Loader.getClasspathFor(e)).lastIndexOf(e.replace(/\./g,"/")),n=-1!=t?n.substring(0,t):a._Loader.getClasspathFor(e,!0);return(e=a._Loader.requireLoaderByBase(n)).getResourceAsStream=a._innerFunctions.getResourceAsStream,e.getResource=a._innerFunctions.getResource,e},getResource:function(e){return(e=this.getResourceAsStream(e))?e.url:null},getResourceAsStream:function(e){if(!e)return null;var t,n=null,i=e=e.replace(/\\/g,"/"),i=this.__CLASS_NAME__;if(2==arguments.length&&0!=e.indexOf("/")&&(e="/"+e),0==e.indexOf("/")){2==arguments.length?(n=arguments[1])||(n=a.binaryFolders[0]):a._Loader&&(n=a._Loader.getClasspathFor(i,!0)),i=n?(r=(n=n.replace(/\\/g,"/")).length,"/"!=(r=n.charAt(r-1))&&(n+="/"),n+e.substring(1)):e.substring(1)}else{if(this.base)n=this.base;else if(a._Loader)if(-1!=(r=(n=a._Loader.getClasspathFor(i)).lastIndexOf(i.replace(/\./g,"/"))))n=n.substring(0,r);else if(r=-1,n.indexOf(".z.js")==n.length-5&&-1!=(r=n.lastIndexOf("/")))for(var n=n.substring(0,r+1),r=i.split(/\./),o=1;o<r.length;o++){for(var s="/",l=0;l<o;l++)s+=r[l]+"/";if(s.length>n.length)break;if(n.indexOf(s)==n.length-s.length){n=n.substring(0,n.length-s.length+1);break}}else n=a._Loader.getClasspathFor(i,!0);else(r=a.binaryFolders)&&r.length&&(n=r[0]);r=(n=(n=n||"j2s/").replace(/\\/g,"/")).length,"/"!=(r=n.charAt(r-1))&&(n+="/"),i=this.base?n+e:-1==(r=i.lastIndexOf("."))||this.base?n+e:n+i.substring(0,r).replace(/\./g,"/")+"/"+e}n=null;try{i.indexOf(":/")<0&&((t=document.location.href.split("?")[0].split("/"))[t.length-1]=i,i=t.join("/")),n=new java.net.URL(i)}catch(e){}return(t=null==n?null:m._getFileData(i.toString()))&&"error"!=t&&0!=t.indexOf("[Exception")?(t=new java.lang.String(t).getBytes(),(t=new java.io.BufferedInputStream(new java.io.ByteArrayInputStream(t))).url=n,t):null},defineMethod:function(e,t,n){a.defineMethod(this,e,t,n)},defineStaticMethod:function(e,t,n){a.defineMethod(this,e,t,n),this[e]=this.prototype[e]},makeConstructor:function(e,t){a.makeConstructor(this,e,t)}};var Pa=[];a.pu$h=function(e){(e=e||self.c$)&&Pa.push(e)},a.p0p=function(){return Pa.pop()},a.decorateAsClass=function(e,t,n,i,r,o){var s=null;t&&(s=(s=t.__PKG_NAME__)||t.__CLASS_NAME__);var l=(s?s+".":"")+n;return a._Loader._classPending[l]&&(delete a._Loader._classPending[l],a._Loader._classCountOK++,a._Loader._classCountPending--),a._Loader&&a._Loader._checkLoad&&System.out.println("decorating class "+s+"."+n),(s=a.unloadedClasses[l])&&(e=s),db(e,t,n),o?a.inheritClass(e,i,o):i&&a.inheritClass(e,i),r&&a.implementOf(e,r),e};var db=function(e,t,n){var i;for(t?t.__PKG_NAME__?(i=t.__PKG_NAME__+"."+n,t[n]=e,t===java.lang&&a.setGlobal(n,e)):(i=t.__CLASS_NAME__+"."+n,t[n]=e):(i=n,a.setGlobal(n,e)),a.extendJO(e,i),t=a.innerFunctionNames,n=0;n<t.length;n++)e[t[n]]=a._innerFunctions[t[n]];a._Loader&&a._Loader.updateNodeForFunctionDecoration(i)};a.declareInterface=function(e,t,n){function i(){}return db(i,e,t),n&&a.implementOf(i,n),i},a.declareType=function(e,t,n,i,r){return a.decorateAsClass(function(){a.instantialize(this,arguments)},e,t,n,i,r)},a.declareAnonymous=function(e,t,n,i,r){return a.decorateAsClass(function(){a.prepareCallback(this,arguments),a.instantialize(this,arguments)},e,t,n,i,r)},a.decorateAsType=function(e,t,n,i,r,o){if(a.extendJO(e,t),e.equals=a._innerFunctions.equals,e.getName=a._innerFunctions.getName,o)for(t=0;t<a.innerFunctionNames.length;t++)e[o=a.innerFunctionNames[t]]=a._innerFunctions[o];return r?a.inheritClass(e,n,r):n&&a.inheritClass(e,n),i&&a.implementOf(e,i),e},Number.prototype._numberToString=Number.prototype.toString,a.declarePackage("java.io"),a.declarePackage("java.lang.annotation"),a.declarePackage("java.lang.instrument"),a.declarePackage("java.lang.management"),a.declarePackage("java.lang.reflect"),a.declarePackage("java.lang.ref"),java.lang.ref.reflect=java.lang.reflect,a.declarePackage("java.util"),a.declarePackage("java.security"),a.declareInterface(java.io,"Closeable"),a.declareInterface(java.io,"DataInput"),a.declareInterface(java.io,"DataOutput"),a.declareInterface(java.io,"Externalizable"),a.declareInterface(java.io,"Flushable"),a.declareInterface(java.io,"Serializable"),a.declareInterface(java.lang,"Iterable"),a.declareInterface(java.lang,"CharSequence"),a.declareInterface(java.lang,"Cloneable"),a.declareInterface(java.lang,"Appendable"),a.declareInterface(java.lang,"Comparable"),a.declareInterface(java.lang,"Runnable"),a.declareInterface(java.util,"Comparator"),java.lang.ClassLoader={__CLASS_NAME__:"ClassLoader"};var fb=function(e,t,n,i){throw e="",i&&(e=i.substring(1).replace(/\\/g,",")),t=(n&&"construct"!=n?"Method":"Constructor")+" "+a.getClassName(t,!0)+"."+n+"("+e+") is not found!",new java.lang.NoSuchMethodException(t)};a.prepareCallback=function(e,t){var n=t[0];if(e&&n&&n!==window){var i=a.getClassName(n,!0),r={};if(e.b$)for(var o in e.b$)r[o]=e.b$[o];for((e.b$=r)[i]=n,i=a.getClass(n);i.superClazz;)i=i.superClazz,r[a.getClassName(i,!0)]=n;if(n=n.b$)for(o in n)r[o]=n[o]}for(r=0;r<t.length-1;r++)t[r]=t[r+1];0<t.length&&t.length--},a.innerTypeInstance=function(e,t,n){var i;if(e=e||arguments.callee.caller,n||t.$finals)if(i=new e(t,a.inheritArgs),n)if(t.f$){var r,o={};for(r in t.f$)o[r]=t.f$[r];for(r in n)o[r]=n[r];i.f$=o}else i.f$=n;else t.f$&&(i.f$=t.f$);else switch(arguments.length){case 3:return new e(t);case 4:return t.__CLASS_NAME__==e.__CLASS_NAME__&&arguments[3]===a.inheritArgs?t:new e(t,arguments[3]);case 5:return new e(t,arguments[3],arguments[4]);case 6:return new e(t,arguments[3],arguments[4],arguments[5]);case 7:return new e(t,arguments[3],arguments[4],arguments[5],arguments[6]);case 8:return new e(t,arguments[3],arguments[4],arguments[5],arguments[6],arguments[7]);case 9:return new e(t,arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8]);case 10:return new e(t,arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9]);default:i=new e(t,a.inheritArgs)}for(r=arguments.length-3,o=Array(r);0<=--r;)o[r]=arguments[r+3];return a.instantialize(i,o),i},a.cloneFinals=function(){for(var e={},t=arguments.length/2;0<=--t;)e[arguments[t+t]]=arguments[t+t+1];return e},a.isClassDefined=a.isDefinedClass=function(e){if(!e)return!1;if(a.allClasses[e])return!0;for(var t=e.split(/\./),n=null,i=0;i<t.length;i++)if(!(n=n?n[t[i]]:a.allPackage[t[0]]))return!1;return n&&(a.allClasses[e]=!0)},a.defineEnumConstant=function(e,t,n,i,r){return(r=new(r||e)).$name=t,r.$ordinal=n,i&&i.length&&r.construct.apply(r,i),e[t]=r,e.prototype[t]=r,e["$ values"]||(e["$ values"]=[],e.values=function(){return this["$ values"]}),e["$ values"].push(r),r},a.floatToInt=function(e){return isNaN(e)?0:e<0?Math.ceil(e):Math.floor(e)},a.floatToByte=a.floatToShort=a.floatToLong=a.floatToInt,a.doubleToByte=a.doubleToShort=a.doubleToLong=a.doubleToInt=a.floatToInt,a.floatToChar=function(e){return String.fromCharCode(e<0?Math.ceil(e):Math.floor(e))},a.doubleToChar=a.floatToChar;var gb=function(e,t){if("object"==typeof(e=e||0))var n=e;else for(var n=Array(e),i=0;i<e;i++)n[i]=0;return n.BYTES_PER_ELEMENT=t>>3,n._fake=!0,n},va=function(e,t){if(e=e||0,t=t||this.length,this._fake){var n=new this.constructor(t-e);return System.arraycopy(this,e,n,0,t-e),n}return new this.constructor(this.buffer.slice(e*this.BYTES_PER_ELEMENT,t*this.BYTES_PER_ELEMENT))};1==(a.haveInt32=!(!self.Int32Array||self.Int32Array==Array))?Int32Array.prototype.sort||(Int32Array.prototype.sort=Array.prototype.sort):(Int32Array=function(e){return gb(e,32)},Int32Array.prototype.sort=Array.prototype.sort,Int32Array.prototype.toString=function(){return"[object Int32Array]"}),Int32Array.prototype.slice||(Int32Array.prototype.slice=function(){return va.apply(this,arguments)}),Int32Array.prototype.clone=function(){var e=this.slice();return e.BYTES_PER_ELEMENT=4,e},1==(a.haveFloat64=!(!self.Float64Array||self.Float64Array==Array))?Float64Array.prototype.sort||(Float64Array.prototype.sort=Array.prototype.sort):(Float64Array=function(e){return gb(e,64)},Float64Array.prototype.sort=Array.prototype.sort,Float64Array.prototype.toString=function(){return"[object Float64Array]"}),Float64Array.prototype.slice||(Float64Array.prototype.slice=function(){return va.apply(this,arguments)}),Float64Array.prototype.clone=function(){return this.slice()},a.newArray=function(e,t,n,i){return-1!=e||2==arguments.length?ma(arguments,0):((e=t.slice(n,i)).BYTES_PER_ELEMENT=t.BYTES_PER_ELEMENT,e)};var ma=function(e,t){var n=e[0];"string"==typeof n&&(n=n.charCodeAt(0));var i=e.length-1,r=e[i];if(1<i){for(var r=Array(i),o=0;o<i;o++)r[o]=e[o+1];for(i=Array(n),o=0;o<n;o++)i[o]=ma(r,t);return i}switch(0<t&&n<0&&(n=r),t){case 8:return(i=new Int8Array(n)).BYTES_PER_ELEMENT=1,i;case 32:return(i=new Int32Array(n)).BYTES_PER_ELEMENT=4,i;case 64:return(i=new Float64Array(n)).BYTES_PER_ELEMENT=8,i;default:if(((i=n<0?r:Array(n)).BYTES_PER_ELEMENT=0)<n&&null!=r)for(o=n;0<=--o;)i[o]=r;return i}};for(a.newByteArray=function(){return ma(arguments,8)},a.newIntArray=function(){return ma(arguments,32)},a.newFloatArray=function(){return ma(arguments,64)},a.newDoubleArray=a.newFloatArray,a.newLongArray=a.newShortArray=a.newIntArray,a.newCharArray=a.newBooleanArray=a.newArray,1==(a.haveInt8=!!self.Int8Array)?(Int8Array.prototype.sort||(Int8Array.prototype.sort=Array.prototype.sort),Int8Array.prototype.slice||(Int8Array.prototype.slice=function(){return va.apply(this,arguments)})):a.newByteArray=a.newIntArray,Int8Array.prototype.clone=function(){var e=this.slice();return e.BYTES_PER_ELEMENT=1,e},a.isAB=function(e){return e&&"object"==typeof e&&1==e.BYTES_PER_ELEMENT},a.isAI=function(e){return e&&"object"==typeof e&&4==e.BYTES_PER_ELEMENT},a.isAF=function(e){return e&&"object"==typeof e&&8==e.BYTES_PER_ELEMENT},a.isAS=function(e){return e&&"object"==typeof e&&e.constructor==Array&&("string"==typeof e[0]||void 0===e[0])},a.isAII=function(e){return e&&"object"==typeof e&&a.isAI(e[0])},a.isAFF=function(e){return e&&"object"==typeof e&&a.isAF(e[0])},a.isAFFF=function(e){return e&&"object"==typeof e&&a.isAFF(e[0])},a.isASS=function(e){return e&&"object"==typeof e&&a.isAS(e[0])},a.isAFloat=function(e){return e&&"object"==typeof e&&e.constructor==Array&&a.instanceOf(e[0],Float)},a.isAP=function(e){return e&&"JU.P3"==a.getClassName(e[0])},a.defineStatics=function(e){for(var t=arguments.length,n=(t-1)/2;0<=--n;){var i=arguments[--t],r=arguments[--t];e[r]=e.prototype[r]=i}},a.prepareFields=function(e,t){var n=[];if(e.con$truct)for(var i=e.con$truct.stacks,r=0;r<i.length;r++)n[r]=i[r];i=e.con$truct=function(){var e=arguments.callee.stacks;if(e)for(var t=0;t<e.length;t++)e[t].apply(this,[])},e.prototype.con$truct=i,n.push(t),e.con$truct.stacks=n,e.con$truct.index=0},a.checkPrivateMethod=function(){me=arguments.callee.caller,caller=arguments.callee.caller.caller;var e="\\"+a.getParamsType(arguments[0]).join("\\");return me.privateNote||(me.privateNote="You are seeing this note because the method "+me.exName+e+" in class "+me.exClazz.__CLASS_NAME__+" has a superclass method by the same name (possibly with the same parameters) that is private and  therefore might be called improperly from this class. If your  code does not run properly, or you want to make it run faster, change the name of this method to something else.",System.out.println(me.privateNote),alert(me.privateNote)),null},java.lang.Object=a._O,a._O.getName=a._innerFunctions.getName,java.lang.System=System={props:null,$props:{},arraycopy:function(e,t,n,i,r){if(e!==n||i<t)for(;0<=--r;)n[i++]=e[t++];else for(i+=r,t+=r;0<=--r;)e[--i]=e[--t]},currentTimeMillis:function(){return(new Date).getTime()},gc:function(){},getProperties:function(){return System.props},getProperty:function(e,t){if(System.props)return System.props.getProperty(e,t);var n=System.$props[e];if(void 0!==n)return n;if(0<e.indexOf(".")){switch(n=null,e){case"java.version":case"file.separator":case"path.separator":n="/";break;case"line.separator":n=0<=navigator.userAgent.indexOf("Windows")?"\r\n":"\n";break;case"os.name":case"os.version":n=navigator.userAgent}if(n)return System.$props[e]=n}return 1==arguments.length?null:null==t?e:t},getSecurityManager:function(){return null},setProperties:function(e){System.props=e},lineSeparator:function(){return"\n"},setProperty:function(e,t){if(!System.props)return System.$props[e]=t;System.props.setProperty(e,t)}},System.identityHashCode=function(e){return null==e?0:e._$hashcode||(e._$hashcode=++a._hashCode)},System.out=new a._O,System.out.__CLASS_NAME__="java.io.PrintStream",System.out.print=function(){},System.out.printf=function(){},System.out.println=function(){},System.out.write=function(){},System.err=new a._O,System.err.__CLASS_NAME__="java.io.PrintStream",System.err.print=function(){},System.err.printf=function(){},System.err.println=function(){},System.err.write=function(){},a.popup=a.assert=a.log=a.error=window.alert,Thread=function(){},Thread.J2S_THREAD=Thread.prototype.J2S_THREAD=new Thread,Thread.currentThread=Thread.prototype.currentThread=function(){return this.J2S_THREAD},a.innerFunctionNames=a.innerFunctionNames.concat("getSuperclass isAssignableFrom getConstructor getDeclaredMethod getDeclaredMethods getMethod getMethods getModifiers newInstance".split(" ")),a._innerFunctions.getSuperclass=function(){return this.superClazz},a._innerFunctions.isAssignableFrom=function(e){return 0<=a.getInheritedLevel(e,this)},a._innerFunctions.getConstructor=function(){return new java.lang.reflect.Constructor(this,[],[],java.lang.reflect.Modifier.PUBLIC)},a._innerFunctions.getDeclaredMethods=a._innerFunctions.getMethods=function(){var e,t=[],n=this.prototype;for(e in n)"function"!=typeof n[e]||n[e].__CLASS_NAME__||t.push(new java.lang.reflect.Method(this,e,[],java.lang.Void,[],java.lang.reflect.Modifier.PUBLIC));for(e in n=this)"function"!=typeof n[e]||n[e].__CLASS_NAME__||t.push(new java.lang.reflect.Method(this,e,[],java.lang.Void,[],java.lang.reflect.Modifier.PUBLIC|java.lang.reflect.Modifier.STATIC));return t},a._innerFunctions.getDeclaredMethod=a._innerFunctions.getMethod=function(e){var t,n=this.prototype;for(t in n)if(e==t&&"function"==typeof n[t]&&!n[t].__CLASS_NAME__)return new java.lang.reflect.Method(this,t,[],java.lang.Void,[],java.lang.reflect.Modifier.PUBLIC);for(t in n=this)if(e==t&&"function"==typeof n[t]&&!n[t].__CLASS_NAME__)return new java.lang.reflect.Method(this,t,[],java.lang.Void,[],java.lang.reflect.Modifier.PUBLIC|java.lang.reflect.Modifier.STATIC);return null},a._innerFunctions.getModifiers=function(){return java.lang.reflect.Modifier.PUBLIC},a._innerFunctions.newInstance=function(a){switch(null==a?0:a.length){case 0:return new this;case 1:return new this(a[0]);case 2:return new this(a[0],a[1]);case 3:return new this(a[0],a[1],a[2]);case 4:return new this(a[0],a[1],a[2],a[3]);default:for(var b="new "+this.__CLASS_NAME__+"(",c=0;c<a.length;c++)b+=(0==c?"":",")+"a["+c+"]";return eval(b+")")}},j=a.innerFunctionNames,q=0;q<j.length;q++)a._O[j[q]]=a._innerFunctions[j[q]],Array[j[q]]=a._innerFunctions[j[q]];a._Loader=a.ClazzLoader=function(){};var x=function(){this.parents=[],this.musts=[],this.optionals=[],this.onLoaded=this.path=this.name=this.declaration=null,this.status=0,this.random=.13412};!function(a,b){b._checkLoad=m._checkLoad,b.updateNodeForFunctionDecoration=function(e){var t;(e=H(e))&&e.status==x.STATUS_KNOWN&&window.setTimeout((t=e,function(){updateNode(t)}),1)},x.prototype.toString=function(){return this.name||this.path||"ClazzNode"},x.STATUS_UNKNOWN=0,x.STATUS_KNOWN=1,x.STATUS_CONTENT_LOADED=2,x.STATUS_MUSTS_LOADED=3,x.STATUS_DECLARED=4,x.STATUS_LOAD_COMPLETE=5;var c=[];b.requireLoaderByBase=function(e){for(var t=0;t<c.length;t++)if(c[t].base==e)return c[t];return(t=new b).base=e,c.push(t),t};var d=new x,e={},h=0,j=6,l=navigator.userAgent.toLowerCase(),q=-1!=l.indexOf("opera"),s=-1!=l.indexOf("msie")&&!q,f=-1!=l.indexOf("gecko"),B;if(q&&(j=1,q=l.indexOf("opera/"),-1!=q)){var t=9;try{t=parseFloat(l.subString(q+6))}catch(e){}9.6<=t&&(j=6)}isClassDefined=self.Clazz&&a.isClassDefined?a.isClassDefined:(B={},function(e){return 1==B[e]});var C=function(e){if(!e||0==e.length)return[];for(var t=null,n=0;n<e.length;n++)if(e[n]){if("$"==e[n].charAt(0))if("."==e[n].charAt(1)){if(!t)continue;var i=t.lastIndexOf(".");-1!=i&&(t=t.substring(0,i),e[n]=t+e[n].substring(1))}else e[n]="org.eclipse.s"+e[n].substring(1);t=e[n]}return e},E=[],D={},I=0;b.loadPackageClasspath=function(e,t,n,i,r,o){r=r||0,i=i||null,o=o||0;var a=n&&D["@"+e];if(0!=r||!n||D["@java"]||0==e.indexOf("java")||null==window["java.registered"]||D["@java"]||(b.loadPackage("java",i?function(){b.loadPackageClasspath(e,t,n,i,1)}:null),!i))if(e instanceof Array)if(C(e),i)o<e.length?b.loadPackageClasspath(e[o],t,n,function(){b.loadPackageClasspath(e,t,n,i,1,o+1)},1):i();else for(a=0;a<e.length;a++)b.loadPackageClasspath(e[a],t,n,null);else{switch(e){case"java.*":e="java";case"java":t&&(D[r="@net.sf.j2s.ajax"]||(D[r]=t),D[r="@net.sf.j2s"]||(D[r]=t));break;case"swt":e="org.eclipse.swt";break;case"ajax":e="net.sf.j2s.ajax";break;case"j2s":e="net.sf.j2s";break;default:e.lastIndexOf(".*")==e.length-2&&(e=e.substring(0,e.length-2))}t&&(D["@"+e]=t),!n||a||window[e+".registered"]?i&&i():(I++,"java"==e&&(e="core"),b.loadClass(e+".package",function(){0==--I&&ca()},!0,!0,1))}},a.loadClass=function(e,t,n){return self.Class||(Class=a,Class.forName=a._4Name,JavaObject=a._O),e&&b.loadClass(e,t,!0,n,1)},b.loadClass=function(t,n,i,r,o){if(o=o||0,null==r&&(r=!1),"boolean"==typeof n)return a.evalType(t);if(null==window["java.registered"]||D["@java"]||b.loadPackage("java"),b.keepOnLoading=!0,!i&&(I&&t.lastIndexOf(".package")!=t.length-8||0!=t.indexOf("java.")&&!isClassDefined(da)))La.push([t,n]),System.out.println("loadclass-queuing"+t+da+" "+isClassDefined(da));else if((o=isClassDefined(t))||O["@"+t])o&&n&&(!(i=H(t))||i.status>=x.STATUS_LOAD_COMPLETE)&&(r?window.setTimeout(n,25):n());else{var s,l,c,u=b.getClasspathFor(t);if(!(o=e[u]))for(r=E.length;0<=--r;)if(E[r].path==u||E[r].name==t){o=!0;break}if(o){n&&(o=H(t))&&(o.onLoaded?n!=o.onLoaded&&(s=o.onLoaded,l=n,o.onLoaded=function(){s(),l()}):o.onLoaded=n)}else{for((o=a.unloadedClasses[t]&&H(t)||new x).name=t,o.path=u,o.isPackage=u.lastIndexOf("package.js")==u.length-10,X(u,t,o),o.onLoaded=n,o.status=x.STATUS_KNOWN,t=!1,r=E.length;0<=--r;)if(E[r].status!=x.STATUS_LOAD_COMPLETE){t=!0;break}if(o.isPackage){for(r=E.length;0<=--r&&!E[r].isPackage;)E[r+1]=E[r];E[++r]=o}else t&&E.push(o);t||(c=!1,n&&(c=ha,ha=!0),i&&(n=null),Ja(d,o,!0),V(o,o.path,o.requiredBy,!1,n?function(){ha=c,n()}:null))}}},b.loadPackage=function(e,t){t=t||null,window[e+".registered"]=!1,b.loadPackageClasspath(e,b.J2SLibBase||(b.J2SLibBase=b.getJ2SLibBase()||"j2s/"),!0,t)},b.jarClasspath=function(e,t){t instanceof Array||(t=[t]),C(t),m._debugCore&&(e=e.replace(/\.z\./,"."));for(var n=t.length;0<=--n;)D["#"+t[n]]=e;D["$"+e]=t},b.registerPackages=function(e,t){for(var n=b.getClasspathFor(e+".*",!0),i=0;i<t.length;i++)window.Clazz&&a.declarePackage(e+"."+t[i]),b.loadPackageClasspath(e+"."+t[i],n)},b.getClasspathFor=function(e,t,n){var i,r,o=D["#"+e];if(!o||t||n){if(o)e=e.replace(/\./g,"/"),(0<=(r=o.lastIndexOf(e))||0<=(r=e.lastIndexOf("/"))&&0<=(r=o.lastIndexOf(e.substring(0,r))))&&(i=o.substring(0,r));else{for(r=e.length+2;0<=(r=e.lastIndexOf(".",r-2))&&!(i=D["@"+e.substring(0,r)]););t||(e=e.replace(/\./g,"/"))}null==i&&(i=window.Clazz&&a.binaryFolders&&a.binaryFolders.length?a.binaryFolders[0]:b.binaryFolders&&b.binaryFolders.length?b.binaryFolders[0]:"j2s"),o=(i.lastIndexOf("/")==i.length-1?i:i+"/")+(t?"":e.lastIndexOf("/*")==e.length-2?e.substring(0,r+1):e+(n?"."!=n.charAt(0)?"."+n:n:".js"))}return o},b.ignore=function(){var e=(t=1==arguments.length&&arguments[0]instanceof Array?t=arguments[0]:null)?t.length:arguments.length;if(!t)for(var t=Array(e),n=0;n<e;n++)t[n]=arguments[n];for(C(t),n=0;n<e;n++)O["@"+t[n]]=1},b.onScriptLoading=function(){},b.onScriptLoaded=function(){},b.onScriptInitialized=function(){},b.onScriptCompleted=function(){},b.onClassUnloaded=function(){},b.onGlobalLoaded=function(){},b.keepOnLoading=!0;var L={},O={},U=function(c,d,e,f){if(!f)try{eval(e+";//# sourceURL="+c)}catch(t){if(a._isQuiet)return;throw c="[Java2Script] The required class file \n\n"+c+(0==e.indexOf("[Exception")&&e.indexOf("data: no")?"\nwas not found.\n":"\ncould not be loaded. Script error: "+t.message+" \n\ndata:\n\n"+e)+"\n\n"+a.getStackTrace(),alert(c),a.alert(c),t}b.onScriptLoaded(c,!1),ta(d)},ba=function(e){return function(){if("interactive"!=e.readyState){try{e.parentNode&&e.parentNode.removeChild(e)}catch(e){}e=null}}},aa=function(e){window["j2s.script.debugging"]||window.setTimeout(ba(e),1)};a._4Name=function(e,t,n){return a.isClassDefined(e)?a.evalType(e):1==(t=m._isAsync&&t?t._restoreState(e,n):null)?null:b.setLoadingMode(t?b.MODE_SCRIPT:"xhr.sync")?(b.loadClass(e,t,!1,!0,1),null):(b.loadClass(e),a.evalType(e))},a.currentPath="";var V=function(t,n,i,r,o){if(a.currentPath=n,r&&alert("WHY>>"),r=e[n],e[n]=!0,Ya(E,n),sa=!(M=!0),b._checkLoad&&System.out.println("\t"+n+(i?"\n -- required by "+i:"")+"  ajax="+M+" async="+sa),i=n,a._debugging&&(n=n.replace(/\.z\.js/,".js")),r||System.out.println("loadScript "+n),b.onScriptLoading(n),M&&!sa){var s=m._getFileData(n);try{U(n,i,s,r)}catch(e){alert(e+" loading file "+n+" "+t.name+" "+a.getStackTrace())}o&&o()}else t={dataType:"script",async:!0,type:"GET",url:n,success:ua(n,!1,o),error:ua(n,!0,o)},h++,r?setTimeout(t.success,0):m.$ajax(t)},ua=function(n,i,r){return a.getStackTrace(),function(){f&&this.timeoutHandle&&(window.clearTimeout(this.timeoutHandle),this.timeoutHandle=null),0<h&&h--,this.onerror=this.onload=null,i&&alert("There was a problem loading "+n),b.onScriptLoaded(n,!0);var e=this,t=r?function(){aa(e),ta(n,r)}:function(){aa(e),ta(n)};0<=W?window.setTimeout(function(){ta(n,t)},W):ta(n,t)}},ha=!0,ga=!1,ta=function(t,n){var i=L["@"+t];if(i){var r,o=D["$"+t];if(o)for(var l=0;l<o.length;l++){var c,u=o[l];u!=i.name&&(r=H(u))?r.status<x.STATUS_CONTENT_LOADED&&(r.status=x.STATUS_CONTENT_LOADED,updateNode(r)):((r=new x).name=u,(c=D["#"+u])||(alert(u+" J2S error in tryToLoadNext"),error("Java2Script implementation error! Please report this bug!")),r.path=c,X(r.path,u,r),r.status=x.STATUS_CONTENT_LOADED,Ja(d,r,!1),updateNode(r))}if(i instanceof Array)for(l=0;l<i.length;l++)i[l].status<x.STATUS_CONTENT_LOADED&&(i[l].status=x.STATUS_CONTENT_LOADED,updateNode(i[l]));else if(i.status<x.STATUS_CONTENT_LOADED){for(r=!1,o=document.getElementsByTagName("SCRIPT"),l=0;l<o.length;l++)if(s){if(o[l].onreadystatechange&&o[l].onreadystatechange.path==i.path&&"interactive"==o[l].readyState){r=!0;break}}else if(o[l].onload&&o[l].onload.path==i.path){r=!0;break}r||(i.status=x.STATUS_CONTENT_LOADED,updateNode(i))}if(b.keepOnLoading){if(l=!0,r=Ka(x.STATUS_KNOWN))for(S(r);h<j&&(r=Ka(x.STATUS_KNOWN));)S(r);else if(0!=E.length)r=E.shift(),!e[r.path]||0!=E.length||!ha||r.musts.length||r.optionals.length?(Ja(d,r,!0),V(r,r.path,r.requiredBy,!1)):ha=ha&&!1;else if(r=G(x.STATUS_KNOWN))for(S(r);h<j&&(r=G(x.STATUS_KNOWN));)S(r);else l=!1;if(!(l||0<h)){for(i=[Ka,G],o=null,l=0;l<2;l++)for(;r=i[l](x.STATUS_CONTENT_LOADED);)1==l&&o===r&&(r.status=x.STATUS_LOAD_COMPLETE),updateNode(r),o=r;for(;ma=[],na(d,t););for(l=0;l<2;l++)for(o=null;(r=i[l](x.STATUS_DECLARED))&&o!==r;)updateNode(o=r);for(o=[],l=0;l<2;l++)for(;r=i[l](x.STATUS_DECLARED);)o.push(r),r.status=x.STATUS_LOAD_COMPLETE;if(o.length){for(l=0;l<o.length;l++)Da(o[l]);for(l=0;l<o.length;l++)(i=o[l].onLoaded)&&(o[l].onLoaded=null,i())}if(n)n();else if(b._classCountPending){for(u in b._classPending)if(r=H(u),System.out.println("class left pending "+u+" "+r),r){updateNode(r);break}}else b._checkLoad&&(System.out.println("I think I'm done: SAEM call count: "+Q),a.showDuplicates(!0));b.onGlobalLoaded()}}}},ma=[],na=function(e,t){var n=ma,i=n.length;n.push(e);for(var r,o=i;0<=--o&&!(n[o]===e&&n[o].status>=x.STATUS_DECLARED););if(0<=o){for(b._checkLoad&&System.out.println("cycle found loading "+t+" for "+e);o<i;o++){var a=n[o];for(a.status=x.STATUS_LOAD_COMPLETE,Da(a),r=0;r<a.parents.length;r++)updateNode(a.parents[r]);a.parents=[];var s=a.onLoaded;b._checkLoad&&(r="cycle setting status to LOAD_COMPLETE for "+a.name+(s?" firing "+s.toString():""),System.out.println(r)),s&&(a.onLoaded=null,s())}return!(n.length=0)}for(a=[e.musts,e.optionals],r=0;r<2;r++)for(o=(s=a[r]).length;0<=--o;)if(s[o].status==x.STATUS_DECLARED&&na(s[o],t))return!0;return n.length=i,!1};b._classCountPending=0,b._classCountOK=0,b._classPending={},b.showPending=function(){var e,t=[];for(e in b._classPending){var n=H(e);n?(t.push(n),System.out.println(va("","",n,"",0))):alert("No node for "+e)}return t};var va=function(e,t,n,i,r){if(e+=(t+="--"+n.name)+"\n",5<r)return e+(i+" ...\n");if(e+=(i+="\t")+"status: "+n.status+"\n",n.parents&&n.parents.length&&n.parents[0]&&n.parents[0].name){e+=i+"parents: "+n.parents.length+"\n";for(var o=0;o<n.parents.length;o++)e=va(e,t,n.parents[o],i+"\t",r+1);e+="\n"}return e};updateNode=function(e){if(!e.name||e.status>=x.STATUS_LOAD_COMPLETE)Da(e);else{var t=!0;if(e.musts.length&&e.declaration)for(var n=e.musts.length,i=n;0<=--i;){var r=e.musts[i];if(r.requiredBy=e,r.status<x.STATUS_DECLARED&&isClassDefined(r.name)){var o=[];if(r.status=x.STATUS_LOAD_COMPLETE,Da(r),r.declaration&&r.declaration.clazzList){for(var a=0,s=r.declaration.clazzList,l=s.length;a<l;a++){var c=H(s[a]);c&&c.status!=x.STATUS_LOAD_COMPLETE&&c!==r&&(c.status=r.status,c.declaration=null,Da(c),c.onLoaded&&o.push(c))}r.declaration=null}for(r.onLoaded&&o.push(r),a=0;a<o.length;a++)(s=o[a].onLoaded)&&(o[a].onLoaded=null,s())}else r.status==x.STATUS_CONTENT_LOADED&&updateNode(r),r.status<x.STATUS_DECLARED&&(t=!1);e.musts.length!=n&&(i=n=e.musts.length,t=!0)}if(t){if(e.status<x.STATUS_DECLARED&&((i=e.declaration)&&(i(),i.executed=!0),b._checkLoad&&b._classPending[e.name]&&(delete b._classPending[e.name],b._classCountOK,b._classCountPending--),e.status=x.STATUS_DECLARED,B&&(B[e.name]=!0),b.onScriptInitialized(e.path),e.declaration&&e.declaration.clazzList))for(a=0,l=(s=e.declaration.clazzList).length;a<l;a++)(c=H(s[a]))&&c.status!=x.STATUS_DECLARED&&c!==e&&(c.status=x.STATUS_DECLARED,B&&(B[c.name]=!0),b.onScriptInitialized(c.path));if(t=x.STATUS_DECLARED,0==e.optionals.length&&0==e.musts.length||e.status>x.STATUS_KNOWN&&!e.declaration||Ta(e.musts,x.STATUS_LOAD_COMPLETE)&&Ta(e.optionals,x.STATUS_LOAD_COMPLETE)){if(t=x.STATUS_LOAD_COMPLETE,!wa(e,t))return!1;if(e.declaration&&e.declaration.clazzList)for(a=0,l=(s=e.declaration.clazzList).length;a<l;a++)if((c=H(s[a]))&&c.status!=t&&c!==e&&(c.declaration=null,!wa(c,t)))return!1}if(e.parents&&e.parents.length){for(i=0;i<e.parents.length;i++)(a=e.parents[i]).status<t&&updateNode(a,a.name);t==x.STATUS_LOAD_COMPLETE&&(e.parents=[])}}}};var Ta=function(e,t){for(var n=e.length;0<=--n;)if(e[n].status<t)return!1;return!0},wa=function(e,t){e.status=t,b.onScriptCompleted(e.path);var n=e.onLoaded;return!(n&&(e.onLoaded=null,n(),!b.keepOnLoading))&&(Da(e),!0)},ya={"r0.13412":1},Ba=function(){for(;;){var e=Math.random(),t="r"+e;if(!ya[t])return ya[t]=1,d.random=e}},H=function(e){return Ba(),Ea(e,d)},G=function(e){return Ba(),Ca(d,e)},Ka=function(e){return ra(d,e)},Ea=function(e,t){var n;return t.name==e?t:(n=$a(e,t.musts))||(n=$a(e,t.optionals))?n:null},$a=function(e,t){for(var n=d.random,i=t.length;0<=--i;){var r=t[i];if(r.name==e||r.random!=n&&(r.random=n,r=Ea(e,r)))return r}return null},Aa=function(t,n){return!(t.status!=n||n==x.STATUS_KNOWN&&e[t.path]||n!=x.STATUS_DECLARED&&isClassDefined(t.name))},ra=function(e,t){for(var n=e.musts.length;0<=--n;){var i=e.musts[n];if(Aa(i,t)||(i=ra(i,t)))return i}return Aa(e,t)?e:null},Ca=function(e,t){var n;return(n=oa(e.musts,t))||(n=oa(e.optionals,t))||Aa(n=e,t)?n:null},oa=function(e,t){if(e)for(var n=d.random,i=0;i<e.length;i++){var r=e[i];if(Aa(r,t)||r.random!=n&&(r.random=n,r=Ca(r,t)))return r}return null},R=function(e,t,n,i){if(t instanceof Array){C(t);for(var r=0;r<t.length;r++)R(e,t[r],n,i,t)}else b._checkLoad&&!b._classPending[t]&&(b._classPending[t]=1,0==b._classCountPending++&&(b._classCountOK=0),System.out.println("Loading class "+t)),(r=L["#"+t])||((r=(r=H(t))?r:new x).name=t,r.path=D["#"+t]||"unknown",X(r.path,t,r),r.status=x.STATUS_KNOWN,Ja(d,r,!1)),ja(r,e,!0),5==arguments.length&&i&&(i.status=r.status,i.clazzList=arguments[4]),(r.declaration=i)&&(r.status=x.STATUS_CONTENT_LOADED),ja(r,n,!1)},ja=function(e,t,n){if(t&&t.length){C(t);for(var i=0;i<t.length;i++){var r,o=t[i];!o||isClassDefined(o)||O["@"+o]||((r=H(o))||((r=new x).name=o,r.status=x.STATUS_KNOWN),r.requiredBy=e,Ja(e,r,n))}}};window.Clazz?a.load=R:b.load=R;var X=function(e,t,n){if(e=L[i="@"+e])if(e instanceof Array){for(var i=!1,r=0;r<e.length;r++)if(e[r].name==t){i=!0;break}i||e.push(n)}else L[i]=[e,n];else L[i]=n;L["#"+t]=n},S=function(t){var n=t.name;if(!isClassDefined(n)&&!O["@"+n]){var i=b.getClasspathFor(n);if(t.path=i,X(i,n,t),!e[i])return V(t,i,t.requiredBy,!1),!0}return!1},da=b.runtimeKeyClass="java.lang.String",La=[];b.getJ2SLibBase=function(){var e=window["j2s.lib"];return e?e.base+("."==e.alias?"":(e.alias?e.alias:e.version?e.version:"1.0.0")+"/"):null};var sa=!0,M=!1,W=-1;b.MODE_SCRIPT=4,b.MODE_XHR=2,b.MODE_SYNC=1,b.setLoadingMode=function(e,t){var n=!0,i=!0;return"string"==typeof e?(0<=(e=e.toLowerCase()).indexOf("script")?i=!1:e.indexOf("async"),n=!1):e&b.MODE_SCRIPT?i=!1:n=!(e&b.MODE_SYNC),M=i,W=(sa=n)&&0<=t?t:-1,n};var ca=function(){if(!I&&isClassDefined(da)){for(var e=La,t=0;t<e.length;t++)b.loadClass(e[t][0],e[t][1]);La=[]}};b.loadZJar=function(e,t){var n=null,i=t instanceof Array;i?t=t[t.length-1]:n=t==da?ca:null,b.jarClasspath(e,i?t:[t]),b.loadClass(t,n,!0)};var Fa={},Pa=[],Ja=function(e,t,n){var i=!1;n?(n=e.musts,t.requiredBy||(t.requiredBy=e)):n=e.optionals,Fa[t.name]||(Pa.push(t),Fa[t.name]=t);for(var r=0;r<n.length;r++)if(n[r].name==t.name){i=!0;break}i||(n.push(t),ha&&0!=t.name.indexOf("java")&&0!=t.name.indexOf("net.sf.j2s.ajax")&&(ga&&(ha=!1),ga=!0));e:{if(e.name&&e!=d&&e!=t)for(i=0;i<t.parents.length;i++)if(t.parents[i].name==e.name)break e;t.parents.push(e)}},Da=function(e){var t=e.parents;if(t)for(var n=t.length;0<=--n;)Ya(t[n].musts,e)||Ya(t[n].optionals,e)};a.binaryFolders=b.binaryFolders=[b.getJ2SLibBase()]}(a,a._Loader),a._LoaderProgressMonitor={};var aa=a._LoaderProgressMonitor,L=null,ga=0,O=null,wa=0;aa.DEFAULT_OPACITY=m&&m._j2sLoadMonitorOpacity?m._j2sLoadMonitorOpacity:55,aa.hideMonitor=function(){O.style.display="none"},aa.showStatus=function(e,t){var n,i,r,o,a;O||((a=document.createElement("DIV")).id="_Loader-status",a.style.cssText="position:absolute;bottom:4px;left:4px;padding:2px 8px;z-index:"+(window["j2s.lib"].monitorZIndex||1e4)+";background-color:#8e0000;color:yellow;font-family:Arial, sans-serif;font-size:10pt;white-space:nowrap;",a.onmouseover=ub,O=a,document.body.appendChild(a),ya=ya||!0),jb(O),null==e?t?na():aa.hideMonitor():(O.appendChild(document.createTextNode(""+e)),"none"==O.style.display&&(O.style.display=""),kb(aa.DEFAULT_OPACITY),a=navigator.userAgent,r=(i=(n=document.body).parentNode).clientHeight,n=n.scrollTop+n.offsetTop,o=i.scrollTop+i.offsetTop,a=a.indexOf("Opera")<0&&document.all?0==r?n:o:!(a.indexOf("Gecko")<0)||r==i.offsetHeight&&r==i.scrollHeight?n:o,wa!=a&&(wa=a,O.style.bottom=wa+4+"px"),t&&na())};var jb=function(e){if(e)for(var t=e.childNodes.length;0<=--t;){var n=e.childNodes[t];if(n){n.childNodes&&n.childNodes.length&&jb(n);try{e.removeChild(n)}catch(e){}}}},kb=function(e){L&&e==aa.DEFAULT_OPACITY&&(window.clearTimeout(L),L=null),ga=e,navigator.userAgent.toLowerCase(),O.style.filter="Alpha(Opacity="+e+")",O.style.opacity=e/100},ub=function(){aa.hideMonitor()},ya=!1,na=function(){"none"!=O.style.display&&(ga==aa.DEFAULT_OPACITY?(L=window.setTimeout(function(){na()},750),ga-=5):0<=ga-10?(kb(ga-10),L=window.setTimeout(function(){na()},40)):O.style.display="none")},C=a.Console,ba=System;C.maxTotalLines=1e4,C.setMaxTotalLines=function(e){C.maxTotalLines=0<e?e:999999},C.maxLatency=40,C.setMaxLatency=function(e){C.maxLatency=0<e?e:40},C.pinning=!1,C.enablePinning=function(e){C.pinning=e},C.linesCount=0,C.metLineBreak=!1,C.createConsoleWindow=function(){var e=document.createElement("DIV");return e.style.cssText="font-family:monospace, Arial, sans-serif;",document.body.appendChild(e),e};var V=String.fromCharCode(160),V=V+(V+V+V);C.consoleOutput=function(e,t){var n=window["j2s.lib"];if((n=n&&n.console)&&"string"==typeof n&&(n=document.getElementById(n)),!n)return!1;if(C.linesCount>C.maxTotalLines){for(var i=0;i<C.linesCount-C.maxTotalLines;i++)n&&0<n.childNodes.length&&n.removeChild(n.childNodes[0]);C.linesCount=C.maxTotalLines}var r=!1;if(0<(e=(void 0===e?"":null==e?"null":""+e).replace(/\t/g,V)).length)switch(e.charAt(e.length-1)){case"\n":case"\r":e=1<e.length?e.substring(0,e.length-("\r"==e.charAt(e.length-2)?2:1)):"",r=!0}for(var o=null,i=0,a=(o=(e=e.replace(/\t/g,V)).split(/\r\n|\r|\n/g)).length-1;i<=a;i++){var s=null;if(C.metLineBreak||0==C.linesCount||n.childNodes.length<1)s=document.createElement("DIV"),n.appendChild(s),s.style.whiteSpace="nowrap",C.linesCount++;else try{s=n.childNodes[n.childNodes.length-1]}catch(e){s=document.createElement("DIV"),n.appendChild(s),s.style.whiteSpace="nowrap",C.linesCount++}var l=document.createElement("SPAN");s.appendChild(l),l.style.whiteSpace="nowrap",t&&(l.style.color=t),0==(s=o[i]).length&&(s=V),l.appendChild(document.createTextNode(s)),C.pinning||(n.scrollTop+=100),C.metLineBreak=i!=a||r}i=n.parentNode.className,!C.pinning&&i&&-1!=i.indexOf("composite")&&(n.parentNode.scrollTop=n.parentNode.scrollHeight),C.lastOutputTime=(new Date).getTime()},C.clear=function(){try{C.metLineBreak=!0;var e=window["j2s.lib"],t=e&&e.console;if(t=t&&document.getElementById(t)){for(var n=t.childNodes,i=n.length;0<=--i;)t.removeChild(n[i]);C.linesCount=0}}catch(e){}},a.alert=function(e){C.consoleOutput(e+"\r\n")},ba.out.print=function(e){C.consoleOutput(e)},ba.out.println=function(e){C.consoleOutput(void 0===e?"\r\n":null==e?"null\r\n":e+"\r\n")},ba.out.write=function(e,t,n){ba.out.print(String.instantialize(e).substring(t,t+n))},ba.err.__CLASS_NAME__="java.io.PrintStream",ba.err.print=function(e){C.consoleOutput(e,"red")},ba.err.println=function(e){C.consoleOutput(void 0===e?"\r\n":null==e?"null\r\n":e+"\r\n","red")},ba.err.write=function(e,t,n){ba.err.print(String.instantialize(e).substring(t,t+n))}}(Clazz,Jmol))},Jmol.___JmolDate="$Date: 2020-05-27 14:50:46 -0500 (Wed, 27 May 2020) $",Jmol.___fullJmolProperties="src/org/jmol/viewer/Jmol.properties",Jmol.___JmolVersion="14.31.2";var Detector={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{return!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(e){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var e="Your browser supports WebGL";return this.webgl||(e=window.WebGLRenderingContext?'Your graphics card does not seem to support <a class="link" href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation">WebGL</a>. Find out how to get it <a class="link" href="http://get.webgl.org/">here</a>.':'Your browser does not seem to support <a class="link" href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation">WebGL</a>. Find out how to get it <a class="link" href="http://get.webgl.org/">here</a>.'),e}};var THREE=THREE||{REVISION:"49"};self.Int32Array||(self.Int32Array=Array,self.Float32Array=Array),function(){for(var r=0,e=["ms","moz","webkit","o"],t=0;t<e.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[e[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[t]+"CancelAnimationFrame"]||window[e[t]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var t=Date.now(),n=Math.max(0,16-(t-r)),i=window.setTimeout(function(){e(t+n)},n);return r=t+n,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),THREE.Clock=function(e){this.autoStart=void 0===e||e,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1},THREE.Clock.prototype.start=function(){this.oldTime=this.startTime=Date.now(),this.running=!0},THREE.Clock.prototype.stop=function(){this.getElapsedTime(),this.running=!1},THREE.Clock.prototype.getElapsedTime=function(){return this.elapsedTime=this.elapsedTime+this.getDelta()},THREE.Clock.prototype.getDelta=function(){var e,t=0;return this.autoStart&&!this.running&&this.start(),this.running&&(t=.001*((e=Date.now())-this.oldTime),this.oldTime=e,this.elapsedTime=this.elapsedTime+t),t},THREE.Color=function(e){return void 0!==e&&this.setHex(e),this},THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e){return this.r=e.r*e.r,this.g=e.g*e.g,this.b=e.b*e.b,this},copyLinearToGamma:function(e){return this.r=Math.sqrt(e.r),this.g=Math.sqrt(e.g),this.b=Math.sqrt(e.b),this},convertGammaToLinear:function(){var e=this.r,t=this.g,n=this.b;return this.r=e*e,this.g=t*t,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSV:function(e,t,n){var i,r,o;if(0===n)this.r=this.g=this.b=0;else switch(r=6*e-(i=Math.floor(6*e)),e=n*(1-t),o=n*(1-t*r),t=n*(1-t*(1-r)),i){case 1:this.r=o,this.g=n,this.b=e;break;case 2:this.r=e,this.g=n,this.b=t;break;case 3:this.r=e,this.g=o,this.b=n;break;case 4:this.r=t,this.g=e,this.b=n;break;case 5:this.r=n,this.g=e,this.b=o;break;case 6:case 0:this.r=n,this.g=t,this.b=e}return this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},lerpSelf:function(e,t){return this.r=this.r+(e.r-this.r)*t,this.g=this.g+(e.g-this.g)*t,this.b=this.b+(e.b-this.b)*t,this},getHex:function(){return Math.floor(255*this.r)<<16^Math.floor(255*this.g)<<8^Math.floor(255*this.b)},getContextStyle:function(){return"rgb("+Math.floor(255*this.r)+","+Math.floor(255*this.g)+","+Math.floor(255*this.b)+")"},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}},THREE.Vector2=function(e,t){this.x=e||0,this.y=t||0},THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(e,t){return this.x=e,this.y=t,this},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addSelf:function(e){return this.x=this.x+e.x,this.y=this.y+e.y,this},sub:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},subSelf:function(e){return this.x=this.x-e.x,this.y=this.y-e.y,this},multiplyScalar:function(e){return this.x=this.x*e,this.y=this.y*e,this},divideScalar:function(e){return e?(this.x=this.x/e,this.y=this.y/e):this.set(0,0),this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSq())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x;return t*t+(e=this.y-e.y)*e},setLength:function(e){return this.normalize().multiplyScalar(e)},lerpSelf:function(e,t){return this.x=this.x+(e.x-this.x)*t,this.y=this.y+(e.y-this.y)*t,this},equals:function(e){return e.x===this.x&&e.y===this.y},isZero:function(){return this.lengthSq()<1e-4},clone:function(){return new THREE.Vector2(this.x,this.y)}},THREE.Vector3=function(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0},THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addSelf:function(e){return this.x=this.x+e.x,this.y=this.y+e.y,this.z=this.z+e.z,this},addScalar:function(e){return this.x=this.x+e,this.y=this.y+e,this.z=this.z+e,this},sub:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},subSelf:function(e){return this.x=this.x-e.x,this.y=this.y-e.y,this.z=this.z-e.z,this},multiply:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},multiplySelf:function(e){return this.x=this.x*e.x,this.y=this.y*e.y,this.z=this.z*e.z,this},multiplyScalar:function(e){return this.x=this.x*e,this.y=this.y*e,this.z=this.z*e,this},divideSelf:function(e){return this.x=this.x/e.x,this.y=this.y/e.y,this.z=this.z/e.z,this},divideScalar:function(e){return e?(this.x=this.x/e,this.y=this.y/e,this.z=this.z/e):this.z=this.y=this.x=0,this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.lengthSq())},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){return this.normalize().multiplyScalar(e)},lerpSelf:function(e,t){return this.x=this.x+(e.x-this.x)*t,this.y=this.y+(e.y-this.y)*t,this.z=this.z+(e.z-this.z)*t,this},cross:function(e,t){return this.x=e.y*t.z-e.z*t.y,this.y=e.z*t.x-e.x*t.z,this.z=e.x*t.y-e.y*t.x,this},crossSelf:function(e){var t=this.x,n=this.y,i=this.z;return this.x=n*e.z-i*e.y,this.y=i*e.x-t*e.z,this.z=t*e.y-n*e.x,this},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){return(new THREE.Vector3).sub(this,e).lengthSq()},getPositionFromMatrix:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this},getRotationFromMatrix:function(e,t){var n=t?t.x:1,i=t?t.y:1,r=t?t.z:1,o=e.elements[0]/n,a=e.elements[4]/i,n=e.elements[1]/n,i=e.elements[5]/i,s=e.elements[9]/r,l=e.elements[10]/r;return this.y=Math.asin(e.elements[8]/r),r=Math.cos(this.y),1e-5<Math.abs(r)?(this.x=Math.atan2(-s/r,l/r),this.z=Math.atan2(-a/r,o/r)):(this.x=0,this.z=Math.atan2(n,i)),this},getScaleFromMatrix:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),n=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),e=this.set(e.elements[8],e.elements[9],e.elements[10]).length();this.x=t,this.y=n,this.z=e},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},isZero:function(){return this.lengthSq()<1e-4},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}},THREE.Vector4=function(e,t,n,i){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==i?i:1},THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addSelf:function(e){return this.x=this.x+e.x,this.y=this.y+e.y,this.z=this.z+e.z,this.w=this.w+e.w,this},sub:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},subSelf:function(e){return this.x=this.x-e.x,this.y=this.y-e.y,this.z=this.z-e.z,this.w=this.w-e.w,this},multiplyScalar:function(e){return this.x=this.x*e,this.y=this.y*e,this.z=this.z*e,this.w=this.w*e,this},divideScalar:function(e){return e?(this.x=this.x/e,this.y=this.y/e,this.z=this.z/e,this.w=this.w/e):(this.z=this.y=this.x=0,this.w=1),this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.dot(this)},length:function(){return Math.sqrt(this.lengthSq())},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){return this.normalize().multiplyScalar(e)},lerpSelf:function(e,t){return this.x=this.x+(e.x-this.x)*t,this.y=this.y+(e.y-this.y)*t,this.z=this.z+(e.z-this.z)*t,this.w=this.w+(e.w-this.w)*t,this},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}},THREE.Frustum=function(){this.planes=[new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4]},THREE.Frustum.prototype.setFromMatrix=function(e){var t=this.planes,e=(g=e.elements)[0],n=g[1],i=g[2],r=g[3],o=g[4],a=g[5],s=g[6],l=g[7],c=g[8],u=g[9],h=g[10],f=g[11],d=g[12],p=g[13],m=g[14],g=g[15];for(t[0].set(r-e,l-o,f-c,g-d),t[1].set(r+e,l+o,f+c,g+d),t[2].set(r+n,l+a,f+u,g+p),t[3].set(r-n,l-a,f-u,g-p),t[4].set(r-i,l-s,f-h,g-m),t[5].set(r+i,l+s,f+h,g+m),e=0;e<6;e++)(n=t[e]).divideScalar(Math.sqrt(n.x*n.x+n.y*n.y+n.z*n.z))},THREE.Frustum.prototype.contains=function(e){for(var t=this.planes,n=(i=e.matrixWorld).elements,i=-e.geometry.boundingSphere.radius*i.getMaxScaleOnAxis(),r=0;r<6;r++)if((e=t[r].x*n[12]+t[r].y*n[13]+t[r].z*n[14]+t[r].w)<=i)return!1;return!0},THREE.Frustum.__v1=new THREE.Vector3,THREE.Ray=function(e,t){function u(e,t,n){return C.sub(n,e),i=C.dot(t),r=S.add(e,D.copy(t).multiplyScalar(i)),n.distanceTo(r)}function h(e,t,n,i){return C.sub(i,t),S.sub(n,t),D.sub(e,t),o=C.dot(C),a=C.dot(S),s=C.dot(D),l=S.dot(S),c=S.dot(D),w=(o*c-a*s)*(E=1/(o*l-a*a)),0<=(T=(l*s-a*c)*E)&&0<=w&&T+w<1}this.origin=e||new THREE.Vector3,this.direction=t||new THREE.Vector3;var f=1e-4;this.setPrecision=function(e){f=e};var d=new THREE.Vector3,p=new THREE.Vector3,m=new THREE.Vector3,g=new THREE.Vector3,v=new THREE.Vector3,_=new THREE.Vector3,y=new THREE.Vector3,b=new THREE.Vector3,x=new THREE.Vector3;this.intersectObject=function(e){var t,n=[];if(e instanceof THREE.Particle){if((i=u(this.origin,this.direction,e.matrixWorld.getPosition()))>e.scale.x)return[];t={distance:i,point:e.position,face:null,object:e},n.push(t)}else if(e instanceof THREE.Mesh){var i=u(this.origin,this.direction,e.matrixWorld.getPosition()),r=THREE.Frustum.__v1.set(e.matrixWorld.getColumnX().length(),e.matrixWorld.getColumnY().length(),e.matrixWorld.getColumnZ().length());if(i>e.geometry.boundingSphere.radius*Math.max(r.x,Math.max(r.y,r.z)))return n;var o,a,s,l=e.geometry,c=l.vertices;for(e.matrixRotationWorld.extractRotation(e.matrixWorld),i=0,r=l.faces.length;i<r;i++)t=l.faces[i],v.copy(this.origin),_.copy(this.direction),s=e.matrixWorld,y=s.multiplyVector3(y.copy(t.centroid)).subSelf(v),b=e.matrixRotationWorld.multiplyVector3(b.copy(t.normal)),o=_.dot(b),Math.abs(o)<f||(a=b.dot(y)/o)<0||!e.doubleSided&&!(e.flipSided?0<o:o<0)||(x.add(v,_.multiplyScalar(a)),t instanceof THREE.Face3?(d=s.multiplyVector3(d.copy(c[t.a])),p=s.multiplyVector3(p.copy(c[t.b])),m=s.multiplyVector3(m.copy(c[t.c])),h(x,d,p,m)&&(t={distance:v.distanceTo(x),point:x.clone(),face:t,object:e},n.push(t))):t instanceof THREE.Face4&&(d=s.multiplyVector3(d.copy(c[t.a])),p=s.multiplyVector3(p.copy(c[t.b])),m=s.multiplyVector3(m.copy(c[t.c])),g=s.multiplyVector3(g.copy(c[t.d])),(h(x,d,p,g)||h(x,p,m,g))&&(t={distance:v.distanceTo(x),point:x.clone(),face:t,object:e},n.push(t))))}return n},this.intersectObjects=function(e){for(var t=[],n=0,i=e.length;n<i;n++)Array.prototype.push.apply(t,this.intersectObject(e[n]));return t.sort(function(e,t){return e.distance-t.distance}),t};var i,r,o,a,s,l,c,E,T,w,C=new THREE.Vector3,S=new THREE.Vector3,D=new THREE.Vector3},THREE.Rectangle=function(){function a(){e=c-s,t=u-l}var s,l,c,u,e,t,h=!0;this.getX=function(){return s},this.getY=function(){return l},this.getWidth=function(){return e},this.getHeight=function(){return t},this.getLeft=function(){return s},this.getTop=function(){return l},this.getRight=function(){return c},this.getBottom=function(){return u},this.set=function(e,t,n,i){h=!1,s=e,l=t,c=n,u=i,a()},this.addPoint=function(e,t){u=h?(h=!1,c=s=e,l=t):(s=s<e?s:e,l=l<t?l:t,c=e<c?c:e,t<u?u:t),a()},this.add3Points=function(e,t,n,i,r,o){u=h?(h=!1,s=e<n?e<r?e:r:n<r?n:r,l=t<i?t<o?t:o:i<o?i:o,c=n<e?r<e?e:r:r<n?n:r,i<t?o<t?t:o:o<i?i:o):(s=e<n?e<r?e<s?e:s:r<s?r:s:n<r?n<s?n:s:r<s?r:s,l=t<i?t<o?t<l?t:l:o<l?o:l:i<o?i<l?i:l:o<l?o:l,c=n<e?r<e?c<e?e:c:c<r?r:c:r<n?c<n?n:c:c<r?r:c,i<t?o<t?u<t?t:u:u<o?o:u:o<i?u<i?i:u:u<o?o:u),a()},this.addRectangle=function(e){u=h?(h=!1,s=e.getLeft(),l=e.getTop(),c=e.getRight(),e.getBottom()):(s=s<e.getLeft()?s:e.getLeft(),l=l<e.getTop()?l:e.getTop(),c=c>e.getRight()?c:e.getRight(),u>e.getBottom()?u:e.getBottom()),a()},this.inflate=function(e){s-=e,l-=e,c+=e,u+=e,a()},this.minSelf=function(e){s=s>e.getLeft()?s:e.getLeft(),l=l>e.getTop()?l:e.getTop(),c=c<e.getRight()?c:e.getRight(),u=u<e.getBottom()?u:e.getBottom(),a()},this.intersects=function(e){return!(c<e.getLeft()||s>e.getRight()||u<e.getTop()||l>e.getBottom())},this.empty=function(){h=!0,u=c=l=s=0,a()},this.isEmpty=function(){return h}},THREE.Math={clamp:function(e,t,n){return e<t?t:n<e?n:e},clampBottom:function(e,t){return e<t?t:e},mapLinear:function(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},sign:function(e){return e<0?-1:0<e?1:0}},THREE.Matrix3=function(){this.elements=new Float32Array(9)},THREE.Matrix3.prototype={constructor:THREE.Matrix3,getInverse:function(e){var e=(c=e.elements)[10]*c[5]-c[6]*c[9],t=-c[10]*c[1]+c[2]*c[9],n=c[6]*c[1]-c[2]*c[5],i=-c[10]*c[4]+c[6]*c[8],r=c[10]*c[0]-c[2]*c[8],o=-c[6]*c[0]+c[2]*c[4],a=c[9]*c[4]-c[5]*c[8],s=-c[9]*c[0]+c[1]*c[8],l=c[5]*c[0]-c[1]*c[4],c=1/(c=c[0]*e+c[1]*i+c[2]*a),u=this.elements;return u[0]=c*e,u[1]=c*t,u[2]=c*n,u[3]=c*i,u[4]=c*r,u[5]=c*o,u[6]=c*a,u[7]=c*s,u[8]=c*l,this},transpose:function(){var e=this.elements,t=e[1];return e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},transposeIntoArray:function(e){var t=this.m;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}},THREE.Matrix4=function(e,t,n,i,r,o,a,s,l,c,u,h,f,d,p,m){this.elements=new Float32Array(16),this.set(void 0!==e?e:1,t||0,n||0,i||0,r||0,void 0!==o?o:1,a||0,s||0,l||0,c||0,void 0!==u?u:1,h||0,f||0,d||0,p||0,void 0!==m?m:1)},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(e,t,n,i,r,o,a,s,l,c,u,h,f,d,p,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=i,g[1]=r,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=f,g[7]=d,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(e){return e=e.elements,this.set(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]),this},lookAt:function(e,t,n){var i=this.elements,r=THREE.Matrix4.__v1,o=THREE.Matrix4.__v2,a=THREE.Matrix4.__v3;return a.sub(e,t).normalize(),0===a.length()&&(a.z=1),r.cross(n,a).normalize(),0===r.length()&&(a.x=a.x+1e-4,r.cross(n,a).normalize()),o.cross(a,r),i[0]=r.x,i[4]=o.x,i[8]=a.x,i[1]=r.y,i[5]=o.y,i[9]=a.y,i[2]=r.z,i[6]=o.z,i[10]=a.z,this},multiply:function(e,t){var n=e.elements,i=t.elements,r=this.elements,o=n[0],a=n[4],s=n[8],l=n[12],c=n[1],u=n[5],h=n[9],f=n[13],d=n[2],p=n[6],m=n[10],g=n[14],v=n[3],_=n[7],y=n[11],n=n[15],b=i[0],x=i[4],E=i[8],T=i[12],w=i[1],C=i[5],S=i[9],D=i[13],R=i[2],A=i[6],M=i[10],L=i[14],H=i[3],F=i[7],P=i[11],i=i[15];return r[0]=o*b+a*w+s*R+l*H,r[4]=o*x+a*C+s*A+l*F,r[8]=o*E+a*S+s*M+l*P,r[12]=o*T+a*D+s*L+l*i,r[1]=c*b+u*w+h*R+f*H,r[5]=c*x+u*C+h*A+f*F,r[9]=c*E+u*S+h*M+f*P,r[13]=c*T+u*D+h*L+f*i,r[2]=d*b+p*w+m*R+g*H,r[6]=d*x+p*C+m*A+g*F,r[10]=d*E+p*S+m*M+g*P,r[14]=d*T+p*D+m*L+g*i,r[3]=v*b+_*w+y*R+n*H,r[7]=v*x+_*C+y*A+n*F,r[11]=v*E+_*S+y*M+n*P,r[15]=v*T+_*D+y*L+n*i,this},multiplySelf:function(e){return this.multiply(this,e)},multiplyToArray:function(e,t,n){var i=this.elements;return this.multiply(e,t),n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this},multiplyScalar:function(e){var t=this.elements;return t[0]=t[0]*e,t[4]=t[4]*e,t[8]=t[8]*e,t[12]=t[12]*e,t[1]=t[1]*e,t[5]=t[5]*e,t[9]=t[9]*e,t[13]=t[13]*e,t[2]=t[2]*e,t[6]=t[6]*e,t[10]=t[10]*e,t[14]=t[14]*e,t[3]=t[3]*e,t[7]=t[7]*e,t[11]=t[11]*e,t[15]=t[15]*e,this},multiplyVector3:function(e){var t=this.elements,n=e.x,i=e.y,r=e.z,o=1/(t[3]*n+t[7]*i+t[11]*r+t[15]);return e.x=(t[0]*n+t[4]*i+t[8]*r+t[12])*o,e.y=(t[1]*n+t[5]*i+t[9]*r+t[13])*o,e.z=(t[2]*n+t[6]*i+t[10]*r+t[14])*o,e},multiplyVector4:function(e){var t=this.elements,n=e.x,i=e.y,r=e.z,o=e.w;return e.x=t[0]*n+t[4]*i+t[8]*r+t[12]*o,e.y=t[1]*n+t[5]*i+t[9]*r+t[13]*o,e.z=t[2]*n+t[6]*i+t[10]*r+t[14]*o,e.w=t[3]*n+t[7]*i+t[11]*r+t[15]*o,e},rotateAxis:function(e){var t=this.elements,n=e.x,i=e.y,r=e.z;return e.x=n*t[0]+i*t[4]+r*t[8],e.y=n*t[1]+i*t[5]+r*t[9],e.z=n*t[2]+i*t[6]+r*t[10],e.normalize(),e},crossVector:function(e){var t=this.elements,n=new THREE.Vector4;return n.x=t[0]*e.x+t[4]*e.y+t[8]*e.z+t[12]*e.w,n.y=t[1]*e.x+t[5]*e.y+t[9]*e.z+t[13]*e.w,n.z=t[2]*e.x+t[6]*e.y+t[10]*e.z+t[14]*e.w,n.w=e.w?t[3]*e.x+t[7]*e.y+t[11]*e.z+t[15]*e.w:1,n},determinant:function(){var e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],o=e[1],a=e[5],s=e[9],l=e[13],c=e[2],u=e[6],h=e[10],f=e[14],d=e[3],p=e[7],m=e[11];return r*s*u*d-i*l*u*d-r*a*h*d+n*l*h*d+i*a*f*d-n*s*f*d-r*s*c*p+i*l*c*p+r*o*h*p-t*l*h*p-i*o*f*p+t*s*f*p+r*a*c*m-n*l*c*m-r*o*u*m+t*l*u*m+n*o*f*m-t*a*f*m-i*a*c*(e=e[15])+n*s*c*e+i*o*u*e-t*s*u*e-n*o*h*e+t*a*h*e},transpose:function(){var e=this.elements,t=e[1];return e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},flattenToArrayOffset:function(e,t){var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e},getPosition:function(){var e=this.elements;return THREE.Matrix4.__v1.set(e[12],e[13],e[14])},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getColumnX:function(){var e=this.elements;return THREE.Matrix4.__v1.set(e[0],e[1],e[2])},getColumnY:function(){var e=this.elements;return THREE.Matrix4.__v1.set(e[4],e[5],e[6])},getColumnZ:function(){var e=this.elements;return THREE.Matrix4.__v1.set(e[8],e[9],e[10])},getInverse:function(e){var t=this.elements,n=(v=e.elements)[0],i=v[4],r=v[8],o=v[12],a=v[1],s=v[5],l=v[9],c=v[13],u=v[2],h=v[6],f=v[10],d=v[14],p=v[3],m=v[7],g=v[11],v=v[15];return t[0]=l*d*m-c*f*m+c*h*g-s*d*g-l*h*v+s*f*v,t[4]=o*f*m-r*d*m-o*h*g+i*d*g+r*h*v-i*f*v,t[8]=r*c*m-o*l*m+o*s*g-i*c*g-r*s*v+i*l*v,t[12]=o*l*h-r*c*h-o*s*f+i*c*f+r*s*d-i*l*d,t[1]=c*f*p-l*d*p-c*u*g+a*d*g+l*u*v-a*f*v,t[5]=r*d*p-o*f*p+o*u*g-n*d*g-r*u*v+n*f*v,t[9]=o*l*p-r*c*p-o*a*g+n*c*g+r*a*v-n*l*v,t[13]=r*c*u-o*l*u+o*a*f-n*c*f-r*a*d+n*l*d,t[2]=s*d*p-c*h*p+c*u*m-a*d*m-s*u*v+a*h*v,t[6]=o*h*p-i*d*p-o*u*m+n*d*m+i*u*v-n*h*v,t[10]=i*c*p-o*s*p+o*a*m-n*c*m-i*a*v+n*s*v,t[14]=o*s*u-i*c*u-o*a*h+n*c*h+i*a*d-n*s*d,t[3]=l*h*p-s*f*p-l*u*m+a*f*m+s*u*g-a*h*g,t[7]=i*f*p-r*h*p+r*u*m-n*f*m-i*u*g+n*h*g,t[11]=r*s*p-i*l*p-r*a*m+n*l*m+i*a*g-n*s*g,t[15]=i*l*u-r*s*u+r*a*h-n*l*h-i*a*f+n*s*f,this.multiplyScalar(1/e.determinant()),this},setRotationFromEuler:function(e,t){var n=this.elements,i=e.x,r=e.y,o=e.z,a=Math.cos(i),i=Math.sin(i),s=Math.cos(r),r=Math.sin(r),l=Math.cos(o),o=Math.sin(o);switch(t){case"YXZ":var c=s*l,u=s*o,h=r*l,f=r*o;n[0]=c+f*i,n[4]=h*i-u,n[8]=a*r,n[1]=a*o,n[5]=a*l,n[9]=-i,n[2]=u*i-h,n[6]=f+c*i,n[10]=a*s;break;case"ZXY":c=s*l,u=s*o,h=r*l,f=r*o,n[0]=c-f*i,n[4]=-a*o,n[8]=h+u*i,n[1]=u+h*i,n[5]=a*l,n[9]=f-c*i,n[2]=-a*r,n[6]=i,n[10]=a*s;break;case"ZYX":c=a*l,u=a*o,h=i*l,f=i*o,n[0]=s*l,n[4]=h*r-u,n[8]=c*r+f,n[1]=s*o,n[5]=f*r+c,n[9]=u*r-h,n[2]=-r,n[6]=i*s,n[10]=a*s;break;case"YZX":c=a*s,u=a*r,h=i*s,f=i*r,n[0]=s*l,n[4]=f-c*o,n[8]=h*o+u,n[1]=o,n[5]=a*l,n[9]=-i*l,n[2]=-r*l,n[6]=u*o+h,n[10]=c-f*o;break;case"XZY":c=a*s,u=a*r,h=i*s,f=i*r,n[0]=s*l,n[4]=-o,n[8]=r*l,n[1]=c*o+f,n[5]=a*l,n[9]=u*o-h,n[2]=h*o-u,n[6]=i*l,n[10]=f*o+c;break;default:c=a*l,u=a*o,h=i*l,f=i*o,n[0]=s*l,n[4]=-s*o,n[8]=r,n[1]=u+h*r,n[5]=c-f*r,n[9]=-i*s,n[2]=f-c*r,n[6]=h+u*r,n[10]=a*s}return this},setRotationFromQuaternion:function(e){var t=this.elements,n=e.x,i=e.y,r=e.z,o=e.w,a=r+r,e=n*(c=n+n),s=n*(u=i+i),n=n*a,l=i*u,i=i*a,r=r*a,c=o*c,u=o*u,o=o*a;return t[0]=1-(l+r),t[4]=s-o,t[8]=n+u,t[1]=s+o,t[5]=1-(e+r),t[9]=i-c,t[2]=n-u,t[6]=i+c,t[10]=1-(e+l),this},compose:function(e,t,n){var i=this.elements,r=THREE.Matrix4.__m1,o=THREE.Matrix4.__m2;return r.identity(),r.setRotationFromQuaternion(t),o.makeScale(n.x,n.y,n.z),this.multiply(r,o),i[12]=e.x,i[13]=e.y,i[14]=e.z,this},decompose:function(e,t,n){var i=this.elements,r=THREE.Matrix4.__v1,o=THREE.Matrix4.__v2,a=THREE.Matrix4.__v3;return r.set(i[0],i[1],i[2]),o.set(i[4],i[5],i[6]),a.set(i[8],i[9],i[10]),e=e instanceof THREE.Vector3?e:new THREE.Vector3,t=t instanceof THREE.Quaternion?t:new THREE.Quaternion,(n=n instanceof THREE.Vector3?n:new THREE.Vector3).x=r.length(),n.y=o.length(),n.z=a.length(),e.x=i[12],e.y=i[13],e.z=i[14],(i=THREE.Matrix4.__m1).copy(this),i.elements[0]=i.elements[0]/n.x,i.elements[1]=i.elements[1]/n.x,i.elements[2]=i.elements[2]/n.x,i.elements[4]=i.elements[4]/n.y,i.elements[5]=i.elements[5]/n.y,i.elements[6]=i.elements[6]/n.y,i.elements[8]=i.elements[8]/n.z,i.elements[9]=i.elements[9]/n.z,i.elements[10]=i.elements[10]/n.z,t.setFromRotationMatrix(i),[e,t,n]},extractPosition:function(e){var t=this.elements,e=e.elements;return t[12]=e[12],t[13]=e[13],t[14]=e[14],this},extractRotation:function(e){var t=this.elements,e=e.elements,n=1/(r=THREE.Matrix4.__v1).set(e[0],e[1],e[2]).length(),i=1/r.set(e[4],e[5],e[6]).length(),r=1/r.set(e[8],e[9],e[10]).length();return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,this},translate:function(e){var t=this.elements,n=e.x,i=e.y,e=e.z;return t[12]=t[0]*n+t[4]*i+t[8]*e+t[12],t[13]=t[1]*n+t[5]*i+t[9]*e+t[13],t[14]=t[2]*n+t[6]*i+t[10]*e+t[14],t[15]=t[3]*n+t[7]*i+t[11]*e+t[15],this},rotateX:function(e){var t=this.elements,n=t[4],i=t[5],r=t[6],o=t[7],a=t[8],s=t[9],l=t[10],c=t[11],u=Math.cos(e),e=Math.sin(e);return t[4]=u*n+e*a,t[5]=u*i+e*s,t[6]=u*r+e*l,t[7]=u*o+e*c,t[8]=u*a-e*n,t[9]=u*s-e*i,t[10]=u*l-e*r,t[11]=u*c-e*o,this},rotateY:function(e){var t=this.elements,n=t[0],i=t[1],r=t[2],o=t[3],a=t[8],s=t[9],l=t[10],c=t[11],u=Math.cos(e),e=Math.sin(e);return t[0]=u*n-e*a,t[1]=u*i-e*s,t[2]=u*r-e*l,t[3]=u*o-e*c,t[8]=u*a+e*n,t[9]=u*s+e*i,t[10]=u*l+e*r,t[11]=u*c+e*o,this},rotateZ:function(e){var t=this.elements,n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=Math.cos(e),e=Math.sin(e);return t[0]=u*n+e*a,t[1]=u*i+e*s,t[2]=u*r+e*l,t[3]=u*o+e*c,t[4]=u*a-e*n,t[5]=u*s-e*i,t[6]=u*l-e*r,t[7]=u*c-e*o,this},rotateByAxis:function(e,t){var n=this.elements;if(1===e.x&&0===e.y&&0===e.z)return this.rotateX(t);if(0===e.x&&1===e.y&&0===e.z)return this.rotateY(t);if(0===e.x&&0===e.y&&1===e.z)return this.rotateZ(t);var i=e.x,r=e.y,o=e.z,r=r/(a=Math.sqrt(i*i+r*r+o*o)),o=o/a,a=(i=i/a)*i,s=r*r,l=o*o,c=i*r*(h=1-(p=Math.cos(t))),u=i*o*h,h=r*o*h,i=i*(d=Math.sin(t)),f=r*d,d=o*d,o=a+(1-a)*p,a=c+d,r=u-f,c=c-d,s=s+(1-s)*p,d=h+i,u=u+f,h=h-i,l=l+(1-l)*p,p=n[0],i=n[1],f=n[2],m=n[3],g=n[4],v=n[5],_=n[6],y=n[7],b=n[8],x=n[9],E=n[10],T=n[11];return n[0]=o*p+a*g+r*b,n[1]=o*i+a*v+r*x,n[2]=o*f+a*_+r*E,n[3]=o*m+a*y+r*T,n[4]=c*p+s*g+d*b,n[5]=c*i+s*v+d*x,n[6]=c*f+s*_+d*E,n[7]=c*m+s*y+d*T,n[8]=u*p+h*g+l*b,n[9]=u*i+h*v+l*x,n[10]=u*f+h*_+l*E,n[11]=u*m+h*y+l*T,this},scale:function(e){var t=this.elements,n=e.x,i=e.y,e=e.z;return t[0]=t[0]*n,t[4]=t[4]*i,t[8]=t[8]*e,t[1]=t[1]*n,t[5]=t[5]*i,t[9]=t[9]*e,t[2]=t[2]*n,t[6]=t[6]*i,t[10]=t[10]*e,t[3]=t[3]*n,t[7]=t[7]*i,t[11]=t[11]*e,this},getMaxScaleOnAxis:function(){var e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],Math.max(e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10])))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),e=Math.sin(e);return this.set(1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),e=Math.sin(e);return this.set(t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),e=Math.sin(e);return this.set(t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),i=Math.sin(t),r=1-n,o=e.x,a=e.y,s=e.z,l=r*o,c=r*a;return this.set(l*o+n,l*a-i*s,l*s+i*a,0,l*a+i*s,c*a+n,c*s-i*o,0,l*s-i*a,c*s+i*o,r*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeFrustum:function(e,t,n,i,r,o){var a=this.elements;return a[0]=2*r/(t-e),a[4]=0,a[8]=(t+e)/(t-e),a[12]=0,a[1]=0,a[5]=2*r/(i-n),a[9]=(i+n)/(i-n),a[13]=0,a[2]=0,a[6]=0,a[10]=-(o+r)/(o-r),a[14]=-2*o*r/(o-r),a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(e,t,n,i){var r=-(e=n*Math.tan(e*Math.PI/360));return this.makeFrustum(r*t,e*t,r,e,n,i)},makeOrthographic:function(e,t,n,i,r,o){var a=this.elements,s=t-e,l=n-i,c=o-r;return a[0]=2/s,a[4]=0,a[8]=0,a[12]=-(t+e)/s,a[1]=0,a[5]=2/l,a[9]=0,a[13]=-(n+i)/l,a[2]=0,a[6]=0,a[10]=-2/c,a[14]=-(o+r)/c,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},clone:function(){var e=this.elements;return new THREE.Matrix4(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])}},THREE.Matrix4.__v1=new THREE.Vector3,THREE.Matrix4.__v2=new THREE.Vector3,THREE.Matrix4.__v3=new THREE.Vector3,THREE.Matrix4.__m1=new THREE.Matrix4,THREE.Matrix4.__m2=new THREE.Matrix4,THREE.Object3D=function(){this.id=THREE.Object3DCount++,this.name="",this.parent=void 0,this.children=[],this.up=new THREE.Vector3(0,1,0),this.position=new THREE.Vector3,this.rotation=new THREE.Vector3,this.eulerOrder="XYZ",this.scale=new THREE.Vector3(1,1,1),this.flipSided=this.doubleSided=!1,this.renderDepth=null,this.rotationAutoUpdate=!0,this.matrix=new THREE.Matrix4,this.matrixWorld=new THREE.Matrix4,this.matrixRotationWorld=new THREE.Matrix4,this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=!0,this.quaternion=new THREE.Quaternion,this.useQuaternion=!1,this.boundRadius=0,this.boundRadiusScale=1,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this._vector=new THREE.Vector3},THREE.Object3D.prototype={constructor:THREE.Object3D,applyMatrix:function(e){this.matrix.multiply(e,this.matrix),this.scale.getScaleFromMatrix(this.matrix),this.rotation.getRotationFromMatrix(this.matrix,this.scale),this.position.getPositionFromMatrix(this.matrix)},translate:function(e,t){this.matrix.rotateAxis(t),this.position.addSelf(t.multiplyScalar(e))},translateX:function(e){this.translate(e,this._vector.set(1,0,0))},translateY:function(e){this.translate(e,this._vector.set(0,1,0))},translateZ:function(e){this.translate(e,this._vector.set(0,0,1))},lookAt:function(e){this.matrix.lookAt(e,this.position,this.up),this.rotationAutoUpdate&&this.rotation.getRotationFromMatrix(this.matrix)},add:function(e){if(e!==this&&e instanceof THREE.Object3D){void 0!==e.parent&&e.parent.remove(e),(e.parent=this).children.push(e);for(var t=this;void 0!==t.parent;)t=t.parent;void 0!==t&&t instanceof THREE.Scene&&t.__addObject(e)}},remove:function(e){var t=this.children.indexOf(e);if(-1!==t){for(e.parent=void 0,this.children.splice(t,1),t=this;void 0!==t.parent;)t=t.parent;void 0!==t&&t instanceof THREE.Scene&&t.__removeObject(e)}},getChildByName:function(e,t){for(var n,i=0,r=this.children.length;i<r;i++){if((n=this.children[i]).name===e)return n;if(t&&void 0!==(n=n.getChildByName(e,t)))return n}},updateMatrix:function(){this.matrix.setPosition(this.position),this.useQuaternion?this.matrix.setRotationFromQuaternion(this.quaternion):this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder),1===this.scale.x&&1===this.scale.y&&1===this.scale.z||(this.matrix.scale(this.scale),this.boundRadiusScale=Math.max(this.scale.x,Math.max(this.scale.y,this.scale.z))),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent?this.matrixWorld.multiply(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),e=!(this.matrixWorldNeedsUpdate=!1));for(var t=0,n=this.children.length;t<n;t++)this.children[t].updateMatrixWorld(e)}},THREE.Object3DCount=0,THREE.Projector=function(){function A(){var e=z[H]=z[H]||new THREE.RenderableVertex;return H++,e}function M(e,t){return t.z-e.z}var r,o,L,H,F,P,N,k,I,O,B,a=[],z=[],j=[],U=[],V=[],W=[],G={objects:[],sprites:[],lights:[],elements:[]},s=new THREE.Vector3,q=new THREE.Vector4,X=new THREE.Matrix4,$=new THREE.Matrix4,Y=new THREE.Frustum,J=new THREE.Vector4,Z=new THREE.Vector4;this.projectVector=function(e,t){return t.matrixWorldInverse.getInverse(t.matrixWorld),X.multiply(t.projectionMatrix,t.matrixWorldInverse),X.multiplyVector3(e),e},this.unprojectVector=function(e,t){return t.projectionMatrixInverse.getInverse(t.projectionMatrix),X.multiply(t.matrixWorld,t.projectionMatrixInverse),X.multiplyVector3(e),e},this.pickingRay=function(e,t){var n;return e.z=-1,n=new THREE.Vector3(e.x,e.y,1),this.unprojectVector(e,t),this.unprojectVector(n,t),n.subSelf(e).normalize(),new THREE.Ray(e,n)},this.projectGraph=function(e,t){o=0,G.objects.length=0,G.sprites.length=0,G.lights.length=0;var i=function(e){if(!1!==e.visible){(e instanceof THREE.Mesh||e instanceof THREE.Line)&&(!1===e.frustumCulled||Y.contains(e))?(s.copy(e.matrixWorld.getPosition()),X.multiplyVector3(s),t=a[o]=a[o]||new THREE.RenderableObject,o++,(r=t).object=e,r.z=s.z,G.objects.push(r)):e instanceof THREE.Light&&G.lights.push(e);for(var t=0,n=e.children.length;t<n;t++)i(e.children[t])}};return i(e),t&&G.objects.sort(M),G},this.projectScene=function(e,t,n){var i,r,o,a,s,l,c,u,h,f,d,p,m,g,v,_,y,b,x,E,T,w,C,S=t.near,D=t.far,R=!1;for(B=I=N=P=0,void(G.elements.length=0)===t.parent&&e.add(t),e.updateMatrixWorld(),t.matrixWorldInverse.getInverse(t.matrixWorld),X.multiply(t.projectionMatrix,t.matrixWorldInverse),Y.setFromMatrix(X),G=this.projectGraph(e,!1),e=0,i=G.objects.length;e<i;e++)if(f=(h=G.objects[e].object).matrixWorld,H=0,h instanceof THREE.Mesh){for(d=h.geometry,p=h.geometry.materials,a=d.vertices,m=d.faces,g=d.faceVertexUvs,d=h.matrixRotationWorld.extractRotation(f),r=0,o=a.length;r<o;r++)(L=A()).positionWorld.copy(a[r]),f.multiplyVector3(L.positionWorld),L.positionScreen.copy(L.positionWorld),X.multiplyVector4(L.positionScreen),L.positionScreen.x=L.positionScreen.x/L.positionScreen.w,L.positionScreen.y=L.positionScreen.y/L.positionScreen.w,L.visible=L.positionScreen.z>S&&L.positionScreen.z<D;for(a=0,r=m.length;a<r;a++){if((o=m[a])instanceof THREE.Face3){if(s=z[o.a],l=z[o.b],c=z[o.c],!(s.visible&&l.visible&&c.visible))continue;if(R=(c.positionScreen.x-s.positionScreen.x)*(l.positionScreen.y-s.positionScreen.y)-(c.positionScreen.y-s.positionScreen.y)*(l.positionScreen.x-s.positionScreen.x)<0,!h.doubleSided&&R==h.flipSided)continue;u=j[P]=j[P]||new THREE.RenderableFace3,P++,(F=u).v1.copy(s),F.v2.copy(l),F.v3.copy(c)}else if(o instanceof THREE.Face4){if(s=z[o.a],l=z[o.b],c=z[o.c],u=z[o.d],!(s.visible&&l.visible&&c.visible&&u.visible))continue;if(R=(u.positionScreen.x-s.positionScreen.x)*(l.positionScreen.y-s.positionScreen.y)-(u.positionScreen.y-s.positionScreen.y)*(l.positionScreen.x-s.positionScreen.x)<0||(l.positionScreen.x-c.positionScreen.x)*(u.positionScreen.y-c.positionScreen.y)-(l.positionScreen.y-c.positionScreen.y)*(u.positionScreen.x-c.positionScreen.x)<0,!h.doubleSided&&R==h.flipSided)continue;v=U[N]=U[N]||new THREE.RenderableFace4,N++,(F=v).v1.copy(s),F.v2.copy(l),F.v3.copy(c),F.v4.copy(u)}for(F.normalWorld.copy(o.normal),R||!h.flipSided&&!h.doubleSided||F.normalWorld.negate(),d.multiplyVector3(F.normalWorld),F.centroidWorld.copy(o.centroid),f.multiplyVector3(F.centroidWorld),F.centroidScreen.copy(F.centroidWorld),X.multiplyVector3(F.centroidScreen),s=0,l=(c=o.vertexNormals).length;s<l;s++)(u=F.vertexNormalsWorld[s]).copy(c[s]),R||!h.flipSided&&!h.doubleSided||u.negate(),d.multiplyVector3(u);for(s=0,l=g.length;s<l;s++)if(v=g[s][a])for(c=0,u=v.length;c<u;c++)F.uvs[s][c]=v[c];F.material=h.material,F.faceMaterial=null!==o.materialIndex?p[o.materialIndex]:null,F.z=F.centroidScreen.z,G.elements.push(F)}}else if(h instanceof THREE.Line)for($.multiply(X,f),a=h.geometry.vertices,(s=A()).positionScreen.copy(a[0]),$.multiplyVector4(s.positionScreen),f=h.type===THREE.LinePieces?2:1,r=1,o=a.length;r<o;r++)(s=A()).positionScreen.copy(a[r]),$.multiplyVector4(s.positionScreen),0<(r+1)%f||(l=z[H-2],J.copy(s.positionScreen),Z.copy(l.positionScreen),y=Z,x=b=void 0,b=0,x=1,E=(_=J).z+_.w,T=y.z+y.w,w=-_.z+_.w,C=-y.z+y.w,(0<=E&&0<=T&&0<=w&&0<=C||!(E<0&&T<0||w<0&&C<0||(E<0?b=Math.max(b,E/(E-T)):T<0&&(x=Math.min(x,E/(E-T))),w<0?b=Math.max(b,w/(w-C)):C<0&&(x=Math.min(x,w/(w-C))),x<b))&&(_.lerpSelf(y,b),y.lerpSelf(_,1-x),1))&&(J.multiplyScalar(1/J.w),Z.multiplyScalar(1/Z.w),p=V[I]=V[I]||new THREE.RenderableLine,I++,(k=p).v1.positionScreen.copy(J),k.v2.positionScreen.copy(Z),k.z=Math.max(J.z,Z.z),k.material=h.material,G.elements.push(k)));for(e=0,i=G.sprites.length;e<i;e++)f=(h=G.sprites[e].object).matrixWorld,h instanceof THREE.Particle&&(q.set(f.elements[12],f.elements[13],f.elements[14],1),X.multiplyVector4(q),q.z=q.z/q.w,0<q.z&&q.z<1&&(S=W[B]=W[B]||new THREE.RenderableParticle,B++,(O=S).x=q.x/q.w,O.y=q.y/q.w,O.z=q.z,O.rotation=h.rotation.z,O.scale.x=h.scale.x*Math.abs(O.x-(q.x+t.projectionMatrix.elements[0])/(q.w+t.projectionMatrix.elements[12])),O.scale.y=h.scale.y*Math.abs(O.y-(q.y+t.projectionMatrix.elements[5])/(q.w+t.projectionMatrix.elements[13])),O.material=h.material,G.elements.push(O)));return n&&G.elements.sort(M),G}},THREE.Quaternion=function(e,t,n,i){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==i?i:1},THREE.Quaternion.prototype={constructor:THREE.Quaternion,set:function(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},setFromEuler:function(e){var t=Math.PI/360,n=e.x*t,i=e.y*t,r=e.z*t,e=Math.cos(i),i=Math.sin(i),t=Math.cos(-r),r=Math.sin(-r),o=Math.cos(n),n=Math.sin(n),a=e*t,s=i*r;return this.w=a*o-s*n,this.x=a*n+s*o,this.y=i*t*o+e*r*n,this.z=e*r*o-i*t*n,this},setFromAxisAngle:function(e,t){var n=t/2,i=Math.sin(n);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(n),this},setFromRotationMatrix:function(e){var t=Math.pow(e.determinant(),1/3);return this.w=Math.sqrt(Math.max(0,t+e.elements[0]+e.elements[5]+e.elements[10]))/2,this.x=Math.sqrt(Math.max(0,t+e.elements[0]-e.elements[5]-e.elements[10]))/2,this.y=Math.sqrt(Math.max(0,t-e.elements[0]+e.elements[5]-e.elements[10]))/2,this.z=Math.sqrt(Math.max(0,t-e.elements[0]-e.elements[5]+e.elements[10]))/2,this.x=e.elements[6]-e.elements[9]<0?-Math.abs(this.x):Math.abs(this.x),this.y=e.elements[8]-e.elements[2]<0?-Math.abs(this.y):Math.abs(this.y),this.z=e.elements[1]-e.elements[4]<0?-Math.abs(this.z):Math.abs(this.z),this.normalize(),this},calculateW:function(){return this.w=-Math.sqrt(Math.abs(1-this.x*this.x-this.y*this.y-this.z*this.z)),this},inverse:function(){return this.x=-1*this.x,this.y=-1*this.y,this.z=-1*this.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?this.w=this.z=this.y=this.x=0:(e=1/e,this.x=this.x*e,this.y=this.y*e,this.z=this.z*e,this.w=this.w*e),this},multiply:function(e,t){return this.x=e.x*t.w+e.y*t.z-e.z*t.y+e.w*t.x,this.y=-e.x*t.z+e.y*t.w+e.z*t.x+e.w*t.y,this.z=e.x*t.y-e.y*t.x+e.z*t.w+e.w*t.z,this.w=-e.x*t.x-e.y*t.y-e.z*t.z+e.w*t.w,this},multiplySelf:function(e){var t=this.x,n=this.y,i=this.z,r=this.w,o=e.x,a=e.y,s=e.z,e=e.w;return this.x=t*e+r*o+n*s-i*a,this.y=n*e+r*a+i*o-t*s,this.z=i*e+r*s+t*a-n*o,this.w=r*e-t*o-n*a-i*s,this},multiplyVector3:function(e,t){t=t||e;var n=e.x,i=e.y,r=e.z,o=this.x,a=this.y,s=this.z,l=this.w,c=l*n+a*r-s*i,u=l*i+s*n-o*r,h=l*r+o*i-a*n,n=-o*n-a*i-s*r;return t.x=c*l+n*-o+u*-s-h*-a,t.y=u*l+n*-a+h*-o-c*-s,t.z=h*l+n*-s+c*-a-u*-o,t},clone:function(){return new THREE.Quaternion(this.x,this.y,this.z,this.w)}},THREE.Quaternion.slerp=function(e,t,n,i){if((o=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z)<0?(n.w=-t.w,n.x=-t.x,n.y=-t.y,n.z=-t.z,o=-o):n.copy(t),1<=Math.abs(o))return n.w=e.w,n.x=e.x,n.y=e.y,n.z=e.z,n;var r=Math.acos(o),o=Math.sqrt(1-o*o);return Math.abs(o)<.001?(n.w=.5*(e.w+t.w),n.x=.5*(e.x+t.x),n.y=.5*(e.y+t.y),n.z=.5*(e.z+t.z)):(t=Math.sin((1-i)*r)/o,i=Math.sin(i*r)/o,n.w=e.w*t+n.w*i,n.x=e.x*t+n.x*i,n.y=e.y*t+n.y*i,n.z=e.z*t+n.z*i),n},THREE.Vertex=function(){},THREE.Face3=function(e,t,n,i,r,o){this.a=e,this.b=t,this.c=n,this.normal=i instanceof THREE.Vector3?i:new THREE.Vector3,this.vertexNormals=i instanceof Array?i:[],this.color=r instanceof THREE.Color?r:new THREE.Color,this.vertexColors=r instanceof Array?r:[],this.vertexTangents=[],this.materialIndex=o,this.centroid=new THREE.Vector3},THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var e,t,n=new THREE.Face3(this.a,this.b,this.c);for(n.normal.copy(this.normal),n.color.copy(this.color),n.centroid.copy(this.centroid),n.materialIndex=this.materialIndex,e=0,t=this.vertexNormals.length;e<t;e++)n.vertexNormals[e]=this.vertexNormals[e].clone();for(e=0,t=this.vertexColors.length;e<t;e++)n.vertexColors[e]=this.vertexColors[e].clone();for(e=0,t=this.vertexTangents.length;e<t;e++)n.vertexTangents[e]=this.vertexTangents[e].clone();return n}},THREE.Face4=function(e,t,n,i,r,o,a){this.a=e,this.b=t,this.c=n,this.d=i,this.normal=r instanceof THREE.Vector3?r:new THREE.Vector3,this.vertexNormals=r instanceof Array?r:[],this.color=o instanceof THREE.Color?o:new THREE.Color,this.vertexColors=o instanceof Array?o:[],this.vertexTangents=[],this.materialIndex=a,this.centroid=new THREE.Vector3},THREE.Face4.prototype={constructor:THREE.Face4,clone:function(){var e,t,n=new THREE.Face4(this.a,this.b,this.c,this.d);for(n.normal.copy(this.normal),n.color.copy(this.color),n.centroid.copy(this.centroid),n.materialIndex=this.materialIndex,e=0,t=this.vertexNormals.length;e<t;e++)n.vertexNormals[e]=this.vertexNormals[e].clone();for(e=0,t=this.vertexColors.length;e<t;e++)n.vertexColors[e]=this.vertexColors[e].clone();for(e=0,t=this.vertexTangents.length;e<t;e++)n.vertexTangents[e]=this.vertexTangents[e].clone();return n}},THREE.UV=function(e,t){this.u=e||0,this.v=t||0},THREE.UV.prototype={constructor:THREE.UV,set:function(e,t){return this.u=e,this.v=t,this},copy:function(e){return this.u=e.u,this.v=e.v,this},lerpSelf:function(e,t){return this.u=this.u+(e.u-this.u)*t,this.v=this.v+(e.v-this.v)*t,this},clone:function(){return new THREE.UV(this.u,this.v)}},THREE.Geometry=function(){this.id=THREE.GeometryCount++,this.vertices=[],this.colors=[],this.materials=[],this.faces=[],this.faceUvs=[[]],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.dynamic=this.hasTangents=!1},THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(e){var t=new THREE.Matrix4;t.extractRotation(e);for(var n=0,i=this.vertices.length;n<i;n++)e.multiplyVector3(this.vertices[n]);for(n=0,i=this.faces.length;n<i;n++){var r=this.faces[n];t.multiplyVector3(r.normal);for(var o=0,a=r.vertexNormals.length;o<a;o++)t.multiplyVector3(r.vertexNormals[o]);e.multiplyVector3(r.centroid)}},computeCentroids:function(){for(var e,t=0,n=this.faces.length;t<n;t++)(e=this.faces[t]).centroid.set(0,0,0),e instanceof THREE.Face3?(e.centroid.addSelf(this.vertices[e.a]),e.centroid.addSelf(this.vertices[e.b]),e.centroid.addSelf(this.vertices[e.c]),e.centroid.divideScalar(3)):e instanceof THREE.Face4&&(e.centroid.addSelf(this.vertices[e.a]),e.centroid.addSelf(this.vertices[e.b]),e.centroid.addSelf(this.vertices[e.c]),e.centroid.addSelf(this.vertices[e.d]),e.centroid.divideScalar(4))},computeFaceNormals:function(){for(var e,t,n,i,r=new THREE.Vector3,o=new THREE.Vector3,a=0,s=this.faces.length;a<s;a++)e=this.faces[a],t=this.vertices[e.a],n=this.vertices[e.b],i=this.vertices[e.c],r.sub(i,n),o.sub(t,n),r.crossSelf(o),r.isZero()||r.normalize(),e.normal.copy(r)},computeVertexNormals:function(){var e,t,n,i;if(void 0===this.__tmpVertices){for(i=this.__tmpVertices=Array(this.vertices.length),e=0,t=this.vertices.length;e<t;e++)i[e]=new THREE.Vector3;for(e=0,t=this.faces.length;e<t;e++)(n=this.faces[e])instanceof THREE.Face3?n.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]:n instanceof THREE.Face4&&(n.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3])}else for(i=this.__tmpVertices,e=0,t=this.vertices.length;e<t;e++)i[e].set(0,0,0);for(e=0,t=this.faces.length;e<t;e++)(n=this.faces[e])instanceof THREE.Face3?(i[n.a].addSelf(n.normal),i[n.b].addSelf(n.normal),i[n.c].addSelf(n.normal)):n instanceof THREE.Face4&&(i[n.a].addSelf(n.normal),i[n.b].addSelf(n.normal),i[n.c].addSelf(n.normal),i[n.d].addSelf(n.normal));for(e=0,t=this.vertices.length;e<t;e++)i[e].normalize();for(e=0,t=this.faces.length;e<t;e++)(n=this.faces[e])instanceof THREE.Face3?(n.vertexNormals[0].copy(i[n.a]),n.vertexNormals[1].copy(i[n.b]),n.vertexNormals[2].copy(i[n.c])):n instanceof THREE.Face4&&(n.vertexNormals[0].copy(i[n.a]),n.vertexNormals[1].copy(i[n.b]),n.vertexNormals[2].copy(i[n.c]),n.vertexNormals[3].copy(i[n.d]))},computeMorphNormals:function(){var e,t,n;for(l=0,c=this.faces.length;l<c;l++)for((n=this.faces[l]).__originalFaceNormal?n.__originalFaceNormal.copy(n.normal):n.__originalFaceNormal=n.normal.clone(),n.__originalVertexNormals||(n.__originalVertexNormals=[]),e=0,t=n.vertexNormals.length;e<t;e++)n.__originalVertexNormals[e]?n.__originalVertexNormals[e].copy(n.vertexNormals[e]):n.__originalVertexNormals[e]=n.vertexNormals[e].clone();var i=new THREE.Geometry;for(i.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];for(var r,o,a=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals,l=0,c=this.faces.length;l<c;l++)n=this.faces[l],r=new THREE.Vector3,o=n instanceof THREE.Face3?{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3}:{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3,d:new THREE.Vector3},a.push(r),s.push(o)}for(a=this.morphNormals[e],i.vertices=this.morphTargets[e].vertices,i.computeFaceNormals(),i.computeVertexNormals(),l=0,c=this.faces.length;l<c;l++)n=this.faces[l],r=a.faceNormals[l],o=a.vertexNormals[l],r.copy(n.normal),n instanceof THREE.Face3?(o.a.copy(n.vertexNormals[0]),o.b.copy(n.vertexNormals[1]),o.c.copy(n.vertexNormals[2])):(o.a.copy(n.vertexNormals[0]),o.b.copy(n.vertexNormals[1]),o.c.copy(n.vertexNormals[2]),o.d.copy(n.vertexNormals[3]))}for(l=0,c=this.faces.length;l<c;l++)(n=this.faces[l]).normal=n.__originalFaceNormal,n.vertexNormals=n.__originalVertexNormals},computeTangents:function(){function e(e,t,n,i,r,o,a){l=e.vertices[t],c=e.vertices[n],u=e.vertices[i],h=s[r],f=s[o],d=s[a],p=c.x-l.x,m=u.x-l.x,g=c.y-l.y,v=u.y-l.y,_=c.z-l.z,y=u.z-l.z,b=f.u-h.u,x=d.u-h.u,E=f.v-h.v,T=d.v-h.v,w=1/(b*T-x*E),D.set((T*p-E*m)*w,(T*g-E*v)*w,(T*_-E*y)*w),R.set((b*m-x*p)*w,(b*v-x*g)*w,(b*y-x*_)*w),C[t].addSelf(D),C[n].addSelf(D),C[i].addSelf(D),S[t].addSelf(R),S[n].addSelf(R),S[i].addSelf(R)}for(var t,n,i,s,l,c,u,h,f,d,p,m,g,v,_,y,b,x,E,T,w,r,C=[],S=[],D=new THREE.Vector3,R=new THREE.Vector3,o=new THREE.Vector3,a=new THREE.Vector3,A=new THREE.Vector3,M=0,L=this.vertices.length;M<L;M++)C[M]=new THREE.Vector3,S[M]=new THREE.Vector3;for(M=0,L=this.faces.length;M<L;M++)i=this.faces[M],s=this.faceVertexUvs[0][M],i instanceof THREE.Face3?e(this,i.a,i.b,i.c,0,1,2):i instanceof THREE.Face4&&(e(this,i.a,i.b,i.d,0,1,3),e(this,i.b,i.c,i.d,1,2,3));var H=["a","b","c","d"];for(M=0,L=this.faces.length;M<L;M++)for(i=this.faces[M],t=0;t<i.vertexNormals.length;t++)A.copy(i.vertexNormals[t]),n=i[H[t]],r=C[n],o.copy(r),o.subSelf(A.multiplyScalar(A.dot(r))).normalize(),a.cross(i.vertexNormals[t],r),n=(n=a.dot(S[n]))<0?-1:1,i.vertexTangents[t]=new THREE.Vector4(o.x,o.y,o.z,n);this.hasTangents=!0},computeBoundingBox:function(){if(this.boundingBox||(this.boundingBox={min:new THREE.Vector3,max:new THREE.Vector3}),0<this.vertices.length){var e=this.vertices[0];this.boundingBox.min.copy(e),this.boundingBox.max.copy(e);for(var t=this.boundingBox.min,n=this.boundingBox.max,i=1,r=this.vertices.length;i<r;i++)(e=this.vertices[i]).x<t.x?t.x=e.x:e.x>n.x&&(n.x=e.x),e.y<t.y?t.y=e.y:e.y>n.y&&(n.y=e.y),e.z<t.z?t.z=e.z:e.z>n.z&&(n.z=e.z)}else this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)},computeBoundingSphere:function(){this.boundingSphere||(this.boundingSphere={radius:0});for(var e,t=0,n=0,i=this.vertices.length;n<i;n++)t<(e=this.vertices[n].length())&&(t=e);this.boundingSphere.radius=t},mergeVertices:function(){for(var e,t,n={},i=[],r=[],o=Math.pow(10,4),a=0,s=this.vertices.length;a<s;a++)e=this.vertices[a],void 0===n[e=[Math.round(e.x*o),Math.round(e.y*o),Math.round(e.z*o)].join("_")]?(n[e]=a,i.push(this.vertices[a]),r[a]=i.length-1):r[a]=r[n[e]];for(a=0,s=this.faces.length;a<s;a++)if((o=this.faces[a])instanceof THREE.Face3)o.a=r[o.a],o.b=r[o.b],o.c=r[o.c];else if(o instanceof THREE.Face4)for(o.a=r[o.a],o.b=r[o.b],o.c=r[o.c],o.d=r[o.d],e=[o.a,o.b,o.c,o.d],n=3;0<n;n--)if(e.indexOf(o["abcd"[n]])!=n){for(e.splice(n,1),this.faces[a]=new THREE.Face3(e[0],e[1],e[2]),o=0,e=this.faceVertexUvs.length;o<e;o++)(t=this.faceVertexUvs[o][a])&&t.splice(n,1);break}return r=this.vertices.length-i.length,this.vertices=i,r}},THREE.GeometryCount=0,THREE.Spline=function(e){function t(e,t,n,i,r,o,a){return(2*(t-n)+(e=.5*(n-e))+(i=.5*(i-t)))*a+(-3*(t-n)-2*e-i)*o+e*r+t}this.points=e;var n,i,r,o,a,s,l,c,u,h=[],f={x:0,y:0,z:0};this.initFromArray=function(e){this.points=[];for(var t=0;t<e.length;t++)this.points[t]={x:e[t][0],y:e[t][1],z:e[t][2]}},this.getPoint=function(e){return n=(this.points.length-1)*e,i=Math.floor(n),r=n-i,h[0]=0===i?i:i-1,h[1]=i,h[2]=i>this.points.length-2?this.points.length-1:i+1,h[3]=i>this.points.length-3?this.points.length-1:i+2,s=this.points[h[0]],l=this.points[h[1]],c=this.points[h[2]],u=this.points[h[3]],a=r*(o=r*r),f.x=t(s.x,l.x,c.x,u.x,r,o,a),f.y=t(s.y,l.y,c.y,u.y,r,o,a),f.z=t(s.z,l.z,c.z,u.z,r,o,a),f},this.getControlPointsArray=function(){for(var e,t=this.points.length,n=[],i=0;i<t;i++)e=this.points[i],n[i]=[e.x,e.y,e.z];return n},this.getLength=function(e){var t,n,i,r=t=0,o=new THREE.Vector3,a=new THREE.Vector3,s=[],l=0;for(s[0]=0,e=e||100,n=this.points.length*e,o.copy(this.points[0]),e=1;e<n;e++)t=e/n,i=this.getPoint(t),a.copy(i),l+=a.distanceTo(o),o.copy(i),t=(this.points.length-1)*t,(t=Math.floor(t))!=r&&(s[t]=l,r=t);return s[s.length]=l,{chunks:s,total:l}},this.reparametrizeByArcLength=function(e){var t,n,i,r,o,a,s=[],l=new THREE.Vector3,c=this.getLength();for(s.push(l.copy(this.points[0]).clone()),t=1;t<this.points.length;t++){for(n=c.chunks[t]-c.chunks[t-1],a=Math.ceil(e*n/c.total),r=(t-1)/(this.points.length-1),o=t/(this.points.length-1),n=1;n<a-1;n++)i=r+n*(1/a)*(o-r),i=this.getPoint(i),s.push(l.copy(i).clone());s.push(l.copy(this.points[t]).clone())}this.points=s}},THREE.Camera=function(){THREE.Object3D.call(this),this.matrixWorldInverse=new THREE.Matrix4,this.projectionMatrix=new THREE.Matrix4,this.projectionMatrixInverse=new THREE.Matrix4},THREE.Camera.prototype=new THREE.Object3D,THREE.Camera.prototype.constructor=THREE.Camera,THREE.Camera.prototype.lookAt=function(e){this.matrix.lookAt(this.position,e,this.up),this.rotationAutoUpdate&&this.rotation.getRotationFromMatrix(this.matrix)},THREE.OrthographicCamera=function(e,t,n,i,r,o){THREE.Camera.call(this),this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()},THREE.OrthographicCamera.prototype=new THREE.Camera,THREE.OrthographicCamera.prototype.constructor=THREE.OrthographicCamera,THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)},THREE.PerspectiveCamera=function(e,t,n,i){THREE.Camera.call(this),this.fov=void 0!==e?e:50,this.aspect=void 0!==t?t:1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype=new THREE.Camera,THREE.PerspectiveCamera.prototype.constructor=THREE.PerspectiveCamera,THREE.PerspectiveCamera.prototype.setLens=function(e,t){this.fov=2*Math.atan((void 0!==t?t:24)/(2*e))*(180/Math.PI),this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.setViewOffset=function(e,t,n,i,r,o){this.fullWidth=e,this.fullHeight=t,this.x=n,this.y=i,this.width=r,this.height=o,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var e,t,n,i;this.fullWidth?(t=(n=this.fullWidth/this.fullHeight)*(i=-(e=Math.tan(this.fov*Math.PI/360)*this.near)),n=Math.abs(n*e-t),i=Math.abs(e-i),this.projectionMatrix.makeFrustum(t+this.x*n/this.fullWidth,t+(this.x+this.width)*n/this.fullWidth,e-(this.y+this.height)*i/this.fullHeight,e-this.y*i/this.fullHeight,this.near,this.far)):this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)},THREE.Light=function(e){THREE.Object3D.call(this),this.color=new THREE.Color(e)},THREE.Light.prototype=new THREE.Object3D,THREE.Light.prototype.constructor=THREE.Light,THREE.Light.prototype.supr=THREE.Object3D.prototype,THREE.AmbientLight=function(e){THREE.Light.call(this,e)},THREE.AmbientLight.prototype=new THREE.Light,THREE.AmbientLight.prototype.constructor=THREE.AmbientLight,THREE.DirectionalLight=function(e,t,n){THREE.Light.call(this,e),this.position=new THREE.Vector3(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==t?t:1,this.distance=void 0!==n?n:0,this.onlyShadow=this.castShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraTop=this.shadowCameraRight=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapHeight=this.shadowMapWidth=512,this.shadowCascade=!1,this.shadowCascadeOffset=new THREE.Vector3(0,0,-1e3),this.shadowCascadeCount=2,this.shadowCascadeBias=[0,0,0],this.shadowCascadeWidth=[512,512,512],this.shadowCascadeHeight=[512,512,512],this.shadowCascadeNearZ=[-1,.99,.998],this.shadowCascadeFarZ=[.99,.998,1],this.shadowCascadeArray=[],this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null},THREE.DirectionalLight.prototype=new THREE.Light,THREE.DirectionalLight.prototype.constructor=THREE.DirectionalLight,THREE.PointLight=function(e,t,n){THREE.Light.call(this,e),this.position=new THREE.Vector3(0,0,0),this.intensity=void 0!==t?t:1,this.distance=void 0!==n?n:0},THREE.PointLight.prototype=new THREE.Light,THREE.PointLight.prototype.constructor=THREE.PointLight,THREE.SpotLight=function(e,t,n,i,r){THREE.Light.call(this,e),this.position=new THREE.Vector3(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==t?t:1,this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/2,this.exponent=void 0!==r?r:10,this.onlyShadow=this.castShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapHeight=this.shadowMapWidth=512,this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null},THREE.SpotLight.prototype=new THREE.Light,THREE.SpotLight.prototype.constructor=THREE.SpotLight,THREE.Material=function(e){e=e||{},this.id=THREE.MaterialCount++,this.name="",this.opacity=void 0!==e.opacity?e.opacity:1,this.transparent=void 0!==e.transparent&&e.transparent,this.blending=void 0!==e.blending?e.blending:THREE.NormalBlending,this.blendSrc=void 0!==e.blendSrc?e.blendSrc:THREE.SrcAlphaFactor,this.blendDst=void 0!==e.blendDst?e.blendDst:THREE.OneMinusSrcAlphaFactor,this.blendEquation=void 0!==e.blendEquation?e.blendEquation:THREE.AddEquation,this.depthTest=void 0===e.depthTest||e.depthTest,this.depthWrite=void 0===e.depthWrite||e.depthWrite,this.polygonOffset=void 0!==e.polygonOffset&&e.polygonOffset,this.polygonOffsetFactor=void 0!==e.polygonOffsetFactor?e.polygonOffsetFactor:0,this.polygonOffsetUnits=void 0!==e.polygonOffsetUnits?e.polygonOffsetUnits:0,this.alphaTest=void 0!==e.alphaTest?e.alphaTest:0,this.overdraw=void 0!==e.overdraw&&e.overdraw,this.needsUpdate=this.visible=!0},THREE.MaterialCount=0,THREE.NoShading=0,THREE.FlatShading=1,THREE.SmoothShading=2,THREE.NoColors=0,THREE.FaceColors=1,THREE.VertexColors=2,THREE.NoBlending=0,THREE.NormalBlending=1,THREE.AdditiveBlending=2,THREE.SubtractiveBlending=3,THREE.MultiplyBlending=4,THREE.AdditiveAlphaBlending=5,THREE.CustomBlending=6,THREE.AddEquation=100,THREE.SubtractEquation=101,THREE.ReverseSubtractEquation=102,THREE.ZeroFactor=200,THREE.OneFactor=201,THREE.SrcColorFactor=202,THREE.OneMinusSrcColorFactor=203,THREE.SrcAlphaFactor=204,THREE.OneMinusSrcAlphaFactor=205,THREE.DstAlphaFactor=206,THREE.OneMinusDstAlphaFactor=207,THREE.DstColorFactor=208,THREE.OneMinusDstColorFactor=209,THREE.SrcAlphaSaturateFactor=210,THREE.LineBasicMaterial=function(e){THREE.Material.call(this,e),e=e||{},this.color=void 0!==e.color?new THREE.Color(e.color):new THREE.Color(16777215),this.linewidth=void 0!==e.linewidth?e.linewidth:1,this.linecap=void 0!==e.linecap?e.linecap:"round",this.linejoin=void 0!==e.linejoin?e.linejoin:"round",this.vertexColors=!!e.vertexColors&&e.vertexColors,this.fog=void 0===e.fog||e.fog},THREE.LineBasicMaterial.prototype=new THREE.Material,THREE.LineBasicMaterial.prototype.constructor=THREE.LineBasicMaterial,THREE.MeshBasicMaterial=function(e){THREE.Material.call(this,e),e=e||{},this.color=void 0!==e.color?new THREE.Color(e.color):new THREE.Color(16777215),this.map=void 0!==e.map?e.map:null,this.lightMap=void 0!==e.lightMap?e.lightMap:null,this.envMap=void 0!==e.envMap?e.envMap:null,this.combine=void 0!==e.combine?e.combine:THREE.MultiplyOperation,this.reflectivity=void 0!==e.reflectivity?e.reflectivity:1,this.refractionRatio=void 0!==e.refractionRatio?e.refractionRatio:.98,this.fog=void 0===e.fog||e.fog,this.shading=void 0!==e.shading?e.shading:THREE.SmoothShading,this.wireframe=void 0!==e.wireframe&&e.wireframe,this.wireframeLinewidth=void 0!==e.wireframeLinewidth?e.wireframeLinewidth:1,this.wireframeLinecap=void 0!==e.wireframeLinecap?e.wireframeLinecap:"round",this.wireframeLinejoin=void 0!==e.wireframeLinejoin?e.wireframeLinejoin:"round",this.vertexColors=void 0!==e.vertexColors?e.vertexColors:THREE.NoColors,this.skinning=void 0!==e.skinning&&e.skinning,this.morphTargets=void 0!==e.morphTargets&&e.morphTargets},THREE.MeshBasicMaterial.prototype=new THREE.Material,THREE.MeshBasicMaterial.prototype.constructor=THREE.MeshBasicMaterial,THREE.MeshLambertMaterial=function(e){THREE.Material.call(this,e),e=e||{},this.color=void 0!==e.color?new THREE.Color(e.color):new THREE.Color(16777215),this.ambient=void 0!==e.ambient?new THREE.Color(e.ambient):new THREE.Color(16777215),this.emissive=void 0!==e.emissive?new THREE.Color(e.emissive):new THREE.Color(0),this.wrapAround=void 0!==e.wrapAround&&e.wrapAround,this.wrapRGB=new THREE.Vector3(1,1,1),this.map=void 0!==e.map?e.map:null,this.lightMap=void 0!==e.lightMap?e.lightMap:null,this.envMap=void 0!==e.envMap?e.envMap:null,this.combine=void 0!==e.combine?e.combine:THREE.MultiplyOperation,this.reflectivity=void 0!==e.reflectivity?e.reflectivity:1,this.refractionRatio=void 0!==e.refractionRatio?e.refractionRatio:.98,this.fog=void 0===e.fog||e.fog,this.shading=void 0!==e.shading?e.shading:THREE.SmoothShading,this.wireframe=void 0!==e.wireframe&&e.wireframe,this.wireframeLinewidth=void 0!==e.wireframeLinewidth?e.wireframeLinewidth:1,this.wireframeLinecap=void 0!==e.wireframeLinecap?e.wireframeLinecap:"round",this.wireframeLinejoin=void 0!==e.wireframeLinejoin?e.wireframeLinejoin:"round",this.vertexColors=void 0!==e.vertexColors?e.vertexColors:THREE.NoColors,this.skinning=void 0!==e.skinning&&e.skinning,this.morphTargets=void 0!==e.morphTargets&&e.morphTargets,this.morphNormals=void 0!==e.morphNormals&&e.morphNormals},THREE.MeshLambertMaterial.prototype=new THREE.Material,THREE.MeshLambertMaterial.prototype.constructor=THREE.MeshLambertMaterial,THREE.MeshPhongMaterial=function(e){THREE.Material.call(this,e),e=e||{},this.color=void 0!==e.color?new THREE.Color(e.color):new THREE.Color(16777215),this.ambient=void 0!==e.ambient?new THREE.Color(e.ambient):new THREE.Color(16777215),this.emissive=void 0!==e.emissive?new THREE.Color(e.emissive):new THREE.Color(0),this.specular=void 0!==e.specular?new THREE.Color(e.specular):new THREE.Color(1118481),this.shininess=void 0!==e.shininess?e.shininess:30,this.metal=void 0!==e.metal&&e.metal,this.perPixel=void 0!==e.perPixel&&e.perPixel,this.wrapAround=void 0!==e.wrapAround&&e.wrapAround,this.wrapRGB=new THREE.Vector3(1,1,1),this.map=void 0!==e.map?e.map:null,this.lightMap=void 0!==e.lightMap?e.lightMap:null,this.envMap=void 0!==e.envMap?e.envMap:null,this.combine=void 0!==e.combine?e.combine:THREE.MultiplyOperation,this.reflectivity=void 0!==e.reflectivity?e.reflectivity:1,this.refractionRatio=void 0!==e.refractionRatio?e.refractionRatio:.98,this.fog=void 0===e.fog||e.fog,this.shading=void 0!==e.shading?e.shading:THREE.SmoothShading,this.wireframe=void 0!==e.wireframe&&e.wireframe,this.wireframeLinewidth=void 0!==e.wireframeLinewidth?e.wireframeLinewidth:1,this.wireframeLinecap=void 0!==e.wireframeLinecap?e.wireframeLinecap:"round",this.wireframeLinejoin=void 0!==e.wireframeLinejoin?e.wireframeLinejoin:"round",this.vertexColors=void 0!==e.vertexColors?e.vertexColors:THREE.NoColors,this.skinning=void 0!==e.skinning&&e.skinning,this.morphTargets=void 0!==e.morphTargets&&e.morphTargets,this.morphNormals=void 0!==e.morphNormals&&e.morphNormals},THREE.MeshPhongMaterial.prototype=new THREE.Material,THREE.MeshPhongMaterial.prototype.constructor=THREE.MeshPhongMaterial,THREE.MeshDepthMaterial=function(e){THREE.Material.call(this,e),e=e||{},this.shading=void 0!==e.shading?e.shading:THREE.SmoothShading,this.wireframe=void 0!==e.wireframe&&e.wireframe,this.wireframeLinewidth=void 0!==e.wireframeLinewidth?e.wireframeLinewidth:1},THREE.MeshDepthMaterial.prototype=new THREE.Material,THREE.MeshDepthMaterial.prototype.constructor=THREE.MeshDepthMaterial,THREE.MeshNormalMaterial=function(e){THREE.Material.call(this,e),e=e||{},this.shading=e.shading?e.shading:THREE.FlatShading,this.wireframe=!!e.wireframe&&e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth?e.wireframeLinewidth:1},THREE.MeshNormalMaterial.prototype=new THREE.Material,THREE.MeshNormalMaterial.prototype.constructor=THREE.MeshNormalMaterial,THREE.MeshFaceMaterial=function(){},THREE.ParticleBasicMaterial=function(e){THREE.Material.call(this,e),e=e||{},this.color=void 0!==e.color?new THREE.Color(e.color):new THREE.Color(16777215),this.map=void 0!==e.map?e.map:null,this.size=void 0!==e.size?e.size:1,this.sizeAttenuation=void 0===e.sizeAttenuation||e.sizeAttenuation,this.vertexColors=void 0!==e.vertexColors&&e.vertexColors,this.fog=void 0===e.fog||e.fog},THREE.ParticleBasicMaterial.prototype=new THREE.Material,THREE.ParticleBasicMaterial.prototype.constructor=THREE.ParticleBasicMaterial,THREE.ShaderMaterial=function(e){THREE.Material.call(this,e),e=e||{},this.fragmentShader=void 0!==e.fragmentShader?e.fragmentShader:"void main() {}",this.vertexShader=void 0!==e.vertexShader?e.vertexShader:"void main() {}",this.uniforms=void 0!==e.uniforms?e.uniforms:{},this.attributes=e.attributes,this.shading=void 0!==e.shading?e.shading:THREE.SmoothShading,this.wireframe=void 0!==e.wireframe&&e.wireframe,this.wireframeLinewidth=void 0!==e.wireframeLinewidth?e.wireframeLinewidth:1,this.fog=void 0!==e.fog&&e.fog,this.lights=void 0!==e.lights&&e.lights,this.vertexColors=void 0!==e.vertexColors?e.vertexColors:THREE.NoColors,this.skinning=void 0!==e.skinning&&e.skinning,this.morphTargets=void 0!==e.morphTargets&&e.morphTargets,this.morphNormals=void 0!==e.morphNormals&&e.morphNormals},THREE.ShaderMaterial.prototype=new THREE.Material,THREE.ShaderMaterial.prototype.constructor=THREE.ShaderMaterial,THREE.Texture=function(e,t,n,i,r,o,a,s){this.id=THREE.TextureCount++,this.image=e,this.mapping=void 0!==t?t:new THREE.UVMapping,this.wrapS=void 0!==n?n:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==i?i:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==r?r:THREE.LinearFilter,this.minFilter=void 0!==o?o:THREE.LinearMipMapLinearFilter,this.format=void 0!==a?a:THREE.RGBAFormat,this.type=void 0!==s?s:THREE.UnsignedByteType,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.generateMipmaps=!0,this.needsUpdate=this.premultiplyAlpha=!1,this.onUpdate=null},THREE.Texture.prototype={constructor:THREE.Texture,clone:function(){var e=new THREE.Texture(this.image,this.mapping,this.wrapS,this.wrapT,this.magFilter,this.minFilter,this.format,this.type);return e.offset.copy(this.offset),e.repeat.copy(this.repeat),e}},THREE.TextureCount=0,THREE.MultiplyOperation=0,THREE.MixOperation=1,THREE.UVMapping=function(){},THREE.CubeReflectionMapping=function(){},THREE.CubeRefractionMapping=function(){},THREE.SphericalReflectionMapping=function(){},THREE.SphericalRefractionMapping=function(){},THREE.RepeatWrapping=0,THREE.ClampToEdgeWrapping=1,THREE.MirroredRepeatWrapping=2,THREE.NearestFilter=3,THREE.NearestMipMapNearestFilter=4,THREE.NearestMipMapLinearFilter=5,THREE.LinearFilter=6,THREE.LinearMipMapNearestFilter=7,THREE.LinearMipMapLinearFilter=8,THREE.ByteType=9,THREE.UnsignedByteType=10,THREE.ShortType=11,THREE.UnsignedShortType=12,THREE.IntType=13,THREE.UnsignedIntType=14,THREE.FloatType=15,THREE.AlphaFormat=16,THREE.RGBFormat=17,THREE.RGBAFormat=18,THREE.LuminanceFormat=19,THREE.LuminanceAlphaFormat=20,THREE.DataTexture=function(e,t,n,i,r,o,a,s,l,c){THREE.Texture.call(this,null,o,a,s,l,c,i,r),this.image={data:e,width:t,height:n}},THREE.DataTexture.prototype=new THREE.Texture,THREE.DataTexture.prototype.constructor=THREE.DataTexture,THREE.DataTexture.prototype.clone=function(){var e=new THREE.DataTexture(this.image.data,this.image.width,this.image.height,this.format,this.type,this.mapping,this.wrapS,this.wrapT,this.magFilter,this.minFilter);return e.offset.copy(this.offset),e.repeat.copy(this.repeat),e},THREE.Particle=function(e){THREE.Object3D.call(this),this.material=e},THREE.Particle.prototype=new THREE.Object3D,THREE.Particle.prototype.constructor=THREE.Particle,THREE.ParticleSystem=function(e,t){THREE.Object3D.call(this),this.geometry=e,this.material=void 0!==t?t:new THREE.ParticleBasicMaterial({color:16777215*Math.random()}),this.sortParticles=!1,this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere(),this.boundRadius=e.boundingSphere.radius),this.frustumCulled=!1},THREE.ParticleSystem.prototype=new THREE.Object3D,THREE.ParticleSystem.prototype.constructor=THREE.ParticleSystem,THREE.Line=function(e,t,n){THREE.Object3D.call(this),this.geometry=e,this.material=void 0!==t?t:new THREE.LineBasicMaterial({color:16777215*Math.random()}),this.type=void 0!==n?n:THREE.LineStrip,this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere())},THREE.LineStrip=0,THREE.LinePieces=1,THREE.Line.prototype=new THREE.Object3D,THREE.Line.prototype.constructor=THREE.Line,THREE.Mesh=function(e,t){if(THREE.Object3D.call(this),this.geometry=e,this.material=void 0!==t?t:new THREE.MeshBasicMaterial({color:16777215*Math.random(),wireframe:!0}),this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere(),this.boundRadius=e.boundingSphere.radius,this.geometry.morphTargets.length)){this.morphTargetBase=-1,this.morphTargetForcedOrder=[],this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var n=0;n<this.geometry.morphTargets.length;n++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[n].name]=n}},THREE.Mesh.prototype=new THREE.Object3D,THREE.Mesh.prototype.constructor=THREE.Mesh,THREE.Mesh.prototype.supr=THREE.Object3D.prototype,THREE.Mesh.prototype.getMorphTargetIndexByName=function(e){return void 0!==this.morphTargetDictionary[e]?this.morphTargetDictionary[e]:0},THREE.Ribbon=function(e,t){THREE.Object3D.call(this),this.geometry=e,this.material=t},THREE.Ribbon.prototype=new THREE.Object3D,THREE.Ribbon.prototype.constructor=THREE.Ribbon,THREE.LOD=function(){THREE.Object3D.call(this),this.LODs=[]},THREE.LOD.prototype=new THREE.Object3D,THREE.LOD.prototype.constructor=THREE.LOD,THREE.LOD.prototype.supr=THREE.Object3D.prototype,THREE.LOD.prototype.addLevel=function(e,t){void 0===t&&(t=0);for(var t=Math.abs(t),n=0;n<this.LODs.length&&!(t<this.LODs[n].visibleAtDistance);n++);this.LODs.splice(n,0,{visibleAtDistance:t,object3D:e}),this.add(e)},THREE.LOD.prototype.update=function(e){if(1<this.LODs.length){e.matrixWorldInverse.getInverse(e.matrixWorld),e=-((e=e.matrixWorldInverse).elements[2]*this.matrixWorld.elements[12]+e.elements[6]*this.matrixWorld.elements[13]+e.elements[10]*this.matrixWorld.elements[14]+e.elements[14]),this.LODs[0].object3D.visible=!0;for(var t=1;t<this.LODs.length&&e>=this.LODs[t].visibleAtDistance;t++)this.LODs[t-1].object3D.visible=!1,this.LODs[t].object3D.visible=!0;for(;t<this.LODs.length;t++)this.LODs[t].object3D.visible=!1}},THREE.Sprite=function(e){THREE.Object3D.call(this),this.color=void 0!==e.color?new THREE.Color(e.color):new THREE.Color(16777215),this.map=void 0!==e.map?e.map:new THREE.Texture,this.blending=void 0!==e.blending?e.blending:THREE.NormalBlending,this.blendSrc=void 0!==e.blendSrc?e.blendSrc:THREE.SrcAlphaFactor,this.blendDst=void 0!==e.blendDst?e.blendDst:THREE.OneMinusSrcAlphaFactor,this.blendEquation=void 0!==e.blendEquation?e.blendEquation:THREE.AddEquation,this.useScreenCoordinates=void 0===e.useScreenCoordinates||e.useScreenCoordinates,this.mergeIntoThis3D=void 0!==e.mergeIntoThis3D?e.mergeIntoThis3D:!this.useScreenCoordinates,this.affectedByDistance=void 0!==e.affectedByDistance?e.affectedByDistance:!this.useScreenCoordinates,this.scaleByViewport=void 0!==e.scaleByViewport?e.scaleByViewport:!this.affectedByDistance,this.alignment=e.alignment instanceof THREE.Vector2?e.alignment:THREE.SpriteAlignment.center,this.rotation3d=this.rotation,this.rotation=0,this.opacity=1,this.uvOffset=new THREE.Vector2(0,0),this.uvScale=new THREE.Vector2(1,1)},THREE.Sprite.prototype=new THREE.Object3D,THREE.Sprite.prototype.constructor=THREE.Sprite,THREE.Sprite.prototype.updateMatrix=function(){this.matrix.setPosition(this.position),this.rotation3d.set(0,0,this.rotation),this.matrix.setRotationFromEuler(this.rotation3d),1===this.scale.x&&1===this.scale.y||(this.matrix.scale(this.scale),this.boundRadiusScale=Math.max(this.scale.x,this.scale.y)),this.matrixWorldNeedsUpdate=!0},THREE.SpriteAlignment={},THREE.SpriteAlignment.topLeft=new THREE.Vector2(1,-1),THREE.SpriteAlignment.topCenter=new THREE.Vector2(0,-1),THREE.SpriteAlignment.topRight=new THREE.Vector2(-1,-1),THREE.SpriteAlignment.centerLeft=new THREE.Vector2(1,0),THREE.SpriteAlignment.center=new THREE.Vector2(0,0),THREE.SpriteAlignment.centerRight=new THREE.Vector2(-1,0),THREE.SpriteAlignment.bottomLeft=new THREE.Vector2(1,1),THREE.SpriteAlignment.bottomCenter=new THREE.Vector2(0,1),THREE.SpriteAlignment.bottomRight=new THREE.Vector2(-1,1),THREE.Scene=function(){THREE.Object3D.call(this),this.overrideMaterial=this.fog=null,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]},THREE.Scene.prototype=new THREE.Object3D,THREE.Scene.prototype.constructor=THREE.Scene,THREE.Scene.prototype.__addObject=function(e){var t;for(e instanceof THREE.Light?-1===this.__lights.indexOf(e)&&this.__lights.push(e):e instanceof THREE.Camera||-1!==this.__objects.indexOf(e)||(this.__objects.push(e),this.__objectsAdded.push(e),-1!==(t=this.__objectsRemoved.indexOf(e))&&this.__objectsRemoved.splice(t,1)),t=0;t<e.children.length;t++)this.__addObject(e.children[t])},THREE.Scene.prototype.__removeObject=function(e){var t;for(e instanceof THREE.Light?-1!==(t=this.__lights.indexOf(e))&&this.__lights.splice(t,1):e instanceof THREE.Camera||-1!==(t=this.__objects.indexOf(e))&&(this.__objects.splice(t,1),this.__objectsRemoved.push(e),-1!==(t=this.__objectsAdded.indexOf(e))&&this.__objectsAdded.splice(t,1)),t=0;t<e.children.length;t++)this.__removeObject(e.children[t])},THREE.Fog=function(e,t,n){this.color=new THREE.Color(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3},THREE.FogExp2=function(e,t){this.color=new THREE.Color(e),this.density=void 0!==t?t:25e-5},THREE.ShaderChunk={fog_pars_fragment:"#ifdef USE_FOG\nuniform vec3 fogColor;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;\nuniform float fogFar;\n#endif\n#endif",fog_fragment:"#ifdef USE_FOG\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#ifdef FOG_EXP2\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n#else\nfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n#endif\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\nvarying vec3 vReflect;\nuniform float reflectivity;\nuniform samplerCube envMap;\nuniform float flipEnvMap;\nuniform int combine;\n#endif",envmap_fragment:"#ifdef USE_ENVMAP\n#ifdef DOUBLE_SIDED\nfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\nvec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * vReflect.x, vReflect.yz ) );\n#else\nvec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * vReflect.x, vReflect.yz ) );\n#endif\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\nif ( combine == 1 ) {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, reflectivity );\n} else {\ngl_FragColor.xyz = gl_FragColor.xyz * cubeColor.xyz;\n}\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\nvarying vec3 vReflect;\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\nvec3 nWorld = mat3( objectMatrix[ 0 ].xyz, objectMatrix[ 1 ].xyz, objectMatrix[ 2 ].xyz ) * normal;\nif ( useRefract ) {\nvReflect = refract( normalize( mPosition.xyz - cameraPosition ), normalize( nWorld.xyz ), refractionRatio );\n} else {\nvReflect = reflect( normalize( mPosition.xyz - cameraPosition ), normalize( nWorld.xyz ) );\n}\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\nuniform sampler2D map;\n#endif",map_particle_fragment:"#ifdef USE_MAP\ngl_FragColor = gl_FragColor * texture2D( map, gl_PointCoord );\n#endif",map_pars_vertex:"#ifdef USE_MAP\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif",map_pars_fragment:"#ifdef USE_MAP\nvarying vec2 vUv;\nuniform sampler2D map;\n#endif",map_vertex:"#ifdef USE_MAP\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",map_fragment:"#ifdef USE_MAP\n#ifdef GAMMA_INPUT\nvec4 texelColor = texture2D( map, vUv );\ntexelColor.xyz *= texelColor.xyz;\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor = gl_FragColor * texture2D( map, vUv );\n#endif\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\nuniform sampler2D lightMap;\n#endif",lightmap_pars_vertex:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\ngl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n#endif",lightmap_vertex:"#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif",lights_lambert_pars_vertex:"uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngle[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif",lights_lambert_vertex:"vLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\nvLightBack = vec3( 0.0 );\n#endif\ntransformedNormal = normalize( transformedNormal );\n#if MAX_DIR_LIGHTS > 0\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, dirVector );\nvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\ndirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\ndirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n#ifdef DOUBLE_SIDED\nvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n#endif\n}\n#endif\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\npointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\npointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n#ifdef DOUBLE_SIDED\nvLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nlVector = normalize( lVector );\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - mPosition.xyz ) );\nif ( spotEffect > spotLightAngle[ i ] ) {\nspotEffect = pow( spotEffect, spotLightExponent[ i ] );\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\nspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\nspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n#ifdef DOUBLE_SIDED\nvLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n#endif\n}\n}\n#endif\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n#ifdef DOUBLE_SIDED\nvLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n#endif",lights_phong_pars_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvarying vec3 vWorldPosition;\n#endif",lights_phong_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nvSpotLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvWorldPosition = mPosition.xyz;\n#endif",lights_phong_pars_fragment:"uniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#else\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngle[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#else\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\nvarying vec3 vWorldPosition;\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",lights_phong_fragment:"vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#ifdef DOUBLE_SIDED\nnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n#endif\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse  = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vPointLight[ i ].xyz );\nfloat lDistance = vPointLight[ i ].w;\n#endif\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n#endif\npointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\nvec3 pointHalfVector = normalize( lVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = max( pow( pointDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n#else\npointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse  = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vSpotLight[ i ].xyz );\nfloat lDistance = vSpotLight[ i ].w;\n#endif\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngle[ i ] ) {\nspotEffect = pow( spotEffect, spotLightExponent[ i ] );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n#endif\nspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\nvec3 spotHalfVector = normalize( lVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = max( pow( spotDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse  = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, dirVector );\n#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n#endif\ndirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = max( pow( dirDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_fragment:"#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, opacity );\n#endif",color_pars_vertex:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\nuniform mat4 boneGlobalMatrices[ MAX_BONES ];\n#endif",skinning_vertex:"#ifdef USE_SKINNING\ngl_Position  = ( boneGlobalMatrices[ int( skinIndex.x ) ] * skinVertexA ) * skinWeight.x;\ngl_Position += ( boneGlobalMatrices[ int( skinIndex.y ) ] * skinVertexB ) * skinWeight.y;\ngl_Position  = projectionMatrix * modelViewMatrix * gl_Position;\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n#ifndef USE_MORPHNORMALS\nuniform float morphTargetInfluences[ 8 ];\n#else\nuniform float morphTargetInfluences[ 4 ];\n#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\nvec3 morphed = vec3( 0.0 );\nmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\nmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\nmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\nmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n#ifndef USE_MORPHNORMALS\nmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\nmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\nmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\nmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n#endif\nmorphed += position;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( morphed, 1.0 );\n#endif",default_vertex:"#ifndef USE_MORPHTARGETS\n#ifndef USE_SKINNING\ngl_Position = projectionMatrix * mvPosition;\n#endif\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\nvec3 morphedNormal = vec3( 0.0 );\nmorphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\nmorphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\nmorphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\nmorphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\nmorphedNormal += normal;\nvec3 transformedNormal = normalMatrix * morphedNormal;\n#else\nvec3 transformedNormal = normalMatrix * normal;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap[ MAX_SHADOWS ];\nuniform vec2 shadowMapSize[ MAX_SHADOWS ];\nuniform float shadowDarkness[ MAX_SHADOWS ];\nuniform float shadowBias[ MAX_SHADOWS ];\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\n#endif",shadowmap_fragment:"#ifdef USE_SHADOWMAP\n#ifdef SHADOWMAP_DEBUG\nvec3 frustumColors[3];\nfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\nfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\nfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n#endif\n#ifdef SHADOWMAP_CASCADE\nint inFrustumCount = 0;\n#endif\nfloat fDepth;\nvec3 shadowColor = vec3( 1.0 );\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\nbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\nbool inFrustum = all( inFrustumVec );\n#ifdef SHADOWMAP_CASCADE\ninFrustumCount += int( inFrustum );\nbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n#else\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n#endif\nbool frustumTest = all( frustumTestVec );\nif ( frustumTest ) {\nshadowCoord.z += shadowBias[ i ];\n#ifdef SHADOWMAP_SOFT\nfloat shadow = 0.0;\nconst float shadowDelta = 1.0 / 9.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.25 * xPixelOffset;\nfloat dy0 = -1.25 * yPixelOffset;\nfloat dx1 = 1.25 * xPixelOffset;\nfloat dy1 = 1.25 * yPixelOffset;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#else\nvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\nfloat fDepth = unpackDepth( rgbaDepth );\nif ( fDepth < shadowCoord.z )\nshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n#endif\n}\n#ifdef SHADOWMAP_DEBUG\n#ifdef SHADOWMAP_CASCADE\nif ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n#else\nif ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n#endif\n#endif\n}\n#ifdef GAMMA_OUTPUT\nshadowColor *= shadowColor;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n#ifdef USE_MORPHTARGETS\nvShadowCoord[ i ] = shadowMatrix[ i ] * objectMatrix * vec4( morphed, 1.0 );\n#else\nvShadowCoord[ i ] = shadowMatrix[ i ] * objectMatrix * vec4( position, 1.0 );\n#endif\n}\n#endif",alphatest_fragment:"#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif",linear_to_gamma_fragment:"#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif"},THREE.UniformsUtils={merge:function(e){for(var t,n,i={},r=0;r<e.length;r++)for(t in n=this.clone(e[r]))i[t]=n[t];return i},clone:function(e){var t,n,i,r={};for(t in e)for(n in r[t]={},e[t])i=e[t][n],r[t][n]=i instanceof THREE.Color||i instanceof THREE.Vector2||i instanceof THREE.Vector3||i instanceof THREE.Vector4||i instanceof THREE.Matrix4||i instanceof THREE.Texture?i.clone():i instanceof Array?i.slice():i;return r}},THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:0,texture:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:2,texture:null},envMap:{type:"t",value:1,texture:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngle:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:0,texture:null},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:6,texture:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},THREE.ShaderLib={depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float mNear;\nuniform float mFar;\nuniform float opacity;\nvoid main() {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat color = 1.0 - smoothstep( mNear, mFar, depth );\ngl_FragColor = vec4( vec3( color ), opacity );\n}"},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:"varying vec3 vNormal;\nvoid main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\nvNormal = normalMatrix * normal;\ngl_Position = projectionMatrix * mvPosition;\n}",fragmentShader:"uniform float opacity;\nvarying vec3 vNormal;\nvoid main() {\ngl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n}"},basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["varying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,"#ifndef USE_ENVMAP\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\n#endif",THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,"#ifdef DOUBLE_SIDED\nif ( gl_FrontFacing )\ngl_FragColor.xyz *= vLightFront;\nelse\ngl_FragColor.xyz *= vLightBack;\n#else\ngl_FragColor.xyz *= vLightFront;\n#endif",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["varying vec3 vViewPosition;\nvarying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.color_vertex,"#ifndef USE_ENVMAP\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\n#endif\nvViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.morphnormal_vertex,"vNormal = transformedNormal;",THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;\nuniform float scale;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n#ifdef USE_SIZEATTENUATION\ngl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n#else\ngl_PointSize = size;\n#endif\ngl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"vec4 pack_depth( const in float depth ) {\nconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\nconst vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\nvec4 res = fract( depth * bit_shift );\nres -= res.xxyz * bit_mask;\nreturn res;\n}\nvoid main() {\ngl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n}"}},THREE.WebGLRenderer=function(e){function Hn(e,t){var n=e.vertices.length,i=t.material;if(i.attributes)for(var r in void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]),i.attributes){var o,a=i.attributes[r];a.__webglInitialized&&!a.createUniqueBuffers||(a.__webglInitialized=!0,o=1,"v2"===a.type?o=2:"v3"===a.type?o=3:"v4"===a.type?o=4:"c"===a.type&&(o=3),a.size=o,a.array=new Float32Array(n*o),a.buffer=Un.createBuffer(),a.buffer.belongsToAttribute=r,a.needsUpdate=!0),e.__webglCustomAttributesList.push(a)}}function Fn(e,t){return!e.material||e.material instanceof THREE.MeshFaceMaterial?0<=t.materialIndex?e.geometry.materials[t.materialIndex]:void 0:e.material}function Pn(e){return!(e instanceof THREE.MeshBasicMaterial&&!e.envMap||e instanceof THREE.MeshDepthMaterial)&&(e&&void 0!==e.shading&&e.shading===THREE.SmoothShading?THREE.SmoothShading:THREE.FlatShading)}function Nn(e){return!!(e.map||e.lightMap||e instanceof THREE.ShaderMaterial)}function kn(e,t,n){var i,r,o,a=e.vertices,s=a.length,l=e.colors,c=l.length,u=e.__vertexArray,h=e.__colorArray,f=e.__sortArray,d=e.verticesNeedUpdate,p=e.colorsNeedUpdate,m=e.__webglCustomAttributesList;if(n.sortParticles){for(Y.copy($),Y.multiplySelf(n.matrixWorld),i=0;i<s;i++)r=a[i],J.copy(r),Y.multiplyVector3(J),f[i]=[J.z,i];for(f.sort(function(e,t){return t[0]-e[0]}),i=0;i<s;i++)r=a[f[i][1]],u[o=3*i]=r.x,u[o+1]=r.y,u[o+2]=r.z;for(i=0;i<c;i++)o=3*i,r=l[f[i][1]],h[o]=r.r,h[o+1]=r.g,h[o+2]=r.b;if(m)for(l=0,c=m.length;l<c;l++)if(void 0===(a=m[l]).boundTo||"vertices"===a.boundTo)if(o=0,r=a.value.length,1===a.size)for(i=0;i<r;i++)s=f[i][1],a.array[i]=a.value[s];else if(2===a.size)for(i=0;i<r;i++)s=f[i][1],s=a.value[s],a.array[o]=s.x,a.array[o+1]=s.y,o+=2;else if(3===a.size)if("c"===a.type)for(i=0;i<r;i++)s=f[i][1],s=a.value[s],a.array[o]=s.r,a.array[o+1]=s.g,a.array[o+2]=s.b,o+=3;else for(i=0;i<r;i++)s=f[i][1],s=a.value[s],a.array[o]=s.x,a.array[o+1]=s.y,a.array[o+2]=s.z,o+=3;else if(4===a.size)for(i=0;i<r;i++)s=f[i][1],s=a.value[s],a.array[o]=s.x,a.array[o+1]=s.y,a.array[o+2]=s.z,a.array[o+3]=s.w,o+=4}else{if(d)for(i=0;i<s;i++)r=a[i],u[o=3*i]=r.x,u[o+1]=r.y,u[o+2]=r.z;if(p)for(i=0;i<c;i++)r=l[i],h[o=3*i]=r.r,h[o+1]=r.g,h[o+2]=r.b;if(m)for(l=0,c=m.length;l<c;l++)if((a=m[l]).needsUpdate&&(void 0===a.boundTo||"vertices"===a.boundTo))if(r=a.value.length,o=0,1===a.size)for(i=0;i<r;i++)a.array[i]=a.value[i];else if(2===a.size)for(i=0;i<r;i++)s=a.value[i],a.array[o]=s.x,a.array[o+1]=s.y,o+=2;else if(3===a.size)if("c"===a.type)for(i=0;i<r;i++)s=a.value[i],a.array[o]=s.r,a.array[o+1]=s.g,a.array[o+2]=s.b,o+=3;else for(i=0;i<r;i++)s=a.value[i],a.array[o]=s.x,a.array[o+1]=s.y,a.array[o+2]=s.z,o+=3;else if(4===a.size)for(i=0;i<r;i++)s=a.value[i],a.array[o]=s.x,a.array[o+1]=s.y,a.array[o+2]=s.z,a.array[o+3]=s.w,o+=4}if((d||n.sortParticles)&&(Un.bindBuffer(Un.ARRAY_BUFFER,e.__webglVertexBuffer),Un.bufferData(Un.ARRAY_BUFFER,u,t)),(p||n.sortParticles)&&(Un.bindBuffer(Un.ARRAY_BUFFER,e.__webglColorBuffer),Un.bufferData(Un.ARRAY_BUFFER,h,t)),m)for(l=0,c=m.length;l<c;l++)((a=m[l]).needsUpdate||n.sortParticles)&&(Un.bindBuffer(Un.ARRAY_BUFFER,a.buffer),Un.bufferData(Un.ARRAY_BUFFER,a.array,t))}function p(e,t){return t.z-e.z}function m(e,t,n){if(e.length)for(var i=0,r=e.length;i<r;i++)I=N=null,k=w=f=h=M=A=C=-1,Q=!0,e[i].render(t,n,G,q),I=N=null,k=w=f=h=M=A=C=-1,Q=!0}function g(e,t,n,i,r,o,a,s){for(var l,c,u,h=t?(c=e.length-1,t=-1):(c=0,t=e.length,1),f=c;f!==t;f+=h)if((l=e[f]).render){if(c=l.object,u=l.buffer,s)l=s;else{if(!(l=l[n]))continue;a&&zn.setBlending(l.blending,l.blendEquation,l.blendSrc,l.blendDst),zn.setDepthTest(l.depthTest),zn.setDepthWrite(l.depthWrite),y(l.polygonOffset,l.polygonOffsetFactor,l.polygonOffsetUnits)}zn.setObjectFaces(c),u instanceof THREE.BufferGeometry?zn.renderBufferDirect(i,r,o,l,u,c):zn.renderBuffer(i,r,o,l,u,c)}}function v(e,t,n,i,r,o,a){for(var s,l,c=0,u=e.length;c<u;c++)if((l=(s=e[c]).object).visible){if(a)s=a;else{if(!(s=s[t]))continue;o&&zn.setBlending(s.blending,s.blendEquation,s.blendSrc,s.blendDst),zn.setDepthTest(s.depthTest),zn.setDepthWrite(s.depthWrite),y(s.polygonOffset,s.polygonOffsetFactor,s.polygonOffsetUnits)}zn.renderImmediateObject(n,i,r,s,l)}}function In(e,t,n){e.push({buffer:t,object:n,opaque:null,transparent:null})}function On(e){for(var t in e.attributes)if(e.attributes[t].needsUpdate)return!0;return!1}function Bn(e){for(var t in e.attributes)e.attributes[t].needsUpdate=!1}function d(e,t,n,i,r){if(i.program&&!i.needsUpdate||(zn.initMaterial(i,t,n,r),i.needsUpdate=!1),i.morphTargets&&!r.__webglMorphTargetInfluences){r.__webglMorphTargetInfluences=new Float32Array(zn.maxMorphTargets);for(var o=0,a=zn.maxMorphTargets;o<a;o++)r.__webglMorphTargetInfluences[o]=0}var s=!1,a=(o=i.program).uniforms,l=i.uniforms;if(o!==N&&(Un.useProgram(o),N=o,s=!0),i.id!==k&&(k=i.id,s=!0),!s&&e===I||(Un.uniformMatrix4fv(a.projectionMatrix,!1,e._projectionMatrixArray),e!==I&&(I=e)),s){if(n&&i.fog&&(l.fogColor.value=n.color,n instanceof THREE.Fog?(l.fogNear.value=n.near,l.fogFar.value=n.far):n instanceof THREE.FogExp2&&(l.fogDensity.value=n.density)),i instanceof THREE.MeshPhongMaterial||i instanceof THREE.MeshLambertMaterial||i.lights){if(Q){for(var c,u,h,f,d=0,p=0,m=0,g=K,v=g.directional.colors,_=g.directional.positions,y=g.point.colors,b=g.point.positions,x=g.point.distances,E=g.spot.colors,T=g.spot.positions,w=g.spot.distances,C=g.spot.directions,S=g.spot.angles,D=g.spot.exponents,R=0,A=0,M=0,L=f=0,n=L=0,s=t.length;n<s;n++)(c=t[n]).onlyShadow||(u=c.color,h=c.intensity,f=c.distance,c instanceof THREE.AmbientLight?zn.gammaInput?(d+=u.r*u.r,p+=u.g*u.g,m+=u.b*u.b):(d+=u.r,p+=u.g,m+=u.b):c instanceof THREE.DirectionalLight?(f=3*R,zn.gammaInput?(v[f]=u.r*u.r*h*h,v[f+1]=u.g*u.g*h*h,v[f+2]=u.b*u.b*h*h):(v[f]=u.r*h,v[f+1]=u.g*h,v[f+2]=u.b*h),Z.copy(c.matrixWorld.getPosition()),Z.subSelf(c.target.matrixWorld.getPosition()),Z.normalize(),_[f]=Z.x,_[f+1]=Z.y,_[f+2]=Z.z,R+=1):c instanceof THREE.PointLight?(L=3*A,zn.gammaInput?(y[L]=u.r*u.r*h*h,y[L+1]=u.g*u.g*h*h,y[L+2]=u.b*u.b*h*h):(y[L]=u.r*h,y[L+1]=u.g*h,y[L+2]=u.b*h),u=c.matrixWorld.getPosition(),b[L]=u.x,b[L+1]=u.y,b[L+2]=u.z,x[A]=f,A+=1):c instanceof THREE.SpotLight&&(L=3*M,zn.gammaInput?(E[L]=u.r*u.r*h*h,E[L+1]=u.g*u.g*h*h,E[L+2]=u.b*u.b*h*h):(E[L]=u.r*h,E[L+1]=u.g*h,E[L+2]=u.b*h),u=c.matrixWorld.getPosition(),T[L]=u.x,T[L+1]=u.y,T[L+2]=u.z,w[M]=f,Z.copy(u),Z.subSelf(c.target.matrixWorld.getPosition()),Z.normalize(),C[L]=Z.x,C[L+1]=Z.y,C[L+2]=Z.z,S[M]=Math.cos(c.angle),D[M]=c.exponent,M+=1));for(n=3*R,s=v.length;n<s;n++)v[n]=0;for(n=3*A,s=y.length;n<s;n++)y[n]=0;for(n=3*M,s=E.length;n<s;n++)E[n]=0;g.directional.length=R,g.point.length=A,g.spot.length=M,g.ambient[0]=d,g.ambient[1]=p,g.ambient[2]=m,Q=!1}n=K,l.ambientLightColor.value=n.ambient,l.directionalLightColor.value=n.directional.colors,l.directionalLightDirection.value=n.directional.positions,l.pointLightColor.value=n.point.colors,l.pointLightPosition.value=n.point.positions,l.pointLightDistance.value=n.point.distances,l.spotLightColor.value=n.spot.colors,l.spotLightPosition.value=n.spot.positions,l.spotLightDistance.value=n.spot.distances,l.spotLightDirection.value=n.spot.directions,l.spotLightAngle.value=n.spot.angles,l.spotLightExponent.value=n.spot.exponents}if((i instanceof THREE.MeshBasicMaterial||i instanceof THREE.MeshLambertMaterial||i instanceof THREE.MeshPhongMaterial)&&(l.opacity.value=i.opacity,zn.gammaInput?l.diffuse.value.copyGammaToLinear(i.color):l.diffuse.value=i.color,(l.map.texture=i.map)&&l.offsetRepeat.value.set(i.map.offset.x,i.map.offset.y,i.map.repeat.x,i.map.repeat.y),l.lightMap.texture=i.lightMap,l.envMap.texture=i.envMap,l.flipEnvMap.value=i.envMap instanceof THREE.WebGLRenderTargetCube?1:-1,l.reflectivity.value=i.reflectivity,l.refractionRatio.value=i.refractionRatio,l.combine.value=i.combine,l.useRefract.value=i.envMap&&i.envMap.mapping instanceof THREE.CubeRefractionMapping),i instanceof THREE.LineBasicMaterial?(l.diffuse.value=i.color,l.opacity.value=i.opacity):i instanceof THREE.ParticleBasicMaterial?(l.psColor.value=i.color,l.opacity.value=i.opacity,l.size.value=i.size,l.scale.value=P.height/2,l.map.texture=i.map):i instanceof THREE.MeshPhongMaterial?(l.shininess.value=i.shininess,zn.gammaInput?(l.ambient.value.copyGammaToLinear(i.ambient),l.emissive.value.copyGammaToLinear(i.emissive),l.specular.value.copyGammaToLinear(i.specular)):(l.ambient.value=i.ambient,l.emissive.value=i.emissive,l.specular.value=i.specular),i.wrapAround&&l.wrapRGB.value.copy(i.wrapRGB)):i instanceof THREE.MeshLambertMaterial?(zn.gammaInput?(l.ambient.value.copyGammaToLinear(i.ambient),l.emissive.value.copyGammaToLinear(i.emissive)):(l.ambient.value=i.ambient,l.emissive.value=i.emissive),i.wrapAround&&l.wrapRGB.value.copy(i.wrapRGB)):i instanceof THREE.MeshDepthMaterial?(l.mNear.value=e.near,l.mFar.value=e.far,l.opacity.value=i.opacity):i instanceof THREE.MeshNormalMaterial&&(l.opacity.value=i.opacity),r.receiveShadow&&!i._shadowPass&&l.shadowMatrix)for(s=n=0,c=t.length;s<c;s++)(d=t[s]).castShadow&&(d instanceof THREE.SpotLight||d instanceof THREE.DirectionalLight&&!d.shadowCascade)&&(l.shadowMap.texture[n]=d.shadowMap,l.shadowMapSize.value[n]=d.shadowMapSize,l.shadowMatrix.value[n]=d.shadowMatrix,l.shadowDarkness.value[n]=d.shadowDarkness,l.shadowBias.value[n]=d.shadowBias,n++);for(l=0,n=(t=i.uniformsList).length;l<n;l++)if(d=o.uniforms[t[l][1]])switch(p=(s=t[l][0]).type,c=s.value,p){case"i":Un.uniform1i(d,c);break;case"f":Un.uniform1f(d,c);break;case"v2":Un.uniform2f(d,c.x,c.y);break;case"v3":Un.uniform3f(d,c.x,c.y,c.z);break;case"v4":Un.uniform4f(d,c.x,c.y,c.z,c.w);break;case"c":Un.uniform3f(d,c.r,c.g,c.b);break;case"fv1":Un.uniform1fv(d,c);break;case"fv":Un.uniform3fv(d,c);break;case"v2v":for(s._array||(s._array=new Float32Array(2*c.length)),p=0,m=c.length;p<m;p++)g=2*p,s._array[g]=c[p].x,s._array[g+1]=c[p].y;Un.uniform2fv(d,s._array);break;case"v3v":for(s._array||(s._array=new Float32Array(3*c.length)),p=0,m=c.length;p<m;p++)g=3*p,s._array[g]=c[p].x,s._array[g+1]=c[p].y,s._array[g+2]=c[p].z;Un.uniform3fv(d,s._array);break;case"v4v":for(s._array||(s._array=new Float32Array(4*c.length)),p=0,m=c.length;p<m;p++)g=4*p,s._array[g]=c[p].x,s._array[g+1]=c[p].y,s._array[g+2]=c[p].z,s._array[g+3]=c[p].w;Un.uniform4fv(d,s._array);break;case"m4":s._array||(s._array=new Float32Array(16)),c.flattenToArray(s._array),Un.uniformMatrix4fv(d,!1,s._array);break;case"m4v":for(s._array||(s._array=new Float32Array(16*c.length)),p=0,m=c.length;p<m;p++)c[p].flattenToArrayOffset(s._array,16*p);Un.uniformMatrix4fv(d,!1,s._array);break;case"t":if(Un.uniform1i(d,c),!(d=s.texture))continue;if(d.image instanceof Array&&6===d.image.length){if(6===(s=d).image.length)if(s.needsUpdate){for(s.image.__webglTextureCube||(s.image.__webglTextureCube=Un.createTexture()),Un.activeTexture(Un.TEXTURE0+c),Un.bindTexture(Un.TEXTURE_CUBE_MAP,s.image.__webglTextureCube),c=[],d=0;d<6;d++)p=c,m=d,zn.autoScaleCubemaps?(g=s.image[d],_=te,g.width<=_&&g.height<=_||(y=Math.max(g.width,g.height),v=Math.floor(g.width*_/y),_=Math.floor(g.height*_/y),(y=document.createElement("canvas")).width=v,y.height=_,y.getContext("2d").drawImage(g,0,0,g.width,g.height,0,0,v,_),g=y)):g=s.image[d],p[m]=g;for(p=0==((d=c[0]).width&d.width-1)&&0==(d.height&d.height-1),m=F(s.format),g=F(s.type),H(Un.TEXTURE_CUBE_MAP,s,p),d=0;d<6;d++)Un.texImage2D(Un.TEXTURE_CUBE_MAP_POSITIVE_X+d,0,m,m,g,c[d]);s.generateMipmaps&&p&&Un.generateMipmap(Un.TEXTURE_CUBE_MAP),s.needsUpdate=!1,s.onUpdate&&s.onUpdate()}else Un.activeTexture(Un.TEXTURE0+c),Un.bindTexture(Un.TEXTURE_CUBE_MAP,s.image.__webglTextureCube)}else d instanceof THREE.WebGLRenderTargetCube?(s=d,Un.activeTexture(Un.TEXTURE0+c),Un.bindTexture(Un.TEXTURE_CUBE_MAP,s.__webglTexture)):zn.setTexture(d,c);break;case"tv":if(!s._array)for(s._array=[],p=0,m=s.texture.length;p<m;p++)s._array[p]=c+p;for(Un.uniform1iv(d,s._array),p=0,m=s.texture.length;p<m;p++)(d=s.texture[p])&&zn.setTexture(d,s._array[p])}(i instanceof THREE.ShaderMaterial||i instanceof THREE.MeshPhongMaterial||i.envMap)&&null!==a.cameraPosition&&(t=e.matrixWorld.getPosition(),Un.uniform3f(a.cameraPosition,t.x,t.y,t.z)),(i instanceof THREE.MeshPhongMaterial||i instanceof THREE.MeshLambertMaterial||i instanceof THREE.ShaderMaterial||i.skinning)&&null!==a.viewMatrix&&Un.uniformMatrix4fv(a.viewMatrix,!1,e._viewMatrixArray),i.skinning&&Un.uniformMatrix4fv(a.boneGlobalMatrices,!1,r.boneMatrices)}return Un.uniformMatrix4fv(a.modelViewMatrix,!1,r._modelViewMatrix.elements),a.normalMatrix&&Un.uniformMatrix3fv(a.normalMatrix,!1,r._normalMatrix.elements),null!==a.objectMatrix&&Un.uniformMatrix4fv(a.objectMatrix,!1,r.matrixWorld.elements),o}function _(e,t){e._modelViewMatrix.multiply(t.matrixWorldInverse,e.matrixWorld),e._normalMatrix.getInverse(e._modelViewMatrix),e._normalMatrix.transpose()}function y(e,t,n){L!==e&&(e?Un.enable(Un.POLYGON_OFFSET_FILL):Un.disable(Un.POLYGON_OFFSET_FILL),L=e),!e||O===t&&B===n||(Un.polygonOffset(t,n),O=t,B=n)}function b(e,t){var n;return"fragment"===e?n=Un.createShader(Un.FRAGMENT_SHADER):"vertex"===e&&(n=Un.createShader(Un.VERTEX_SHADER)),Un.shaderSource(n,t),Un.compileShader(n),Un.getShaderParameter(n,Un.COMPILE_STATUS)?n:null}function H(e,t,n){n?(Un.texParameteri(e,Un.TEXTURE_WRAP_S,F(t.wrapS)),Un.texParameteri(e,Un.TEXTURE_WRAP_T,F(t.wrapT)),Un.texParameteri(e,Un.TEXTURE_MAG_FILTER,F(t.magFilter)),Un.texParameteri(e,Un.TEXTURE_MIN_FILTER,F(t.minFilter))):(Un.texParameteri(e,Un.TEXTURE_WRAP_S,Un.CLAMP_TO_EDGE),Un.texParameteri(e,Un.TEXTURE_WRAP_T,Un.CLAMP_TO_EDGE),Un.texParameteri(e,Un.TEXTURE_MAG_FILTER,i(t.magFilter)),Un.texParameteri(e,Un.TEXTURE_MIN_FILTER,i(t.minFilter)))}function l(e,t){Un.bindRenderbuffer(Un.RENDERBUFFER,e),t.depthBuffer&&!t.stencilBuffer?(Un.renderbufferStorage(Un.RENDERBUFFER,Un.DEPTH_COMPONENT16,t.width,t.height),Un.framebufferRenderbuffer(Un.FRAMEBUFFER,Un.DEPTH_ATTACHMENT,Un.RENDERBUFFER,e)):t.depthBuffer&&t.stencilBuffer?(Un.renderbufferStorage(Un.RENDERBUFFER,Un.DEPTH_STENCIL,t.width,t.height),Un.framebufferRenderbuffer(Un.FRAMEBUFFER,Un.DEPTH_STENCIL_ATTACHMENT,Un.RENDERBUFFER,e)):Un.renderbufferStorage(Un.RENDERBUFFER,Un.RGBA4,t.width,t.height)}function i(e){switch(e){case THREE.NearestFilter:case THREE.NearestMipMapNearestFilter:case THREE.NearestMipMapLinearFilter:return Un.NEAREST;default:return Un.LINEAR}}function F(e){switch(e){case THREE.RepeatWrapping:return Un.REPEAT;case THREE.ClampToEdgeWrapping:return Un.CLAMP_TO_EDGE;case THREE.MirroredRepeatWrapping:return Un.MIRRORED_REPEAT;case THREE.NearestFilter:return Un.NEAREST;case THREE.NearestMipMapNearestFilter:return Un.NEAREST_MIPMAP_NEAREST;case THREE.NearestMipMapLinearFilter:return Un.NEAREST_MIPMAP_LINEAR;case THREE.LinearFilter:return Un.LINEAR;case THREE.LinearMipMapNearestFilter:return Un.LINEAR_MIPMAP_NEAREST;case THREE.LinearMipMapLinearFilter:return Un.LINEAR_MIPMAP_LINEAR;case THREE.ByteType:return Un.BYTE;case THREE.UnsignedByteType:return Un.UNSIGNED_BYTE;case THREE.ShortType:return Un.SHORT;case THREE.UnsignedShortType:return Un.UNSIGNED_SHORT;case THREE.IntType:return Un.INT;case THREE.UnsignedIntType:return Un.UNSIGNED_INT;case THREE.FloatType:return Un.FLOAT;case THREE.AlphaFormat:return Un.ALPHA;case THREE.RGBFormat:return Un.RGB;case THREE.RGBAFormat:return Un.RGBA;case THREE.LuminanceFormat:return Un.LUMINANCE;case THREE.LuminanceAlphaFormat:return Un.LUMINANCE_ALPHA;case THREE.AddEquation:return Un.FUNC_ADD;case THREE.SubtractEquation:return Un.FUNC_SUBTRACT;case THREE.ReverseSubtractEquation:return Un.FUNC_REVERSE_SUBTRACT;case THREE.ZeroFactor:return Un.ZERO;case THREE.OneFactor:return Un.ONE;case THREE.SrcColorFactor:return Un.SRC_COLOR;case THREE.OneMinusSrcColorFactor:return Un.ONE_MINUS_SRC_COLOR;case THREE.SrcAlphaFactor:return Un.SRC_ALPHA;case THREE.OneMinusSrcAlphaFactor:return Un.ONE_MINUS_SRC_ALPHA;case THREE.DstAlphaFactor:return Un.DST_ALPHA;case THREE.OneMinusDstAlphaFactor:return Un.ONE_MINUS_DST_ALPHA;case THREE.DstColorFactor:return Un.DST_COLOR;case THREE.OneMinusDstColorFactor:return Un.ONE_MINUS_DST_COLOR;case THREE.SrcAlphaSaturateFactor:return Un.SRC_ALPHA_SATURATE}return 0}var P=void 0!==(e=e||{}).canvas?e.canvas:document.createElement("canvas"),x=void 0!==e.precision?e.precision:"highp",t=void 0===e.alpha||e.alpha,n=void 0===e.premultipliedAlpha||e.premultipliedAlpha,r=void 0!==e.antialias&&e.antialias,o=void 0===e.stencil||e.stencil,a=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,s=void 0!==e.clearColor?new THREE.Color(e.clearColor):new THREE.Color(0),c=void 0!==e.clearAlpha?e.clearAlpha:0,E=void 0!==e.maxLights?e.maxLights:4;this.domElement=P,this.context=null,this.autoUpdateScene=this.autoUpdateObjects=this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.shadowMapEnabled=this.physicallyBasedShading=this.gammaOutput=this.gammaInput=!1,this.shadowMapCullFrontFaces=this.shadowMapSoft=this.shadowMapAutoUpdate=!0,this.shadowMapCascade=this.shadowMapDebug=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.renderPluginsPre=[],this.renderPluginsPost=[],this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var zn=this,T=[],N=null,u=null,k=-1,w=null,I=null,jn=0,h=-1,f=-1,C=-1,S=-1,D=-1,R=-1,A=-1,M=-1,L=null,O=null,B=null,z=null,j=0,U=0,V=0,W=0,G=0,q=0,X=new THREE.Frustum,$=new THREE.Matrix4,Y=new THREE.Matrix4,J=new THREE.Vector4,Z=new THREE.Vector3,Q=!0,K={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],angles:[],exponents:[]}},Un=function(){var e;try{if(!(e=P.getContext("experimental-webgl",{alpha:t,premultipliedAlpha:n,antialias:r,stencil:o,preserveDrawingBuffer:a})))throw"Error creating WebGL context."}catch(e){}return e.getExtension("OES_texture_float"),e}();Un.clearColor(0,0,0,1),Un.clearDepth(1),Un.clearStencil(0),Un.enable(Un.DEPTH_TEST),Un.depthFunc(Un.LEQUAL),Un.frontFace(Un.CCW),Un.cullFace(Un.BACK),Un.enable(Un.CULL_FACE),Un.enable(Un.BLEND),Un.blendEquation(Un.FUNC_ADD),Un.blendFunc(Un.SRC_ALPHA,Un.ONE_MINUS_SRC_ALPHA),Un.clearColor(s.r,s.g,s.b,c);var ee=(this.context=Un).getParameter(Un.MAX_VERTEX_TEXTURE_IMAGE_UNITS);Un.getParameter(Un.MAX_TEXTURE_SIZE);var te=Un.getParameter(Un.MAX_CUBE_MAP_TEXTURE_SIZE);this.getContext=function(){return Un},this.supportsVertexTextures=function(){return 0<ee},this.setSize=function(e,t){P.width=e,P.height=t,this.setViewport(0,0,P.width,P.height)},this.setViewport=function(e,t,n,i){j=e,U=t,V=n,W=i,Un.viewport(j,U,V,W)},this.setScissor=function(e,t,n,i){Un.scissor(e,t,n,i)},this.enableScissorTest=function(e){e?Un.enable(Un.SCISSOR_TEST):Un.disable(Un.SCISSOR_TEST)},this.setClearColorHex=function(e,t){s.setHex(e),c=t,Un.clearColor(s.r,s.g,s.b,c)},this.setClearColor=function(e,t){s.copy(e),c=t,Un.clearColor(s.r,s.g,s.b,c)},this.getClearColor=function(){return s},this.getClearAlpha=function(){return c},this.clear=function(e,t,n){var i=0;void 0!==e&&!e||(i|=Un.COLOR_BUFFER_BIT),void 0!==t&&!t||(i|=Un.DEPTH_BUFFER_BIT),void 0!==n&&!n||(i|=Un.STENCIL_BUFFER_BIT),Un.clear(i)},this.clearTarget=function(e,t,n,i){this.setRenderTarget(e),this.clear(t,n,i)},this.addPostPlugin=function(e){e.init(this),this.renderPluginsPost.push(e)},this.addPrePlugin=function(e){e.init(this),this.renderPluginsPre.push(e)},this.deallocateObject=function(e){if(e.__webglInit)if(e.__webglInit=!1,delete e._modelViewMatrix,delete e._normalMatrix,delete e._normalMatrixArray,delete e._modelViewMatrixArray,delete e._objectMatrixArray,e instanceof THREE.Mesh)for(var t in e.geometry.geometryGroups){var n=e.geometry.geometryGroups[t];Un.deleteBuffer(n.__webglVertexBuffer),Un.deleteBuffer(n.__webglNormalBuffer),Un.deleteBuffer(n.__webglTangentBuffer),Un.deleteBuffer(n.__webglColorBuffer),Un.deleteBuffer(n.__webglUVBuffer),Un.deleteBuffer(n.__webglUV2Buffer),Un.deleteBuffer(n.__webglSkinVertexABuffer),Un.deleteBuffer(n.__webglSkinVertexBBuffer),Un.deleteBuffer(n.__webglSkinIndicesBuffer),Un.deleteBuffer(n.__webglSkinWeightsBuffer),Un.deleteBuffer(n.__webglFaceBuffer),Un.deleteBuffer(n.__webglLineBuffer);var i=void 0,r=void 0;if(n.numMorphTargets)for(i=0,r=n.numMorphTargets;i<r;i++)Un.deleteBuffer(n.__webglMorphTargetsBuffers[i]);if(n.numMorphNormals)for(i=0,r=n.numMorphNormals;i<r;i++)Un.deleteBuffer(n.__webglMorphNormalsBuffers[i]);if(n.__webglCustomAttributesList)for(i in i=void 0,n.__webglCustomAttributesList)Un.deleteBuffer(n.__webglCustomAttributesList[i].buffer);zn.info.memory.geometries--}else e instanceof THREE.Line&&(e=e.geometry,Un.deleteBuffer(e.__webglVertexBuffer),Un.deleteBuffer(e.__webglColorBuffer),zn.info.memory.geometries--)},this.deallocateTexture=function(e){e.__webglInit&&(e.__webglInit=!1,Un.deleteTexture(e.__webglTexture),zn.info.memory.textures--)},this.deallocateRenderTarget=function(e){if(e&&e.__webglTexture)if(Un.deleteTexture(e.__webglTexture),e instanceof THREE.WebGLRenderTargetCube)for(var t=0;t<6;t++)Un.deleteFramebuffer(e.__webglFramebuffer[t]),Un.deleteRenderbuffer(e.__webglRenderbuffer[t]);else Un.deleteFramebuffer(e.__webglFramebuffer),Un.deleteRenderbuffer(e.__webglRenderbuffer)},this.updateShadowMap=function(e,t){k=w=M=A=C=-1,Q=!(N=null),f=h=-1,this.shadowMapPlugin.update(e,t)},this.renderBufferImmediate=function(e,t,n){if(e.__webglVertexBuffer||(e.__webglVertexBuffer=Un.createBuffer()),e.__webglNormalBuffer||(e.__webglNormalBuffer=Un.createBuffer()),e.hasPos&&(Un.bindBuffer(Un.ARRAY_BUFFER,e.__webglVertexBuffer),Un.bufferData(Un.ARRAY_BUFFER,e.positionArray,Un.DYNAMIC_DRAW),Un.enableVertexAttribArray(t.attributes.position),Un.vertexAttribPointer(t.attributes.position,3,Un.FLOAT,!1,0,0)),e.hasNormal){if(Un.bindBuffer(Un.ARRAY_BUFFER,e.__webglNormalBuffer),n===THREE.FlatShading)for(var i,r,o,a,s,l,c=3*e.count,u=0;u<c;u+=9)i=(n=e.normalArray)[u],r=n[u+1],o=n[u+2],a=n[u+3],s=n[u+4],l=n[u+5],i=(i+a+n[u+6])/3,r=(r+s+n[u+7])/3,o=(o+l+n[u+8])/3,n[u]=i,n[u+1]=r,n[u+2]=o,n[u+3]=i,n[u+4]=r,n[u+5]=o,n[u+6]=i,n[u+7]=r,n[u+8]=o;Un.bufferData(Un.ARRAY_BUFFER,e.normalArray,Un.DYNAMIC_DRAW),Un.enableVertexAttribArray(t.attributes.normal),Un.vertexAttribPointer(t.attributes.normal,3,Un.FLOAT,!1,0,0)}Un.drawArrays(Un.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,i,r,o){if(!1!==i.visible&&(e=(n=d(e,t,n,i,o)).attributes,t=!1,(i=16777215*r.id+2*n.id+(i.wireframe?1:0))!==w&&(w=i,t=!0),o instanceof THREE.Mesh))for(i=0,n=(o=r.offsets).length;i<n;++i)t&&(Un.bindBuffer(Un.ARRAY_BUFFER,r.vertexPositionBuffer),Un.vertexAttribPointer(e.position,r.vertexPositionBuffer.itemSize,Un.FLOAT,!1,0,12*o[i].index),0<=e.normal&&r.vertexNormalBuffer&&(Un.bindBuffer(Un.ARRAY_BUFFER,r.vertexNormalBuffer),Un.vertexAttribPointer(e.normal,r.vertexNormalBuffer.itemSize,Un.FLOAT,!1,0,12*o[i].index)),0<=e.uv&&r.vertexUvBuffer&&(r.vertexUvBuffer?(Un.bindBuffer(Un.ARRAY_BUFFER,r.vertexUvBuffer),Un.vertexAttribPointer(e.uv,r.vertexUvBuffer.itemSize,Un.FLOAT,!1,0,8*o[i].index),Un.enableVertexAttribArray(e.uv)):Un.disableVertexAttribArray(e.uv)),0<=e.color&&r.vertexColorBuffer&&(Un.bindBuffer(Un.ARRAY_BUFFER,r.vertexColorBuffer),Un.vertexAttribPointer(e.color,r.vertexColorBuffer.itemSize,Un.FLOAT,!1,0,16*o[i].index)),Un.bindBuffer(Un.ELEMENT_ARRAY_BUFFER,r.vertexIndexBuffer)),Un.drawElements(Un.TRIANGLES,o[i].count,Un.UNSIGNED_SHORT,2*o[i].start),zn.info.render.calls++,zn.info.render.vertices=zn.info.render.vertices+o[i].count,zn.info.render.faces=zn.info.render.faces+o[i].count/3},this.renderBuffer=function(e,t,n,i,r,o){if(!1!==i.visible){t=(n=d(e,t,n,i,o)).attributes,e=!1;if((n=16777215*r.id+2*n.id+(i.wireframe?1:0))!==w&&(w=n,e=!0),!i.morphTargets&&0<=t.position)e&&(Un.bindBuffer(Un.ARRAY_BUFFER,r.__webglVertexBuffer),Un.vertexAttribPointer(t.position,3,Un.FLOAT,!1,0,0));else if(o.morphTargetBase){if(n=i.program.attributes,-1!==o.morphTargetBase?(Un.bindBuffer(Un.ARRAY_BUFFER,r.__webglMorphTargetsBuffers[o.morphTargetBase]),Un.vertexAttribPointer(n.position,3,Un.FLOAT,!1,0,0)):0<=n.position&&(Un.bindBuffer(Un.ARRAY_BUFFER,r.__webglVertexBuffer),Un.vertexAttribPointer(n.position,3,Un.FLOAT,!1,0,0)),o.morphTargetForcedOrder.length){f=0;for(var a=o.morphTargetForcedOrder,s=o.morphTargetInfluences;f<i.numSupportedMorphTargets&&f<a.length;)Un.bindBuffer(Un.ARRAY_BUFFER,r.__webglMorphTargetsBuffers[a[f]]),Un.vertexAttribPointer(n["morphTarget"+f],3,Un.FLOAT,!1,0,0),i.morphNormals&&(Un.bindBuffer(Un.ARRAY_BUFFER,r.__webglMorphNormalsBuffers[a[f]]),Un.vertexAttribPointer(n["morphNormal"+f],3,Un.FLOAT,!1,0,0)),o.__webglMorphTargetInfluences[f]=s[a[f]],f++}else{var l,a=[],c=-1,u=0,h=(s=o.morphTargetInfluences).length,f=0;for(-1!==o.morphTargetBase&&(a[o.morphTargetBase]=!0);f<i.numSupportedMorphTargets;){for(l=0;l<h;l++)!a[l]&&s[l]>c&&(c=s[u=l]);Un.bindBuffer(Un.ARRAY_BUFFER,r.__webglMorphTargetsBuffers[u]),Un.vertexAttribPointer(n["morphTarget"+f],3,Un.FLOAT,!1,0,0),i.morphNormals&&(Un.bindBuffer(Un.ARRAY_BUFFER,r.__webglMorphNormalsBuffers[u]),Un.vertexAttribPointer(n["morphNormal"+f],3,Un.FLOAT,!1,0,0)),o.__webglMorphTargetInfluences[f]=c,c=-(a[u]=1),f++}}null!==i.program.uniforms.morphTargetInfluences&&Un.uniform1fv(i.program.uniforms.morphTargetInfluences,o.__webglMorphTargetInfluences)}if(e){if(r.__webglCustomAttributesList)for(f=0,s=r.__webglCustomAttributesList.length;f<s;f++)0<=t[(n=r.__webglCustomAttributesList[f]).buffer.belongsToAttribute]&&(Un.bindBuffer(Un.ARRAY_BUFFER,n.buffer),Un.vertexAttribPointer(t[n.buffer.belongsToAttribute],n.size,Un.FLOAT,!1,0,0));0<=t.color&&(Un.bindBuffer(Un.ARRAY_BUFFER,r.__webglColorBuffer),Un.vertexAttribPointer(t.color,3,Un.FLOAT,!1,0,0)),0<=t.normal&&(Un.bindBuffer(Un.ARRAY_BUFFER,r.__webglNormalBuffer),Un.vertexAttribPointer(t.normal,3,Un.FLOAT,!1,0,0)),0<=t.tangent&&(Un.bindBuffer(Un.ARRAY_BUFFER,r.__webglTangentBuffer),Un.vertexAttribPointer(t.tangent,4,Un.FLOAT,!1,0,0)),0<=t.uv&&(r.__webglUVBuffer?(Un.bindBuffer(Un.ARRAY_BUFFER,r.__webglUVBuffer),Un.vertexAttribPointer(t.uv,2,Un.FLOAT,!1,0,0),Un.enableVertexAttribArray(t.uv)):Un.disableVertexAttribArray(t.uv)),0<=t.uv2&&(r.__webglUV2Buffer?(Un.bindBuffer(Un.ARRAY_BUFFER,r.__webglUV2Buffer),Un.vertexAttribPointer(t.uv2,2,Un.FLOAT,!1,0,0),Un.enableVertexAttribArray(t.uv2)):Un.disableVertexAttribArray(t.uv2)),i.skinning&&0<=t.skinVertexA&&0<=t.skinVertexB&&0<=t.skinIndex&&0<=t.skinWeight&&(Un.bindBuffer(Un.ARRAY_BUFFER,r.__webglSkinVertexABuffer),Un.vertexAttribPointer(t.skinVertexA,4,Un.FLOAT,!1,0,0),Un.bindBuffer(Un.ARRAY_BUFFER,r.__webglSkinVertexBBuffer),Un.vertexAttribPointer(t.skinVertexB,4,Un.FLOAT,!1,0,0),Un.bindBuffer(Un.ARRAY_BUFFER,r.__webglSkinIndicesBuffer),Un.vertexAttribPointer(t.skinIndex,4,Un.FLOAT,!1,0,0),Un.bindBuffer(Un.ARRAY_BUFFER,r.__webglSkinWeightsBuffer),Un.vertexAttribPointer(t.skinWeight,4,Un.FLOAT,!1,0,0))}o instanceof THREE.Mesh?(i.wireframe?((i=i.wireframeLinewidth)!==z&&(Un.lineWidth(i),z=i),e&&Un.bindBuffer(Un.ELEMENT_ARRAY_BUFFER,r.__webglLineBuffer),Un.drawElements(Un.LINES,r.__webglLineCount,Un.UNSIGNED_SHORT,0)):(e&&Un.bindBuffer(Un.ELEMENT_ARRAY_BUFFER,r.__webglFaceBuffer),Un.drawElements(Un.TRIANGLES,r.__webglFaceCount,Un.UNSIGNED_SHORT,0)),zn.info.render.calls++,zn.info.render.vertices=zn.info.render.vertices+r.__webglFaceCount,zn.info.render.faces=zn.info.render.faces+r.__webglFaceCount/3):o instanceof THREE.Line&&(o=o.type===THREE.LineStrip?Un.LINE_STRIP:Un.LINES,(i=i.linewidth)!==z&&(Un.lineWidth(i),z=i),Un.drawArrays(o,0,r.__webglLineCount),zn.info.render.calls++)}},this.render=function(e,t,n,i){var r,o,a=e.__lights,s=e.fog;for(k=-1,Q=!0,void 0===t.parent&&e.add(t),this.autoUpdateScene&&e.updateMatrixWorld(),t._viewMatrixArray||(t._viewMatrixArray=new Float32Array(16)),t._projectionMatrixArray||(t._projectionMatrixArray=new Float32Array(16)),t.matrixWorldInverse.getInverse(t.matrixWorld),t.matrixWorldInverse.flattenToArray(t._viewMatrixArray),t.projectionMatrix.flattenToArray(t._projectionMatrixArray),$.multiply(t.projectionMatrix,t.matrixWorldInverse),X.setFromMatrix($),this.autoUpdateObjects&&this.initWebGLObjects(e),m(this.renderPluginsPre,e,t),zn.info.render.calls=0,zn.info.render.vertices=0,zn.info.render.faces=0,zn.info.render.points=0,this.setRenderTarget(n),(this.autoClear||i)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),i=0,r=(o=e.__webglObjects).length;i<r;i++){var l,c,u,h,f,d=(f=o[i]).object;f.render=!1,!d.visible||(d instanceof THREE.Mesh||d instanceof THREE.ParticleSystem)&&d.frustumCulled&&!X.contains(d)||(_(d,t),c=(l=f).object,u=l.buffer,h=h=h=void 0,(h=c.material)instanceof THREE.MeshFaceMaterial?0<=(h=u.materialIndex)&&((h=c.geometry.materials[h]).transparent?(l.transparent=h,l.opaque=null):(l.opaque=h,l.transparent=null)):h&&(h.transparent?(l.transparent=h,l.opaque=null):(l.opaque=h,l.transparent=null)),f.render=!0,this.sortObjects&&(d.renderDepth?f.z=d.renderDepth:(J.copy(d.matrixWorld.getPosition()),$.multiplyVector3(J),f.z=J.z)))}for(this.sortObjects&&o.sort(p),i=0,r=(o=e.__webglObjectsImmediate).length;i<r;i++)(d=(f=o[i]).object).visible&&(_(d,t),(d=f.object.material).transparent?(f.transparent=d,f.opaque=null):(f.opaque=d,f.transparent=null));e.overrideMaterial?(i=e.overrideMaterial,this.setBlending(i.blending,i.blendEquation,i.blendSrc,i.blendDst),this.setDepthTest(i.depthTest),this.setDepthWrite(i.depthWrite),y(i.polygonOffset,i.polygonOffsetFactor,i.polygonOffsetUnits),g(e.__webglObjects,!1,"",t,a,s,!0,i),v(e.__webglObjectsImmediate,"",t,a,s,!1,i)):(this.setBlending(THREE.NormalBlending),g(e.__webglObjects,!0,"opaque",t,a,s,!1),v(e.__webglObjectsImmediate,"opaque",t,a,s,!1),g(e.__webglObjects,!1,"transparent",t,a,s,!0),v(e.__webglObjectsImmediate,"transparent",t,a,s,!0)),m(this.renderPluginsPost,e,t),n&&n.generateMipmaps&&n.minFilter!==THREE.NearestFilter&&n.minFilter!==THREE.LinearFilter&&(n instanceof THREE.WebGLRenderTargetCube?(Un.bindTexture(Un.TEXTURE_CUBE_MAP,n.__webglTexture),Un.generateMipmap(Un.TEXTURE_CUBE_MAP),Un.bindTexture(Un.TEXTURE_CUBE_MAP,null)):(Un.bindTexture(Un.TEXTURE_2D,n.__webglTexture),Un.generateMipmap(Un.TEXTURE_2D),Un.bindTexture(Un.TEXTURE_2D,null))),this.setDepthTest(!0),this.setDepthWrite(!0)},this.renderImmediateObject=function(e,t,n,i,r){var o=d(e,t,n,i,r);w=-1,zn.setObjectFaces(r),r.immediateRenderCallback?r.immediateRenderCallback(o,Un,X):r.render(function(e){zn.renderBufferImmediate(e,o,i.shading)})},this.initWebGLObjects=function(e){for(e.__webglObjects||(e.__webglObjects=[],e.__webglObjectsImmediate=[],e.__webglSprites=[],e.__webglFlares=[]);e.__objectsAdded.length;){var t,n,i,r,o,a,s,l,c=e.__objectsAdded[0],u=e,h=void 0,f=void 0,d=void 0;if(!c.__webglInit)if(c.__webglInit=!0,c._modelViewMatrix=new THREE.Matrix4,c._normalMatrix=new THREE.Matrix3,c instanceof THREE.Mesh){if((f=c.geometry)instanceof THREE.Geometry){if(void 0===f.geometryGroups){var p,m=f,g=void 0,v=void 0,_=void 0,y=void 0,b=void 0,x=void 0,E={},T=m.morphTargets.length,w=m.morphNormals.length;for(m.geometryGroups={},g=0,p=m.faces.length;g<p;g++)void 0===E[b=void 0!==(_=(v=m.faces[g]).materialIndex)?_:-1]&&(E[b]={hash:b,counter:0}),x=E[b].hash+"_"+E[b].counter,void 0===m.geometryGroups[x]&&(m.geometryGroups[x]={faces3:[],faces4:[],materialIndex:_,vertices:0,numMorphTargets:T,numMorphNormals:w}),y=v instanceof THREE.Face3?3:4,65535<m.geometryGroups[x].vertices+y&&(E[b].counter=E[b].counter+1,x=E[b].hash+"_"+E[b].counter,void 0===m.geometryGroups[x]&&(m.geometryGroups[x]={faces3:[],faces4:[],materialIndex:_,vertices:0,numMorphTargets:T,numMorphNormals:w})),v instanceof THREE.Face3?m.geometryGroups[x].faces3.push(g):m.geometryGroups[x].faces4.push(g),m.geometryGroups[x].vertices=m.geometryGroups[x].vertices+y;m.geometryGroupsList=[];var C=void 0;for(C in m.geometryGroups)m.geometryGroups[C].id=jn++,m.geometryGroupsList.push(m.geometryGroups[C])}for(h in f.geometryGroups)if(!(d=f.geometryGroups[h]).__webglVertexBuffer){var S=d;S.__webglVertexBuffer=Un.createBuffer(),S.__webglNormalBuffer=Un.createBuffer(),S.__webglTangentBuffer=Un.createBuffer(),S.__webglColorBuffer=Un.createBuffer(),S.__webglUVBuffer=Un.createBuffer(),S.__webglUV2Buffer=Un.createBuffer(),S.__webglSkinVertexABuffer=Un.createBuffer(),S.__webglSkinVertexBBuffer=Un.createBuffer(),S.__webglSkinIndicesBuffer=Un.createBuffer(),S.__webglSkinWeightsBuffer=Un.createBuffer(),S.__webglFaceBuffer=Un.createBuffer(),S.__webglLineBuffer=Un.createBuffer();var D=void 0,R=void 0;if(S.numMorphTargets)for(S.__webglMorphTargetsBuffers=[],D=0,R=S.numMorphTargets;D<R;D++)S.__webglMorphTargetsBuffers.push(Un.createBuffer());if(S.numMorphNormals)for(S.__webglMorphNormalsBuffers=[],D=0,R=S.numMorphNormals;D<R;D++)S.__webglMorphNormalsBuffers.push(Un.createBuffer());zn.info.memory.geometries++;var A=d,M=c,L=M.geometry,H=A.faces3,F=A.faces4,P=3*H.length+4*F.length,N=+H.length+2*F.length,k=3*H.length+4*F.length,I=Fn(M,A),O=Nn(I),B=Pn(I),z=!!I.vertexColors&&I.vertexColors;A.__vertexArray=new Float32Array(3*P),B&&(A.__normalArray=new Float32Array(3*P)),L.hasTangents&&(A.__tangentArray=new Float32Array(4*P)),z&&(A.__colorArray=new Float32Array(3*P)),O&&((0<L.faceUvs.length||0<L.faceVertexUvs.length)&&(A.__uvArray=new Float32Array(2*P)),(1<L.faceUvs.length||1<L.faceVertexUvs.length)&&(A.__uv2Array=new Float32Array(2*P))),M.geometry.skinWeights.length&&M.geometry.skinIndices.length&&(A.__skinVertexAArray=new Float32Array(4*P),A.__skinVertexBArray=new Float32Array(4*P),A.__skinIndexArray=new Float32Array(4*P),A.__skinWeightArray=new Float32Array(4*P)),A.__faceArray=new Uint16Array(3*N),A.__lineArray=new Uint16Array(2*k);var j=void 0,U=void 0;if(A.numMorphTargets)for(A.__morphTargetsArrays=[],j=0,U=A.numMorphTargets;j<U;j++)A.__morphTargetsArrays.push(new Float32Array(3*P));if(A.numMorphNormals)for(A.__morphNormalsArrays=[],j=0,U=A.numMorphNormals;j<U;j++)A.__morphNormalsArrays.push(new Float32Array(3*P));if(A.__webglFaceCount=3*N,A.__webglLineCount=2*k,I.attributes){void 0===A.__webglCustomAttributesList&&(A.__webglCustomAttributesList=[]);var V=void 0;for(V in I.attributes){var W,G,q=I.attributes[V],X={};for(W in q)X[W]=q[W];X.__webglInitialized&&!X.createUniqueBuffers||(X.__webglInitialized=!0,G=1,"v2"===X.type?G=2:"v3"===X.type?G=3:"v4"===X.type?G=4:"c"===X.type&&(G=3),X.size=G,X.array=new Float32Array(P*G),X.buffer=Un.createBuffer(),X.buffer.belongsToAttribute=V,q.needsUpdate=!0,X.__original=q),A.__webglCustomAttributesList.push(X)}}A.__inittedArrays=!0,f.verticesNeedUpdate=!0,f.morphTargetsNeedUpdate=!0,f.elementsNeedUpdate=!0,f.uvsNeedUpdate=!0,f.normalsNeedUpdate=!0,f.tangetsNeedUpdate=!0,f.colorsNeedUpdate=!0}}}else c instanceof THREE.Line?(f=c.geometry).__webglVertexBuffer||((t=f).__webglVertexBuffer=Un.createBuffer(),t.__webglColorBuffer=Un.createBuffer(),zn.info.memory.geometries++,i=c,r=(n=f).vertices.length,n.__vertexArray=new Float32Array(3*r),n.__colorArray=new Float32Array(3*r),n.__webglLineCount=r,Hn(n,i),f.verticesNeedUpdate=!0,f.colorsNeedUpdate=!0):c instanceof THREE.ParticleSystem&&((f=c.geometry).__webglVertexBuffer||((o=f).__webglVertexBuffer=Un.createBuffer(),o.__webglColorBuffer=Un.createBuffer(),zn.info.geometries++,s=c,l=(a=f).vertices.length,a.__vertexArray=new Float32Array(3*l),a.__colorArray=new Float32Array(3*l),a.__sortArray=[],a.__webglParticleCount=l,Hn(a,s),f.verticesNeedUpdate=!0,f.colorsNeedUpdate=!0));if(!c.__webglActive){if(c instanceof THREE.Mesh)if((f=c.geometry)instanceof THREE.BufferGeometry)In(u.__webglObjects,f,c);else for(h in f.geometryGroups)d=f.geometryGroups[h],In(u.__webglObjects,d,c);else c instanceof THREE.Line&&(f=c.geometry,In(u.__webglObjects,f,c));c.__webglActive=!0}e.__objectsAdded.splice(0,1)}for(;e.__objectsRemoved.length;){var $=e.__objectsRemoved[0];if($ instanceof THREE.Mesh||$ instanceof THREE.Line)for(var Y=e.__webglObjects,J=$,Z=Y.length-1;0<=Z;Z--)Y[Z].object===J&&Y.splice(Z,1);$.__webglActive=!1,e.__objectsRemoved.splice(0,1)}for(var Q=0,K=e.__webglObjects.length;Q<K;Q++){var ee=e.__webglObjects[Q].object,te=ee.geometry,ne=void 0,ie=void 0,re=void 0;if(ee instanceof THREE.Mesh)if(te instanceof THREE.BufferGeometry)te.verticesNeedUpdate=!1,te.elementsNeedUpdate=!1,te.uvsNeedUpdate=!1,te.normalsNeedUpdate=!1,te.colorsNeedUpdate=!1;else{for(var oe=0,ae=te.geometryGroupsList.length;oe<ae;oe++)if(ie=(re=Fn(ee,ne=te.geometryGroupsList[oe])).attributes&&On(re),te.verticesNeedUpdate||te.morphTargetsNeedUpdate||te.elementsNeedUpdate||te.uvsNeedUpdate||te.normalsNeedUpdate||te.colorsNeedUpdate||te.tangetsNeedUpdate||ie){var se=ne,le=Un.DYNAMIC_DRAW,ce=!te.dynamic,ue=re;if(se.__inittedArrays){var he=Pn(ue),fe=!!ue.vertexColors&&ue.vertexColors,de=Nn(ue),pe=he===THREE.SmoothShading,me=void 0,ge=void 0,ve=void 0,_e=void 0,ye=void 0,be=void 0,xe=void 0,Ee=void 0,Te=void 0,we=void 0,Ce=void 0,Se=void 0,De=void 0,Re=void 0,Ae=void 0,Me=void 0,Le=void 0,He=void 0,Fe=void 0,Pe=void 0,Ne=void 0,ke=void 0,Ie=void 0,Oe=void 0,Be=void 0,ze=void 0,je=void 0,Ue=void 0,Ve=void 0,We=void 0,Ge=void 0,qe=void 0,Xe=void 0,$e=void 0,Ye=void 0,Je=void 0,Ze=void 0,Qe=void 0,Ke=void 0,et=void 0,tt=void 0,nt=void 0,it=void 0,rt=void 0,ot=void 0,at=void 0,st=void 0,lt=void 0,ct=void 0,ut=void 0,ht=void 0,ft=void 0,dt=void 0,pt=void 0,mt=0,gt=0,vt=0,_t=0,yt=0,bt=0,xt=0,Et=0,Tt=0,wt=0,Ct=0,St=0,Dt=void 0,Rt=se.__vertexArray,At=se.__uvArray,Mt=se.__uv2Array,Lt=se.__normalArray,Ht=se.__tangentArray,Ft=se.__colorArray,Pt=se.__skinVertexAArray,Nt=se.__skinVertexBArray,kt=se.__skinIndexArray,It=se.__skinWeightArray,Ot=se.__morphTargetsArrays,Bt=se.__morphNormalsArrays,zt=se.__webglCustomAttributesList,jt=void 0,Ut=se.__faceArray,Vt=se.__lineArray,Wt=ee.geometry,Gt=Wt.elementsNeedUpdate,qt=Wt.uvsNeedUpdate,Xt=Wt.normalsNeedUpdate,$t=Wt.tangetsNeedUpdate,Yt=Wt.colorsNeedUpdate,Jt=Wt.morphTargetsNeedUpdate,Zt=Wt.vertices,Qt=se.faces3,Kt=se.faces4,en=Wt.faces,tn=Wt.faceVertexUvs[0],nn=Wt.faceVertexUvs[1],rn=Wt.skinVerticesA,on=Wt.skinVerticesB,an=Wt.skinIndices,sn=Wt.skinWeights,ln=Wt.morphTargets,cn=Wt.morphNormals;if(Wt.verticesNeedUpdate){for(me=0,ge=Qt.length;me<ge;me++)Se=Zt[(_e=en[Qt[me]]).a],De=Zt[_e.b],Re=Zt[_e.c],Rt[gt]=Se.x,Rt[gt+1]=Se.y,Rt[gt+2]=Se.z,Rt[gt+3]=De.x,Rt[gt+4]=De.y,Rt[gt+5]=De.z,Rt[gt+6]=Re.x,Rt[gt+7]=Re.y,Rt[gt+8]=Re.z,gt+=9;for(me=0,ge=Kt.length;me<ge;me++)Se=Zt[(_e=en[Kt[me]]).a],De=Zt[_e.b],Re=Zt[_e.c],Ae=Zt[_e.d],Rt[gt]=Se.x,Rt[gt+1]=Se.y,Rt[gt+2]=Se.z,Rt[gt+3]=De.x,Rt[gt+4]=De.y,Rt[gt+5]=De.z,Rt[gt+6]=Re.x,Rt[gt+7]=Re.y,Rt[gt+8]=Re.z,Rt[gt+9]=Ae.x,Rt[gt+10]=Ae.y,Rt[gt+11]=Ae.z,gt+=12;Un.bindBuffer(Un.ARRAY_BUFFER,se.__webglVertexBuffer),Un.bufferData(Un.ARRAY_BUFFER,Rt,le)}if(Jt)for(ct=0,ut=ln.length;ct<ut;ct++){for(me=Ct=0,ge=Qt.length;me<ge;me++)_e=en[dt=Qt[me]],Se=ln[ct].vertices[_e.a],De=ln[ct].vertices[_e.b],Re=ln[ct].vertices[_e.c],(ht=Ot[ct])[Ct]=Se.x,ht[Ct+1]=Se.y,ht[Ct+2]=Se.z,ht[Ct+3]=De.x,ht[Ct+4]=De.y,ht[Ct+5]=De.z,ht[Ct+6]=Re.x,ht[Ct+7]=Re.y,ht[Ct+8]=Re.z,ue.morphNormals&&(ke=pe?(Pe=(pt=cn[ct].vertexNormals[dt]).a,Ne=pt.b,pt.c):Ne=Pe=cn[ct].faceNormals[dt],(ft=Bt[ct])[Ct]=Pe.x,ft[Ct+1]=Pe.y,ft[Ct+2]=Pe.z,ft[Ct+3]=Ne.x,ft[Ct+4]=Ne.y,ft[Ct+5]=Ne.z,ft[Ct+6]=ke.x,ft[Ct+7]=ke.y,ft[Ct+8]=ke.z),Ct+=9;for(me=0,ge=Kt.length;me<ge;me++)_e=en[dt=Kt[me]],Se=ln[ct].vertices[_e.a],De=ln[ct].vertices[_e.b],Re=ln[ct].vertices[_e.c],Ae=ln[ct].vertices[_e.d],(ht=Ot[ct])[Ct]=Se.x,ht[Ct+1]=Se.y,ht[Ct+2]=Se.z,ht[Ct+3]=De.x,ht[Ct+4]=De.y,ht[Ct+5]=De.z,ht[Ct+6]=Re.x,ht[Ct+7]=Re.y,ht[Ct+8]=Re.z,ht[Ct+9]=Ae.x,ht[Ct+10]=Ae.y,ht[Ct+11]=Ae.z,ue.morphNormals&&(Ie=pe?(Pe=(pt=cn[ct].vertexNormals[dt]).a,Ne=pt.b,ke=pt.c,pt.d):ke=Ne=Pe=cn[ct].faceNormals[dt],(ft=Bt[ct])[Ct]=Pe.x,ft[Ct+1]=Pe.y,ft[Ct+2]=Pe.z,ft[Ct+3]=Ne.x,ft[Ct+4]=Ne.y,ft[Ct+5]=Ne.z,ft[Ct+6]=ke.x,ft[Ct+7]=ke.y,ft[Ct+8]=ke.z,ft[Ct+9]=Ie.x,ft[Ct+10]=Ie.y,ft[Ct+11]=Ie.z),Ct+=12;Un.bindBuffer(Un.ARRAY_BUFFER,se.__webglMorphTargetsBuffers[ct]),Un.bufferData(Un.ARRAY_BUFFER,Ot[ct],le),ue.morphNormals&&(Un.bindBuffer(Un.ARRAY_BUFFER,se.__webglMorphNormalsBuffers[ct]),Un.bufferData(Un.ARRAY_BUFFER,Bt[ct],le))}if(sn.length){for(me=0,ge=Qt.length;me<ge;me++)Ue=sn[(_e=en[Qt[me]]).a],Ve=sn[_e.b],We=sn[_e.c],It[wt]=Ue.x,It[wt+1]=Ue.y,It[wt+2]=Ue.z,It[wt+3]=Ue.w,It[wt+4]=Ve.x,It[wt+5]=Ve.y,It[wt+6]=Ve.z,It[wt+7]=Ve.w,It[wt+8]=We.x,It[wt+9]=We.y,It[wt+10]=We.z,It[wt+11]=We.w,qe=an[_e.a],Xe=an[_e.b],$e=an[_e.c],kt[wt]=qe.x,kt[wt+1]=qe.y,kt[wt+2]=qe.z,kt[wt+3]=qe.w,kt[wt+4]=Xe.x,kt[wt+5]=Xe.y,kt[wt+6]=Xe.z,kt[wt+7]=Xe.w,kt[wt+8]=$e.x,kt[wt+9]=$e.y,kt[wt+10]=$e.z,kt[wt+11]=$e.w,Je=rn[_e.a],Ze=rn[_e.b],Qe=rn[_e.c],Pt[wt]=Je.x,Pt[wt+1]=Je.y,Pt[wt+2]=Je.z,Pt[wt+3]=1,Pt[wt+4]=Ze.x,Pt[wt+5]=Ze.y,Pt[wt+6]=Ze.z,Pt[wt+7]=1,Pt[wt+8]=Qe.x,Pt[wt+9]=Qe.y,Pt[wt+10]=Qe.z,Pt[wt+11]=1,et=on[_e.a],tt=on[_e.b],nt=on[_e.c],Nt[wt]=et.x,Nt[wt+1]=et.y,Nt[wt+2]=et.z,Nt[wt+3]=1,Nt[wt+4]=tt.x,Nt[wt+5]=tt.y,Nt[wt+6]=tt.z,Nt[wt+7]=1,Nt[wt+8]=nt.x,Nt[wt+9]=nt.y,Nt[wt+10]=nt.z,Nt[wt+11]=1,wt+=12;for(me=0,ge=Kt.length;me<ge;me++)Ue=sn[(_e=en[Kt[me]]).a],Ve=sn[_e.b],We=sn[_e.c],Ge=sn[_e.d],It[wt]=Ue.x,It[wt+1]=Ue.y,It[wt+2]=Ue.z,It[wt+3]=Ue.w,It[wt+4]=Ve.x,It[wt+5]=Ve.y,It[wt+6]=Ve.z,It[wt+7]=Ve.w,It[wt+8]=We.x,It[wt+9]=We.y,It[wt+10]=We.z,It[wt+11]=We.w,It[wt+12]=Ge.x,It[wt+13]=Ge.y,It[wt+14]=Ge.z,It[wt+15]=Ge.w,qe=an[_e.a],Xe=an[_e.b],$e=an[_e.c],Ye=an[_e.d],kt[wt]=qe.x,kt[wt+1]=qe.y,kt[wt+2]=qe.z,kt[wt+3]=qe.w,kt[wt+4]=Xe.x,kt[wt+5]=Xe.y,kt[wt+6]=Xe.z,kt[wt+7]=Xe.w,kt[wt+8]=$e.x,kt[wt+9]=$e.y,kt[wt+10]=$e.z,kt[wt+11]=$e.w,kt[wt+12]=Ye.x,kt[wt+13]=Ye.y,kt[wt+14]=Ye.z,kt[wt+15]=Ye.w,Je=rn[_e.a],Ze=rn[_e.b],Qe=rn[_e.c],Ke=rn[_e.d],Pt[wt]=Je.x,Pt[wt+1]=Je.y,Pt[wt+2]=Je.z,Pt[wt+3]=1,Pt[wt+4]=Ze.x,Pt[wt+5]=Ze.y,Pt[wt+6]=Ze.z,Pt[wt+7]=1,Pt[wt+8]=Qe.x,Pt[wt+9]=Qe.y,Pt[wt+10]=Qe.z,Pt[wt+11]=1,Pt[wt+12]=Ke.x,Pt[wt+13]=Ke.y,Pt[wt+14]=Ke.z,Pt[wt+15]=1,et=on[_e.a],tt=on[_e.b],nt=on[_e.c],it=on[_e.d],Nt[wt]=et.x,Nt[wt+1]=et.y,Nt[wt+2]=et.z,Nt[wt+3]=1,Nt[wt+4]=tt.x,Nt[wt+5]=tt.y,Nt[wt+6]=tt.z,Nt[wt+7]=1,Nt[wt+8]=nt.x,Nt[wt+9]=nt.y,Nt[wt+10]=nt.z,Nt[wt+11]=1,Nt[wt+12]=it.x,Nt[wt+13]=it.y,Nt[wt+14]=it.z,Nt[wt+15]=1,wt+=16;0<wt&&(Un.bindBuffer(Un.ARRAY_BUFFER,se.__webglSkinVertexABuffer),Un.bufferData(Un.ARRAY_BUFFER,Pt,le),Un.bindBuffer(Un.ARRAY_BUFFER,se.__webglSkinVertexBBuffer),Un.bufferData(Un.ARRAY_BUFFER,Nt,le),Un.bindBuffer(Un.ARRAY_BUFFER,se.__webglSkinIndicesBuffer),Un.bufferData(Un.ARRAY_BUFFER,kt,le),Un.bindBuffer(Un.ARRAY_BUFFER,se.__webglSkinWeightsBuffer),Un.bufferData(Un.ARRAY_BUFFER,It,le))}if(Yt&&fe){for(me=0,ge=Qt.length;me<ge;me++)xe=(_e=en[Qt[me]]).vertexColors,Ee=_e.color,ze=3===xe.length&&fe===THREE.VertexColors?(Oe=xe[0],Be=xe[1],xe[2]):Be=Oe=Ee,Ft[Tt]=Oe.r,Ft[Tt+1]=Oe.g,Ft[Tt+2]=Oe.b,Ft[Tt+3]=Be.r,Ft[Tt+4]=Be.g,Ft[Tt+5]=Be.b,Ft[Tt+6]=ze.r,Ft[Tt+7]=ze.g,Ft[Tt+8]=ze.b,Tt+=9;for(me=0,ge=Kt.length;me<ge;me++)xe=(_e=en[Kt[me]]).vertexColors,Ee=_e.color,je=4===xe.length&&fe===THREE.VertexColors?(Oe=xe[0],Be=xe[1],ze=xe[2],xe[3]):ze=Be=Oe=Ee,Ft[Tt]=Oe.r,Ft[Tt+1]=Oe.g,Ft[Tt+2]=Oe.b,Ft[Tt+3]=Be.r,Ft[Tt+4]=Be.g,Ft[Tt+5]=Be.b,Ft[Tt+6]=ze.r,Ft[Tt+7]=ze.g,Ft[Tt+8]=ze.b,Ft[Tt+9]=je.r,Ft[Tt+10]=je.g,Ft[Tt+11]=je.b,Tt+=12;0<Tt&&(Un.bindBuffer(Un.ARRAY_BUFFER,se.__webglColorBuffer),Un.bufferData(Un.ARRAY_BUFFER,Ft,le))}if($t&&Wt.hasTangents){for(me=0,ge=Qt.length;me<ge;me++)Me=(Te=(_e=en[Qt[me]]).vertexTangents)[0],Le=Te[1],He=Te[2],Ht[xt]=Me.x,Ht[xt+1]=Me.y,Ht[xt+2]=Me.z,Ht[xt+3]=Me.w,Ht[xt+4]=Le.x,Ht[xt+5]=Le.y,Ht[xt+6]=Le.z,Ht[xt+7]=Le.w,Ht[xt+8]=He.x,Ht[xt+9]=He.y,Ht[xt+10]=He.z,Ht[xt+11]=He.w,xt+=12;for(me=0,ge=Kt.length;me<ge;me++)Me=(Te=(_e=en[Kt[me]]).vertexTangents)[0],Le=Te[1],He=Te[2],Fe=Te[3],Ht[xt]=Me.x,Ht[xt+1]=Me.y,Ht[xt+2]=Me.z,Ht[xt+3]=Me.w,Ht[xt+4]=Le.x,Ht[xt+5]=Le.y,Ht[xt+6]=Le.z,Ht[xt+7]=Le.w,Ht[xt+8]=He.x,Ht[xt+9]=He.y,Ht[xt+10]=He.z,Ht[xt+11]=He.w,Ht[xt+12]=Fe.x,Ht[xt+13]=Fe.y,Ht[xt+14]=Fe.z,Ht[xt+15]=Fe.w,xt+=16;Un.bindBuffer(Un.ARRAY_BUFFER,se.__webglTangentBuffer),Un.bufferData(Un.ARRAY_BUFFER,Ht,le)}if(Xt&&he){for(me=0,ge=Qt.length;me<ge;me++)if(ye=(_e=en[Qt[me]]).vertexNormals,be=_e.normal,3===ye.length&&pe)for(rt=0;rt<3;rt++)at=ye[rt],Lt[bt]=at.x,Lt[bt+1]=at.y,Lt[bt+2]=at.z,bt+=3;else for(rt=0;rt<3;rt++)Lt[bt]=be.x,Lt[bt+1]=be.y,Lt[bt+2]=be.z,bt+=3;for(me=0,ge=Kt.length;me<ge;me++)if(ye=(_e=en[Kt[me]]).vertexNormals,be=_e.normal,4===ye.length&&pe)for(rt=0;rt<4;rt++)at=ye[rt],Lt[bt]=at.x,Lt[bt+1]=at.y,Lt[bt+2]=at.z,bt+=3;else for(rt=0;rt<4;rt++)Lt[bt]=be.x,Lt[bt+1]=be.y,Lt[bt+2]=be.z,bt+=3;Un.bindBuffer(Un.ARRAY_BUFFER,se.__webglNormalBuffer),Un.bufferData(Un.ARRAY_BUFFER,Lt,le)}if(qt&&tn&&de){for(me=0,ge=Qt.length;me<ge;me++)if(_e=en[ve=Qt[me]],void 0!==(we=tn[ve]))for(rt=0;rt<3;rt++)st=we[rt],At[vt]=st.u,At[vt+1]=st.v,vt+=2;for(me=0,ge=Kt.length;me<ge;me++)if(_e=en[ve=Kt[me]],void 0!==(we=tn[ve]))for(rt=0;rt<4;rt++)st=we[rt],At[vt]=st.u,At[vt+1]=st.v,vt+=2;0<vt&&(Un.bindBuffer(Un.ARRAY_BUFFER,se.__webglUVBuffer),Un.bufferData(Un.ARRAY_BUFFER,At,le))}if(qt&&nn&&de){for(me=0,ge=Qt.length;me<ge;me++)if(_e=en[ve=Qt[me]],void 0!==(Ce=nn[ve]))for(rt=0;rt<3;rt++)lt=Ce[rt],Mt[_t]=lt.u,Mt[_t+1]=lt.v,_t+=2;for(me=0,ge=Kt.length;me<ge;me++)if(_e=en[ve=Kt[me]],void 0!==(Ce=nn[ve]))for(rt=0;rt<4;rt++)lt=Ce[rt],Mt[_t]=lt.u,Mt[_t+1]=lt.v,_t+=2;0<_t&&(Un.bindBuffer(Un.ARRAY_BUFFER,se.__webglUV2Buffer),Un.bufferData(Un.ARRAY_BUFFER,Mt,le))}if(Gt){for(me=0,ge=Qt.length;me<ge;me++)_e=en[Qt[me]],Ut[yt]=mt,Ut[yt+1]=mt+1,Ut[yt+2]=mt+2,yt+=3,Vt[Et]=mt,Vt[Et+1]=mt+1,Vt[Et+2]=mt,Vt[Et+3]=mt+2,Vt[Et+4]=mt+1,Vt[Et+5]=mt+2,Et+=6,mt+=3;for(me=0,ge=Kt.length;me<ge;me++)_e=en[Kt[me]],Ut[yt]=mt,Ut[yt+1]=mt+1,Ut[yt+2]=mt+3,Ut[yt+3]=mt+1,Ut[yt+4]=mt+2,Ut[yt+5]=mt+3,yt+=6,Vt[Et]=mt,Vt[Et+1]=mt+1,Vt[Et+2]=mt,Vt[Et+3]=mt+3,Vt[Et+4]=mt+1,Vt[Et+5]=mt+2,Vt[Et+6]=mt+2,Vt[Et+7]=mt+3,Et+=8,mt+=4;Un.bindBuffer(Un.ELEMENT_ARRAY_BUFFER,se.__webglFaceBuffer),Un.bufferData(Un.ELEMENT_ARRAY_BUFFER,Ut,le),Un.bindBuffer(Un.ELEMENT_ARRAY_BUFFER,se.__webglLineBuffer),Un.bufferData(Un.ELEMENT_ARRAY_BUFFER,Vt,le)}if(zt)for(rt=0,ot=zt.length;rt<ot;rt++)if((jt=zt[rt]).__original.needsUpdate){if(St=0,1===jt.size){if(void 0===jt.boundTo||"vertices"===jt.boundTo){for(me=0,ge=Qt.length;me<ge;me++)_e=en[Qt[me]],jt.array[St]=jt.value[_e.a],jt.array[St+1]=jt.value[_e.b],jt.array[St+2]=jt.value[_e.c],St+=3;for(me=0,ge=Kt.length;me<ge;me++)_e=en[Kt[me]],jt.array[St]=jt.value[_e.a],jt.array[St+1]=jt.value[_e.b],jt.array[St+2]=jt.value[_e.c],jt.array[St+3]=jt.value[_e.d],St+=4}else if("faces"===jt.boundTo){for(me=0,ge=Qt.length;me<ge;me++)Dt=jt.value[Qt[me]],jt.array[St]=Dt,jt.array[St+1]=Dt,jt.array[St+2]=Dt,St+=3;for(me=0,ge=Kt.length;me<ge;me++)Dt=jt.value[Kt[me]],jt.array[St]=Dt,jt.array[St+1]=Dt,jt.array[St+2]=Dt,jt.array[St+3]=Dt,St+=4}}else if(2===jt.size){if(void 0===jt.boundTo||"vertices"===jt.boundTo){for(me=0,ge=Qt.length;me<ge;me++)_e=en[Qt[me]],Se=jt.value[_e.a],De=jt.value[_e.b],Re=jt.value[_e.c],jt.array[St]=Se.x,jt.array[St+1]=Se.y,jt.array[St+2]=De.x,jt.array[St+3]=De.y,jt.array[St+4]=Re.x,jt.array[St+5]=Re.y,St+=6;for(me=0,ge=Kt.length;me<ge;me++)_e=en[Kt[me]],Se=jt.value[_e.a],De=jt.value[_e.b],Re=jt.value[_e.c],Ae=jt.value[_e.d],jt.array[St]=Se.x,jt.array[St+1]=Se.y,jt.array[St+2]=De.x,jt.array[St+3]=De.y,jt.array[St+4]=Re.x,jt.array[St+5]=Re.y,jt.array[St+6]=Ae.x,jt.array[St+7]=Ae.y,St+=8}else if("faces"===jt.boundTo){for(me=0,ge=Qt.length;me<ge;me++)Re=De=Se=Dt=jt.value[Qt[me]],jt.array[St]=Se.x,jt.array[St+1]=Se.y,jt.array[St+2]=De.x,jt.array[St+3]=De.y,jt.array[St+4]=Re.x,jt.array[St+5]=Re.y,St+=6;for(me=0,ge=Kt.length;me<ge;me++)Ae=Re=De=Se=Dt=jt.value[Kt[me]],jt.array[St]=Se.x,jt.array[St+1]=Se.y,jt.array[St+2]=De.x,jt.array[St+3]=De.y,jt.array[St+4]=Re.x,jt.array[St+5]=Re.y,jt.array[St+6]=Ae.x,jt.array[St+7]=Ae.y,St+=8}}else if(3===jt.size){var un="c"===jt.type?["r","g","b"]:["x","y","z"];if(void 0===jt.boundTo||"vertices"===jt.boundTo){for(me=0,ge=Qt.length;me<ge;me++)_e=en[Qt[me]],Se=jt.value[_e.a],De=jt.value[_e.b],Re=jt.value[_e.c],jt.array[St]=Se[un[0]],jt.array[St+1]=Se[un[1]],jt.array[St+2]=Se[un[2]],jt.array[St+3]=De[un[0]],jt.array[St+4]=De[un[1]],jt.array[St+5]=De[un[2]],jt.array[St+6]=Re[un[0]],jt.array[St+7]=Re[un[1]],jt.array[St+8]=Re[un[2]],St+=9;for(me=0,ge=Kt.length;me<ge;me++)_e=en[Kt[me]],Se=jt.value[_e.a],De=jt.value[_e.b],Re=jt.value[_e.c],Ae=jt.value[_e.d],jt.array[St]=Se[un[0]],jt.array[St+1]=Se[un[1]],jt.array[St+2]=Se[un[2]],jt.array[St+3]=De[un[0]],jt.array[St+4]=De[un[1]],jt.array[St+5]=De[un[2]],jt.array[St+6]=Re[un[0]],jt.array[St+7]=Re[un[1]],jt.array[St+8]=Re[un[2]],jt.array[St+9]=Ae[un[0]],jt.array[St+10]=Ae[un[1]],jt.array[St+11]=Ae[un[2]],St+=12}else if("faces"===jt.boundTo){for(me=0,ge=Qt.length;me<ge;me++)Re=De=Se=Dt=jt.value[Qt[me]],jt.array[St]=Se[un[0]],jt.array[St+1]=Se[un[1]],jt.array[St+2]=Se[un[2]],jt.array[St+3]=De[un[0]],jt.array[St+4]=De[un[1]],jt.array[St+5]=De[un[2]],jt.array[St+6]=Re[un[0]],jt.array[St+7]=Re[un[1]],jt.array[St+8]=Re[un[2]],St+=9;for(me=0,ge=Kt.length;me<ge;me++)Ae=Re=De=Se=Dt=jt.value[Kt[me]],jt.array[St]=Se[un[0]],jt.array[St+1]=Se[un[1]],jt.array[St+2]=Se[un[2]],jt.array[St+3]=De[un[0]],jt.array[St+4]=De[un[1]],jt.array[St+5]=De[un[2]],jt.array[St+6]=Re[un[0]],jt.array[St+7]=Re[un[1]],jt.array[St+8]=Re[un[2]],jt.array[St+9]=Ae[un[0]],jt.array[St+10]=Ae[un[1]],jt.array[St+11]=Ae[un[2]],St+=12}}else if(4===jt.size)if(void 0===jt.boundTo||"vertices"===jt.boundTo){for(me=0,ge=Qt.length;me<ge;me++)_e=en[Qt[me]],Se=jt.value[_e.a],De=jt.value[_e.b],Re=jt.value[_e.c],jt.array[St]=Se.x,jt.array[St+1]=Se.y,jt.array[St+2]=Se.z,jt.array[St+3]=Se.w,jt.array[St+4]=De.x,jt.array[St+5]=De.y,jt.array[St+6]=De.z,jt.array[St+7]=De.w,jt.array[St+8]=Re.x,jt.array[St+9]=Re.y,jt.array[St+10]=Re.z,jt.array[St+11]=Re.w,St+=12;for(me=0,ge=Kt.length;me<ge;me++)_e=en[Kt[me]],Se=jt.value[_e.a],De=jt.value[_e.b],Re=jt.value[_e.c],Ae=jt.value[_e.d],jt.array[St]=Se.x,jt.array[St+1]=Se.y,jt.array[St+2]=Se.z,jt.array[St+3]=Se.w,jt.array[St+4]=De.x,jt.array[St+5]=De.y,jt.array[St+6]=De.z,jt.array[St+7]=De.w,jt.array[St+8]=Re.x,jt.array[St+9]=Re.y,jt.array[St+10]=Re.z,jt.array[St+11]=Re.w,jt.array[St+12]=Ae.x,jt.array[St+13]=Ae.y,jt.array[St+14]=Ae.z,jt.array[St+15]=Ae.w,St+=16}else if("faces"===jt.boundTo){for(me=0,ge=Qt.length;me<ge;me++)Re=De=Se=Dt=jt.value[Qt[me]],jt.array[St]=Se.x,jt.array[St+1]=Se.y,jt.array[St+2]=Se.z,jt.array[St+3]=Se.w,jt.array[St+4]=De.x,jt.array[St+5]=De.y,jt.array[St+6]=De.z,jt.array[St+7]=De.w,jt.array[St+8]=Re.x,jt.array[St+9]=Re.y,jt.array[St+10]=Re.z,jt.array[St+11]=Re.w,St+=12;for(me=0,ge=Kt.length;me<ge;me++)Ae=Re=De=Se=Dt=jt.value[Kt[me]],jt.array[St]=Se.x,jt.array[St+1]=Se.y,jt.array[St+2]=Se.z,jt.array[St+3]=Se.w,jt.array[St+4]=De.x,jt.array[St+5]=De.y,jt.array[St+6]=De.z,jt.array[St+7]=De.w,jt.array[St+8]=Re.x,jt.array[St+9]=Re.y,jt.array[St+10]=Re.z,jt.array[St+11]=Re.w,jt.array[St+12]=Ae.x,jt.array[St+13]=Ae.y,jt.array[St+14]=Ae.z,jt.array[St+15]=Ae.w,St+=16}Un.bindBuffer(Un.ARRAY_BUFFER,jt.buffer),Un.bufferData(Un.ARRAY_BUFFER,jt.array,le)}ce&&(delete se.__inittedArrays,delete se.__colorArray,delete se.__normalArray,delete se.__tangentArray,delete se.__uvArray,delete se.__uv2Array,delete se.__faceArray,delete se.__vertexArray,delete se.__lineArray,delete se.__skinVertexAArray,delete se.__skinVertexBArray,delete se.__skinIndexArray,delete se.__skinWeightArray)}}te.verticesNeedUpdate=!1,te.morphTargetsNeedUpdate=!1,te.elementsNeedUpdate=!1,te.uvsNeedUpdate=!1,te.normalsNeedUpdate=!1,te.colorsNeedUpdate=!1,te.tangetsNeedUpdate=!1,re.attributes&&Bn(re)}else if(ee instanceof THREE.Line){if(ie=(re=Fn(ee,ne)).attributes&&On(re),te.verticesNeedUpdate||te.colorsNeedUpdate||ie){var hn=te,fn=Un.DYNAMIC_DRAW,dn=void 0,pn=void 0,mn=void 0,gn=void 0,vn=void 0,_n=hn.vertices,yn=hn.colors,bn=_n.length,xn=yn.length,En=hn.__vertexArray,Tn=hn.__colorArray,wn=hn.colorsNeedUpdate,Cn=hn.__webglCustomAttributesList,Sn=void 0,Dn=void 0,Rn=void 0,An=void 0,Mn=void 0,Ln=void 0;if(hn.verticesNeedUpdate){for(dn=0;dn<bn;dn++)mn=_n[dn],En[gn=3*dn]=mn.x,En[gn+1]=mn.y,En[gn+2]=mn.z;Un.bindBuffer(Un.ARRAY_BUFFER,hn.__webglVertexBuffer),Un.bufferData(Un.ARRAY_BUFFER,En,fn)}if(wn){for(pn=0;pn<xn;pn++)vn=yn[pn],Tn[gn=3*pn]=vn.r,Tn[gn+1]=vn.g,Tn[gn+2]=vn.b;Un.bindBuffer(Un.ARRAY_BUFFER,hn.__webglColorBuffer),Un.bufferData(Un.ARRAY_BUFFER,Tn,fn)}if(Cn)for(Sn=0,Dn=Cn.length;Sn<Dn;Sn++)if((Ln=Cn[Sn]).needsUpdate&&(void 0===Ln.boundTo||"vertices"===Ln.boundTo)){if(gn=0,An=Ln.value.length,1===Ln.size)for(Rn=0;Rn<An;Rn++)Ln.array[Rn]=Ln.value[Rn];else if(2===Ln.size)for(Rn=0;Rn<An;Rn++)Mn=Ln.value[Rn],Ln.array[gn]=Mn.x,Ln.array[gn+1]=Mn.y,gn+=2;else if(3===Ln.size)if("c"===Ln.type)for(Rn=0;Rn<An;Rn++)Mn=Ln.value[Rn],Ln.array[gn]=Mn.r,Ln.array[gn+1]=Mn.g,Ln.array[gn+2]=Mn.b,gn+=3;else for(Rn=0;Rn<An;Rn++)Mn=Ln.value[Rn],Ln.array[gn]=Mn.x,Ln.array[gn+1]=Mn.y,Ln.array[gn+2]=Mn.z,gn+=3;else if(4===Ln.size)for(Rn=0;Rn<An;Rn++)Mn=Ln.value[Rn],Ln.array[gn]=Mn.x,Ln.array[gn+1]=Mn.y,Ln.array[gn+2]=Mn.z,Ln.array[gn+3]=Mn.w,gn+=4;Un.bindBuffer(Un.ARRAY_BUFFER,Ln.buffer),Un.bufferData(Un.ARRAY_BUFFER,Ln.array,fn)}}te.verticesNeedUpdate=!1,te.colorsNeedUpdate=!1,re.attributes&&Bn(re)}else ee instanceof THREE.ParticleSystem&&(ie=(re=Fn(ee,ne)).attributes&&On(re),(te.verticesNeedUpdate||te.colorsNeedUpdate||ee.sortParticles||ie)&&kn(te,Un.DYNAMIC_DRAW,ee),te.verticesNeedUpdate=!1,te.colorsNeedUpdate=!1,re.attributes&&Bn(re))}},this.initMaterial=function(e,t,n,i){var r,o,a,s,l,c,u;for(e instanceof THREE.MeshDepthMaterial?a="depth":e instanceof THREE.MeshNormalMaterial?a="normal":e instanceof THREE.MeshBasicMaterial?a="basic":e instanceof THREE.MeshLambertMaterial?a="lambert":e instanceof THREE.MeshPhongMaterial?a="phong":e instanceof THREE.LineBasicMaterial?a="basic":e instanceof THREE.ParticleBasicMaterial&&(a="particle_basic"),a&&(d=THREE.ShaderLib[a],e.uniforms=THREE.UniformsUtils.clone(d.uniforms),e.vertexShader=d.vertexShader,e.fragmentShader=d.fragmentShader),s=u=p=d=0,l=t.length;s<l;s++)(c=t[s]).onlyShadow||(c instanceof THREE.DirectionalLight&&u++,c instanceof THREE.PointLight&&p++,c instanceof THREE.SpotLight&&d++);u=p+d+u<=E?(l=u,c=p,d):(l=Math.ceil(E*u/(p+u)),c=E-l);for(var h,f=0,d=0,p=t.length;d<p;d++)(s=t[d]).castShadow&&(s instanceof THREE.SpotLight&&f++,s instanceof THREE.DirectionalLight&&!s.shadowCascade&&f++);e:{p=e.fragmentShader,s=e.vertexShader;var m,d=e.uniforms,t=e.attributes,n={map:!!e.map,envMap:!!e.envMap,lightMap:!!e.lightMap,vertexColors:e.vertexColors,fog:n,useFog:e.fog,sizeAttenuation:e.sizeAttenuation,skinning:e.skinning,maxBones:50,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals,maxDirLights:l,maxPointLights:c,maxSpotLights:u,maxShadows:f,shadowMapEnabled:this.shadowMapEnabled&&i.receiveShadow,shadowMapSoft:this.shadowMapSoft,shadowMapDebug:this.shadowMapDebug,shadowMapCascade:this.shadowMapCascade,alphaTest:e.alphaTest,metal:e.metal,perPixel:e.perPixel,wrapAround:e.wrapAround,doubleSided:i&&i.doubleSided},i=[];for(m in a?i.push(a):(i.push(p),i.push(s)),n)i.push(m),i.push(n[m]);for(a=i.join(),m=0,i=T.length;m<i;m++)if(T[m].code===a){h=T[m].program;break e}m=Un.createProgram(),i=["precision "+x+" float;",0<ee?"#define VERTEX_TEXTURES":"",zn.gammaInput?"#define GAMMA_INPUT":"",zn.gammaOutput?"#define GAMMA_OUTPUT":"",zn.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"","#define MAX_DIR_LIGHTS "+n.maxDirLights,"#define MAX_POINT_LIGHTS "+n.maxPointLights,"#define MAX_SPOT_LIGHTS "+n.maxSpotLights,"#define MAX_SHADOWS "+n.maxShadows,"#define MAX_BONES "+n.maxBones,n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.lightMap?"#define USE_LIGHTMAP":"",n.vertexColors?"#define USE_COLOR":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals?"#define USE_MORPHNORMALS":"",n.perPixel?"#define PHONG_PER_PIXEL":"",n.wrapAround?"#define WRAP_AROUND":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapSoft?"#define SHADOWMAP_SOFT":"",n.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",n.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 objectMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\nattribute vec3 color;\n#endif\n#ifdef USE_MORPHTARGETS\nattribute vec3 morphTarget0;\nattribute vec3 morphTarget1;\nattribute vec3 morphTarget2;\nattribute vec3 morphTarget3;\n#ifdef USE_MORPHNORMALS\nattribute vec3 morphNormal0;\nattribute vec3 morphNormal1;\nattribute vec3 morphNormal2;\nattribute vec3 morphNormal3;\n#else\nattribute vec3 morphTarget4;\nattribute vec3 morphTarget5;\nattribute vec3 morphTarget6;\nattribute vec3 morphTarget7;\n#endif\n#endif\n#ifdef USE_SKINNING\nattribute vec4 skinVertexA;\nattribute vec4 skinVertexB;\nattribute vec4 skinIndex;\nattribute vec4 skinWeight;\n#endif\n"].join("\n"),l=["precision "+x+" float;","#define MAX_DIR_LIGHTS "+n.maxDirLights,"#define MAX_POINT_LIGHTS "+n.maxPointLights,"#define MAX_SPOT_LIGHTS "+n.maxSpotLights,"#define MAX_SHADOWS "+n.maxShadows,n.alphaTest?"#define ALPHATEST "+n.alphaTest:"",zn.gammaInput?"#define GAMMA_INPUT":"",zn.gammaOutput?"#define GAMMA_OUTPUT":"",zn.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fog instanceof THREE.FogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.lightMap?"#define USE_LIGHTMAP":"",n.vertexColors?"#define USE_COLOR":"",n.metal?"#define METAL":"",n.perPixel?"#define PHONG_PER_PIXEL":"",n.wrapAround?"#define WRAP_AROUND":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapSoft?"#define SHADOWMAP_SOFT":"",n.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",n.shadowMapCascade?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"].join("\n"),Un.attachShader(m,b("fragment",l+p)),Un.attachShader(m,b("vertex",i+s)),Un.linkProgram(m),Un.getProgramParameter(m,Un.LINK_STATUS),m.uniforms={},m.attributes={};var g,i=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","objectMatrix","cameraPosition","boneGlobalMatrices","morphTargetInfluences"];for(g in d)i.push(g);for(g=i,i=0,d=g.length;i<d;i++)p=g[i],m.uniforms[p]=Un.getUniformLocation(m,p);for(i=["position","normal","uv","uv2","tangent","color","skinVertexA","skinVertexB","skinIndex","skinWeight"],g=0;g<n.maxMorphTargets;g++)i.push("morphTarget"+g);for(g=0;g<n.maxMorphNormals;g++)i.push("morphNormal"+g);for(h in t)i.push(h);for(g=0,t=(h=i).length;g<t;g++)n=h[g],m.attributes[n]=Un.getAttribLocation(m,n);m.id=T.length,T.push({program:m,code:a}),zn.info.memory.programs=T.length,h=m}if(e.program=h,0<=(h=e.program.attributes).position&&Un.enableVertexAttribArray(h.position),0<=h.color&&Un.enableVertexAttribArray(h.color),0<=h.normal&&Un.enableVertexAttribArray(h.normal),0<=h.tangent&&Un.enableVertexAttribArray(h.tangent),e.skinning&&0<=h.skinVertexA&&0<=h.skinVertexB&&0<=h.skinIndex&&0<=h.skinWeight&&(Un.enableVertexAttribArray(h.skinVertexA),Un.enableVertexAttribArray(h.skinVertexB),Un.enableVertexAttribArray(h.skinIndex),Un.enableVertexAttribArray(h.skinWeight)),e.attributes)for(o in e.attributes)void 0!==h[o]&&0<=h[o]&&Un.enableVertexAttribArray(h[o]);if(e.morphTargets)for(m="morphTarget",o=e.numSupportedMorphTargets=0;o<this.maxMorphTargets;o++)0<=h[g=m+o]&&(Un.enableVertexAttribArray(h[g]),e.numSupportedMorphTargets++);if(e.morphNormals)for(m="morphNormal",o=e.numSupportedMorphNormals=0;o<this.maxMorphNormals;o++)0<=h[g=m+o]&&(Un.enableVertexAttribArray(h[g]),e.numSupportedMorphNormals++);for(r in e.uniformsList=[],e.uniforms)e.uniformsList.push([e.uniforms[r],r])},this.setFaceCulling=function(e,t){e?(t&&"ccw"!==t?Un.frontFace(Un.CW):Un.frontFace(Un.CCW),"back"===e?Un.cullFace(Un.BACK):"front"===e?Un.cullFace(Un.FRONT):Un.cullFace(Un.FRONT_AND_BACK),Un.enable(Un.CULL_FACE)):Un.disable(Un.CULL_FACE)},this.setObjectFaces=function(e){h!==e.doubleSided&&(e.doubleSided?Un.disable(Un.CULL_FACE):Un.enable(Un.CULL_FACE),h=e.doubleSided),f!==e.flipSided&&(e.flipSided?Un.frontFace(Un.CW):Un.frontFace(Un.CCW),f=e.flipSided)},this.setDepthTest=function(e){A!==e&&(e?Un.enable(Un.DEPTH_TEST):Un.disable(Un.DEPTH_TEST),A=e)},this.setDepthWrite=function(e){M!==e&&(Un.depthMask(e),M=e)},this.setBlending=function(e,t,n,i){if(e!==C){switch(e){case THREE.NoBlending:Un.disable(Un.BLEND);break;case THREE.AdditiveBlending:Un.enable(Un.BLEND),Un.blendEquation(Un.FUNC_ADD),Un.blendFunc(Un.SRC_ALPHA,Un.ONE);break;case THREE.SubtractiveBlending:Un.enable(Un.BLEND),Un.blendEquation(Un.FUNC_ADD),Un.blendFunc(Un.ZERO,Un.ONE_MINUS_SRC_COLOR);break;case THREE.MultiplyBlending:Un.enable(Un.BLEND),Un.blendEquation(Un.FUNC_ADD),Un.blendFunc(Un.ZERO,Un.SRC_COLOR);break;case THREE.CustomBlending:Un.enable(Un.BLEND);break;default:Un.enable(Un.BLEND),Un.blendEquationSeparate(Un.FUNC_ADD,Un.FUNC_ADD),Un.blendFuncSeparate(Un.SRC_ALPHA,Un.ONE_MINUS_SRC_ALPHA,Un.ONE,Un.ONE_MINUS_SRC_ALPHA)}C=e}e===THREE.CustomBlending?(t!==S&&(Un.blendEquation(F(t)),S=t),n===D&&i===R||(Un.blendFunc(F(n),F(i)),D=n,R=i)):R=D=S=null},this.setTexture=function(e,t){var n,i,r,o;e.needsUpdate?(e.__webglInit||(e.__webglInit=!0,e.__webglTexture=Un.createTexture(),zn.info.memory.textures++),Un.activeTexture(Un.TEXTURE0+t),Un.bindTexture(Un.TEXTURE_2D,e.__webglTexture),Un.pixelStorei(Un.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),i=0==((n=e.image).width&n.width-1)&&0==(n.height&n.height-1),r=F(e.format),o=F(e.type),H(Un.TEXTURE_2D,e,i),e instanceof THREE.DataTexture?Un.texImage2D(Un.TEXTURE_2D,0,r,n.width,n.height,0,r,o,n.data):Un.texImage2D(Un.TEXTURE_2D,0,r,r,o,e.image),e.generateMipmaps&&i&&Un.generateMipmap(Un.TEXTURE_2D),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()):(Un.activeTexture(Un.TEXTURE0+t),Un.bindTexture(Un.TEXTURE_2D,e.__webglTexture))},this.setRenderTarget=function(e){var t=e instanceof THREE.WebGLRenderTargetCube;if(e&&!e.__webglFramebuffer){void 0===e.depthBuffer&&(e.depthBuffer=!0),void 0===e.stencilBuffer&&(e.stencilBuffer=!0),e.__webglTexture=Un.createTexture();var n=0==(e.width&e.width-1)&&0==(e.height&e.height-1),i=F(e.format),r=F(e.type);if(t){e.__webglFramebuffer=[],e.__webglRenderbuffer=[],Un.bindTexture(Un.TEXTURE_CUBE_MAP,e.__webglTexture),H(Un.TEXTURE_CUBE_MAP,e,n);for(var o=0;o<6;o++){e.__webglFramebuffer[o]=Un.createFramebuffer(),e.__webglRenderbuffer[o]=Un.createRenderbuffer(),Un.texImage2D(Un.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,i,e.width,e.height,0,i,r,null);var a=e,s=Un.TEXTURE_CUBE_MAP_POSITIVE_X+o;Un.bindFramebuffer(Un.FRAMEBUFFER,e.__webglFramebuffer[o]),Un.framebufferTexture2D(Un.FRAMEBUFFER,Un.COLOR_ATTACHMENT0,s,a.__webglTexture,0),l(e.__webglRenderbuffer[o],e)}n&&Un.generateMipmap(Un.TEXTURE_CUBE_MAP)}else e.__webglFramebuffer=Un.createFramebuffer(),e.__webglRenderbuffer=Un.createRenderbuffer(),Un.bindTexture(Un.TEXTURE_2D,e.__webglTexture),H(Un.TEXTURE_2D,e,n),Un.texImage2D(Un.TEXTURE_2D,0,i,e.width,e.height,0,i,r,null),i=Un.TEXTURE_2D,Un.bindFramebuffer(Un.FRAMEBUFFER,e.__webglFramebuffer),Un.framebufferTexture2D(Un.FRAMEBUFFER,Un.COLOR_ATTACHMENT0,i,e.__webglTexture,0),l(e.__webglRenderbuffer,e),n&&Un.generateMipmap(Un.TEXTURE_2D);t?Un.bindTexture(Un.TEXTURE_CUBE_MAP,null):Un.bindTexture(Un.TEXTURE_2D,null),Un.bindRenderbuffer(Un.RENDERBUFFER,null),Un.bindFramebuffer(Un.FRAMEBUFFER,null)}r=e?(t=t?e.__webglFramebuffer[e.activeCubeFace]:e.__webglFramebuffer,n=e.width,e=e.height,i=0):(t=null,n=V,e=W,i=j,U),t!==u&&(Un.bindFramebuffer(Un.FRAMEBUFFER,t),Un.viewport(i,r,n,e),u=t),G=n,q=e}},THREE.WebGLRenderTarget=function(e,t,n){this.width=e,this.height=t,n=n||{},this.wrapS=void 0!==n.wrapS?n.wrapS:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==n.wrapT?n.wrapT:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==n.magFilter?n.magFilter:THREE.LinearFilter,this.minFilter=void 0!==n.minFilter?n.minFilter:THREE.LinearMipMapLinearFilter,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.format=void 0!==n.format?n.format:THREE.RGBAFormat,this.type=void 0!==n.type?n.type:THREE.UnsignedByteType,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.generateMipmaps=!0},THREE.WebGLRenderTarget.prototype.clone=function(){var e=new THREE.WebGLRenderTarget(this.width,this.height);return e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.magFilter=this.magFilter,e.minFilter=this.minFilter,e.offset.copy(this.offset),e.repeat.copy(this.repeat),e.format=this.format,e.type=this.type,e.depthBuffer=this.depthBuffer,e.stencilBuffer=this.stencilBuffer,e},THREE.WebGLRenderTargetCube=function(e,t,n){THREE.WebGLRenderTarget.call(this,e,t,n),this.activeCubeFace=0},THREE.WebGLRenderTargetCube.prototype=new THREE.WebGLRenderTarget,THREE.WebGLRenderTargetCube.prototype.constructor=THREE.WebGLRenderTargetCube,THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3,this.positionScreen=new THREE.Vector4,this.visible=!0},THREE.RenderableVertex.prototype.copy=function(e){this.positionWorld.copy(e.positionWorld),this.positionScreen.copy(e.positionScreen)},THREE.RenderableFace3=function(){this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.centroidWorld=new THREE.Vector3,this.centroidScreen=new THREE.Vector3,this.normalWorld=new THREE.Vector3,this.vertexNormalsWorld=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.faceMaterial=this.material=null,this.uvs=[[]],this.z=null},THREE.RenderableFace4=function(){this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.v4=new THREE.RenderableVertex,this.centroidWorld=new THREE.Vector3,this.centroidScreen=new THREE.Vector3,this.normalWorld=new THREE.Vector3,this.vertexNormalsWorld=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.faceMaterial=this.material=null,this.uvs=[[]],this.z=null},THREE.RenderableObject=function(){this.z=this.object=null},THREE.RenderableLine=function(){this.z=null,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.material=null},THREE.GeometryUtils={merge:function(e,t){for(var n,i,r=e.vertices.length,o=t instanceof THREE.Mesh?t.geometry:t,a=e.vertices,s=o.vertices,l=e.faces,c=o.faces,u=e.faceVertexUvs[0],h=o.faceVertexUvs[0],f={},d=0;d<e.materials.length;d++)f[e.materials[d].id]=d;t instanceof THREE.Mesh&&(t.matrixAutoUpdate&&t.updateMatrix(),n=t.matrix,(i=new THREE.Matrix4).extractRotation(n,t.scale));for(var d=0,p=s.length;d<p;d++){var m=s[d].clone();n&&n.multiplyVector3(m),a.push(m)}for(d=0,p=c.length;d<p;d++){var g,v,_=(a=c[d]).vertexNormals,y=a.vertexColors;for(a instanceof THREE.Face3?g=new THREE.Face3(a.a+r,a.b+r,a.c+r):a instanceof THREE.Face4&&(g=new THREE.Face4(a.a+r,a.b+r,a.c+r,a.d+r)),g.normal.copy(a.normal),i&&i.multiplyVector3(g.normal),s=0,m=_.length;s<m;s++)v=_[s].clone(),i&&i.multiplyVector3(v),g.vertexNormals.push(v);for(g.color.copy(a.color),s=0,m=y.length;s<m;s++)v=y[s],g.vertexColors.push(v.clone());void 0!==a.materialIndex&&(void 0===(y=f[m=(s=o.materials[a.materialIndex]).id])&&(y=e.materials.length,f[m]=y,e.materials.push(s)),g.materialIndex=y),g.centroid.copy(a.centroid),n&&n.multiplyVector3(g.centroid),l.push(g)}for(d=0,p=h.length;d<p;d++){for(i=[],s=0,m=(n=h[d]).length;s<m;s++)i.push(new THREE.UV(n[s].u,n[s].v));u.push(i)}},clone:function(e){var t,n=new THREE.Geometry,i=e.vertices,r=e.faces,o=e.faceVertexUvs[0];for(e.materials&&(n.materials=e.materials.slice()),e=0,t=i.length;e<t;e++)n.vertices.push(i[e].clone());for(e=0,t=r.length;e<t;e++)n.faces.push(r[e].clone());for(e=0,t=o.length;e<t;e++){for(var r=[],a=0,s=(i=o[e]).length;a<s;a++)r.push(new THREE.UV(i[a].u,i[a].v));n.faceVertexUvs[0].push(r)}return n},randomPointInTriangle:function(e,t,n){var i,r=new THREE.Vector3,o=THREE.GeometryUtils.__v1,a=THREE.GeometryUtils.random(),s=THREE.GeometryUtils.random();return 1<a+s&&(a=1-a,s=1-s),i=1-a-s,r.copy(e),r.multiplyScalar(a),o.copy(t),o.multiplyScalar(s),r.addSelf(o),o.copy(n),o.multiplyScalar(i),r.addSelf(o),r},randomPointInFace:function(e,t,n){var i,r,o;if(e instanceof THREE.Face3)return i=t.vertices[e.a],r=t.vertices[e.b],o=t.vertices[e.c],THREE.GeometryUtils.randomPointInTriangle(i,r,o);if(e instanceof THREE.Face4){i=t.vertices[e.a],r=t.vertices[e.b],o=t.vertices[e.c];var a,t=t.vertices[e.d];return n?e._area1&&e._area2?(n=e._area1,a=e._area2):(n=THREE.GeometryUtils.triangleArea(i,r,t),a=THREE.GeometryUtils.triangleArea(r,o,t),e._area1=n,e._area2=a):(n=THREE.GeometryUtils.triangleArea(i,r,t),a=THREE.GeometryUtils.triangleArea(r,o,t)),THREE.GeometryUtils.random()*(n+a)<n?THREE.GeometryUtils.randomPointInTriangle(i,r,t):THREE.GeometryUtils.randomPointInTriangle(r,o,t)}},randomPointsInGeometry:function(e,t){function n(r){return function e(t,n){if(n<t)return t;var i=t+Math.floor((n-t)/2);return f[i]>r?e(t,i-1):f[i]<r?e(i+1,n):i}(0,f.length-1)}for(var i,r,o,a,s,l=e.faces,c=e.vertices,u=l.length,h=0,f=[],d=0;d<u;d++)(i=l[d])instanceof THREE.Face3?(r=c[i.a],o=c[i.b],a=c[i.c],i._area=THREE.GeometryUtils.triangleArea(r,o,a)):i instanceof THREE.Face4&&(r=c[i.a],o=c[i.b],a=c[i.c],s=c[i.d],i._area1=THREE.GeometryUtils.triangleArea(r,o,s),i._area2=THREE.GeometryUtils.triangleArea(o,a,s),i._area=i._area1+i._area2),h+=i._area,f[d]=h;for(i=[],d=0;d<t;d++)c=n(c=THREE.GeometryUtils.random()*h),i[d]=THREE.GeometryUtils.randomPointInFace(l[c],e,!0);return i},triangleArea:function(e,t,n){var i,r=THREE.GeometryUtils.__v1;return r.sub(e,t),i=r.length(),r.sub(e,n),e=r.length(),r.sub(t,n),t=.5*(i+e+(n=r.length())),Math.sqrt(t*(t-i)*(t-e)*(t-n))},center:function(e){e.computeBoundingBox();var t=e.boundingBox,n=new THREE.Vector3;return n.add(t.min,t.max),n.multiplyScalar(-.5),e.applyMatrix((new THREE.Matrix4).makeTranslation(n.x,n.y,n.z)),e.computeBoundingBox(),n},normalizeUVs:function(e){for(var t=0,n=(e=e.faceVertexUvs[0]).length;t<n;t++)for(var i=e[t],r=0,o=i.length;r<o;r++)1!==i[r].u&&(i[r].u=i[r].u-Math.floor(i[r].u)),1!==i[r].v&&(i[r].v=i[r].v-Math.floor(i[r].v))},triangulateQuads:function(e){for(var t,n,i=[],r=[],o=[],a=0,s=e.faceUvs.length;a<s;a++)r[a]=[];for(a=0,s=e.faceVertexUvs.length;a<s;a++)o[a]=[];for(a=0,s=e.faces.length;a<s;a++)if((t=e.faces[a])instanceof THREE.Face4){n=t.a;var l=t.b,c=t.c,u=t.d,h=new THREE.Face3,f=new THREE.Face3;for(h.color.copy(t.color),f.color.copy(t.color),h.materialIndex=t.materialIndex,f.materialIndex=t.materialIndex,h.a=n,h.b=l,h.c=u,f.a=l,f.b=c,f.c=u,4===t.vertexColors.length&&(h.vertexColors[0]=t.vertexColors[0].clone(),h.vertexColors[1]=t.vertexColors[1].clone(),h.vertexColors[2]=t.vertexColors[3].clone(),f.vertexColors[0]=t.vertexColors[1].clone(),f.vertexColors[1]=t.vertexColors[2].clone(),f.vertexColors[2]=t.vertexColors[3].clone()),i.push(h,f),t=0,n=e.faceVertexUvs.length;t<n;t++)e.faceVertexUvs[t].length&&(l=(h=e.faceVertexUvs[t][a])[1],c=h[2],u=h[3],h=[h[0].clone(),l.clone(),u.clone()],l=[l.clone(),c.clone(),u.clone()],o[t].push(h,l));for(t=0,n=e.faceUvs.length;t<n;t++)e.faceUvs[t].length&&(l=e.faceUvs[t][a],r[t].push(l,l))}else{for(i.push(t),t=0,n=e.faceUvs.length;t<n;t++)r[t].push(e.faceUvs[t]);for(t=0,n=e.faceVertexUvs.length;t<n;t++)o[t].push(e.faceVertexUvs[t])}e.faces=i,e.faceUvs=r,e.faceVertexUvs=o,e.computeCentroids(),e.computeFaceNormals(),e.computeVertexNormals(),e.hasTangents&&e.computeTangents()},explode:function(e){for(var t=[],n=0,i=e.faces.length;n<i;n++){var r,o,a,s,l=t.length,c=e.faces[n];c instanceof THREE.Face4?(r=c.a,o=c.b,a=c.c,r=e.vertices[r],o=e.vertices[o],a=e.vertices[a],s=e.vertices[c.d],t.push(r.clone()),t.push(o.clone()),t.push(a.clone()),t.push(s.clone()),c.a=l,c.b=l+1,c.c=l+2,c.d=l+3):(r=c.a,o=c.b,a=c.c,r=e.vertices[r],o=e.vertices[o],a=e.vertices[a],t.push(r.clone()),t.push(o.clone()),t.push(a.clone()),c.a=l,c.b=l+1,c.c=l+2)}e.vertices=t,delete e.__tmpVertices},tessellate:function(e,t){for(var n,i,r,o,a,s,l,c,u,h,f,d,p,m,g,v,_,y=[],b=[],x=0,E=e.faceVertexUvs.length;x<E;x++)b[x]=[];for(x=0,E=e.faces.length;x<E;x++)if((n=e.faces[x])instanceof THREE.Face3)if(i=n.a,r=n.b,o=n.c,s=e.vertices[i],l=e.vertices[r],c=e.vertices[o],h=s.distanceTo(l),f=l.distanceTo(c),u=s.distanceTo(c),t<h||t<f||t<u)for(a=e.vertices.length,v=n.clone(),_=n.clone(),n=f<=h&&u<=h?((s=s.clone()).lerpSelf(l,.5),v.a=i,v.b=a,v.c=o,_.a=a,_.b=r,_.c=o,3===n.vertexNormals.length&&((i=n.vertexNormals[0].clone()).lerpSelf(n.vertexNormals[1],.5),v.vertexNormals[1].copy(i),_.vertexNormals[0].copy(i)),3===n.vertexColors.length&&((i=n.vertexColors[0].clone()).lerpSelf(n.vertexColors[1],.5),v.vertexColors[1].copy(i),_.vertexColors[0].copy(i)),0):h<=f&&u<=f?((s=l.clone()).lerpSelf(c,.5),v.a=i,v.b=r,v.c=a,_.a=a,_.b=o,_.c=i,3===n.vertexNormals.length&&((i=n.vertexNormals[1].clone()).lerpSelf(n.vertexNormals[2],.5),v.vertexNormals[2].copy(i),_.vertexNormals[0].copy(i),_.vertexNormals[1].copy(n.vertexNormals[2]),_.vertexNormals[2].copy(n.vertexNormals[0])),3===n.vertexColors.length&&((i=n.vertexColors[1].clone()).lerpSelf(n.vertexColors[2],.5),v.vertexColors[2].copy(i),_.vertexColors[0].copy(i),_.vertexColors[1].copy(n.vertexColors[2]),_.vertexColors[2].copy(n.vertexColors[0])),1):((s=s.clone()).lerpSelf(c,.5),v.a=i,v.b=r,v.c=a,_.a=a,_.b=r,_.c=o,3===n.vertexNormals.length&&((i=n.vertexNormals[0].clone()).lerpSelf(n.vertexNormals[2],.5),v.vertexNormals[2].copy(i),_.vertexNormals[0].copy(i)),3===n.vertexColors.length&&((i=n.vertexColors[0].clone()).lerpSelf(n.vertexColors[2],.5),v.vertexColors[2].copy(i),_.vertexColors[0].copy(i)),2),y.push(v,_),e.vertices.push(s),i=0,r=e.faceVertexUvs.length;i<r;i++)e.faceVertexUvs[i].length&&(_=(s=e.faceVertexUvs[i][x])[0],o=s[1],v=s[2],o=0===n?((l=_.clone()).lerpSelf(o,.5),s=[_.clone(),l.clone(),v.clone()],[l.clone(),o.clone(),v.clone()]):1===n?((l=o.clone()).lerpSelf(v,.5),s=[_.clone(),o.clone(),l.clone()],[l.clone(),v.clone(),_.clone()]):((l=_.clone()).lerpSelf(v,.5),s=[_.clone(),o.clone(),l.clone()],[l.clone(),o.clone(),v.clone()]),b[i].push(s,o));else for(y.push(n),i=0,r=e.faceVertexUvs.length;i<r;i++)b[i].push(e.faceVertexUvs[i][x]);else if(i=n.a,r=n.b,o=n.c,a=n.d,s=e.vertices[i],l=e.vertices[r],c=e.vertices[o],u=e.vertices[a],h=s.distanceTo(l),f=l.distanceTo(c),d=c.distanceTo(u),p=s.distanceTo(u),t<h||t<f||t<d||t<p)for(m=e.vertices.length,g=e.vertices.length+1,v=n.clone(),_=n.clone(),n=f<=h&&d<=h&&p<=h||f<=d&&h<=d&&p<=d?((h=s.clone()).lerpSelf(l,.5),(l=c.clone()).lerpSelf(u,.5),v.a=i,v.b=m,v.c=g,v.d=a,_.a=m,_.b=r,_.c=o,_.d=g,4===n.vertexNormals.length&&((i=n.vertexNormals[0].clone()).lerpSelf(n.vertexNormals[1],.5),(r=n.vertexNormals[2].clone()).lerpSelf(n.vertexNormals[3],.5),v.vertexNormals[1].copy(i),v.vertexNormals[2].copy(r),_.vertexNormals[0].copy(i),_.vertexNormals[3].copy(r)),4===n.vertexColors.length&&((i=n.vertexColors[0].clone()).lerpSelf(n.vertexColors[1],.5),(r=n.vertexColors[2].clone()).lerpSelf(n.vertexColors[3],.5),v.vertexColors[1].copy(i),v.vertexColors[2].copy(r),_.vertexColors[0].copy(i),_.vertexColors[3].copy(r)),0):((h=l.clone()).lerpSelf(c,.5),(l=u.clone()).lerpSelf(s,.5),v.a=i,v.b=r,v.c=m,v.d=g,_.a=g,_.b=m,_.c=o,_.d=a,4===n.vertexNormals.length&&((i=n.vertexNormals[1].clone()).lerpSelf(n.vertexNormals[2],.5),(r=n.vertexNormals[3].clone()).lerpSelf(n.vertexNormals[0],.5),v.vertexNormals[2].copy(i),v.vertexNormals[3].copy(r),_.vertexNormals[0].copy(r),_.vertexNormals[1].copy(i)),4===n.vertexColors.length&&((i=n.vertexColors[1].clone()).lerpSelf(n.vertexColors[2],.5),(r=n.vertexColors[3].clone()).lerpSelf(n.vertexColors[0],.5),v.vertexColors[2].copy(i),v.vertexColors[3].copy(r),_.vertexColors[0].copy(r),_.vertexColors[1].copy(i)),1),y.push(v,_),e.vertices.push(h,l),i=0,r=e.faceVertexUvs.length;i<r;i++)e.faceVertexUvs[i].length&&(_=(s=e.faceVertexUvs[i][x])[0],o=s[1],v=s[2],s=s[3],o=0===n?((l=_.clone()).lerpSelf(o,.5),(c=v.clone()).lerpSelf(s,.5),_=[_.clone(),l.clone(),c.clone(),s.clone()],[l.clone(),o.clone(),v.clone(),c.clone()]):((l=o.clone()).lerpSelf(v,.5),(c=s.clone()).lerpSelf(_,.5),_=[_.clone(),o.clone(),l.clone(),c.clone()],[c.clone(),l.clone(),v.clone(),s.clone()]),b[i].push(_,o));else for(y.push(n),i=0,r=e.faceVertexUvs.length;i<r;i++)b[i].push(e.faceVertexUvs[i][x]);e.faces=y,e.faceVertexUvs=b}},THREE.GeometryUtils.random=THREE.Math.random16,THREE.GeometryUtils.__v1=new THREE.Vector3,THREE.ImageUtils={crossOrigin:"anonymous",loadTexture:function(e,t,n){var i=new Image,r=new THREE.Texture(i,t);return i.onload=function(){r.needsUpdate=!0,n&&n(this)},i.crossOrigin=this.crossOrigin,i.src=e,r},loadTextureCube:function(e,t,n){for(var i=[],r=new THREE.Texture(i,t),t=i.loadCount=0,o=e.length;t<o;++t)i[t]=new Image,i[t].onload=function(){i.loadCount=i.loadCount+1,6===i.loadCount&&(r.needsUpdate=!0),n&&n(this)},i[t].crossOrigin=this.crossOrigin,i[t].src=e[t];return r},getNormalMap:function(e,t){var t=1|t,n=e.width,i=e.height,r=document.createElement("canvas");r.width=n,r.height=i;var o=r.getContext("2d");o.drawImage(e,0,0);for(var a,s,l=o.getImageData(0,0,n,i).data,c=o.createImageData(n,i),u=c.data,h=0;h<n;h++)for(var f=0;f<i;f++){var d=f-1<0?0:f-1,p=i-1<f+1?i-1:f+1,m=h-1<0?0:h-1,g=n-1<h+1?n-1:h+1,v=[],_=[0,0,l[4*(f*n+h)]/255*t];for(v.push([-1,0,l[4*(f*n+m)]/255*t]),v.push([-1,-1,l[4*(d*n+m)]/255*t]),v.push([0,-1,l[4*(d*n+h)]/255*t]),v.push([1,-1,l[4*(d*n+g)]/255*t]),v.push([1,0,l[4*(f*n+g)]/255*t]),v.push([1,1,l[4*(p*n+g)]/255*t]),v.push([0,1,l[4*(p*n+h)]/255*t]),v.push([-1,1,l[4*(p*n+m)]/255*t]),d=[],m=v.length,p=0;p<m;p++){var g=v[p],y=v[(p+1)%m],g=[g[0]-_[0],g[1]-_[1],g[2]-_[2]],y=[y[0]-_[0],y[1]-_[1],y[2]-_[2]];d.push((a=[g[1]*y[2]-g[2]*y[1],g[2]*y[0]-g[0]*y[2],g[0]*y[1]-g[1]*y[0]],s=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]),[a[0]/s,a[1]/s,a[2]/s]))}for(v=[0,0,0],p=0;p<d.length;p++)v[0]=v[0]+d[p][0],v[1]=v[1]+d[p][1],v[2]=v[2]+d[p][2];v[0]=v[0]/d.length,v[1]=v[1]/d.length,v[2]=v[2]/d.length,u[_=4*(f*n+h)]=(v[0]+1)/2*255|0,u[_+1]=255*(v[1]+.5)|0,u[_+2]=255*v[2]|0,u[_+3]=255}return o.putImageData(c,0,0),r},generateDataTexture:function(e,t,n){for(var i=e*t,r=new Uint8Array(3*i),o=Math.floor(255*n.r),a=Math.floor(255*n.g),n=Math.floor(255*n.b),s=0;s<i;s++)r[3*s]=o,r[3*s+1]=a,r[3*s+2]=n;return(e=new THREE.DataTexture(r,e,t,THREE.RGBFormat)).needsUpdate=!0,e}},THREE.SceneUtils={showHierarchy:function(e,t){THREE.SceneUtils.traverseHierarchy(e,function(e){e.visible=t})},traverseHierarchy:function(e,t){for(var n,i=e.children.length,r=0;r<i;r++)t(n=e.children[r]),THREE.SceneUtils.traverseHierarchy(n,t)},createMultiMaterialObject:function(e,t){for(var n=t.length,i=new THREE.Object3D,r=0;r<n;r++){var o=new THREE.Mesh(e,t[r]);i.add(o)}return i},cloneObject:function(e){var t;e instanceof THREE.Mesh?t=new THREE.Mesh(e.geometry,e.material):e instanceof THREE.Line?t=new THREE.Line(e.geometry,e.material,e.type):e instanceof THREE.Ribbon?t=new THREE.Ribbon(e.geometry,e.material):e instanceof THREE.ParticleSystem?(t=new THREE.ParticleSystem(e.geometry,e.material)).sortParticles=e.sortParticles:e instanceof THREE.Particle?t=new THREE.Particle(e.material):e instanceof THREE.Sprite?((t=new THREE.Sprite({})).color.copy(e.color),t.map=e.map,t.blending=e.blending,t.useScreenCoordinates=e.useScreenCoordinates,t.mergeIntoThis3D=e.mergeIntoThis3D,t.affectedByDistance=e.affectedByDistance,t.scaleByViewport=e.scaleByViewport,t.alignment=e.alignment,t.rotation3d.copy(e.rotation3d),t.rotation=e.rotation,t.opacity=e.opacity,t.uvOffset.copy(e.uvOffset),t.uvScale.copy(e.uvScale)):e instanceof THREE.LOD?t=new THREE.LOD:e instanceof THREE.Object3D&&(t=new THREE.Object3D),t.name=e.name,t.parent=e.parent,t.up.copy(e.up),t.position.copy(e.position),t.rotation instanceof THREE.Vector3&&t.rotation.copy(e.rotation),t.eulerOrder=e.eulerOrder,t.scale.copy(e.scale),t.dynamic=e.dynamic,t.doubleSided=e.doubleSided,t.flipSided=e.flipSided,t.renderDepth=e.renderDepth,t.rotationAutoUpdate=e.rotationAutoUpdate,t.matrix.copy(e.matrix),t.matrixWorld.copy(e.matrixWorld),t.matrixRotationWorld.copy(e.matrixRotationWorld),t.matrixAutoUpdate=e.matrixAutoUpdate,t.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,t.quaternion.copy(e.quaternion),t.useQuaternion=e.useQuaternion,t.boundRadius=e.boundRadius,t.boundRadiusScale=e.boundRadiusScale,t.visible=e.visible,t.castShadow=e.castShadow,t.receiveShadow=e.receiveShadow,t.frustumCulled=e.frustumCulled;for(var n=0;n<e.children.length;n++){var i=THREE.SceneUtils.cloneObject(e.children[n]);(t.children[n]=i).parent=t}if(e instanceof THREE.LOD)for(n=0;n<e.LODs.length;n++)t.LODs[n]={visibleAtDistance:e.LODs[n].visibleAtDistance,object3D:t.children[n]};return t},detach:function(e,t,n){e.applyMatrix(t.matrixWorld),t.remove(e),n.add(e)},attach:function(e,t,n){var i=new THREE.Matrix4;i.getInverse(n.matrixWorld),e.applyMatrix(i),t.remove(e),n.add(e)}},THREE.WebGLRenderer&&(THREE.ShaderUtils={lib:{fresnel:{uniforms:{mRefractionRatio:{type:"f",value:1.02},mFresnelBias:{type:"f",value:.1},mFresnelPower:{type:"f",value:2},mFresnelScale:{type:"f",value:1},tCube:{type:"t",value:1,texture:null}},fragmentShader:"uniform samplerCube tCube;\nvarying vec3 vReflect;\nvarying vec3 vRefract[3];\nvarying float vReflectionFactor;\nvoid main() {\nvec4 reflectedColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\nvec4 refractedColor = vec4( 1.0, 1.0, 1.0, 1.0 );\nrefractedColor.r = textureCube( tCube, vec3( -vRefract[0].x, vRefract[0].yz ) ).r;\nrefractedColor.g = textureCube( tCube, vec3( -vRefract[1].x, vRefract[1].yz ) ).g;\nrefractedColor.b = textureCube( tCube, vec3( -vRefract[2].x, vRefract[2].yz ) ).b;\nrefractedColor.a = 1.0;\ngl_FragColor = mix( refractedColor, reflectedColor, clamp( vReflectionFactor, 0.0, 1.0 ) );\n}",vertexShader:"uniform float mRefractionRatio;\nuniform float mFresnelBias;\nuniform float mFresnelScale;\nuniform float mFresnelPower;\nvarying vec3 vReflect;\nvarying vec3 vRefract[3];\nvarying float vReflectionFactor;\nvoid main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\nvec3 nWorld = normalize ( mat3( objectMatrix[0].xyz, objectMatrix[1].xyz, objectMatrix[2].xyz ) * normal );\nvec3 I = mPosition.xyz - cameraPosition;\nvReflect = reflect( I, nWorld );\nvRefract[0] = refract( normalize( I ), nWorld, mRefractionRatio );\nvRefract[1] = refract( normalize( I ), nWorld, mRefractionRatio * 0.99 );\nvRefract[2] = refract( normalize( I ), nWorld, mRefractionRatio * 0.98 );\nvReflectionFactor = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( I ), nWorld ), mFresnelPower );\ngl_Position = projectionMatrix * mvPosition;\n}"},normal:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},tDiffuse:{type:"t",value:0,texture:null},tCube:{type:"t",value:1,texture:null},tNormal:{type:"t",value:2,texture:null},tSpecular:{type:"t",value:3,texture:null},tAO:{type:"t",value:4,texture:null},tDisplacement:{type:"t",value:5,texture:null},uNormalScale:{type:"f",value:1},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},uDiffuseColor:{type:"c",value:new THREE.Color(16777215)},uSpecularColor:{type:"c",value:new THREE.Color(1118481)},uAmbientColor:{type:"c",value:new THREE.Color(16777215)},uShininess:{type:"f",value:30},uOpacity:{type:"f",value:1},uReflectivity:{type:"f",value:.5},uOffset:{type:"v2",value:new THREE.Vector2(0,0)},uRepeat:{type:"v2",value:new THREE.Vector2(1,1)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 uAmbientColor;\nuniform vec3 uDiffuseColor;\nuniform vec3 uSpecularColor;\nuniform float uShininess;\nuniform float uOpacity;\nuniform bool enableDiffuse;\nuniform bool enableSpecular;\nuniform bool enableAO;\nuniform bool enableReflection;\nuniform sampler2D tDiffuse;\nuniform sampler2D tNormal;\nuniform sampler2D tSpecular;\nuniform sampler2D tAO;\nuniform samplerCube tCube;\nuniform float uNormalScale;\nuniform float uReflectivity;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;",THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3( 1.0 ), uOpacity );\nvec3 specularTex = vec3( 1.0 );\nvec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;\nnormalTex.xy *= uNormalScale;\nnormalTex = normalize( normalTex );\nif( enableDiffuse ) {\n#ifdef GAMMA_INPUT\nvec4 texelColor = texture2D( tDiffuse, vUv );\ntexelColor.xyz *= texelColor.xyz;\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );\n#endif\n}\nif( enableAO ) {\n#ifdef GAMMA_INPUT\nvec4 aoColor = texture2D( tAO, vUv );\naoColor.xyz *= aoColor.xyz;\ngl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;\n#endif\n}\nif( enableSpecular )\nspecularTex = texture2D( tSpecular, vUv ).xyz;\nmat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );\nvec3 finalNormal = tsb * normalTex;\nvec3 normal = normalize( finalNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec3 pointVector = normalize( vPointLight[ i ].xyz );\nfloat pointDistance = vPointLight[ i ].w;\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );\n#endif\npointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;\nvec3 pointHalfVector = normalize( pointVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;\n#else\npointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\n#ifdef WRAP_AROUND\nfloat directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );\nfloat directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\n#endif\ndirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor) + totalSpecular;\nif ( enableReflection ) {\nvec3 wPos = cameraPosition - vViewPosition;\nvec3 vReflect = reflect( normalize( wPos ), normal );\nvec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );\n}",THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;\nuniform vec2 uOffset;\nuniform vec2 uRepeat;\n#ifdef VERTEX_TEXTURES\nuniform sampler2D tDisplacement;\nuniform float uDisplacementScale;\nuniform float uDisplacementBias;\n#endif\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\nvarying vec3 vViewPosition;",THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\nvViewPosition = -mvPosition.xyz;\nvNormal = normalMatrix * normal;\nvTangent = normalMatrix * tangent.xyz;\nvBinormal = cross( vNormal, vTangent ) * tangent.w;\nvUv = uv * uRepeat + uOffset;\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#ifdef VERTEX_TEXTURES\nvec3 dv = texture2D( tDisplacement, uv ).xyz;\nfloat df = uDisplacementScale * dv.x + uDisplacementBias;\nvec4 displacedPosition = vec4( normalize( vNormal.xyz ) * df, 0.0 ) + mvPosition;\ngl_Position = projectionMatrix * displacedPosition;\n#else\ngl_Position = projectionMatrix * mvPosition;\n#endif",THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:1,texture:null},tFlip:{type:"f",value:-1}},vertexShader:"varying vec3 vViewPosition;\nvoid main() {\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\nvViewPosition = cameraPosition - mPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vViewPosition;\nvoid main() {\nvec3 wPos = cameraPosition - vViewPosition;\ngl_FragColor = textureCube( tCube, vec3( tFlip * wPos.x, wPos.yz ) );\n}"}}}),THREE.BufferGeometry=function(){this.id=THREE.GeometryCount++,this.vertexColorArray=this.vertexUvArray=this.vertexNormalArray=this.vertexPositionArray=this.vertexIndexArray=this.vertexColorBuffer=this.vertexUvBuffer=this.vertexNormalBuffer=this.vertexPositionBuffer=this.vertexIndexBuffer=null,this.dynamic=!1,this.boundingSphere=this.boundingBox=null,this.morphTargets=[]},THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,computeBoundingBox:function(){},computeBoundingSphere:function(){}},THREE.CubeGeometry=function(e,t,n,b,x,E,i,r){function o(e,t,n,i,r,o,a,s){var l,c=b||1,u=x||1,h=r/2,f=o/2,d=T.vertices.length;"x"===e&&"y"===t||"y"===e&&"x"===t?l="z":"x"===e&&"z"===t||"z"===e&&"x"===t?(l="y",u=E||1):("z"===e&&"y"===t||"y"===e&&"z"===t)&&(l="x",c=E||1);var p=c+1,m=u+1,g=r/c,v=o/u,_=new THREE.Vector3;for(_[l]=0<a?1:-1,r=0;r<m;r++)for(o=0;o<p;o++){var y=new THREE.Vector3;y[e]=(o*g-h)*n,y[t]=(r*v-f)*i,y[l]=a,T.vertices.push(y)}for(r=0;r<u;r++)for(o=0;o<c;o++)(e=new THREE.Face4(o+p*r+d,o+p*(r+1)+d,o+1+p*(r+1)+d,o+1+p*r+d)).normal.copy(_),e.vertexNormals.push(_.clone(),_.clone(),_.clone(),_.clone()),e.materialIndex=s,T.faces.push(e),T.faceVertexUvs[0].push([new THREE.UV(o/c,r/u),new THREE.UV(o/c,(r+1)/u),new THREE.UV((o+1)/c,(r+1)/u),new THREE.UV((o+1)/c,r/u)])}THREE.Geometry.call(this);var a,s,l,c,u,h,T=this,f=e/2,d=t/2,p=n/2;if(void 0!==i){if(i instanceof Array)this.materials=i;else for(this.materials=[],a=0;a<6;a++)this.materials.push(i);a=0,c=1,s=2,u=3,l=4,h=5}else this.materials=[];if(this.sides={px:!0,nx:!0,py:!0,ny:!0,pz:!0,nz:!0},null!=r)for(var m in r)void 0!==this.sides[m]&&(this.sides[m]=r[m]);this.sides.px&&o("z","y",-1,-1,n,t,f,a),this.sides.nx&&o("z","y",1,-1,n,t,-f,c),this.sides.py&&o("x","z",1,1,e,n,d,s),this.sides.ny&&o("x","z",1,-1,e,n,-d,u),this.sides.pz&&o("x","y",1,-1,e,t,p,l),this.sides.nz&&o("x","y",-1,-1,e,t,-p,h),this.computeCentroids(),this.mergeVertices()},THREE.CubeGeometry.prototype=new THREE.Geometry,THREE.CubeGeometry.prototype.constructor=THREE.CubeGeometry,THREE.CylinderGeometry=function(e,t,n,i,r,o){THREE.Geometry.call(this);for(var e=void 0!==e?e:20,t=void 0!==t?t:20,a=(n=void 0!==n?n:100)/2,i=i||8,r=r||1,s=[],l=[],c=0;c<=r;c++){for(var u=[],h=[],f=(m=c/r)*(t-e)+e,d=0;d<=i;d++){var p=d/i;(g=new THREE.Vector3).x=f*Math.sin(p*Math.PI*2),g.y=-m*n+a,g.z=f*Math.cos(p*Math.PI*2),this.vertices.push(g),u.push(this.vertices.length-1),h.push(new THREE.UV(p,m))}s.push(u),l.push(h)}for(n=(t-e)/n,d=0;d<i;d++)for(h=0!==e?(u=this.vertices[s[0][d]].clone(),this.vertices[s[0][d+1]].clone()):(u=this.vertices[s[1][d]].clone(),this.vertices[s[1][d+1]].clone()),u.setY(Math.sqrt(u.x*u.x+u.z*u.z)*n).normalize(),h.setY(Math.sqrt(h.x*h.x+h.z*h.z)*n).normalize(),c=0;c<r;c++){var m=s[c][d],f=s[c+1][d],p=s[c+1][d+1],g=s[c][d+1],v=u.clone(),_=u.clone(),y=h.clone(),b=h.clone(),x=l[c][d].clone(),E=l[c+1][d].clone(),T=l[c+1][d+1].clone(),w=l[c][d+1].clone();this.faces.push(new THREE.Face4(m,f,p,g,[v,_,y,b])),this.faceVertexUvs[0].push([x,E,T,w])}if(!o&&0<e)for(this.vertices.push(new THREE.Vector3(0,a,0)),d=0;d<i;d++)m=s[0][d],f=s[0][d+1],p=this.vertices.length-1,v=new THREE.Vector3(0,1,0),_=new THREE.Vector3(0,1,0),y=new THREE.Vector3(0,1,0),x=l[0][d].clone(),E=l[0][d+1].clone(),T=new THREE.UV(E.u,0),this.faces.push(new THREE.Face3(m,f,p,[v,_,y])),this.faceVertexUvs[0].push([x,E,T]);if(!o&&0<t)for(this.vertices.push(new THREE.Vector3(0,-a,0)),d=0;d<i;d++)m=s[c][d+1],f=s[c][d],p=this.vertices.length-1,v=new THREE.Vector3(0,-1,0),_=new THREE.Vector3(0,-1,0),y=new THREE.Vector3(0,-1,0),x=l[c][d+1].clone(),E=l[c][d].clone(),T=new THREE.UV(E.u,1),this.faces.push(new THREE.Face3(m,f,p,[v,_,y])),this.faceVertexUvs[0].push([x,E,T]);this.computeCentroids(),this.computeFaceNormals()},THREE.CylinderGeometry.prototype=new THREE.Geometry,THREE.CylinderGeometry.prototype.constructor=THREE.CylinderGeometry,THREE.PlaneGeometry=function(e,t,n,i){THREE.Geometry.call(this);for(var r=e/2,o=t/2,a=(n=n||1)+1,s=(i=i||1)+1,l=e/n,c=t/i,u=new THREE.Vector3(0,1,0),e=0;e<s;e++)for(t=0;t<a;t++)this.vertices.push(new THREE.Vector3(t*l-r,0,e*c-o));for(e=0;e<i;e++)for(t=0;t<n;t++)(r=new THREE.Face4(t+a*e,t+a*(e+1),t+1+a*(e+1),t+1+a*e)).normal.copy(u),r.vertexNormals.push(u.clone(),u.clone(),u.clone(),u.clone()),this.faces.push(r),this.faceVertexUvs[0].push([new THREE.UV(t/n,e/i),new THREE.UV(t/n,(e+1)/i),new THREE.UV((t+1)/n,(e+1)/i),new THREE.UV((t+1)/n,e/i)]);this.computeCentroids()},THREE.PlaneGeometry.prototype=new THREE.Geometry,THREE.PlaneGeometry.prototype.constructor=THREE.PlaneGeometry,THREE.SphereGeometry=function(e,t,n,i,r,o,a){THREE.Geometry.call(this);for(var e=e||50,i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),s=[],l=[],c=0;c<=n;c++){for(var u=[],h=[],f=0;f<=t;f++){var d=f/t,p=c/n;(m=new THREE.Vector3).x=-e*Math.cos(i+d*r)*Math.sin(o+p*a),m.y=e*Math.cos(o+p*a),m.z=e*Math.sin(i+d*r)*Math.sin(o+p*a),this.vertices.push(m),u.push(this.vertices.length-1),h.push(new THREE.UV(d,p))}s.push(u),l.push(h)}for(c=0;c<n;c++)for(f=0;f<t;f++){var i=s[c][f+1],r=s[c][f],o=s[c+1][f],a=s[c+1][f+1],u=this.vertices[i].clone().normalize(),h=this.vertices[r].clone().normalize(),d=this.vertices[o].clone().normalize(),p=this.vertices[a].clone().normalize(),m=l[c][f+1].clone(),g=l[c][f].clone(),v=l[c+1][f].clone(),_=l[c+1][f+1].clone();Math.abs(this.vertices[i].y)==e?(this.faces.push(new THREE.Face3(i,o,a,[u,d,p])),this.faceVertexUvs[0].push([m,v,_])):Math.abs(this.vertices[o].y)==e?(this.faces.push(new THREE.Face3(i,r,o,[u,h,d])),this.faceVertexUvs[0].push([m,g,v])):(this.faces.push(new THREE.Face4(i,r,o,a,[u,h,d,p])),this.faceVertexUvs[0].push([m,g,v,_]))}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere={radius:e}},THREE.SphereGeometry.prototype=new THREE.Geometry,THREE.SphereGeometry.prototype.constructor=THREE.SphereGeometry,THREE.PolyhedronGeometry=function(e,t,n,i){function r(e){var t=e.normalize().clone();t.index=l.vertices.push(t)-1;var n=Math.atan2(e.z,-e.x)/2/Math.PI+.5,e=Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))/Math.PI+.5;return t.uv=new THREE.UV(n,e),t}function o(e,t,n,i){i<1?((i=new THREE.Face3(e.index,t.index,n.index,[e.clone(),t.clone(),n.clone()])).centroid.addSelf(e).addSelf(t).addSelf(n).divideScalar(3),i.normal=i.centroid.clone().normalize(),l.faces.push(i),i=Math.atan2(i.centroid.z,-i.centroid.x),l.faceVertexUvs[0].push([s(e.uv,e,i),s(t.uv,t,i),s(n.uv,n,i)])):(--i,o(e,a(e,t),a(e,n),i),o(a(e,t),t,a(t,n),i),o(a(e,n),a(t,n),n,i),o(a(e,t),a(t,n),a(e,n),i))}function a(e,t){h[e.index]||(h[e.index]=[]),h[t.index]||(h[t.index]=[]);var n=h[e.index][t.index];return void 0===n&&(h[e.index][t.index]=h[t.index][e.index]=n=r((new THREE.Vector3).add(e,t).divideScalar(2))),n}function s(e,t,n){return n<0&&1===e.u&&(e=new THREE.UV(e.u-1,e.v)),0===t.x&&0===t.z&&(e=new THREE.UV(n/2/Math.PI+.5,e.v)),e}THREE.Geometry.call(this);for(var n=n||1,i=i||0,l=this,c=0,u=e.length;c<u;c++)r(new THREE.Vector3(e[c][0],e[c][1],e[c][2]));for(var h=[],e=this.vertices,c=0,u=t.length;c<u;c++)o(e[t[c][0]],e[t[c][1]],e[t[c][2]],i);for(this.mergeVertices(),c=0,u=this.vertices.length;c<u;c++)this.vertices[c].multiplyScalar(n);this.computeCentroids(),this.boundingSphere={radius:n}},THREE.PolyhedronGeometry.prototype=new THREE.Geometry,THREE.PolyhedronGeometry.prototype.constructor=THREE.PolyhedronGeometry,THREE.IcosahedronGeometry=function(e,t){var n=(1+Math.sqrt(5))/2;THREE.PolyhedronGeometry.call(this,[[-1,n,0],[1,n,0],[-1,-n,0],[1,-n,0],[0,-1,n],[0,1,n],[0,-1,-n],[0,1,-n],[n,0,-1],[n,0,1],[-n,0,-1],[-n,0,1]],[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]],e,t)},THREE.IcosahedronGeometry.prototype=new THREE.Geometry,THREE.IcosahedronGeometry.prototype.constructor=THREE.IcosahedronGeometry,function(){for(var o=0,e=["ms","moz","webkit","o"],t=0;t<e.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[e[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[t]+"CancelAnimationFrame"]||window[e[t]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,t){var n=(new Date).getTime(),i=Math.max(0,16-(n-o)),r=window.setTimeout(function(){e(n+i)},i);return o=n+i,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}();var TV3=THREE.Vector3,TF3=THREE.Face3,TCo=THREE.Color;THREE.Geometry.prototype.colorAll=function(e){for(var t=0;t<this.faces.length;t++)this.faces[t].color=e},THREE.Matrix4.prototype.isIdentity=function(){for(var e=0;e<4;e++)for(var t=0;t<4;t++)if(this.elements[4*e+t]!=(e==t))return!1;return!0};var GLmolElementColors={D:16777152,H:16777215,He:14286847,Li:13402367,Be:12779264,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Ne:11789301,Na:11230450,Mg:9109248,Al:12560038,Si:1578e4,P:16744448,S:16777008,Cl:2093087,Ar:8442339,K:9388244,Ca:4062976,Sc:15132390,Ti:12567239,V:10921643,Cr:9083335,Mn:10255047,Fe:14706227,Co:15765664,Ni:5296208,Cu:13140019,Zn:8224944,Ga:12750735,Ge:6721423,As:12419299,Se:16752896,Br:10889513,Kr:6076625,Rb:7351984,Sr:65280,Y:9764863,Zr:9756896,Nb:7586505,Mo:5551541,Tc:3907230,Ru:2396047,Rh:687500,Pd:27013,Ag:12632256,Cd:16767375,In:10909043,Sn:6717568,Sb:10380213,Te:13924864,I:9699476,Xe:4366e3,Cs:5707663,Ba:51456,La:7394559,Ce:16777159,Pr:14286791,Nd:13107143,Pm:10747847,Sm:9437127,Eu:6422471,Gd:4587463,Tb:3211207,Dy:2097095,Ho:65436,Er:58997,Tm:54354,Yb:48952,Lu:43812,Hf:5096191,Ta:5089023,W:2200790,Re:2522539,Os:2516630,Ir:1528967,Pt:13684960,Au:16765219,Hg:12105936,Tl:10900557,Pb:5724513,Bi:10375093,Po:11230208,At:7688005,Rn:4358806,Fr:4325478,Ra:32e3,Ac:7384058,Th:47871,Pa:41471,U:36863,Np:33023,Pu:27647,Am:5528818,Cm:7888099,Bk:9064419,Cf:10565332,Es:11739092,Fm:11739066,Md:11734438,No:12389767,Lr:13041766,Rf:13369433,Db:13697103,Sg:14221381,Bh:14680120,Hs:15073326,Mt:15400998},GLmolVDWRadii={H:1.08,HE:1.34,LI:1.75,BE:2.05,B:1.47,C:1.49,N:1.41,O:1.4,F:1.39,NE:1.68,NA:1.84,MG:2.05,AL:2.11,SI:2.07,P:1.92,S:1.82,CL:1.83,AR:1.93,K:2.05,CA:2.21,SC:2.16,TI:1.87,V:1.79,CR:1.89,MN:1.97,FE:1.94,CO:1.92,NI:1.84,CU:1.86,ZN:2.1,GA:2.08,GE:2.15,AS:2.06,SE:1.93,BR:1.98,KR:2.12,RB:2.16,SR:2.24,Y:2.19,ZR:1.86,NB:2.07,MO:2.09,TC:2.09,RU:2.07,RH:1.95,PD:2.02,AG:2.03,CD:2.3,IN:2.36,SN:2.33,SB:2.25,TE:2.23,I:2.23,XE:2.21,CS:2.22,BA:2.51,LA:2.4,CE:2.35,PR:2.39,ND:2.29,PM:2.36,SM:2.29,EU:2.33,GD:2.37,TB:2.21,DY:2.29,HO:2.16,ER:2.35,TM:2.27,YB:2.42,LU:2.21,HF:2.12,TA:2.17,W:2.1,RE:2.17,OS:2.16,IR:2.02,PT:2.09,AU:2.17,HG:2.09,TL:2.35,PB:2.32,BI:2.43,PO:2.29,AT:2.36,RN:2.43,FR:2.56,RA:2.43,AC:2.6,TH:2.37,PA:2.43,U:2.4,NP:2.21,PU:2.56,AM:2.56,CM:2.56,BK:2.56,CF:2.56,ES:2.56,FM:2.56},GLmolAminoColors={ALA:13158600,ARG:1334015,ASN:56540,ASP:15075850,CYS:15132160,GLN:56540,GLU:15075850,GLY:15461355,HIS:8553170,ILE:1016335,LEU:1016335,LYS:1334015,MET:15132160,PHE:3289770,PRO:14456450,SER:16422400,THR:16422400,TRP:11819700,TYR:3289770,VAL:1016335,ASX:16738740,GLX:16738740},polarResidues=["ARG","HIS","LYS","ASP","GLU","SER","THR","ASN","GLN","CYS"],nonPolarResidues=["GLY","PRO","ALA","VAL","LEU","ILE","MET","PHE","TYR","TRP"],GLmol=function(){function e(e,t,n,i){return this.create(e,t,n,i),!0}return e.prototype.create=function(e,t,n,i){this.nucleotides=["  G","  A","  T","  C","  U"," DG"," DA"," DT"," DC"," DU"],this.id=e,this.devicePixelRatio=n,this.container=jQuery("#"+this.id),this.WIDTH=this.container.width()*this.devicePixelRatio,this.HEIGHT=this.container.height()*this.devicePixelRatio,this.ASPECT=this.WIDTH/this.HEIGHT,this.NEAR=1,FAR=800,this.CAMERA_Z=-150,this.webglFailed=!0;try{if(t)throw new Error("WebGL disabled");this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.sortObjects=!1;var r=i>>16;r/=255;var o=i>>8&255;o/=255;var a=255&i;a/=255,this.renderer.setClearColor({r:r,g:o,b:a},1),this.eventTarget=this.renderer.domElement,this.container.append(this.renderer.domElement),this.renderer.setSize(this.WIDTH,this.HEIGHT),jQuery(this.renderer.domElement).css({width:this.container.width(),height:this.container.height()}),this.webglFailed=!1}catch(e){this.canvas2d=jQuery("<canvas></canvas"),this.container.append(this.canvas2d),this.eventTarget=this.canvas2d,this.canvas2d[0].height=this.HEIGHT,this.canvas2d[0].width=this.WIDTH,jQuery(this.canvas2d).css({width:this.container.width(),height:this.container.height()})}this.camera=new THREE.PerspectiveCamera(20,this.ASPECT,1,800),this.camera.position=new TV3(0,0,this.CAMERA_Z),this.camera.lookAt(new TV3(0,0,0)),this.perspectiveCamera=this.camera,this.orthoscopicCamera=new THREE.OrthographicCamera,this.orthoscopicCamera.position.z=this.CAMERA_Z,this.orthoscopicCamera.lookAt(new TV3(0,0,0)),this.scene=null,this.rotationGroup=null,this.modelGroup=null,this.framePending=!1,this.bgColor=i,this.bgAlpha=1,this.fov=20,this.fogStart=.4,this.slabNear=-50,this.slabFar=50,this.sphereRadius=1.5,this.cylinderRadius=.4,this.lineWidth=1.5*this.devicePixelRatio,this.curveWidth=3*this.devicePixelRatio,this.defaultColor=13421772,this.sphereQuality=16,this.cylinderQuality=16,this.axisDIV=5,this.strandDIV=6,this.nucleicAcidStrandDIV=4,this.tubeDIV=8,this.coilWidth=.3,this.helixSheetWidth=1.3,this.nucleicAcidWidth=.8,this.thickness=.2,this.cq=new THREE.Quaternion(1,0,0,0),this.dq=new THREE.Quaternion(1,0,0,0),this.isDragging=!1,this.mouseStartX=0,this.mouseStartY=0,this.zoom2D=30,this.canvasAtomRadius=.5,this.canvasBondWidth=.3,this.canvasVDW=!1,this.canvasLine=!1,this.canvasdrawStack=[],this.canvasDetail=24,this.multiTouch=!1,this.multiTouchD=0,this.currentModelPos=0,this.cz=0,this.protein={sheet:[],helix:[],biomtChains:"",biomtMatrices:[],symMat:[],pdbID:"",title:""},this.atoms=[],this.container.on("DOMMouseScroll mousewheel",this.onScroll.bind(this)),this.container.on("mousedown touchstart",this.onPointerDown.bind(this)),jQuery(window).on("mousemove touchmove",this.onPointerMove.bind(this)),jQuery(window).on("mouseup touchend touchcancel",this.onPointerUp.bind(this))},e.prototype.onScroll=function(e){var t;e.preventDefault(),this.scene&&(2e3<(t=.3*(this.rotationGroup.position.z-this.CAMERA_Z))&&(t=2e3),e.originalEvent.detail?(this.rotationGroup.position.z+=t*e.originalEvent.detail/10,this.zoom2D+=t*e.originalEvent.detail/10):e.originalEvent.wheelDelta&&(this.rotationGroup.position.z-=t*e.originalEvent.wheelDelta/400,this.zoom2D-=.5*t*e.originalEvent.wheelDelta/400),1e4<this.rotationGroup.position.z&&(this.rotationGroup.position.z=1e4),this.rotationGroup.position.z<-149&&(this.rotationGroup.position.z=-149),this.zoom2D<2&&(this.zoom2D=2),this.redraw())},e.prototype.onPointerDown=function(e){var t,n,i,r,o;this.scene&&(e.preventDefault(),e.stopImmediatePropagation(),t=e.pageX,n=e.pageY,e.originalEvent.targetTouches&&e.originalEvent.targetTouches[0]&&(t=e.originalEvent.targetTouches[0].pageX,n=e.originalEvent.targetTouches[0].pageY),e.originalEvent.targetTouches&&1<e.originalEvent.targetTouches.length&&(r=(i=e.originalEvent.targetTouches)[0].pageX-i[1].pageX,o=i[0].pageY-i[1].pageY,this.multiTouchD=Math.sqrt(r*r+o*o),this.multiTouch=!0),null!=t&&(this.isDragging=!0,this.mouseButton=e.which||1,this.mouseStartX=t,this.mouseStartY=n,this.cq=this.rotationGroup.quaternion,this.cz=this.rotationGroup.position.z,this.currentModelPos=this.modelGroup.position.clone(),this.cslabNear=this.slabNear,this.cslabFar=this.slabFar))},e.prototype.onPointerMove=function(e){if(this.scene&&this.isDragging){if(e.preventDefault(),e.stopImmediatePropagation(),0==e.which&&(void 0===e.originalEvent.targetTouches||0==e.originalEvent.targetTouches.length)||e.originalEvent.targetTouches&&0==e.originalEvent.targetTouches.length)return this.isDragging=!1,this.multiTouch=!1,void this.redraw();var t,n,i,r,o,a,s,l,c,u,h,f=e.pageX,d=e.pageY;e.originalEvent.targetTouches&&e.originalEvent.targetTouches[0]&&(f=e.originalEvent.targetTouches[0].pageX,d=e.originalEvent.targetTouches[0].pageY),this.multiTouch&&e.originalEvent.targetTouches&&1<e.originalEvent.targetTouches.length&&(r=(t=e.originalEvent.targetTouches)[0].pageX-t[1].pageX,o=t[0].pageY-t[1].pageY,i=(n=Math.sqrt(r*r+o*o))/this.multiTouchD,this.multiTouchD=n,s=.85*(this.rotationGroup.position.z-this.CAMERA_Z),this.rotationGroup.position.z+=s*(1-i),this.zoom2D*=i,1e4<this.rotationGroup.position.z&&(this.rotationGroup.position.z=1e4),this.rotationGroup.position.z<-149&&(this.rotationGroup.position.z=-149),this.zoom2D<2&&(this.zoom2D=2),this.redraw()),this.multiTouch||null==f||(r=(f-this.mouseStartX)/this.WIDTH,o=(d-this.mouseStartY)/this.HEIGHT,a=Math.sqrt(r*r+o*o),1==this.mouseButton&&e.ctrlKey&&e.shiftKey?(this.slabNear=this.cslabNear+100*r,this.slabFar=this.cslabFar+100*o):2==this.mouseButton?((s=.85*(this.rotationGroup.position.z-this.CAMERA_Z))<20&&(s=20),this.webglFailed&&(r*=-1,o*=-1),l=new TV3(-r*s,-o*s,0),c=this.rotationGroup.quaternion,u=new THREE.Quaternion(c.x,c.y,c.z,c.w).inverse().normalize().multiplyVector3(l),this.modelGroup.position.x=this.currentModelPos.x+u.x,this.modelGroup.position.y=this.currentModelPos.y+u.y,this.modelGroup.position.z=this.currentModelPos.z+u.z):1==this.mouseButton&&0!=a&&(h=Math.sin(a*Math.PI)/a,this.dq.x=Math.cos(a*Math.PI),this.dq.y=0,this.dq.z=h*r,this.dq.w=h*o,this.rotationGroup.quaternion=new THREE.Quaternion(1,0,0,0),this.rotationGroup.quaternion.multiplySelf(this.dq),this.rotationGroup.quaternion.multiplySelf(this.cq)),this.redraw())}},e.prototype.onPointerUp=function(e){this.isDragging=!1,e.originalEvent.targetTouches&&1<e.originalEvent.targetTouches.length||(this.multiTouch=!1),this.redraw()},e.prototype.resize=function(){this.WIDTH=this.container.width()*this.devicePixelRatio,this.HEIGHT=this.container.height()*this.devicePixelRatio,this.webglFailed?(this.canvas2d[0].height=this.HEIGHT,this.canvas2d[0].width=this.WIDTH,jQuery(this.canvas2d).css({width:this.container.width(),height:this.container.height()})):(this.ASPECT=this.WIDTH/this.HEIGHT,this.renderer.setSize(this.WIDTH,this.HEIGHT),jQuery(this.renderer.domElement).css({width:this.container.width(),height:this.container.height()}),this.camera.aspect=this.ASPECT,this.camera.updateProjectionMatrix()),this.redraw()},e.prototype.isConnected=function(e,t){var n=e.bonds.indexOf(t.serial);if(-1!=n)return e.bondOrder[n];if(this.protein.smallMolecule&&(e.hetflag||t.hetflag))return 0;var i=(e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)+(e.z-t.z)*(e.z-t.z);return isNaN(i)||i<.5||1.3<i&&("H"==e.elem||"H"==t.elem||"D"==e.elem||"D"==t.elem)||(!(i<3.42)||"S"!=e.elem&&"S"!=t.elem)&&2.78<i?0:1},e.prototype.loadSDF=function(e){this.loadMolecule(e,this.parseSDF)},e.prototype.loadXYZ=function(e){this.loadMolecule(e,this.parseXYZ)},e.prototype.loadPDB=function(e){this.loadMolecule(e,this.parsePDB)},e.prototype.loadMolecule=function(e,t){this.protein={sheet:[],helix:[],biomtChains:"",biomtMatrices:[],symMat:[],pdbID:"",title:""},this.atoms=[],t.call(this,e),this.rebuildScene(),this.zoomInto(this.getAllAtoms()),this.redraw()},e.prototype.parseSDF=function(e){var t=this.atoms,n=this.protein,i=e.split("\n");if(!(i.length<4)){var r=parseInt(i[3].substr(0,3));if(!(isNaN(r)||r<=0)){var o=parseInt(i[3].substr(3,3)),a=4;if(!(i.length<4+r+o)){for(var s=1;s<=r;s++){var l=i[a];a++;var c={};c.serial=s,c.x=parseFloat(l.substr(0,10)),c.y=parseFloat(l.substr(10,10)),c.z=parseFloat(l.substr(20,10)),c.hetflag=!0,c.atom=c.elem=l.substr(31,3).replace(/ /g,""),c.bonds=[],c.bondOrder=[],t[s]=c}for(s=1;s<=o;s++){l=i[a];a++;var u=parseInt(l.substr(0,3)),h=parseInt(l.substr(3,3)),f=parseInt(l.substr(6,3));t[u].bonds.push(h),t[u].bondOrder.push(f),t[h].bonds.push(u),t[h].bondOrder.push(f)}return n.smallMolecule=!0}}}},e.prototype.parseXYZ=function(e){var t=this.atoms,n=this.protein,i=e.split("\n");if(!(i.length<3)){var r=parseInt(i[0].substr(0,3));if(!(isNaN(r)||r<=0||i.length<r+2)){for(var o=2,a=1;a<=r;a++){var s=i[o++].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),l={};l.serial=a,l.atom=l.elem=s[0],l.x=parseFloat(s[1]),l.y=parseFloat(s[2]),l.z=parseFloat(s[3]),l.hetflag=!0,l.bonds=[],l.bondOrder=[],t[a]=l}for(a=1;a<r;a++)for(var c=a+1;c<=r;c++)this.isConnected(t[a],t[c])&&(t[a].bonds.push(c),t[a].bondOrder.push(1),t[c].bonds.push(a),t[c].bondOrder.push(1));return n.smallMolecule=!0}}},e.prototype.parsePDB=function(e){var t=this.atoms,n=this.protein;lines=e.split("\n");for(var i=0;i<lines.length;i++){line=lines[i].replace(/^\s*/,"");var r,o,a,s=line.substr(0,6);if("ATOM  "==s||"HETATM"==s){var l,c,u,h,f,d,p,m,g,v,_,y=line.substr(16,1);if(" "!=y&&"A"!=y)continue;v=parseInt(line.substr(6,5)),l=line.substr(12,4).replace(/ /g,""),c=line.substr(17,3),u=line.substr(21,1),h=parseInt(line.substr(22,5)),f=parseFloat(line.substr(30,8)),d=parseFloat(line.substr(38,8)),p=parseFloat(line.substr(46,8)),_=parseFloat(line.substr(60,8)),""==(g=line.substr(76,2).replace(/ /g,""))&&(g=line.substr(12,4).replace(/ /g,"")),m="H"==line[0],t[v]={resn:c,x:f,y:d,z:p,elem:g,hetflag:m,chain:u,resi:h,serial:v,atom:l,ss:"c",color:16777215,bonds:[],bondOrder:[],b:_}}else if("SHEET "==s){var b=line.substr(21,1),x=parseInt(line.substr(22,4)),E=line.substr(32,1),T=parseInt(line.substr(33,4));n.sheet.push([b,x,E,T])}else if("CONECT"==s)for(var w=parseInt(line.substr(6,5)),C=0;C<4;C++){var S=parseInt(line.substr([11,16,21,26][C],5));isNaN(S)||null!=t[w]&&(t[w].bonds.push(S),t[w].bondOrder.push(1))}else{"HELIX "==s?(b=line.substr(19,1),x=parseInt(line.substr(21,4)),E=line.substr(31,1),T=parseInt(line.substr(33,4)),n.helix.push([b,x,E,T])):"CRYST1"==s?(n.a=parseFloat(line.substr(6,9)),n.b=parseFloat(line.substr(15,9)),n.c=parseFloat(line.substr(24,9)),n.alpha=parseFloat(line.substr(33,7)),n.beta=parseFloat(line.substr(40,7)),n.gamma=parseFloat(line.substr(47,7)),n.spacegroup=line.substr(55,11),this.defineCell()):"REMARK"==s?290==(r=parseInt(line.substr(7,3)))&&"SMTRY"==line.substr(13,5)?(o=parseInt(line[18])-1,a=parseInt(line.substr(21,2)),null==n.symMat[a]&&(n.symMat[a]=(new THREE.Matrix4).identity()),n.symMat[a].elements[o]=parseFloat(line.substr(24,9)),n.symMat[a].elements[o+4]=parseFloat(line.substr(34,9)),n.symMat[a].elements[o+8]=parseFloat(line.substr(44,9)),n.symMat[a].elements[o+12]=parseFloat(line.substr(54,10))):350==r&&"BIOMT"==line.substr(13,5)?(o=parseInt(line[18])-1,a=parseInt(line.substr(21,2)),null==n.biomtMatrices[a]&&(n.biomtMatrices[a]=(new THREE.Matrix4).identity()),n.biomtMatrices[a].elements[o]=parseFloat(line.substr(24,9)),n.biomtMatrices[a].elements[o+4]=parseFloat(line.substr(34,9)),n.biomtMatrices[a].elements[o+8]=parseFloat(line.substr(44,9)),n.biomtMatrices[a].elements[o+12]=parseFloat(line.substr(54,10))):350==r&&"BIOMOLECULE"==line.substr(11,11)?(n.biomtMatrices=[],n.biomtChains=""):350==r&&"CHAINS"==line.substr(34,6)&&(n.biomtChains+=line.substr(41,40)):"HEADER"==s?n.pdbID=line.substr(62,4):"TITLE "==s&&(null==n.title&&(n.title=""),n.title+=line.substr(10,70)+"\n")}}for(i=0;i<t.length;i++)if(null!=(l=t[i])){for(C=0;C<n.sheet.length;C++)l.chain==n.sheet[C][0]&&(l.resi<n.sheet[C][1]||l.resi>n.sheet[C][3]||(l.ss="s",l.resi==n.sheet[C][1]&&(l.ssbegin=!0),l.resi==n.sheet[C][3]&&(l.ssend=!0)));for(C=0;C<n.helix.length;C++)l.chain==n.helix[C][0]&&(l.resi<n.helix[C][1]||l.resi>n.helix[C][3]||(l.ss="h",l.resi==n.helix[C][1]?l.ssbegin=!0:l.resi==n.helix[C][3]&&(l.ssend=!0)))}return!(n.smallMolecule=!1)},e.prototype.calculateBonds=function(){for(var e=this.getAllAtoms(),t=0;t<e.length;t++){var n=e[t],i=this.atoms[n];if(null!=i)for(var r=t+1;r<t+30&&r<e.length;r++){var o=e[r],a=this.atoms[o];null!=a&&this.isConnected(i,a)&&(-1==i.bonds.indexOf(o)&&(i.bonds.push(o),i.bondOrder.push(1)),-1==a.bonds.indexOf(n)&&(a.bonds.push(n),a.bondOrder.push(1)))}}},e.prototype.subdivide=function(e,t){var n=[],i=e;(i=new Array).push(e[0]);for(var r=1,o=e.length-1;r<o;r++){var a=e[r],s=e[r+1];a.smoothen?i.push(new TV3((a.x+s.x)/2,(a.y+s.y)/2,(a.z+s.z)/2)):i.push(a)}i.push(e[e.length-1]);for(var r=-1,l=i.length;r<=l-3;r++)for(var c=i[-1==r?0:r],a=i[r+1],s=i[r+2],u=i[r==l-3?l-1:r+3],h=(new TV3).sub(s,c).multiplyScalar(.5),f=(new TV3).sub(u,a).multiplyScalar(.5),d=0;d<t;d++){var p=1/t*d,m=a.x+p*h.x+p*p*(-3*a.x+3*s.x-2*h.x-f.x)+p*p*p*(2*a.x-2*s.x+h.x+f.x),g=a.y+p*h.y+p*p*(-3*a.y+3*s.y-2*h.y-f.y)+p*p*p*(2*a.y-2*s.y+h.y+f.y),v=a.z+p*h.z+p*p*(-3*a.z+3*s.z-2*h.z-f.z)+p*p*p*(2*a.z-2*s.z+h.z+f.z);n.push(new TV3(m,g,v))}return n.push(i[i.length-1]),n},e.prototype.drawAtomsAsSphere=function(e,t,n,i,r){for(var o=new THREE.SphereGeometry(1,this.sphereQuality,this.sphereQuality),a=0;a<t.length;a++){var s,l,c,u=this.atoms[t[a]];null!=u&&(s=new THREE.MeshLambertMaterial({color:u.color}),l=new THREE.Mesh(o,s),e.add(l),c=i||null==GLmolVDWRadii[u.elem]?n:GLmolVDWRadii[u.elem],!i&&r&&(c*=r),l.scale.x=l.scale.y=l.scale.z=c,l.position.x=u.x,l.position.y=u.y,l.position.z=u.z)}},e.prototype.drawAtomsAsIcosahedron=function(e,t,n,i){for(var r=this.IcosahedronGeometry(),o=0;o<t.length;o++){var a,s,l=this.atoms[t[o]];null!=l&&(a=new THREE.MeshLambertMaterial({color:l.color}),(s=new THREE.Mesh(r,a)).scale.x=s.scale.y=s.scale.z=i||null==GLmolVDWRadii[l.elem]?n:GLmolVDWRadii[l.elem],e.add(s),s.position.x=l.x,s.position.y=l.y,s.position.z=l.z)}},e.prototype.drawBondAsStickSub=function(e,t,n,i,r){var o,a;1<r&&(o=this.calcBondDelta(t,n,2.3*i));var s=new TV3(t.x,t.y,t.z),l=new TV3(n.x,n.y,n.z),c=s.clone().addSelf(l).multiplyScalar(.5);new TCo(t.color),new TCo(n.color);1!=r&&3!=r||(this.drawCylinder(e,s,c,i,t.color),this.drawCylinder(e,l,c,i,n.color)),1<r&&(a=c.clone().addSelf(o),this.drawCylinder(e,s.clone().addSelf(o),a,i,t.color),this.drawCylinder(e,l.clone().addSelf(o),a,i,n.color),a=c.clone().subSelf(o),this.drawCylinder(e,s.clone().subSelf(o),a,i,t.color),this.drawCylinder(e,l.clone().subSelf(o),a,i,n.color))},e.prototype.drawBondsAsStick=function(e,t,n,i,r,o){r&&(n/=2.5);for(var a=0;a<t.length;a++){var s=t[a],l=this.atoms[s];if(null!=l)for(var c=0;c<l.bonds.length;c++){var u,h=l.bonds[c];-1!=t.indexOf(h)&&(null!=(u=this.atoms[h])&&(h<s&&-1!=u.bonds.indexOf(s)||this.drawBondAsStickSub(e,l,u,n,r?l.bondOrder[c]:1)))}}this.drawAtomsAsSphere(e,t,i,!o,o)},e.prototype.defineCell=function(){var e=this.protein;null!=e.a&&(e.ax=e.a,e.ay=0,e.az=0,e.bx=e.b*Math.cos(Math.PI/180*e.gamma),e.by=e.b*Math.sin(Math.PI/180*e.gamma),e.bz=0,e.cx=e.c*Math.cos(Math.PI/180*e.beta),e.cy=e.c*Math.cos(Math.PI/180*e.alpha-Math.cos(Math.PI/180*e.gamma)*Math.cos(Math.PI/180*e.beta))/Math.sin(Math.PI/180*e.gamma),e.cz=Math.sqrt(e.c*e.c*Math.sin(Math.PI/180*e.beta)*Math.sin(Math.PI/180*e.beta)-e.cy*e.cy))},e.prototype.drawUnitcell=function(e){var t=this.protein;if(null!=t.a){for(var n=[[0,0,0],[t.ax,t.ay,t.az],[t.bx,t.by,t.bz],[t.ax+t.bx,t.ay+t.by,t.az+t.bz],[t.cx,t.cy,t.cz],[t.cx+t.ax,t.cy+t.ay,t.cz+t.az],[t.cx+t.bx,t.cy+t.by,t.cz+t.bz],[t.cx+t.ax+t.bx,t.cy+t.ay+t.by,t.cz+t.az+t.bz]],i=[0,1,0,2,1,3,2,3,4,5,4,6,5,7,6,7,0,4,1,5,2,6,3,7],r=new THREE.Geometry,o=0;o<i.length;o++)r.vertices.push(new TV3(n[i[o]][0],n[i[o]][1],n[i[o]][2]));var a=new THREE.LineBasicMaterial({linewidth:1,color:13421772}),s=new THREE.Line(r,a);s.type=THREE.LinePieces,e.add(s)}},e.prototype.calcBondDelta=function(e,t,n){for(var i=new TV3(e.x-t.x,e.y-t.y,e.z-t.z).normalize(),r=null,o=0;o<e.bonds.length&&!r;o++){(a=this.atoms[e.bonds[o]])&&a.serial!=t.serial&&"H"!=a.elem&&(r=a)}for(var a,s,l,o=0;o<t.bonds.length&&!r;o++){(a=this.atoms[t.bonds[o]])&&a.serial!=e.serial&&"H"!=a.elem&&(r=a)}return r&&(l=(s=new TV3(e.x-r.x,e.y-r.y,e.z-r.z).normalize()).dot(i),delta=new TV3(s.x-i.x*l,s.y-i.y*l,s.z-i.z*l)),(!r||Math.abs(l-1)<.001||Math.abs(l+1)<.001)&&(delta=Math.abs(i.x)<.01&&Math.abs(i.y)<.01?new TV3(0,-i.z,i.y):new TV3(-i.y,i.x,0)),delta.normalize().multiplyScalar(n),delta},e.prototype.drawBondsAsLineSub=function(e,t,n,i){var r,o,a=e.vertices,s=e.colors;1<i&&(r=this.calcBondDelta(t,n,.15));var l=new TV3(t.x,t.y,t.z),c=new TV3(n.x,n.y,n.z),u=l.clone().addSelf(c).multiplyScalar(.5),h=new TCo(t.color),f=new TCo(n.color);1!=i&&3!=i||(a.push(l),s.push(h),a.push(u),s.push(h),a.push(c),s.push(f),a.push(u),s.push(f)),1<i&&(a.push(l.clone().addSelf(r)),s.push(h),a.push(o=u.clone().addSelf(r)),s.push(h),a.push(c.clone().addSelf(r)),s.push(f),a.push(o),s.push(f),a.push(l.clone().subSelf(r)),s.push(h),a.push(o=u.clone().subSelf(r)),s.push(h),a.push(c.clone().subSelf(r)),s.push(f),a.push(o),s.push(f))},e.prototype.drawBondsAsLine=function(e,t,n){for(var i=new THREE.Geometry,r=0;r<t.length;r++){var o=t[r],a=this.atoms[o];if(null!=a)for(var s=0;s<a.bonds.length;s++){var l,c=a.bonds[s];-1!=t.indexOf(c)&&(null!=(l=this.atoms[c])&&(c<o&&-1!=l.bonds.indexOf(o)||this.drawBondsAsLineSub(i,a,l,a.bondOrder[s])))}}var u=new THREE.LineBasicMaterial({linewidth:n});u.vertexColors=!0;var h=new THREE.Line(i,u);h.type=THREE.LinePieces,e.add(h)},e.prototype.drawSmoothCurve=function(e,t,n,i,r){if(0!=t.length){r=null==r?5:r;for(var o=new THREE.Geometry,a=this.subdivide(t,r),s=0;s<a.length;s++)o.vertices.push(a[s]),o.colors.push(new TCo(i[0==s?0:Math.round((s-1)/r)]));var l=new THREE.LineBasicMaterial({linewidth:n});l.vertexColors=!0;var c=new THREE.Line(o,l);c.type=THREE.LineStrip,e.add(c)}},e.prototype.drawAsCross=function(e,t,n){for(var i=new THREE.Geometry,r=[[n,0,0],[-n,0,0],[0,n,0],[0,-n,0],[0,0,n],[0,0,-n]],o=0,a=t.length;o<a;o++){var s=this.atoms[t[o]];if(null!=s)for(var l=new TCo(s.color),c=0;c<6;c++)i.vertices.push(new TV3(s.x+r[c][0],s.y+r[c][1],s.z+r[c][2])),i.colors.push(l)}var u=new THREE.LineBasicMaterial({linewidth:this.lineWidth});u.vertexColors=!0;var h=new THREE.Line(i,u,THREE.LinePieces);e.add(h)},e.prototype.drawSmoothTube=function(e,t,n,i){if(!(t.length<2)){for(var r,o=this.tubeDIV,a=this.axisDIV,s=new THREE.Geometry,l=this.subdivide(t,a),c=new TV3,u=0,h=l.length;u<h;u++){var f,d,p,m,g,v,_=(u-1)/a;p=0==u?i[0]:_%1==0?i[_]:(d=_-(f=Math.floor(_)),i[f]*d+i[f+1]*(1-d)),u<h-1?(m=(new TV3).sub(l[u],l[u+1]),g=new TV3(0,-m.z,m.y).normalize().multiplyScalar(p),v=(new TV3).cross(m,g).normalize().multiplyScalar(p),c.dot(g)<0&&(g.negate(),v.negate()),c=g,r=v):(g=c,v=r);for(var y=0;y<o;y++){var b=2*Math.PI/o*y,x=Math.cos(b),E=Math.sin(b);s.vertices.push(new TV3(l[u].x+x*g.x+E*v.x,l[u].y+x*g.y+E*v.y,l[u].z+x*g.z+E*v.z))}}for(var T=0,u=0,h=l.length-1;u<h;u++){var x=new TCo(n[Math.round((u-1)/a)]),w=0,C=(new TV3).sub(s.vertices[T],s.vertices[T+o]).lengthSq(),S=(new TV3).sub(s.vertices[T],s.vertices[T+o+1]).lengthSq();S<C&&(C=S,w=1);for(y=0;y<o;y++)s.faces.push(new TF3(T+y,T+(y+w)%o+o,T+(y+1)%o)),s.faces.push(new TF3(T+(y+1)%o,T+(y+w)%o+o,T+(y+w+1)%o+o)),s.faces[s.faces.length-2].color=x,s.faces[s.faces.length-1].color=x;T+=o}s.computeFaceNormals(),s.computeVertexNormals(!1);var D=new THREE.MeshLambertMaterial;D.vertexColors=THREE.FaceColors;var R=new THREE.Mesh(s,D);R.doubleSided=!0,e.add(R)}},e.prototype.drawMainchainCurve=function(e,t,n,i,r){var o,a,s=[],l=[];for(var c in null==r&&(r=5),t){var u=this.atoms[t[c]];null!=u&&(u.atom!=i||u.hetflag||(o==u.chain&&a+1==u.resi||(this.drawSmoothCurve(e,s,n,l,r),s=[],l=[]),s.push(new TV3(u.x,u.y,u.z)),l.push(u.color),o=u.chain,a=u.resi))}this.drawSmoothCurve(e,s,n,l,r)},e.prototype.drawMainchainTube=function(e,t,n,i){var r,o,a=[],s=[],l=[];for(var c in t){var u=this.atoms[t[c]];null!=u&&(u.atom!=n||u.hetflag||(r==u.chain&&o+1==u.resi||(this.drawSmoothTube(e,a,s,l),a=[],s=[],l=[]),a.push(new TV3(u.x,u.y,u.z)),null==i?l.push(0<u.b?u.b/100:.3):l.push(i),s.push(u.color),r=u.chain,o=u.resi))}this.drawSmoothTube(e,a,s,l)},e.prototype.drawStrip=function(e,t,n,i,r,o){if(!(t.length<2)){if(r=r||this.axisDIV,t=this.subdivide(t,r),n=this.subdivide(n,r),!o)return this.drawThinStrip(e,t,n,i,r);for(var a,s,l,c,u,h,f=new THREE.Geometry,d=f.vertices,p=f.faces,m=0,g=t.length;m<g;m++){d.push(a=t[m]),d.push(a),d.push(s=n[m]),d.push(s),m<g-1&&(u=t[m+1].clone().subSelf(t[m]),h=n[m].clone().subSelf(t[m]).crossSelf(u).normalize().multiplyScalar(o)),d.push(l=t[m].clone().addSelf(h)),d.push(l),d.push(c=n[m].clone().addSelf(h)),d.push(c)}for(var v=[[0,2,-6,-8],[-4,-2,6,4],[7,3,-5,-1],[-3,-7,1,5]],m=1,g=t.length;m<g;m++)for(var _=8*m,y=new TCo(i[Math.round((m-1)/r)]),b=0;b<4;b++){var x=new THREE.Face4(_+v[b][0],_+v[b][1],_+v[b][2],_+v[b][3],void 0,y);p.push(x)}for(var E=d.length-8,m=0;m<4;m++)d.push(d[2*m]),d.push(d[E+2*m]);E+=8,p.push(new THREE.Face4(E,E+2,E+6,E+4,void 0,p[0].color)),p.push(new THREE.Face4(E+1,E+5,E+7,E+3,void 0,p[p.length-3].color)),f.computeFaceNormals(),f.computeVertexNormals();var T=new THREE.MeshLambertMaterial;T.vertexColors=THREE.FaceColors;var w=new THREE.Mesh(f,T);w.doubleSided=!0,e.add(w)}},e.prototype.drawThinStrip=function(e,t,n,i,r){for(var o=new THREE.Geometry,a=0,s=t.length;a<s;a++)o.vertices.push(t[a]),o.vertices.push(n[a]);for(a=1,s=t.length;a<s;a++){var l=new THREE.Face4(2*a,2*a+1,2*a-1,2*a-2);l.color=new TCo(i[Math.round((a-1)/r)]),o.faces.push(l)}o.computeFaceNormals(),o.computeVertexNormals(!1);var c=new THREE.MeshLambertMaterial;c.vertexColors=THREE.FaceColors;var u=new THREE.Mesh(o,c);u.doubleSided=!0,e.add(u)},e.prototype.IcosahedronGeometry=function(){return this.icosahedron||(this.icosahedron=new THREE.IcosahedronGeometry(1)),this.icosahedron},e.prototype.drawCylinder=function(e,t,n,i,r,o){var a,s,l,c;t&&n&&(a=(new TV3).add(t,n).multiplyScalar(.5),r=new TCo(r),o&&!this.cylinderGeometryCap&&(this.cylinderGeometryCap=new THREE.CylinderGeometry(1,1,1,this.cylinderQuality,1,!1),this.cylinderGeometryCap.faceUvs=[],this.faceVertexUvs=[]),o||this.cylinderGeometry||(this.cylinderGeometry=new THREE.CylinderGeometry(1,1,1,this.cylinderQuality,1,!0),this.cylinderGeometry.faceUvs=[],this.faceVertexUvs=[]),s=new THREE.MeshLambertMaterial({color:r.getHex()}),(l=new THREE.Mesh(o?this.cylinderGeometryCap:this.cylinderGeometry,s)).position=a,l.lookAt(t),l.updateMatrix(),l.matrixAutoUpdate=!1,(c=(new THREE.Matrix4).makeScale(i,i,t.distanceTo(n))).rotateX(Math.PI/2),l.matrix.multiplySelf(c),e.add(l))},e.prototype.drawHelixAsCylinder=function(e,t,n){var i=null,r=[],o=[];for(var a in t){var s=this.atoms[t[a]];null==s||s.hetflag||(("h"!=s.ss&&"s"!=s.ss||s.ssend||s.ssbegin)&&r.push(s.serial),"s"==s.ss&&o.push(s.serial),"CA"==s.atom&&("h"==s.ss&&s.ssend&&(null!=i&&this.drawCylinder(e,new TV3(i.x,i.y,i.z),new TV3(s.x,s.y,s.z),n,s.color,!0),i=null),s.chain,s.resi,null==i&&"h"==s.ss&&s.ssbegin&&(i=s)))}null!=i&&this.drawCylinder(e,new TV3(i.x,i.y,i.z),new TV3(s.x,s.y,s.z),n,s.color,!0),this.drawMainchainTube(e,r,"CA",.3),this.drawStrand(e,o,2,void 0,!0,void 0,this.helixSheetWidth,!1,2*this.thickness)},e.prototype.drawCartoon=function(e,t,n,i){this.drawStrand(e,t,2,void 0,!0,void 0,void 0,n,i)},e.prototype.drawStrand=function(e,t,n,i,r,o,a,s,l){n=n||this.strandDIV,i=i||this.axisDIV,o=o||this.coilWidth,a=a||this.helixSheetWidth;for(var c=[],u=0;u<n;u++)c[u]=[];var h,f,d,p=[],m=null,g=null;for(var v in t){var _=this.atoms[t[v]];if(null!=_&&(("O"==_.atom||"CA"==_.atom)&&!_.hetflag))if("CA"==_.atom){if(h!=_.chain||f+1!=_.resi){for(var y=0;!l&&y<n;y++)this.drawSmoothCurve(e,c[y],1,p,i);r&&this.drawStrip(e,c[0],c[n-1],p,i,l);for(c=[],u=0;u<n;u++)c[u]=[];g=m=null,p=[]}d=new TV3(_.x,_.y,_.z),h=_.chain,f=_.resi,g=_.ss,_.ssstart||_.ssend,p.push(_.color)}else{var b=new TV3(_.x,_.y,_.z);b.subSelf(d),b.normalize(),b.multiplyScalar("c"==g?o:a),null!=m&&b.dot(m)<0&&b.negate(),m=b;for(y=0;y<n;y++){var x=2/(n-1)*y-1,E=new TV3(d.x+m.x*x,d.y+m.y*x,d.z+m.z*x);s||"s"!=g||(E.smoothen=!0),c[y].push(E)}}}for(y=0;!l&&y<n;y++)this.drawSmoothCurve(e,c[y],1,p,i);r&&this.drawStrip(e,c[0],c[n-1],p,i,l)},e.prototype.drawNucleicAcidLadderSub=function(e,t,n,i){if(null!=n[0]&&null!=n[1]&&null!=n[2]&&null!=n[3]&&null!=n[4]&&null!=n[5]){for(var r=e.vertices.length,o=0;o<=5;o++)e.vertices.push(n[o]);e.faces.push(new TF3(r,r+1,r+2)),e.faces.push(new TF3(r,r+2,r+3)),e.faces.push(new TF3(r,r+3,r+4)),e.faces.push(new TF3(r,r+4,r+5));for(var a=e.faces.length-4,s=e.faces.length;a<s;a++)e.faces[a].color=i}if(null!=n[4]&&null!=n[3]&&null!=n[6]&&null!=n[7]&&null!=n[8]){r=e.vertices.length;e.vertices.push(n[4]),e.vertices.push(n[3]),e.vertices.push(n[6]),e.vertices.push(n[7]),e.vertices.push(n[8]);for(o=0;o<=4;o++)e.colors.push(i);e.faces.push(new TF3(r,r+1,r+2)),e.faces.push(new TF3(r,r+2,r+3)),e.faces.push(new TF3(r,r+3,r+4));for(a=e.faces.length-3,s=e.faces.length;a<s;a++)e.faces[a].color=i}},e.prototype.drawNucleicAcidLadder=function(e,t){var n,i,r=new THREE.Geometry,o=new THREE.Geometry,a=["N1","C2","N3","C4","C5","C6","N9","C8","N7"],s=new Array(a.length),l=new TCo(13369344);for(var c in t){var u,h=this.atoms[t[c]];null==h||h.hetflag||(h.resi==i&&h.chain==n||(this.drawNucleicAcidLadderSub(r,o,s,l),s=new Array(a.length)),-1!=(u=a.indexOf(h.atom))&&(s[u]=new TV3(h.x,h.y,h.z)),"O3'"==h.atom&&(l=new TCo(h.color)),i=h.resi,n=h.chain)}this.drawNucleicAcidLadderSub(r,o,s,l),r.computeFaceNormals();var f=new THREE.MeshLambertMaterial;f.vertexColors=THREE.VertexColors;var d=new THREE.Mesh(r,f);d.doubleSided=!0,e.add(d)},e.prototype.drawNucleicAcidStick=function(e,t){for(var n,i,r=null,o=null,a=0;a<t.length;a++){var s=this.atoms[t[a]];null==s||s.hetflag||(s.resi==i&&s.chain==n||(null!=r&&null!=o&&this.drawCylinder(e,new TV3(r.x,r.y,r.z),new TV3(o.x,o.y,o.z),.3,r.color,!0),o=r=null),"O3'"==s.atom&&(r=s),"  A"==s.resn||"  G"==s.resn||" DA"==s.resn||" DG"==s.resn?"N1"==s.atom&&(o=s):"N3"==s.atom&&(o=s),i=s.resi,n=s.chain)}null!=r&&null!=o&&this.drawCylinder(e,new TV3(r.x,r.y,r.z),new TV3(o.x,o.y,o.z),.3,r.color,!0)},e.prototype.drawNucleicAcidLine=function(e,t){var n,i,r=null,o=null,a=new THREE.Geometry;for(var s in t){var l=this.atoms[t[s]];null==l||l.hetflag||(l.resi==i&&l.chain==n||(null!=r&&null!=o&&(a.vertices.push(new TV3(r.x,r.y,r.z)),a.colors.push(new TCo(r.color)),a.vertices.push(new TV3(o.x,o.y,o.z)),a.colors.push(new TCo(r.color))),o=r=null),"O3'"==l.atom&&(r=l),"  A"==l.resn||"  G"==l.resn||" DA"==l.resn||" DG"==l.resn?"N1"==l.atom&&(o=l):"N3"==l.atom&&(o=l),i=l.resi,n=l.chain)}null!=r&&null!=o&&(a.vertices.push(new TV3(r.x,r.y,r.z)),a.colors.push(new TCo(r.color)),a.vertices.push(new TV3(o.x,o.y,o.z)),a.colors.push(new TCo(r.color)));var c=new THREE.LineBasicMaterial({linewidth:1,linejoin:!1});c.linewidth=1.5,c.vertexColors=!0;var u=new THREE.Line(a,c,THREE.LinePieces);e.add(u)},e.prototype.drawCartoonNucleicAcid=function(e,t,n,i){this.drawStrandNucleicAcid(e,t,2,n,!0,void 0,i)},e.prototype.drawStrandNucleicAcid=function(e,t,n,i,r,o,a){o=o||this.nucleicAcidWidth,i=i||this.axisDIV,n=n||this.nucleicAcidStrandDIV;for(var s=[],l=0;l<n;l++)s[l]=[];var c,u,h,f=[],d=null;for(var p in t){var m=this.atoms[t[p]];if(null!=m&&(("O3'"==m.atom||"OP2"==m.atom)&&!m.hetflag))if("O3'"==m.atom){if(c!=m.chain||u+1!=m.resi){if(h)for(var g=0;g<n;g++){var v=2/(n-1)*g-1;s[g].push(new TV3(h.x+d.x*v,h.y+d.y*v,h.z+d.z*v))}r&&this.drawStrip(e,s[0],s[1],f,i,a);for(g=0;!a&&g<n;g++)this.drawSmoothCurve(e,s[g],1,f,i);for(s=[],l=0;l<n;l++)s[l]=[];f=[],d=null}h=new TV3(m.x,m.y,m.z),c=m.chain,u=m.resi,f.push(m.color)}else{if(!h){d=null;continue}var _=new TV3(m.x,m.y,m.z);_.subSelf(h),_.normalize().multiplyScalar(o),null!=d&&_.dot(d)<0&&_.negate(),d=_;for(g=0;g<n;g++){v=2/(n-1)*g-1;s[g].push(new TV3(h.x+d.x*v,h.y+d.y*v,h.z+d.z*v))}h=null}}if(h)for(g=0;g<n;g++){v=2/(n-1)*g-1;s[g].push(new TV3(h.x+d.x*v,h.y+d.y*v,h.z+d.z*v))}r&&this.drawStrip(e,s[0],s[1],f,i,a);for(g=0;!a&&g<n;g++)this.drawSmoothCurve(e,s[g],1,f,i)},e.prototype.drawDottedLines=function(e,t,n){for(var i=new THREE.Geometry,r=0,o=Math.floor(t.length/2);r<o;r++){var a=t[2*r],s=t[2*r+1],l=s.clone().subSelf(a),c=l.length();l.normalize().multiplyScalar(.3);for(var u=Math.floor(c/.3),h=0;h<u;h++){var f=new TV3(a.x+l.x*h,a.y+l.y*h,a.z+l.z*h);i.vertices.push(f)}u%2==1&&i.vertices.push(s)}var d=new THREE.LineBasicMaterial({color:n.getHex()});d.linewidth=2;var p=new THREE.Line(i,d,THREE.LinePieces);e.add(p)},e.prototype.getAllAtoms=function(){var e=[];for(var t in this.atoms)e.push(this.atoms[t].serial);return e},e.prototype.getHetatms=function(e){var t=[];for(var n in e){var i=this.atoms[e[n]];null!=i&&i.hetflag&&t.push(i.serial)}return t},e.prototype.removeSolvents=function(e){var t=[];for(var n in e){var i=this.atoms[e[n]];null!=i&&"HOH"!=i.resn&&t.push(i.serial)}return t},e.prototype.getProteins=function(e){var t=[];for(var n in e){var i=this.atoms[e[n]];null!=i&&(i.hetflag||t.push(i.serial))}return t},e.prototype.excludeAtoms=function(e,t){var n=[],i=new Object;for(var r in t)i[t[r]]=!0;for(var r in e){var o=e[r];i[o]||n.push(o)}return n},e.prototype.getSidechains=function(e){var t=[];for(var n in e){var i=this.atoms[e[n]];null!=i&&(i.hetflag||"C"==i.atom||"O"==i.atom||"N"==i.atom&&"PRO"!=i.resn||t.push(i.serial))}return t},e.prototype.getAtomsWithin=function(e,t){var n=[];for(var i in e){var r=this.atoms[e[i]];null!=r&&(r.x<t[0][0]||r.x>t[1][0]||r.y<t[0][1]||r.y>t[1][1]||r.z<t[0][2]||r.z>t[1][2]||n.push(r.serial))}return n},e.prototype.getExtent=function(e){var t=ymin=zmin=9999,n=ymax=zmax=-9999,i=ysum=zsum=cnt=0;for(var r in e){var o=this.atoms[e[r]];null!=o&&(cnt++,i+=o.x,ysum+=o.y,zsum+=o.z,t=t<o.x?t:o.x,ymin=ymin<o.y?ymin:o.y,zmin=zmin<o.z?zmin:o.z,n=n>o.x?n:o.x,ymax=ymax>o.y?ymax:o.y,zmax=zmax>o.z?zmax:o.z)}return[[t,ymin,zmin],[n,ymax,zmax],[i/cnt,ysum/cnt,zsum/cnt]]},e.prototype.getResiduesById=function(e,t){var n=[];for(var i in e){var r=this.atoms[e[i]];null!=r&&-1!=t.indexOf(r.resi)&&n.push(r.serial)}return n},e.prototype.getResidueBySS=function(e,t){var n=[];for(var i in e){var r=this.atoms[e[i]];null!=r&&-1!=t.indexOf(r.ss)&&n.push(r.serial)}return n},e.prototype.getChain=function(e,t){for(var n=[],i={},r=0,o=(t=t.toString()).length;r<o;r++)i[t.substr(r,1)]=!0;for(var r in e){var a=this.atoms[e[r]];null!=a&&i[a.chain]&&n.push(a.serial)}return n},e.prototype.getNonbonded=function(e,t){var n=[];for(var i in e){var r=this.atoms[e[i]];null!=r&&r.hetflag&&0==r.bonds.length&&n.push(r.serial)}return n},e.prototype.colorByAtom=function(e,t){for(var n in e){var i,r=this.atoms[e[n]];null!=r&&(null==(i=t[r.elem])&&(i=GLmolElementColors[r.elem]),null==i&&(i=this.defaultColor),r.color=i)}},e.prototype.colorByStructure=function(e,t,n,i,r){for(var o in e){var a=this.atoms[e[o]];null!=a&&(r||"CA"==a.atom&&!a.hetflag)&&("s"==a.ss[0]?a.color=n:"h"==a.ss[0]?a.color=t:"c"==a.ss[0]&&(a.color=i))}},e.prototype.colorByBFactor=function(e,t){var n=1e3,i=-1e3;for(var r in e){null!=(o=this.atoms[e[r]])&&(o.hetflag||!t&&"CA"!=o.atom&&"O3'"!=o.atom||(n>o.b&&(n=o.b),i<o.b&&(i=o.b)))}var o,a,s=(i+n)/2,l=(i-n)/2;if(!(l<.01&&-.01<l))for(var r in e){null!=(o=this.atoms[e[r]])&&(o.hetflag||!t&&"CA"!=o.atom&&"O3'"!=o.atom||(a=new TCo(0),o.b<s?a.setHSV(.667,(s-o.b)/l,1):a.setHSV(0,(o.b-s)/l,1),o.color=a.getHex()))}},e.prototype.colorByChain=function(e,t){for(var n in e){var i,r=this.atoms[e[n]];null!=r&&(r.hetflag||!t&&"CA"!=r.atom&&"O3'"!=r.atom||((i=new TCo(0)).setHSV(5*r.chain.charCodeAt(0)%17/17,1,.9),r.color=i.getHex()))}},e.prototype.colorByResidue=function(e,t){for(var n in e){var i=this.atoms[e[n]];null!=i&&(c=t[i.resn],null!=c&&(i.color=c))}},e.prototype.colorAtoms=function(e,t){for(var n in e){var i=this.atoms[e[n]];null!=i&&(i.color=t)}},e.prototype.colorByPolarity=function(e,t,n){var i={};for(var r in polarResidues)i[polarResidues[r]]=t;for(r in nonPolarResidues)i[nonPolarResidues[r]]=n;this.colorByResidue(e,i)},e.prototype.colorChainbow=function(e,t){var n,i,r=0;for(i in e)null!=(n=this.atoms[e[i]])&&(!t&&"CA"==n.atom&&"O3'"==n.atom||n.hetflag||r++);var o,a=r,r=0;for(i in e){null!=(n=this.atoms[e[i]])&&(!t&&"CA"==n.atom&&"O3'"==n.atom||n.hetflag||((o=new TCo(0)).setHSV(240/360*(1-r/a),1,.9),n.color=o.getHex(),r++))}},e.prototype.drawSymmetryMates2=function(e,t,n){if(null!=n){t.matrixAutoUpdate=!1;var i=1;this.protein.appliedMatrix=new THREE.Matrix4;for(var r=0;r<n.length;r++){var o=n[r];if(null!=o&&!o.isIdentity()){var a=THREE.SceneUtils.cloneObject(t);a.matrix=o,e.add(a);for(var s=0;s<16;s++)this.protein.appliedMatrix.elements[s]+=o.elements[s];i++}}this.protein.appliedMatrix.multiplyScalar(i)}},e.prototype.drawSymmetryMatesWithTranslation2=function(e,t,n){if(null!=n){var i=this.protein;t.matrixAutoUpdate=!1;for(var r=0;r<n.length;r++){var o=n[r];if(null!=o)for(var a=-1;a<=0;a++)for(var s=-1;s<=0;s++)for(var l=-1;l<=0;l++){var c,u=(new THREE.Matrix4).makeTranslation(i.ax*a+i.bx*s+i.cx*l,i.ay*a+i.by*s+i.cy*l,i.az*a+i.bz*s+i.cz*l),h=o.clone().multiplySelf(u);h.isIdentity()||((c=THREE.SceneUtils.cloneObject(t)).matrix=h,e.add(c))}}}},e.prototype.defineRepresentation=function(){var e=this.getAllAtoms(),t=this.removeSolvents(this.getHetatms(e));this.colorByAtom(e,{}),this.colorByChain(e),this.drawAtomsAsSphere(this.modelGroup,t,this.sphereRadius),this.drawMainchainCurve(this.modelGroup,e,this.curveWidth,"P"),this.drawCartoon(this.modelGroup,e,this.curveWidth)},e.prototype.getView=function(){if(!this.modelGroup)return[0,0,0,0,0,0,0,1];var e=this.modelGroup.position,t=this.rotationGroup.quaternion;return[e.x,e.y,e.z,this.rotationGroup.position.z,t.x,t.y,t.z,t.w]},e.prototype.setView=function(e){this.modelGroup&&this.rotationGroup&&(this.modelGroup.position.x=e[0],this.modelGroup.position.y=e[1],this.modelGroup.position.z=e[2],this.rotationGroup.position.z=e[3],this.rotationGroup.quaternion.x=e[4],this.rotationGroup.quaternion.y=e[5],this.rotationGroup.quaternion.z=e[6],this.rotationGroup.quaternion.w=e[7],this.redraw())},e.prototype.setBackground=function(e,t){var n,i,r;this.scene&&(n=e>>16,n/=255,i=e>>8&255,i/=255,r=255&e,r/=255,void 0===t&&(t=1),this.bgColor=e,this.bgAlpha=t,this.renderer&&this.renderer.setClearColor({r:n,g:i,b:r},t),this.scene.fog.color=new TCo(e))},e.prototype.setupLights=function(e){var t=new THREE.DirectionalLight(16777215);t.position=new TV3(.2,.2,-1).normalize(),t.intensity=1.2,e.add(t);var n=new THREE.AmbientLight(2105376);e.add(n)},e.prototype.initializeScene=function(){this.scene=new THREE.Scene,this.scene.fog=new THREE.Fog(this.bgColor,100,200),this.modelGroup=new THREE.Object3D,this.rotationGroup=new THREE.Object3D,this.rotationGroup.useQuaternion=!0,this.rotationGroup.quaternion=new THREE.Quaternion(1,0,0,0),this.rotationGroup.add(this.modelGroup),this.scene.add(this.rotationGroup),this.setupLights(this.scene)},e.prototype.zoomInto=function(e,t){var n=this.getExtent(e),i=new TV3(n[2][0],n[2][1],n[2][2]);this.protein.appliedMatrix&&(i=this.protein.appliedMatrix.multiplyVector3(i)),this.modelGroup.position=i.multiplyScalar(-1);var r=n[1][0]-n[0][0],o=n[1][1]-n[0][1],a=n[1][2]-n[0][2],s=Math.sqrt(r*r+o*o+a*a);s<25&&(s=25),t||(this.slabNear=-s,this.slabFar=+s),this.rotationGroup.position.z=.35*s/Math.tan(Math.PI/180*this.camera.fov/2)-150,this.rotationGroup.quaternion=new THREE.Quaternion(1,0,0,0),this.zoom2D=30/(s/25)},e.prototype.rebuildScene=function(){this.canvasdrawStack=[];var e=this.getView();this.initializeScene(),this.defineRepresentation(),this.setView(e)},e.prototype.setSlabAndFog=function(){var e=this.rotationGroup.position.z-this.camera.position.z;e<1&&(e=1),this.camera.near=e+this.slabNear,this.camera.near<1&&(this.camera.near=1),this.camera.far=e+this.slabFar,this.camera.near+1>this.camera.far&&(this.camera.far=this.camera.near+1),this.camera instanceof THREE.PerspectiveCamera?this.camera.fov=this.fov:(this.camera.right=e*Math.tan(Math.PI/180*this.fov),this.camera.left=-this.camera.right,this.camera.top=this.camera.right/this.ASPECT,this.camera.bottom=-this.camera.top),this.camera.updateProjectionMatrix(),this.scene.fog.near=this.camera.near+this.fogStart*(this.camera.far-this.camera.near),this.scene.fog.far=this.camera.far},e.prototype.draw=function(){this.scene&&(this.framePending=!1,this.setSlabAndFog(),this.webglFailed?this.render2d():this.renderer.render(this.scene,this.camera))},e.prototype.redraw=function(){this.framePending||(this.pendingFrame=!0,requestAnimationFrame(this.draw.bind(this)))},e.prototype.render2d=function(){var e=this.canvas2d[0].getContext("2d");this.scene.updateMatrixWorld(),e.clearRect(0,0,this.WIDTH,this.HEIGHT),e.fillStyle="rgba("+(this.bgColor>>16)+","+(this.bgColor>>8&255)+","+(255&this.bgColor)+","+this.bgAlpha+")",e.fillRect(0,0,this.WIDTH,this.HEIGHT),e.save(),e.translate(this.WIDTH/2,this.HEIGHT/2),e.scale(this.zoom2D||1,this.zoom2D||1);var t=new THREE.Matrix4;t.multiply(this.camera.matrixWorldInverse,this.modelGroup.matrixWorld);for(var n=2*Math.PI,i=this.atoms,r=0;r<this.atoms.length;r++){null!=(f=i[r])&&(null==f.screen&&(f.screen=new THREE.Vector3),f.screen.set(f.x,f.y,f.z),t.multiplyVector3(f.screen),this.webglFailed||(f.screen.y*=-1))}if(0==this.canvasdrawStack.length)for(r=0;r<i.length;r++){if(null!=(f=i[r])){if(0<(l={i:r,screen:f.screen,color:"rgb("+(f.color>>16)+","+(f.color>>8&255)+","+(255&f.color)+")",r:this.canvasVDW?GLmolVDWRadii[f.elem]:this.canvasAtomRadius,arc:[]}).r)for(var o=this.canvasDetail,a=0;a<o;a++)l.arc.push([l.r*Math.cos(n/o*a),l.r*Math.sin(n/o*a)]);l.bonds=[];for(var s=0;s<f.bonds.length;s++){null!=i[f.bonds[s]]&&l.bonds.push(f.bonds[s])}this.canvasdrawStack.push(l)}}this.canvasdrawStack.sort(function(e,t){return e.screen.z-t.screen.z});for(r=0;r<this.canvasdrawStack.length;r++)i[this.canvasdrawStack[r].i].zIndex=r;for(r=0;r<this.canvasdrawStack.length;r++){var l=this.canvasdrawStack[r];if(!this.isDragging&&0<l.r){e.save(),e.translate(l.screen.x,l.screen.y),e.fillStyle="#000000",e.lineWidth=.02,e.beginPath();for(var c=(l.r+.02)/l.r,a=0;a<l.arc.length;a++)0==a?e.moveTo(c*l.arc[a][0],c*l.arc[a][1]):e.lineTo(c*l.arc[a][0],c*l.arc[a][1]);if(e.closePath(),e.fill(),e.restore(),!this.canvasVDW)for(s=0;s<l.bonds.length;s++){((f=i[l.bonds[s]]).screen.z>l.screen.z||f.screen.z==l.screen.z&&f.zIndex>i[l.i].zIndex)&&(u=(l.screen.x+f.screen.x)/2,h=(l.screen.y+f.screen.y)/2,e.lineWidth=(this.isDragging||this.canvasLine?1/this.zoom2D:this.canvasBondWidth)+.04,e.strokeStyle="#000000",e.beginPath(),e.moveTo(l.screen.x,l.screen.y),e.lineTo(u,h),e.closePath(),e.stroke(),e.beginPath(),e.moveTo(f.screen.x,f.screen.y),e.lineTo(u,h),e.closePath(),e.stroke())}}if(!this.canvasVDW||this.isDragging)for(s=0;s<l.bonds.length;s++){var u,h,f=i[l.bonds[s]],d=this.canvasdrawStack[i[l.bonds[s]].zIndex].color;(f.screen.z>l.screen.z||f.screen.z==l.screen.z&&f.zIndex>i[l.i].zIndex)&&(u=(l.screen.x+f.screen.x)/2,h=(l.screen.y+f.screen.y)/2,e.lineWidth=this.isDragging||this.canvasLine?1/this.zoom2D:this.canvasBondWidth,e.strokeStyle=l.color,e.beginPath(),e.moveTo(l.screen.x,l.screen.y),e.lineTo(u,h),e.closePath(),e.stroke(),e.strokeStyle=d,e.beginPath(),e.moveTo(f.screen.x,f.screen.y),e.lineTo(u,h),e.closePath(),e.stroke())}if(!this.isDragging&&0<l.r){e.save(),e.translate(l.screen.x,l.screen.y),e.fillStyle=l.color,e.beginPath();for(a=0;a<l.arc.length;a++)0==a?e.moveTo(l.arc[a][0],l.arc[a][1]):e.lineTo(l.arc[a][0],l.arc[a][1]);e.closePath(),e.fill(),e.restore()}}e.restore()},e}(),ChemDoodle=function(){var e={iChemLabs:{},informatics:{},io:{},lib:{},structures:{}};return e.structures.d2={},e.structures.d3={},e.getVersion=function(){return"6.0.1"},e}();!function(f,e,L){function s(e){var t=e.length,n=oe.type(e);return!oe.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===n||"function"!==n&&(0===t||"number"==typeof t&&0<t&&t-1 in e)))}function i(e,t,n,i){if(oe.acceptData(e)){var r=oe.expando,o=e.nodeType,a=o?oe.cache:e,s=o?e[r]:e[r]&&r;if(s&&a[s]&&(i||a[s].data)||n!==L||"string"!=typeof t)return a[s=s||(o?e[r]=Z.pop()||oe.guid++:r)]||(a[s]=o?{}:{toJSON:oe.noop}),"object"!=typeof t&&"function"!=typeof t||(i?a[s]=oe.extend(a[s],t):a[s].data=oe.extend(a[s].data,t)),e=a[s],i||(e.data||(e.data={}),e=e.data),n!==L&&(e[oe.camelCase(t)]=n),"string"==typeof t?null==(n=e[t])&&(n=e[oe.camelCase(t)]):n=e,n}}function n(e,t,n){if(oe.acceptData(e)){var i,r,o=e.nodeType,a=o?oe.cache:e,s=o?e[oe.expando]:oe.expando;if(a[s]){if(t&&(i=n?a[s]:a[s].data)){for((r=(t=oe.isArray(t)?t.concat(oe.map(t,oe.camelCase)):t in i?[t]:(t=oe.camelCase(t))in i?[t]:t.split(" ")).length);r--;)delete i[t[r]];if(n?!c(i):!oe.isEmptyObject(i))return}if(!n&&(delete a[s].data,!c(a[s])))return;o?oe.cleanData([e],!0):oe.support.deleteExpando||a!=a.window?delete a[s]:a[s]=null}}}function l(e,t,n){if(n===L&&1===e.nodeType)if(n="data-"+t.replace($t,"-$1").toLowerCase(),"string"==typeof(n=e.getAttribute(n))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:Xt.test(n)?oe.parseJSON(n):n)}catch(e){}oe.data(e,t,n)}else n=L;return n}function c(e){for(var t in e)if(("data"!==t||!oe.isEmptyObject(e[t]))&&"toJSON"!==t)return;return 1}function r(){return!0}function u(){return!1}function t(){try{return q.activeElement}catch(e){}}function o(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function a(e,n,i){if(oe.isFunction(n))return oe.grep(e,function(e,t){return!!n.call(e,t,e)!==i});if(n.nodeType)return oe.grep(e,function(e){return e===n!==i});if("string"==typeof n){if(un.test(n))return oe.filter(n,e,i);n=oe.filter(n,e)}return oe.grep(e,function(e){return 0<=oe.inArray(e,n)!==i})}function p(e){var t=pn.split("|");if((e=e.createDocumentFragment()).createElement)for(;t.length;)e.createElement(t.pop());return e}function h(e,t){return oe.nodeName(e,"table")&&oe.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function d(e){return e.type=(null!==oe.find.attr(e,"type"))+"/"+e.type,e}function m(e){var t=Sn.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function g(e,t){for(var n,i=0;null!=(n=e[i]);i++)oe._data(n,"globalEval",!t||oe._data(t[i],"globalEval"))}function v(e,t){if(1===t.nodeType&&oe.hasData(e)){var n,i,r=oe._data(e),o=oe._data(t,r),a=r.events;if(a)for(n in delete o.handle,o.events={},a)for(r=0,i=a[n].length;r<i;r++)oe.event.add(t,n,a[n][r]);o.data&&(o.data=oe.extend({},o.data))}}function _(e,t){var n,i,r=0,o=typeof e.getElementsByTagName!==W?e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!==W?e.querySelectorAll(t||"*"):L;if(!o)for(o=[],n=e.childNodes||e;null!=(i=n[r]);r++)!t||oe.nodeName(i,t)?o.push(i):oe.merge(o,_(i,t));return t===L||t&&oe.nodeName(e,t)?oe.merge([e],o):o}function y(e){Tn.test(e.type)&&(e.defaultChecked=e.checked)}function b(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),i=t,r=Gn.length;r--;)if((t=Gn[r]+n)in e)return t;return i}function x(e,t){return e=t||e,"none"===oe.css(e,"display")||!oe.contains(e.ownerDocument,e)}function E(e,t){for(var n,i,r,o=[],a=0,s=e.length;a<s;a++)(i=e[a]).style&&(o[a]=oe._data(i,"olddisplay"),n=i.style.display,t?(o[a]||"none"!==n||(i.style.display=""),""===i.style.display&&x(i)&&(o[a]=oe._data(i,"olddisplay",S(i.nodeName)))):!o[a]&&(r=x(i),n&&"none"!==n||!r)&&oe._data(i,"olddisplay",r?n:oe.css(i,"display")));for(a=0;a<s;a++)!(i=e[a]).style||t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?o[a]||"":"none");return e}function T(e,t,n){return(e=On.exec(t))?Math.max(0,e[1]-(n||0))+(e[2]||"px"):t}function w(e,t,n,i,r){t=n===(i?"border":"content")?4:"width"===t?1:0;for(var o=0;t<4;t+=2)"margin"===n&&(o+=oe.css(e,n+Wn[t],!0,r)),i?("content"===n&&(o-=oe.css(e,"padding"+Wn[t],!0,r)),"margin"!==n&&(o-=oe.css(e,"border"+Wn[t]+"Width",!0,r))):(o+=oe.css(e,"padding"+Wn[t],!0,r),"padding"!==n&&(o+=oe.css(e,"border"+Wn[t]+"Width",!0,r)));return o}function C(e,t,n){var i=!0,r="width"===t?e.offsetWidth:e.offsetHeight,o=Ln(e),a=oe.support.boxSizing&&"border-box"===oe.css(e,"boxSizing",!1,o);if(r<=0||null==r){if(((r=Hn(e,t,o))<0||null==r)&&(r=e.style[t]),Bn.test(r))return r;i=a&&(oe.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+w(e,t,n||(a?"border":"content"),i,o)+"px"}function S(e){var t=q,n=jn[e];return n||("none"!==(n=D(e,t))&&n||((t=((Mn=(Mn||oe("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement))[0].contentWindow||Mn[0].contentDocument).document).write("<!doctype html><html><body>"),t.close(),n=D(e,t),Mn.detach()),jn[e]=n),n}function D(e,t){var n=oe(t.createElement(e)).appendTo(t.body),i=oe.css(n[0],"display");return n.remove(),i}function R(n,e,i,r){var t;if(oe.isArray(e))oe.each(e,function(e,t){i||Xn.test(n)?r(n,t):R(n+"["+("object"==typeof t?e:"")+"]",t,i,r)});else if(i||"object"!==oe.type(e))r(n,e);else for(t in e)R(n+"["+t+"]",e[t],i,r)}function A(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,i=0,r=e.toLowerCase().match(se)||[];if(oe.isFunction(t))for(;n=r[i++];)"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function H(t,r,o,a){function s(e){var i;return l[e]=!0,oe.each(t[e]||[],function(e,t){var n=t(r,o,a);return"string"!=typeof n||c||l[n]?c?!(i=n):void 0:(r.dataTypes.unshift(n),s(n),!1)}),i}var l={},c=t===ci;return s(r.dataTypes[0])||!l["*"]&&s("*")}function M(e,t){var n,i,r=oe.ajaxSettings.flatOptions||{};for(i in t)t[i]!==L&&((r[i]?e:n=n||{})[i]=t[i]);return n&&oe.extend(!0,e,n),e}function F(){try{return new f.XMLHttpRequest}catch(e){}}function P(){return setTimeout(function(){vi=L}),vi=oe.now()}function N(e,t,n){for(var i,r=(Ti[t]||[]).concat(Ti["*"]),o=0,a=r.length;o<a;o++)if(i=r[o].call(n,t,e))return i}function k(r,e,t){var n,o,i,a,s,l,c=0,u=Ei.length,h=oe.Deferred().always(function(){delete f.elem}),f=function(){if(o)return!1;for(var e=vi||P(),t=1-((e=Math.max(0,d.startTime+d.duration-e))/d.duration||0),n=0,i=d.tweens.length;n<i;n++)d.tweens[n].run(t);return h.notifyWith(r,[d,t,e]),t<1&&i?e:(h.resolveWith(r,[d]),!1)},d=h.promise({elem:r,props:oe.extend({},e),opts:oe.extend(!0,{specialEasing:{}},t),originalProperties:e,originalOptions:t,startTime:vi||P(),duration:t.duration,tweens:[],createTween:function(e,t){var n=oe.Tween(r,d.opts,e,t,d.opts.specialEasing[e]||d.opts.easing);return d.tweens.push(n),n},stop:function(e){var t=0,n=e?d.tweens.length:0;if(o)return this;for(o=!0;t<n;t++)d.tweens[t].run(1);return e?h.resolveWith(r,[d,e]):h.rejectWith(r,[d,e]),this}});for(n in e=d.props,t=d.opts.specialEasing,e)if(a=t[i=oe.camelCase(n)],s=e[n],oe.isArray(s)&&(a=s[1],s=e[n]=s[0]),n!==i&&(e[i]=s,delete e[n]),(l=oe.cssHooks[i])&&"expand"in l)for(n in s=l.expand(s),delete e[i],s)n in e||(e[n]=s[n],t[n]=a);else t[i]=a;for(;c<u;c++)if(n=Ei[c].call(d,r,e,d.opts))return n;return oe.map(e,N,d),oe.isFunction(d.opts.start)&&d.opts.start.call(r,d),oe.fx.timer(oe.extend(f,{elem:r,anim:d,queue:d.opts.queue})),d.progress(d.opts.progress).done(d.opts.done,d.opts.complete).fail(d.opts.fail).always(d.opts.always)}function I(e,t,n,i,r){return new I.prototype.init(e,t,n,i,r)}function O(e,t){var n,i={height:e},r=0;for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=Wn[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function B(e){return oe.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}function z(e,t){return t.toUpperCase()}function j(e){!q.addEventListener&&"load"!==e.type&&"complete"!==q.readyState||(ve(),oe.ready())}var U,V,W=typeof L,G=f.location,q=f.document,X=q.documentElement,$=f.jQuery,Y=f.$,J={},Z=[],Q=Z.concat,K=Z.push,ee=Z.slice,te=Z.indexOf,ne=J.toString,ie=J.hasOwnProperty,re="1.10.2".trim,oe=function(e,t){return new oe.fn.init(e,t,V)},ae=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,se=/\S+/g,le=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ce=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ue=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,he=/^[\],:{}\s]*$/,fe=/(?:^|:|,)(?:\s*\[)+/g,de=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,pe=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,me=/^-ms-/,ge=/-([\da-z])/gi,ve=function(){q.addEventListener?(q.removeEventListener("DOMContentLoaded",j,!1),f.removeEventListener("load",j,!1)):(q.detachEvent("onreadystatechange",j),f.detachEvent("onload",j))};oe.fn=oe.prototype={jquery:"1.10.2",constructor:oe,init:function(e,t,n){var i;if(!e)return this;if("string"!=typeof e)return e.nodeType?(this.context=this[0]=e,this.length=1,this):oe.isFunction(e)?n.ready(e):(e.selector!==L&&(this.selector=e.selector,this.context=e.context),oe.makeArray(e,this));if(!(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&3<=e.length?[null,e,null]:ce.exec(e))||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof oe?t[0]:t,oe.merge(this,oe.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:q,!0)),ue.test(i[1])&&oe.isPlainObject(t))for(i in t)oe.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i])}else{if((t=q.getElementById(i[2]))&&t.parentNode){if(t.id!==i[2])return n.find(e);this.length=1,this[0]=t}this.context=q,this.selector=e}return this},selector:"",length:0,toArray:function(){return ee.call(this)},get:function(e){return null==e?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e){return(e=oe.merge(this.constructor(),e)).prevObject=this,e.context=this.context,e},each:function(e,t){return oe.each(this,e,t)},ready:function(e){return oe.ready.promise().done(e),this},slice:function(){return this.pushStack(ee.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length;return e=+e+(e<0?t:0),this.pushStack(0<=e&&e<t?[this[e]]:[])},map:function(n){return this.pushStack(oe.map(this,function(e,t){return n.call(e,t,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:K,sort:[].sort,splice:[].splice},oe.fn.init.prototype=oe.fn,oe.extend=oe.fn.extend=function(){var e,t,n,i,r,o=arguments[0]||{},a=1,s=arguments.length,l=!1;for("boolean"==typeof o&&(l=o,o=arguments[1]||{},a=2),"object"==typeof o||oe.isFunction(o)||(o={}),s===a&&(o=this,--a);a<s;a++)if(null!=(r=arguments[a]))for(i in r)e=o[i],o!==(n=r[i])&&(l&&n&&(oe.isPlainObject(n)||(t=oe.isArray(n)))?(e=t?(t=!1,e&&oe.isArray(e)?e:[]):e&&oe.isPlainObject(e)?e:{},o[i]=oe.extend(l,e,n)):n!==L&&(o[i]=n));return o},oe.extend({expando:"jQuery"+("1.10.2"+Math.random()).replace(/\D/g,""),noConflict:function(e){return f.$===oe&&(f.$=Y),e&&f.jQuery===oe&&(f.jQuery=$),oe},isReady:!1,readyWait:1,holdReady:function(e){e?oe.readyWait++:oe.ready(!0)},ready:function(e){if(!(!0===e?--oe.readyWait:oe.isReady)){if(!q.body)return setTimeout(oe.ready);(oe.isReady=!0)!==e&&0<--oe.readyWait||(U.resolveWith(q,[oe]),oe.fn.trigger&&oe(q).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===oe.type(e)},isArray:Array.isArray||function(e){return"array"===oe.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?J[ne.call(e)]||"object":typeof e},isPlainObject:function(e){var t;if(!e||"object"!==oe.type(e)||e.nodeType||oe.isWindow(e))return!1;try{if(e.constructor&&!ie.call(e,"constructor")&&!ie.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(oe.support.ownLast)for(t in e)return ie.call(e,t);for(t in e);return t===L||ie.call(e,t)},isEmptyObject:function(e){for(var t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||q;var i=ue.exec(e);return n=!n&&[],i?[t.createElement(i[1])]:(i=oe.buildFragment([e],t,n),n&&oe(n).remove(),oe.merge([],i.childNodes))},parseJSON:function(e){return f.JSON&&f.JSON.parse?f.JSON.parse(e):null===e?e:"string"==typeof e&&(e=oe.trim(e))&&he.test(e.replace(de,"@").replace(pe,"]").replace(fe,""))?new Function("return "+e)():void oe.error("Invalid JSON: "+e)},parseXML:function(e){var t;if(!e||"string"!=typeof e)return null;try{f.DOMParser?t=(new DOMParser).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e))}catch(e){t=L}return t&&t.documentElement&&!t.getElementsByTagName("parsererror").length||oe.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(e){e&&oe.trim(e)&&(f.execScript||function(e){f.eval.call(f,e)})(e)},camelCase:function(e){return e.replace(me,"ms-").replace(ge,z)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var i=0,r=e.length,o=s(e);if(n){if(o)for(;i<r&&!1!==(o=t.apply(e[i],n));i++);else for(i in e)if(!1===(o=t.apply(e[i],n)))break}else if(o)for(;i<r&&!1!==(o=t.call(e[i],i,e[i]));i++);else for(i in e)if(!1===(o=t.call(e[i],i,e[i])))break;return e},trim:re&&!re.call("\ufeff ")?function(e){return null==e?"":re.call(e)}:function(e){return null==e?"":(e+"").replace(le,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(s(Object(e))?oe.merge(n,"string"==typeof e?[e]:e):K.call(n,e)),n},inArray:function(e,t,n){var i;if(t){if(te)return te.call(t,e,n);for(i=t.length,n=n?n<0?Math.max(0,i+n):n:0;n<i;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,t){var n=t.length,i=e.length,r=0;if("number"==typeof n)for(;r<n;r++)e[i++]=t[r];else for(;t[r]!==L;)e[i++]=t[r++];return e.length=i,e},grep:function(e,t,n){var i=[],r=0,o=e.length;for(n=!!n;r<o;r++)n!==!!t(e[r],r)&&i.push(e[r]);return i},map:function(e,t,n){var i,r=0,o=e.length,a=[];if(s(e))for(;r<o;r++)null!=(i=t(e[r],r,n))&&(a[a.length]=i);else for(r in e)null!=(i=t(e[r],r,n))&&(a[a.length]=i);return Q.apply([],a)},guid:1,proxy:function(e,t){var n,i;return"string"==typeof t&&(i=e[t],t=e,e=i),oe.isFunction(e)?(n=ee.call(arguments,2),(i=function(){return e.apply(t||this,n.concat(ee.call(arguments)))}).guid=e.guid=e.guid||oe.guid++,i):L},access:function(e,t,n,i,r,o,a){var s=0,l=e.length,c=null==n;if("object"===oe.type(n))for(s in r=!0,n)oe.access(e,t,s,n[s],!0,o,a);else if(i!==L&&(r=!0,oe.isFunction(i)||(a=!0),c&&(t=a?(t.call(e,i),null):(c=t,function(e,t,n){return c.call(oe(e),n)})),t))for(;s<l;s++)t(e[s],n,a?i:i.call(e[s],s,t(e[s],n)));return r?e:c?t.call(e):l?t(e[0],n):o},now:function(){return(new Date).getTime()},swap:function(e,t,n,i){var r,o={};for(r in t)o[r]=e.style[r],e.style[r]=t[r];for(r in n=n.apply(e,i||[]),t)e.style[r]=o[r];return n}}),oe.ready.promise=function(e){if(!U)if(U=oe.Deferred(),"complete"===q.readyState)setTimeout(oe.ready);else if(q.addEventListener)q.addEventListener("DOMContentLoaded",j,!1),f.addEventListener("load",j,!1);else{q.attachEvent("onreadystatechange",j),f.attachEvent("onload",j);var n=!1;try{n=null==f.frameElement&&q.documentElement}catch(e){}n&&n.doScroll&&function t(){if(!oe.isReady){try{n.doScroll("left")}catch(e){return setTimeout(t,50)}ve(),oe.ready()}}()}return U.promise(e)},oe.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){J["[object "+t+"]"]=t.toLowerCase()}),V=oe(q);function _e(e,t,n,i){var r,o,a,s,l,c;if((t?t.ownerDocument||t:et)!==je&&ze(t),n=n||[],!e||"string"!=typeof e)return n;if(1!==(s=(t=t||je).nodeType)&&9!==s)return[];if(Ve&&!i){if(r=Rt.exec(e))if(a=r[1]){if(9===s){if(!(o=t.getElementById(a))||!o.parentNode)return n;if(o.id===a)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&Xe(t,o)&&o.id===a)return n.push(o),n}else{if(r[2])return dt.apply(n,t.getElementsByTagName(e)),n;if((a=r[3])&&He.getElementsByClassName&&t.getElementsByClassName)return dt.apply(n,t.getElementsByClassName(a)),n}if(He.qsa&&(!We||!We.test(e))){if(o=r=Ke,a=t,l=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(s=Ye(e),(r=t.getAttribute("id"))?o=r.replace(Lt,"\\$&"):t.setAttribute("id",o),o="[id='"+o+"'] ",a=s.length;a--;)s[a]=o+Je(s[a]);a=Et.test(e)&&t.parentNode||t,l=s.join(",")}if(l)try{return dt.apply(n,a.querySelectorAll(l)),n}catch(e){}finally{r||t.removeAttribute("id")}}}e:{if(e=e.replace(yt,"$1"),o=Ye(e),!i&&1===o.length){if(2<(r=o[0]=o[0].slice(0)).length&&"ID"===(c=r[0]).type&&He.getById&&9===t.nodeType&&Ve&&Pe.relative[r[1].type]){if(!(t=(Pe.find.ID(c.matches[0].replace(Ht,Ft),t)||[])[0])){c=n;break e}e=e.slice(r.shift().value.length)}for(s=St.needsContext.test(e)?0:r.length;s--&&(c=r[s],!Pe.relative[a=c.type]);)if((a=Pe.find[a])&&(i=a(c.matches[0].replace(Ht,Ft),Et.test(r[0].type)&&t.parentNode||t))){if(r.splice(s,1),e=i.length&&Je(r))break;dt.apply(n,i),c=n;break e}}Ie(e,o)(i,t,!Ve,n,Et.test(e)),c=n}return c}function ye(){function n(e,t){return i.push(e+=" ")>Pe.cacheLength&&delete n[i.shift()],n[e]=t}var i=[];return n}function be(e){return e[Ke]=!0,e}function xe(e){var t=je.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t)}}function Ee(e,t){for(var n=e.split("|"),i=e.length;i--;)Pe.attrHandle[n[i]]=t}function Te(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||lt)-(~e.sourceIndex||lt);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function we(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function Ce(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}function Se(a){return be(function(o){return o=+o,be(function(e,t){for(var n,i=a([],e.length,o),r=i.length;r--;)e[n=i[r]]&&(e[n]=!(t[n]=e[n]))})})}function De(){}function Re(s,e,t){var l=e.dir,c=t&&"parentNode"===l,u=nt++;return e.first?function(e,t,n){for(;e=e[l];)if(1===e.nodeType||c)return s(e,t,n)}:function(e,t,n){var i,r,o,a=tt+" "+u;if(n){for(;e=e[l];)if((1===e.nodeType||c)&&s(e,t,n))return!0}else for(;e=e[l];)if(1===e.nodeType||c)if((r=(o=e[Ke]||(e[Ke]={}))[l])&&r[0]===a){if(!0===(i=r[1])||i===Fe)return!0===i}else if((r=o[l]=[a])[1]=s(e,t,n)||Fe,!0===r[1])return!0}}function Ae(r){return 1<r.length?function(e,t,n){for(var i=r.length;i--;)if(!r[i](e,t,n))return!1;return!0}:r[0]}function Me(e,t,n,i,r){for(var o,a=[],s=0,l=e.length,c=null!=t;s<l;s++)(o=e[s])&&(n&&!n(o,i,r)||(a.push(o),c&&t.push(s)));return a}var Le,He,Fe,Pe,Ne,ke,Ie,Oe,Be,ze,je,Ue,Ve,We,Ge,qe,Xe,$e=f,Ye=function(e,t){var n,i,r,o,a,s,l;if(a=rt[e+" "])return t?0:a.slice(0);for(a=e,s=[],l=Pe.preFilter;a;){for(o in n&&!(i=bt.exec(a))||(i&&(a=a.slice(i[0].length)||a),s.push(r=[])),n=!1,(i=xt.exec(a))&&(n=i.shift(),r.push({value:n,type:i[0].replace(yt," ")}),a=a.slice(n.length)),Pe.filter)!(i=St[o].exec(a))||l[o]&&!(i=l[o](i))||(n=i.shift(),r.push({value:n,type:o,matches:i}),a=a.slice(n.length));if(!n)break}return t?a.length:a?_e.error(e):rt(e,s).slice(0)},Je=function(e){for(var t=0,n=e.length,i="";t<n;t++)i+=e[t].value;return i},Ze=function(p,m,g,v,_,e){return v&&!v[Ke]&&(v=Ze(v)),_&&!_[Ke]&&(_=Ze(_,e)),be(function(e,t,n,i){var r,o,a,s=[],l=[],c=t.length;if(!(a=e)){a=m||"*";for(var u=n.nodeType?[n]:n,h=[],f=0,d=u.length;f<d;f++)_e(a,u[f],h);a=h}if(a=!p||!e&&m?a:Me(a,s,p,n,i),u=g?_||(e?p:c||v)?[]:t:a,g&&g(a,u,n,i),v)for(r=Me(u,l),v(r,[],n,i),n=r.length;n--;)(o=r[n])&&(u[l[n]]=!(a[l[n]]=o));if(e){if(_||p){if(_){for(r=[],n=u.length;n--;)(o=u[n])&&r.push(a[n]=o);_(null,u=[],r,i)}for(n=u.length;n--;)(o=u[n])&&-1<(r=_?mt.call(e,o):s[n])&&(e[r]=!(t[r]=o))}}else u=Me(u===t?u.splice(c,u.length):u),_?_(null,t,u,i):dt.apply(t,u)})},Qe=function(e){for(var i,t,n=e.length,r=Pe.relative[e[0].type],o=r||Pe.relative[" "],a=r?1:0,s=Re(function(e){return e===i},o,!0),l=Re(function(e){return-1<mt.call(i,e)},o,!0),c=[function(e,t,n){return!r&&(n||t!==Oe)||((i=t).nodeType?s:l)(e,t,n)}];a<n;a++)if(o=Pe.relative[e[a].type])c=[Re(Ae(c),o)];else{if((o=Pe.filter[e[a].type].apply(null,e[a].matches))[Ke]){for(t=++a;t<n&&!Pe.relative[e[t].type];t++);return Ze(1<a&&Ae(c),1<a&&Je(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(yt,"$1"),o,a<t&&Qe(e.slice(a,t)),t<n&&Qe(e=e.slice(t)),t<n&&Je(e))}c.push(o)}return Ae(c)},Ke="sizzle"+-new Date,et=$e.document,tt=0,nt=0,it=ye(),rt=ye(),ot=ye(),at=!1,st=function(e,t){return e===t&&(at=!0),0},lt=-2147483648,ct={}.hasOwnProperty,ut=[],ht=ut.pop,ft=ut.push,dt=ut.push,pt=ut.slice,mt=ut.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e)return t;return-1},gt="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w#"),vt="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)[\\x20\\t\\r\\n\\f]*(?:([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+gt+")|)|)[\\x20\\t\\r\\n\\f]*\\]",_t=":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+vt.replace(3,8)+")*)|.*)\\)|)",yt=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),bt=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,xt=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,Et=/[\x20\t\r\n\f]*[+~]/,Tt=RegExp("=[\\x20\\t\\r\\n\\f]*([^\\]'\"]*)[\\x20\\t\\r\\n\\f]*\\]","g"),wt=RegExp(_t),Ct=RegExp("^"+gt+"$"),St={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:RegExp("^("+"(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:RegExp("^"+vt),PSEUDO:RegExp("^"+_t),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},Dt=/^[^{]+\{\s*\[native \w/,Rt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,At=/^(?:input|select|textarea|button)$/i,Mt=/^h\d$/i,Lt=/'|\\/g,Ht=RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)","ig"),Ft=function(e,t,n){return(e="0x"+t-65536)!=e||n?t:e<0?String.fromCharCode(65536+e):String.fromCharCode(e>>10|55296,1023&e|56320)};try{dt.apply(ut=pt.call(et.childNodes),et.childNodes),ut[et.childNodes.length].nodeType}catch(e){dt={apply:ut.length?function(e,t){ft.apply(e,pt.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}for(Le in ke=_e.isXML=function(e){return!!(e=e&&(e.ownerDocument||e).documentElement)&&"HTML"!==e.nodeName},He=_e.support={},ze=_e.setDocument=function(e){var s=e?e.ownerDocument||e:et;return e=s.defaultView,s!==je&&9===s.nodeType&&s.documentElement?(Ue=(je=s).documentElement,Ve=!ke(s),e&&e.attachEvent&&e!==e.top&&e.attachEvent("onbeforeunload",function(){ze()}),He.attributes=xe(function(e){return e.className="i",!e.getAttribute("className")}),He.getElementsByTagName=xe(function(e){return e.appendChild(s.createComment("")),!e.getElementsByTagName("*").length}),He.getElementsByClassName=xe(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),He.getById=xe(function(e){return Ue.appendChild(e).id=Ke,!s.getElementsByName||!s.getElementsByName(Ke).length}),He.getById?(Pe.find.ID=function(e,t){if(void 0!==t.getElementById&&Ve){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},Pe.filter.ID=function(e){var t=e.replace(Ht,Ft);return function(e){return e.getAttribute("id")===t}}):(delete Pe.find.ID,Pe.filter.ID=function(e){var t=e.replace(Ht,Ft);return function(e){return(e=void 0!==e.getAttributeNode&&e.getAttributeNode("id"))&&e.value===t}}),Pe.find.TAG=He.getElementsByTagName?function(e,t){if(void 0!==t.getElementsByTagName)return t.getElementsByTagName(e)}:function(e,t){var n,i=[],r=0,o=t.getElementsByTagName(e);if("*"!==e)return o;for(;n=o[r++];)1===n.nodeType&&i.push(n);return i},Pe.find.CLASS=He.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&Ve)return t.getElementsByClassName(e)},Ge=[],We=[],(He.qsa=Dt.test(s.querySelectorAll))&&(xe(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||We.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)"),e.querySelectorAll(":checked").length||We.push(":checked")}),xe(function(e){var t=s.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&We.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),e.querySelectorAll(":enabled").length||We.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),We.push(",.*:")})),(He.matchesSelector=Dt.test(qe=Ue.webkitMatchesSelector||Ue.mozMatchesSelector||Ue.oMatchesSelector||Ue.msMatchesSelector))&&xe(function(e){He.disconnectedMatch=qe.call(e,"div"),qe.call(e,"[s!='']:x"),Ge.push("!=",_t)}),We=We.length&&RegExp(We.join("|")),Ge=Ge.length&&RegExp(Ge.join("|")),Xe=Dt.test(Ue.contains)||Ue.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},st=Ue.compareDocumentPosition?function(e,t){if(e===t)return at=!0,0;var n=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return n?1&n||!He.sortDetached&&t.compareDocumentPosition(e)===n?e===s||Xe(et,e)?-1:t===s||Xe(et,t)?1:Be?mt.call(Be,e)-mt.call(Be,t):0:4&n?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var n=0,i=e.parentNode,r=t.parentNode,o=[e],a=[t];if(e===t)return at=!0,0;if(!i||!r)return e===s?-1:t===s?1:i?-1:r?1:Be?mt.call(Be,e)-mt.call(Be,t):0;if(i===r)return Te(e,t);for(i=e;i=i.parentNode;)o.unshift(i);for(i=t;i=i.parentNode;)a.unshift(i);for(;o[n]===a[n];)n++;return n?Te(o[n],a[n]):o[n]===et?-1:a[n]===et?1:0},s):je},_e.matches=function(e,t){return _e(e,null,null,t)},_e.matchesSelector=function(e,t){if((e.ownerDocument||e)!==je&&ze(e),t=t.replace(Tt,"='$1']"),He.matchesSelector&&Ve&&(!Ge||!Ge.test(t))&&(!We||!We.test(t)))try{var n=qe.call(e,t);if(n||He.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return 0<_e(t,je,null,[e]).length},_e.contains=function(e,t){return(e.ownerDocument||e)!==je&&ze(e),Xe(e,t)},_e.attr=function(e,t){(e.ownerDocument||e)!==je&&ze(e);var n=Pe.attrHandle[t.toLowerCase()];return void 0===(n=n&&ct.call(Pe.attrHandle,t.toLowerCase())?n(e,t,!Ve):void 0)?He.attributes||!Ve?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null:n},_e.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},_e.uniqueSort=function(e){var t,n=[],i=0,r=0;if(at=!He.detectDuplicates,Be=!He.sortStable&&e.slice(0),e.sort(st),at){for(;t=e[r++];)t===e[r]&&(i=n.push(r));for(;i--;)e.splice(n[i],1)}return e},Ne=_e.getText=function(e){var t,n="",i=0;if(t=e.nodeType){if(1===t||9===t||11===t){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=Ne(e)}else if(3===t||4===t)return e.nodeValue}else for(;t=e[i];i++)n+=Ne(t);return n},(Pe=_e.selectors={cacheLength:50,createPseudo:be,match:St,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Ht,Ft),e[3]=(e[4]||e[5]||"").replace(Ht,Ft),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||_e.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&_e.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return St.CHILD.test(e[0])?null:(e[3]&&void 0!==e[4]?e[2]=e[4]:n&&wt.test(n)&&(t=Ye(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Ht,Ft).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=it[e+" "];return t||(t=RegExp("(^|[\\x20\\t\\r\\n\\f])"+e+"([\\x20\\t\\r\\n\\f]|$)"))&&it(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(t,n,i){return function(e){return null==(e=_e.attr(e,t))?"!="===n:!n||(e+="","="===n?e===i:"!="===n?e!==i:"^="===n?i&&0===e.indexOf(i):"*="===n?i&&-1<e.indexOf(i):"$="===n?i&&e.slice(-i.length)===i:"~="===n?-1<(" "+e+" ").indexOf(i):"|="===n&&(e===i||e.slice(0,i.length+1)===i+"-"))}},CHILD:function(u,e,t,h,f){var d="nth"!==u.slice(0,3),p="last"!==u.slice(-4),m="of-type"===e;return 1===h&&0===f?function(e){return!!e.parentNode}:function(e,t,n){var i,r,o,a,s;t=d!=p?"nextSibling":"previousSibling";var l=e.parentNode,c=m&&e.nodeName.toLowerCase();if(n=!n&&!m,l){if(d){for(;t;){for(r=e;r=r[t];)if(m?r.nodeName.toLowerCase()===c:1===r.nodeType)return!1;s=t="only"===u&&!s&&"nextSibling"}return!0}if(s=[p?l.firstChild:l.lastChild],p&&n){for(a=(i=(n=l[Ke]||(l[Ke]={}))[u]||[])[0]===tt&&i[1],o=i[0]===tt&&i[2],r=a&&l.childNodes[a];r=++a&&r&&r[t]||(o=a=0)||s.pop();)if(1===r.nodeType&&++o&&r===e){n[u]=[tt,a,o];break}}else if(n&&(i=(e[Ke]||(e[Ke]={}))[u])&&i[0]===tt)o=i[1];else for(;(r=++a&&r&&r[t]||(o=a=0)||s.pop())&&((m?r.nodeName.toLowerCase()!==c:1!==r.nodeType)||!++o||(n&&((r[Ke]||(r[Ke]={}))[u]=[tt,o]),r!==e)););return(o-=f)===h||0==o%h&&0<=o/h}}},PSEUDO:function(e,o){var t,a=Pe.pseudos[e]||Pe.setFilters[e.toLowerCase()]||_e.error("unsupported pseudo: "+e);return a[Ke]?a(o):1<a.length?(t=[e,e,"",o],Pe.setFilters.hasOwnProperty(e.toLowerCase())?be(function(e,t){for(var n,i=a(e,o),r=i.length;r--;)e[n=mt.call(e,i[r])]=!(t[n]=i[r])}):function(e){return a(e,0,t)}):a}},pseudos:{not:be(function(e){var i=[],r=[],o=Ie(e.replace(yt,"$1"));return o[Ke]?be(function(e,t,n,i){i=o(e,null,i,[]);for(var r=e.length;r--;)(n=i[r])&&(e[r]=!(t[r]=n))}):function(e,t,n){return i[0]=e,o(i,null,n,r),!r.pop()}}),has:be(function(t){return function(e){return 0<_e(t,e).length}}),contains:be(function(t){return function(e){return-1<(e.textContent||e.innerText||Ne(e)).indexOf(t)}}),lang:be(function(n){return Ct.test(n||"")||_e.error("unsupported lang: "+n),n=n.replace(Ht,Ft).toLowerCase(),function(e){var t;do{if(t=Ve?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=$e.location&&$e.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===Ue},focus:function(e){return e===je.activeElement&&(!je.hasFocus||je.hasFocus())&&!(!e.type&&!e.href&&!~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if("@"<e.nodeName||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!Pe.pseudos.empty(e)},header:function(e){return Mt.test(e.nodeName)},input:function(e){return At.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:Se(function(){return[0]}),last:Se(function(e,t){return[t-1]}),eq:Se(function(e,t,n){return[n<0?n+t:n]}),even:Se(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:Se(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:Se(function(e,t,n){for(t=n<0?n+t:n;0<=--t;)e.push(t);return e}),gt:Se(function(e,t,n){for(n=n<0?n+t:n;++n<t;)e.push(n);return e})}}).pseudos.nth=Pe.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Pe.pseudos[Le]=we(Le);for(Le in{submit:!0,reset:!0})Pe.pseudos[Le]=Ce(Le);De.prototype=Pe.filters=Pe.pseudos,Pe.setFilters=new De,Ie=_e.compile=function(e,t){var m=[],g=[],n=ot[e+" "];if(!n){for(i=(t=t||Ye(e)).length;i--;)(n=Qe(t[i]))[Ke]?m.push(n):g.push(n);var v=0,_=0<m.length,y=0<g.length,i=function(e,t,n,i,r){var o,a,s=[],l=0,c="0",u=e&&[],h=null!=r,f=Oe,d=e||y&&Pe.find.TAG("*",r&&t.parentNode||t),p=tt+=null==f?1:Math.random()||.1;for(h&&(Oe=t!==je&&t,Fe=v);null!=(r=d[c]);c++){if(y&&r){for(o=0;a=g[o++];)if(a(r,t,n)){i.push(r);break}h&&(tt=p,Fe=++v)}_&&((r=!a&&r)&&l--,e&&u.push(r))}if(l+=c,_&&c!==l){for(o=0;a=m[o++];)a(u,s,t,n);if(e){if(0<l)for(;c--;)u[c]||s[c]||(s[c]=ht.call(i));s=Me(s)}dt.apply(i,s),h&&!e&&0<s.length&&1<l+m.length&&_e.uniqueSort(i)}return h&&(tt=p,Oe=f),u};i=_?be(i):i,n=ot(e,i)}return n},He.sortStable=Ke.split("").sort(st).join("")===Ke,He.detectDuplicates=at,ze(),He.sortDetached=xe(function(e){return 1&e.compareDocumentPosition(je.createElement("div"))}),xe(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||Ee("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),He.attributes&&xe(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||Ee("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),xe(function(e){return null==e.getAttribute("disabled")})||Ee("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(e,t,n){var i;if(!n)return(i=e.getAttributeNode(t))&&i.specified?i.value:!0===e[t]?t.toLowerCase():null}),oe.find=_e,oe.expr=_e.selectors,oe.expr[":"]=oe.expr.pseudos,oe.unique=_e.uniqueSort,oe.text=_e.getText,oe.isXMLDoc=_e.isXML,oe.contains=_e.contains;var Pt={};oe.Callbacks=function(r){var e,n;"string"==typeof r?(e=Pt[r])||(n=Pt[e=r]={},oe.each(e.match(se)||[],function(e,t){n[t]=!0}),e=n):e=oe.extend({},r);var i,t,o,a,s,l,c=[],u=!(r=e).once&&[],h=function(e){for(t=r.memory&&e,o=!0,s=l||0,l=0,a=c.length,i=!0;c&&s<a;s++)if(!1===c[s].apply(e[0],e[1])&&r.stopOnFalse){t=!1;break}i=!1,c&&(u?u.length&&h(u.shift()):t?c=[]:f.disable())},f={add:function(){var e;return c&&(e=c.length,function i(e){oe.each(e,function(e,t){var n=oe.type(t);"function"===n?r.unique&&f.has(t)||c.push(t):t&&t.length&&"string"!==n&&i(t)})}(arguments),i?a=c.length:t&&(l=e,h(t))),this},remove:function(){return c&&oe.each(arguments,function(e,t){for(var n;-1<(n=oe.inArray(t,c,n));)c.splice(n,1),i&&(n<=a&&a--,n<=s&&s--)}),this},has:function(e){return e?-1<oe.inArray(e,c):!(!c||!c.length)},empty:function(){return c=[],a=0,this},disable:function(){return c=u=t=L,this},disabled:function(){return!c},lock:function(){return u=L,t||f.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!c||o&&!u||(t=[e,(t=t||[]).slice?t.slice():t],i?u.push(t):h(t)),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},oe.extend({Deferred:function(e){var a=[["resolve","done",oe.Callbacks("once memory"),"resolved"],["reject","fail",oe.Callbacks("once memory"),"rejected"],["notify","progress",oe.Callbacks("memory")]],r="pending",s={state:function(){return r},always:function(){return l.done(arguments).fail(arguments),this},then:function(){var o=arguments;return oe.Deferred(function(r){oe.each(a,function(e,t){var n=t[0],i=oe.isFunction(o[e])&&o[e];l[t[1]](function(){var e=i&&i.apply(this,arguments);e&&oe.isFunction(e.promise)?e.promise().done(r.resolve).fail(r.reject).progress(r.notify):r[n+"With"](this===s?r.promise():this,i?[e]:arguments)})}),o=null}).promise()},promise:function(e){return null!=e?oe.extend(e,s):s}},l={};return s.pipe=s.then,oe.each(a,function(e,t){var n=t[2],i=t[3];s[t[1]]=n.add,i&&n.add(function(){r=i},a[1^e][2].disable,a[2][2].lock),l[t[0]]=function(){return l[t[0]+"With"](this===l?s:this,arguments),this},l[t[0]+"With"]=n.fireWith}),s.promise(l),e&&e.call(l,l),l},when:function(e){function t(t,n,i){return function(e){n[t]=this,i[t]=1<arguments.length?ee.call(arguments):e,i===r?c.notifyWith(n,i):--l||c.resolveWith(n,i)}}var r,n,i,o=0,a=ee.call(arguments),s=a.length,l=1!==s||e&&oe.isFunction(e.promise)?s:0,c=1===l?e:oe.Deferred();if(1<s)for(r=Array(s),n=Array(s),i=Array(s);o<s;o++)a[o]&&oe.isFunction(a[o].promise)?a[o].promise().done(t(o,i,a)).fail(c.reject).progress(t(o,n,r)):--l;return l||c.resolveWith(i,a),c.promise()}});var Nt,kt,It,Ot,Bt,zt,jt,Ut,Vt,Wt=oe,Gt={},qt=q.createElement("div");if(qt.setAttribute("className","t"),qt.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",Nt=qt.getElementsByTagName("*")||[],(kt=qt.getElementsByTagName("a")[0])&&kt.style&&Nt.length){zt=(Ot=q.createElement("select")).appendChild(q.createElement("option")),It=qt.getElementsByTagName("input")[0],kt.style.cssText="top:1px;float:left;opacity:.5",Gt.getSetAttribute="t"!==qt.className,Gt.leadingWhitespace=3===qt.firstChild.nodeType,Gt.tbody=!qt.getElementsByTagName("tbody").length,Gt.htmlSerialize=!!qt.getElementsByTagName("link").length,Gt.style=/top/.test(kt.getAttribute("style")),Gt.hrefNormalized="/a"===kt.getAttribute("href"),Gt.opacity=/^0.5/.test(kt.style.opacity),Gt.cssFloat=!!kt.style.cssFloat,Gt.checkOn=!!It.value,Gt.optSelected=zt.selected,Gt.enctype=!!q.createElement("form").enctype,Gt.html5Clone="<:nav></:nav>"!==q.createElement("nav").cloneNode(!0).outerHTML,Gt.inlineBlockNeedsLayout=!1,Gt.shrinkWrapBlocks=!1,Gt.pixelPosition=!1,Gt.deleteExpando=!0,Gt.noCloneEvent=!0,Gt.reliableMarginRight=!0,Gt.boxSizingReliable=!0,It.checked=!0,Gt.noCloneChecked=It.cloneNode(!0).checked,Ot.disabled=!0,Gt.optDisabled=!zt.disabled;try{delete qt.test}catch(e){Gt.deleteExpando=!1}for(Vt in(It=q.createElement("input")).setAttribute("value",""),Gt.input=""===It.getAttribute("value"),It.value="t",It.setAttribute("type","radio"),Gt.radioValue="t"===It.value,It.setAttribute("checked","t"),It.setAttribute("name","t"),(Bt=q.createDocumentFragment()).appendChild(It),Gt.appendChecked=It.checked,Gt.checkClone=Bt.cloneNode(!0).cloneNode(!0).lastChild.checked,qt.attachEvent&&(qt.attachEvent("onclick",function(){Gt.noCloneEvent=!1}),qt.cloneNode(!0).click()),{submit:!0,change:!0,focusin:!0})qt.setAttribute(jt="on"+Vt,"t"),Gt[Vt+"Bubbles"]=jt in f||!1===qt.attributes[jt].expando;for(Vt in qt.style.backgroundClip="content-box",qt.cloneNode(!0).style.backgroundClip="",Gt.clearCloneStyle="content-box"===qt.style.backgroundClip,oe(Gt))break;Gt.ownLast="0"!==Vt,oe(function(){var e,t,n=q.getElementsByTagName("body")[0];n&&((e=q.createElement("div")).style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",n.appendChild(e).appendChild(qt),qt.innerHTML="<table><tr><td></td><td>t</td></tr></table>",(t=qt.getElementsByTagName("td"))[0].style.cssText="padding:0;margin:0;border:0;display:none",Ut=0===t[0].offsetHeight,t[0].style.display="",t[1].style.display="none",Gt.reliableHiddenOffsets=Ut&&0===t[0].offsetHeight,qt.innerHTML="",qt.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",oe.swap(n,null!=n.style.zoom?{zoom:1}:{},function(){Gt.boxSizing=4===qt.offsetWidth}),f.getComputedStyle&&(Gt.pixelPosition="1%"!==(f.getComputedStyle(qt,null)||{}).top,Gt.boxSizingReliable="4px"===(f.getComputedStyle(qt,null)||{width:"4px"}).width,(t=qt.appendChild(q.createElement("div"))).style.cssText=qt.style.cssText="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",t.style.marginRight=t.style.width="0",qt.style.width="1px",Gt.reliableMarginRight=!parseFloat((f.getComputedStyle(t,null)||{}).marginRight)),typeof qt.style.zoom!==W&&(qt.innerHTML="",qt.style.cssText="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;width:1px;padding:1px;display:inline;zoom:1",Gt.inlineBlockNeedsLayout=3===qt.offsetWidth,qt.style.display="block",qt.innerHTML="<div></div>",qt.firstChild.style.width="5px",Gt.shrinkWrapBlocks=3!==qt.offsetWidth,Gt.inlineBlockNeedsLayout&&(n.style.zoom=1)),n.removeChild(e),e=qt=t=null)}),Nt=Ot=Bt=zt=kt=It=null}Wt.support=Gt;var Xt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,$t=/([A-Z])/g;oe.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return!!(e=e.nodeType?oe.cache[e[oe.expando]]:e[oe.expando])&&!c(e)},data:function(e,t,n){return i(e,t,n)},removeData:function(e,t){return n(e,t)},_data:function(e,t,n){return i(e,t,n,!0)},_removeData:function(e,t){return n(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&oe.noData[e.nodeName.toLowerCase()];return!t||!0!==t&&e.getAttribute("classid")===t}}),oe.fn.extend({data:function(e,t){var n,i,r=null,o=0,a=this[0];if(e!==L)return"object"==typeof e?this.each(function(){oe.data(this,e)}):1<arguments.length?this.each(function(){oe.data(this,e,t)}):a?l(a,e,oe.data(a,e)):null;if(this.length&&(r=oe.data(a),1===a.nodeType&&!oe._data(a,"parsedAttrs"))){for(n=a.attributes;o<n.length;o++)0===(i=n[o].name).indexOf("data-")&&l(a,i=oe.camelCase(i.slice(5)),r[i]);oe._data(a,"parsedAttrs",!0)}return r},removeData:function(e){return this.each(function(){oe.removeData(this,e)})}}),oe.extend({queue:function(e,t,n){var i;if(e)return t=(t||"fx")+"queue",i=oe._data(e,t),n&&(!i||oe.isArray(n)?i=oe._data(e,t,oe.makeArray(n)):i.push(n)),i||[]},dequeue:function(e,t){t=t||"fx";var n=oe.queue(e,t),i=n.length,r=n.shift(),o=oe._queueHooks(e,t);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===t&&n.unshift("inprogress"),delete o.stop,r.call(e,function(){oe.dequeue(e,t)},o)),!i&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return oe._data(e,n)||oe._data(e,n,{empty:oe.Callbacks("once memory").add(function(){oe._removeData(e,t+"queue"),oe._removeData(e,n)})})}}),oe.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?oe.queue(this[0],t):n===L?this:this.each(function(){var e=oe.queue(this,t,n);oe._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&oe.dequeue(this,t)})},dequeue:function(e){return this.each(function(){oe.dequeue(this,e)})},delay:function(i,e){return i=oe.fx&&oe.fx.speeds[i]||i,this.queue(e||"fx",function(e,t){var n=setTimeout(e,i);t.stop=function(){clearTimeout(n)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){function n(){--r||o.resolveWith(a,[a])}var i,r=1,o=oe.Deferred(),a=this,s=this.length;for("string"!=typeof e&&(t=e,e=L),e=e||"fx";s--;)(i=oe._data(a[s],e+"queueHooks"))&&i.empty&&(r++,i.empty.add(n));return n(),o.promise(t)}});var Yt,Jt,Zt=/[\t\r\n\f]/g,Qt=/\r/g,Kt=/^(?:input|select|textarea|button|object)$/i,en=/^(?:a|area)$/i,tn=/^(?:checked|selected)$/i,nn=oe.support.getSetAttribute,rn=oe.support.input;oe.fn.extend({attr:function(e,t){return oe.access(this,oe.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){oe.removeAttr(this,e)})},prop:function(e,t){return oe.access(this,oe.prop,e,t,1<arguments.length)},removeProp:function(e){return e=oe.propFix[e]||e,this.each(function(){try{this[e]=L,delete this[e]}catch(e){}})},addClass:function(t){var e,n,i,r,o=0,a=this.length,s="string"==typeof t&&t;if(oe.isFunction(t))return this.each(function(e){oe(this).addClass(t.call(this,e,this.className))});if(s)for(s=(t||"").match(se)||[];o<a;o++)if(n=1===(e=this[o]).nodeType&&(e.className?(" "+e.className+" ").replace(Zt," "):" ")){for(r=0;i=s[r++];)n.indexOf(" "+i+" ")<0&&(n+=i+" ");e.className=oe.trim(n)}return this},removeClass:function(t){var e,n,i,r,o=0,a=this.length,s=0===arguments.length||"string"==typeof t&&t;if(oe.isFunction(t))return this.each(function(e){oe(this).removeClass(t.call(this,e,this.className))});if(s)for(s=(t||"").match(se)||[];o<a;o++)if(n=1===(e=this[o]).nodeType&&(e.className?(" "+e.className+" ").replace(Zt," "):"")){for(r=0;i=s[r++];)for(;0<=n.indexOf(" "+i+" ");)n=n.replace(" "+i+" "," ");e.className=t?oe.trim(n):""}return this},toggleClass:function(r,t){var o=typeof r;return"boolean"==typeof t&&"string"==o?t?this.addClass(r):this.removeClass(r):oe.isFunction(r)?this.each(function(e){oe(this).toggleClass(r.call(this,e,this.className,t),t)}):this.each(function(){if("string"==o)for(var e,t=0,n=oe(this),i=r.match(se)||[];e=i[t++];)n.hasClass(e)?n.removeClass(e):n.addClass(e);else o!==W&&"boolean"!=o||(this.className&&oe._data(this,"__className__",this.className),this.className=!this.className&&!1!==r&&oe._data(this,"__className__")||"")})},hasClass:function(e){e=" "+e+" ";for(var t=0,n=this.length;t<n;t++)if(1===this[t].nodeType&&0<=(" "+this[t].className+" ").replace(Zt," ").indexOf(e))return!0;return!1},val:function(t){var e,n,i,r=this[0];return arguments.length?(i=oe.isFunction(t),this.each(function(e){1!==this.nodeType||(null==(e=i?t.call(this,e,oe(this).val()):t)?e="":"number"==typeof e?e+="":oe.isArray(e)&&(e=oe.map(e,function(e){return null==e?"":e+""})),(n=oe.valHooks[this.type]||oe.valHooks[this.nodeName.toLowerCase()])&&"set"in n&&n.set(this,e,"value")!==L)||(this.value=e)})):r?(n=oe.valHooks[r.type]||oe.valHooks[r.nodeName.toLowerCase()])&&"get"in n&&(e=n.get(r,"value"))!==L?e:"string"==typeof(e=r.value)?e.replace(Qt,""):null==e?"":e:void 0}}),oe.extend({valHooks:{option:{get:function(e){var t=oe.find.attr(e,"value");return null!=t?t:e.text}},select:{get:function(e){for(var t,n=e.options,i=e.selectedIndex,r=(e="select-one"===e.type||i<0)?null:[],o=e?i+1:n.length,a=i<0?o:e?i:0;a<o;a++)if(((t=n[a]).selected||a===i)&&(oe.support.optDisabled?!t.disabled:null===t.getAttribute("disabled"))&&(!t.parentNode.disabled||!oe.nodeName(t.parentNode,"optgroup"))){if(t=oe(t).val(),e)return t;r.push(t)}return r},set:function(e,t){for(var n,i,r=e.options,o=oe.makeArray(t),a=r.length;a--;)((i=r[a]).selected=0<=oe.inArray(oe(i).val(),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}},attr:function(e,t,n){var i,r,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o){if(typeof e.getAttribute===W)return oe.prop(e,t,n);if(1===o&&oe.isXMLDoc(e)||(t=t.toLowerCase(),i=oe.attrHooks[t]||(oe.expr.match.bool.test(t)?Jt:Yt)),n===L)return!(i&&"get"in i&&null!==(r=i.get(e,t)))&&null==(r=oe.find.attr(e,t))?L:r;if(null!==n)return i&&"set"in i&&(r=i.set(e,n,t))!==L?r:(e.setAttribute(t,n+""),n);oe.removeAttr(e,t)}},removeAttr:function(e,t){var n,i,r=0,o=t&&t.match(se);if(o&&1===e.nodeType)for(;n=o[r++];)i=oe.propFix[n]||n,oe.expr.match.bool.test(n)?rn&&nn||!tn.test(n)?e[i]=!1:e[oe.camelCase("default-"+n)]=e[i]=!1:oe.attr(e,n,""),e.removeAttribute(nn?n:i)},attrHooks:{type:{set:function(e,t){if(!oe.support.radioValue&&"radio"===t&&oe.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{for:"htmlFor",class:"className"},prop:function(e,t,n){var i,r,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return(o=1!==o||!oe.isXMLDoc(e))&&(t=oe.propFix[t]||t,r=oe.propHooks[t]),n!==L?r&&"set"in r&&(i=r.set(e,n,t))!==L?i:e[t]=n:r&&"get"in r&&null!==(i=r.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=oe.find.attr(e,"tabindex");return t?parseInt(t,10):Kt.test(e.nodeName)||en.test(e.nodeName)&&e.href?0:-1}}}}),Jt={set:function(e,t,n){return!1===t?oe.removeAttr(e,n):rn&&nn||!tn.test(n)?e.setAttribute(!nn&&oe.propFix[n]||n,n):e[oe.camelCase("default-"+n)]=e[n]=!0,n}},oe.each(oe.expr.match.bool.source.match(/\w+/g),function(e,t){var r=oe.expr.attrHandle[t]||oe.find.attr;oe.expr.attrHandle[t]=rn&&nn||!tn.test(t)?function(e,t,n){var i=oe.expr.attrHandle[t];return e=n?L:(oe.expr.attrHandle[t]=L)!=r(e,t,n)?t.toLowerCase():null,oe.expr.attrHandle[t]=i,e}:function(e,t,n){return n?L:e[oe.camelCase("default-"+t)]?t.toLowerCase():null}}),rn&&nn||(oe.attrHooks.value={set:function(e,t,n){if(!oe.nodeName(e,"input"))return Yt&&Yt.set(e,t,n);e.defaultValue=t}}),nn||(Yt={set:function(e,t,n){var i=e.getAttributeNode(n);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(n)),i.value=t+="","value"===n||t===e.getAttribute(n)?t:L}},oe.expr.attrHandle.id=oe.expr.attrHandle.name=oe.expr.attrHandle.coords=function(e,t,n){var i;return n?L:(i=e.getAttributeNode(t))&&""!==i.value?i.value:null},oe.valHooks.button={get:function(e,t){var n=e.getAttributeNode(t);return n&&n.specified?n.value:L},set:Yt.set},oe.attrHooks.contenteditable={set:function(e,t,n){Yt.set(e,""!==t&&t,n)}},oe.each(["width","height"],function(e,n){oe.attrHooks[n]={set:function(e,t){if(""===t)return e.setAttribute(n,"auto"),t}}})),oe.support.hrefNormalized||oe.each(["href","src"],function(e,t){oe.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),oe.support.style||(oe.attrHooks.style={get:function(e){return e.style.cssText||L},set:function(e,t){return e.style.cssText=t+""}}),oe.support.optSelected||(oe.propHooks.selected={get:function(e){return(e=e.parentNode)&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}}),oe.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),function(){oe.propFix[this.toLowerCase()]=this}),oe.support.enctype||(oe.propFix.enctype="encoding"),oe.each(["radio","checkbox"],function(){oe.valHooks[this]={set:function(e,t){if(oe.isArray(t))return e.checked=0<=oe.inArray(oe(e).val(),t)}},oe.support.checkOn||(oe.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var on=/^(?:input|select|textarea)$/i,an=/^key/,sn=/^(?:mouse|contextmenu)|click/,ln=/^(?:focusinfocus|focusoutblur)$/,cn=/^([^.]*)(?:\.(.+)|)$/;oe.event={global:{},add:function(e,t,n,i,r){var o,a,s,l,c,u,h,f,d;if(s=oe._data(e)){for(n.handler&&(n=(l=n).handler,r=l.selector),n.guid||(n.guid=oe.guid++),(a=s.events)||(a=s.events={}),(c=s.handle)||((c=s.handle=function(e){return typeof oe===W||e&&oe.event.triggered===e.type?L:oe.event.dispatch.apply(c.elem,arguments)}).elem=e),s=(t=(t||"").match(se)||[""]).length;s--;)f=u=(o=cn.exec(t[s])||[])[1],d=(o[2]||"").split(".").sort(),f&&(o=oe.event.special[f]||{},f=(r?o.delegateType:o.bindType)||f,o=oe.event.special[f]||{},u=oe.extend({type:f,origType:u,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&oe.expr.match.needsContext.test(r),namespace:d.join(".")},l),(h=a[f])||((h=a[f]=[]).delegateCount=0,o.setup&&!1!==o.setup.call(e,i,d,c)||(e.addEventListener?e.addEventListener(f,c,!1):e.attachEvent&&e.attachEvent("on"+f,c))),o.add&&(o.add.call(e,u),u.handler.guid||(u.handler.guid=n.guid)),r?h.splice(h.delegateCount++,0,u):h.push(u),oe.event.global[f]=!0);e=null}},remove:function(e,t,n,i,r){var o,a,s,l,c,u,h,f,d,p,m,g=oe.hasData(e)&&oe._data(e);if(g&&(u=g.events)){for(c=(t=(t||"").match(se)||[""]).length;c--;)if(d=m=(s=cn.exec(t[c])||[])[1],p=(s[2]||"").split(".").sort(),d){for(h=oe.event.special[d]||{},f=u[d=(i?h.delegateType:h.bindType)||d]||[],s=s[2]&&RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=f.length;o--;)a=f[o],!r&&m!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||i&&i!==a.selector&&("**"!==i||!a.selector)||(f.splice(o,1),a.selector&&f.delegateCount--,h.remove&&h.remove.call(e,a));l&&!f.length&&(h.teardown&&!1!==h.teardown.call(e,p,g.handle)||oe.removeEvent(e,d,g.handle),delete u[d])}else for(d in u)oe.event.remove(e,d+t[c],n,i,!0);oe.isEmptyObject(u)&&(delete g.handle,oe._removeData(e,"events"))}},trigger:function(e,t,n,i){var r,o,a,s,l=[n||q],c=ie.call(e,"type")?e.type:e,u=ie.call(e,"namespace")?e.namespace.split("."):[],h=r=n=n||q;if(3!==n.nodeType&&8!==n.nodeType&&!ln.test(c+oe.event.triggered)&&(0<=c.indexOf(".")&&(c=(u=c.split(".")).shift(),u.sort()),o=c.indexOf(":")<0&&"on"+c,(e=e[oe.expando]?e:new oe.Event(c,"object"==typeof e&&e)).isTrigger=i?2:3,e.namespace=u.join("."),e.namespace_re=e.namespace?RegExp("(^|\\.)"+u.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=L,e.target||(e.target=n),t=null==t?[e]:oe.makeArray(t,[e]),u=oe.event.special[c]||{},i||!u.trigger||!1!==u.trigger.apply(n,t))){if(!i&&!u.noBubble&&!oe.isWindow(n)){for(a=u.delegateType||c,ln.test(a+c)||(h=h.parentNode);h;h=h.parentNode)l.push(h),r=h;r===(n.ownerDocument||q)&&l.push(r.defaultView||r.parentWindow||f)}for(s=0;(h=l[s++])&&!e.isPropagationStopped();)e.type=1<s?a:u.bindType||c,(r=(oe._data(h,"events")||{})[e.type]&&oe._data(h,"handle"))&&r.apply(h,t),(r=o&&h[o])&&oe.acceptData(h)&&r.apply&&!1===r.apply(h,t)&&e.preventDefault();if(e.type=c,!i&&!e.isDefaultPrevented()&&(!u._default||!1===u._default.apply(l.pop(),t))&&oe.acceptData(n)&&o&&n[c]&&!oe.isWindow(n)){(r=n[o])&&(n[o]=null),oe.event.triggered=c;try{n[c]()}catch(e){}oe.event.triggered=L,r&&(n[o]=r)}return e.result}},dispatch:function(e){e=oe.event.fix(e);var t,n,i,r=[],o=ee.call(arguments),a=(oe._data(this,"events")||{})[e.type]||[],s=oe.event.special[e.type]||{};if((o[0]=e).delegateTarget=this,!s.preDispatch||!1!==s.preDispatch.call(this,e)){for(r=oe.event.handlers.call(this,e,a),a=0;(n=r[a++])&&!e.isPropagationStopped();)for(e.currentTarget=n.elem,i=0;(t=n.handlers[i++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(t.namespace)||(e.handleObj=t,e.data=t.data,(t=((oe.event.special[t.origType]||{}).handle||t.handler).apply(n.elem,o))!==L&&!1===(e.result=t)&&(e.preventDefault(),e.stopPropagation()));return s.postDispatch&&s.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,i,r,o,a=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==e.type)){for(r=[],o=0;o<s;o++)r[n=(i=t[o]).selector+" "]===L&&(r[n]=i.needsContext?0<=oe(n,this).index(l):oe.find(n,this,null,[l]).length),r[n]&&r.push(i);r.length&&a.push({elem:l,handlers:r})}return s<t.length&&a.push({elem:this,handlers:t.slice(s)}),a},fix:function(e){if(e[oe.expando])return e;var t,n,i=e.type,r=e,o=this.fixHooks[i];for(o||(this.fixHooks[i]=o=sn.test(i)?this.mouseHooks:an.test(i)?this.keyHooks:{}),n=o.props?this.props.concat(o.props):this.props,e=new oe.Event(r),i=n.length;i--;)e[t=n[i]]=r[t];return e.target||(e.target=r.srcElement||q),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,o.filter?o.filter(e,r):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,r=t.button,o=t.fromElement;return null==e.pageX&&null!=t.clientX&&(i=(n=e.target.ownerDocument||q).documentElement,n=n.body,e.pageX=t.clientX+(i&&i.scrollLeft||n&&n.scrollLeft||0)-(i&&i.clientLeft||n&&n.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||n&&n.scrollTop||0)-(i&&i.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&o&&(e.relatedTarget=o===e.target?t.toElement:o),e.which||r===L||(e.which=1&r?1:2&r?3:4&r?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==t()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===t()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(oe.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(e){return oe.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==L&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,i){e=oe.extend(new oe.Event,n,{type:e,isSimulated:!0,originalEvent:{}}),i?oe.event.trigger(e,null,t):oe.event.dispatch.call(t,e),e.isDefaultPrevented()&&n.preventDefault()}},oe.removeEvent=q.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){t="on"+t,e.detachEvent&&(typeof e[t]===W&&(e[t]=null),e.detachEvent(t,n))},oe.Event=function(e,t){if(!(this instanceof oe.Event))return new oe.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||!1===e.returnValue||e.getPreventDefault&&e.getPreventDefault()?r:u):this.type=e,t&&oe.extend(this,t),this.timeStamp=e&&e.timeStamp||oe.now(),this[oe.expando]=!0},oe.Event.prototype={isDefaultPrevented:u,isPropagationStopped:u,isImmediatePropagationStopped:u,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=r,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=r,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=r,this.stopPropagation()}},oe.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,r){oe.event.special[e]={delegateType:r,bindType:r,handle:function(e){var t,n=e.relatedTarget,i=e.handleObj;return n&&(n===this||oe.contains(this,n))||(e.type=i.origType,t=i.handler.apply(this,arguments),e.type=r),t}}}),oe.support.submitBubbles||(oe.event.special.submit={setup:function(){if(oe.nodeName(this,"form"))return!1;oe.event.add(this,"click._submit keypress._submit",function(e){e=e.target,(e=oe.nodeName(e,"input")||oe.nodeName(e,"button")?e.form:L)&&!oe._data(e,"submitBubbles")&&(oe.event.add(e,"submit._submit",function(e){e._submit_bubble=!0}),oe._data(e,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&oe.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(oe.nodeName(this,"form"))return!1;oe.event.remove(this,"._submit")}}),oe.support.changeBubbles||(oe.event.special.change={setup:function(){if(on.test(this.nodeName))return"checkbox"!==this.type&&"radio"!==this.type||(oe.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),oe.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),oe.event.simulate("change",this,e,!0)})),!1;oe.event.add(this,"beforeactivate._change",function(e){e=e.target,on.test(e.nodeName)&&!oe._data(e,"changeBubbles")&&(oe.event.add(e,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||oe.event.simulate("change",this.parentNode,e,!0)}),oe._data(e,"changeBubbles",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments)},teardown:function(){return oe.event.remove(this,"._change"),!on.test(this.nodeName)}}),oe.support.focusinBubbles||oe.each({focus:"focusin",blur:"focusout"},function(e,t){function n(e){oe.event.simulate(t,e.target,oe.event.fix(e),!0)}var i=0;oe.event.special[t]={setup:function(){0==i++&&q.addEventListener(e,n,!0)},teardown:function(){0==--i&&q.removeEventListener(e,n,!0)}}}),oe.fn.extend({on:function(e,t,n,i,r){var o,a;if("object"==typeof e){for(o in"string"!=typeof t&&(n=n||t,t=L),e)this.on(o,t,n,e[o],r);return this}if(null==n&&null==i?(i=t,n=t=L):null==i&&("string"==typeof t?(i=n,n=L):(i=n,n=t,t=L)),!1===i)i=u;else if(!i)return this;return 1===r&&(a=i,(i=function(e){return oe().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=oe.guid++)),this.each(function(){oe.event.add(this,e,i,n,t)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,t,n){var i;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,oe(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"!=typeof e)return!1!==t&&"function"!=typeof t||(n=t,t=L),!1===n&&(n=u),this.each(function(){oe.event.remove(this,e,n,t)});for(i in e)this.off(i,t,e[i]);return this},trigger:function(e,t){return this.each(function(){oe.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return oe.event.trigger(e,t,n,!0)}});var un=/^.[^:#\[\.,]*$/,hn=/^(?:parents|prev(?:Until|All))/,fn=oe.expr.match.needsContext,dn={children:!0,contents:!0,next:!0,prev:!0};oe.fn.extend({find:function(e){var t,n=[],i=this,r=i.length;if("string"!=typeof e)return this.pushStack(oe(e).filter(function(){for(t=0;t<r;t++)if(oe.contains(i[t],this))return!0}));for(t=0;t<r;t++)oe.find(e,i[t],n);return(n=this.pushStack(1<r?oe.unique(n):n)).selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t,n=oe(e,this),i=n.length;return this.filter(function(){for(t=0;t<i;t++)if(oe.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(a(this,e||[],!0))},filter:function(e){return this.pushStack(a(this,e||[],!1))},is:function(e){return!!a(this,"string"==typeof e&&fn.test(e)?oe(e):e||[],!1).length},closest:function(e,t){for(var n,i=0,r=this.length,o=[],a=fn.test(e)||"string"!=typeof e?oe(e,t||this.context):0;i<r;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&oe.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?oe.unique(o):o)},index:function(e){return e?"string"==typeof e?oe.inArray(this[0],oe(e)):oe.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?oe(e,t):oe.makeArray(e&&e.nodeType?[e]:e),n=oe.merge(this.get(),n);return this.pushStack(oe.unique(n))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),oe.each({parent:function(e){return(e=e.parentNode)&&11!==e.nodeType?e:null},parents:function(e){return oe.dir(e,"parentNode")},parentsUntil:function(e,t,n){return oe.dir(e,"parentNode",n)},next:function(e){return o(e,"nextSibling")},prev:function(e){return o(e,"previousSibling")},nextAll:function(e){return oe.dir(e,"nextSibling")},prevAll:function(e){return oe.dir(e,"previousSibling")},nextUntil:function(e,t,n){return oe.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return oe.dir(e,"previousSibling",n)},siblings:function(e){return oe.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return oe.sibling(e.firstChild)},contents:function(e){return oe.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:oe.merge([],e.childNodes)}},function(i,r){oe.fn[i]=function(e,t){var n=oe.map(this,r,e);return"Until"!==i.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=oe.filter(t,n)),1<this.length&&(dn[i]||(n=oe.unique(n)),hn.test(i)&&(n=n.reverse())),this.pushStack(n)}}),oe.extend({filter:function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?oe.find.matchesSelector(i,e)?[i]:[]:oe.find.matches(e,oe.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,t,n){var i=[];for(e=e[t];e&&9!==e.nodeType&&(n===L||1!==e.nodeType||!oe(e).is(n));)1===e.nodeType&&i.push(e),e=e[t];return i},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var pn="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",mn=/ jQuery\d+="(?:null|\d+)"/g,gn=RegExp("<(?:"+pn+")[\\s/>]","i"),vn=/^\s+/,_n=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,yn=/<([\w:]+)/,bn=/<tbody/i,xn=/<|&#?\w+;/,En=/<(?:script|style|link)/i,Tn=/^(?:checkbox|radio)$/i,wn=/checked\s*(?:[^=]|=\s*.checked.)/i,Cn=/^$|\/(?:java|ecma)script/i,Sn=/^true\/(.*)/,Dn=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Rn={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:oe.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},An=p(q).appendChild(q.createElement("div"));Rn.optgroup=Rn.option,Rn.tbody=Rn.tfoot=Rn.colgroup=Rn.caption=Rn.thead,Rn.th=Rn.td,oe.fn.extend({text:function(e){return oe.access(this,function(e){return e===L?oe.text(this):this.empty().append((this[0]&&this[0].ownerDocument||q).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||h(this,e).appendChild(e)})},prepend:function(){return this.domManip(arguments,function(e){var t;1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(t=h(this,e)).insertBefore(e,t.firstChild)})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,i=e?oe.filter(e,this):this,r=0;null!=(n=i[r]);r++)t||1!==n.nodeType||oe.cleanData(_(n)),n.parentNode&&(t&&oe.contains(n.ownerDocument,n)&&g(_(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&oe.cleanData(_(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&oe.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return oe.clone(this,e,t)})},html:function(e){return oe.access(this,function(e){var t=this[0]||{},n=0,i=this.length;if(e===L)return 1===t.nodeType?t.innerHTML.replace(mn,""):L;if("string"==typeof e&&!En.test(e)&&(oe.support.htmlSerialize||!gn.test(e))&&(oe.support.leadingWhitespace||!vn.test(e))&&!Rn[(yn.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(_n,"<$1></$2>");try{for(;n<i;n++)1===(t=this[n]||{}).nodeType&&(oe.cleanData(_(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var i=oe.map(this,function(e){return[e.nextSibling,e.parentNode]}),r=0;return this.domManip(arguments,function(e){var t=i[r++],n=i[r++];n&&(t&&t.parentNode!==n&&(t=this.nextSibling),oe(this).remove(),n.insertBefore(e,t))},!0),r?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(n,i,r){n=Q.apply([],n);var e,t,o,a,s=0,l=this.length,c=this,u=l-1,h=n[0],f=oe.isFunction(h);if(f||!(l<=1||"string"!=typeof h||oe.support.checkClone)&&wn.test(h))return this.each(function(e){var t=c.eq(e);f&&(n[0]=h.call(this,e,t.html())),t.domManip(n,i,r)});if(l&&(e=(a=oe.buildFragment(n,this[0].ownerDocument,!1,!r&&this)).firstChild,1===a.childNodes.length&&(a=e),e)){for(t=(o=oe.map(_(a,"script"),d)).length;s<l;s++)e=a,s!==u&&(e=oe.clone(e,!0,!0),t&&oe.merge(o,_(e,"script"))),i.call(this[s],e,s);if(t)for(a=o[o.length-1].ownerDocument,oe.map(o,m),s=0;s<t;s++)e=o[s],Cn.test(e.type||"")&&!oe._data(e,"globalEval")&&oe.contains(a,e)&&(e.src?oe._evalUrl(e.src):oe.globalEval((e.text||e.textContent||e.innerHTML||"").replace(Dn,"")));a=e=null}return this}}),oe.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,o){oe.fn[e]=function(e){for(var t=0,n=[],i=oe(e),r=i.length-1;t<=r;t++)e=t===r?this:this.clone(!0),oe(i[t])[o](e),K.apply(n,e.get());return this.pushStack(n)}}),oe.extend({clone:function(e,t,n){var i,r,o,a,s,l=oe.contains(e.ownerDocument,e);if(oe.support.html5Clone||oe.isXMLDoc(e)||!gn.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(An.innerHTML=e.outerHTML,An.removeChild(o=An.firstChild)),!(oe.support.noCloneEvent&&oe.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||oe.isXMLDoc(e)))for(i=_(o),s=_(e),a=0;null!=(r=s[a]);++a)if(i[a]){var c=i[a],u=void 0,h=void 0,f=void 0;if(1===c.nodeType){if(u=c.nodeName.toLowerCase(),!oe.support.noCloneEvent&&c[oe.expando]){for(h in(f=oe._data(c)).events)oe.removeEvent(c,h,f.handle);c.removeAttribute(oe.expando)}"script"===u&&c.text!==r.text?(d(c).text=r.text,m(c)):"object"===u?(c.parentNode&&(c.outerHTML=r.outerHTML),oe.support.html5Clone&&r.innerHTML&&!oe.trim(c.innerHTML)&&(c.innerHTML=r.innerHTML)):"input"===u&&Tn.test(r.type)?(c.defaultChecked=c.checked=r.checked,c.value!==r.value&&(c.value=r.value)):"option"===u?c.defaultSelected=c.selected=r.defaultSelected:"input"!==u&&"textarea"!==u||(c.defaultValue=r.defaultValue)}}if(t)if(n)for(s=s||_(e),i=i||_(o),a=0;null!=(r=s[a]);a++)v(r,i[a]);else v(e,o);return 0<(i=_(o,"script")).length&&g(i,!l&&_(e,"script")),o},buildFragment:function(e,t,n,i){for(var r,o,a,s,l,c,u=e.length,h=p(t),f=[],d=0;d<u;d++)if((o=e[d])||0===o)if("object"===oe.type(o))oe.merge(f,o.nodeType?[o]:o);else if(xn.test(o)){for(a=a||h.appendChild(t.createElement("div")),s=(yn.exec(o)||["",""])[1].toLowerCase(),c=Rn[s]||Rn._default,a.innerHTML=c[1]+o.replace(_n,"<$1></$2>")+c[2],r=c[0];r--;)a=a.lastChild;if(!oe.support.leadingWhitespace&&vn.test(o)&&f.push(t.createTextNode(vn.exec(o)[0])),!oe.support.tbody)for(r=(o="table"!==s||bn.test(o)?"<table>"!==c[1]||bn.test(o)?0:a:a.firstChild)&&o.childNodes.length;r--;)oe.nodeName(l=o.childNodes[r],"tbody")&&!l.childNodes.length&&o.removeChild(l);for(oe.merge(f,a.childNodes),a.textContent="";a.firstChild;)a.removeChild(a.firstChild);a=h.lastChild}else f.push(t.createTextNode(o));for(a&&h.removeChild(a),oe.support.appendChecked||oe.grep(_(f,"input"),y),d=0;o=f[d++];)if((!i||-1===oe.inArray(o,i))&&(e=oe.contains(o.ownerDocument,o),a=_(h.appendChild(o),"script"),e&&g(a),n))for(r=0;o=a[r++];)Cn.test(o.type||"")&&n.push(o);return h},cleanData:function(e,t){for(var n,i,r,o,a=0,s=oe.expando,l=oe.cache,c=oe.support.deleteExpando,u=oe.event.special;null!=(n=e[a]);a++)if((t||oe.acceptData(n))&&(o=(r=n[s])&&l[r])){if(o.events)for(i in o.events)u[i]?oe.event.remove(n,i):oe.removeEvent(n,i,o.handle);l[r]&&(delete l[r],c?delete n[s]:typeof n.removeAttribute!==W?n.removeAttribute(s):n[s]=null,Z.push(r))}},_evalUrl:function(e){return oe.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})}}),oe.fn.extend({wrapAll:function(t){return oe.isFunction(t)?this.each(function(e){oe(this).wrapAll(t.call(this,e))}):(this[0]&&(e=oe(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)),this);var e},wrapInner:function(n){return oe.isFunction(n)?this.each(function(e){oe(this).wrapInner(n.call(this,e))}):this.each(function(){var e=oe(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=oe.isFunction(t);return this.each(function(e){oe(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(){return this.parent().each(function(){oe.nodeName(this,"body")||oe(this).replaceWith(this.childNodes)}).end()}});var Mn,Ln,Hn,Fn=/alpha\([^)]*\)/i,Pn=/opacity\s*=\s*([^)]*)/,Nn=/^(top|right|bottom|left)$/,kn=/^(none|table(?!-c[ea]).+)/,In=/^margin/,On=RegExp("^("+ae+")(.*)$","i"),Bn=RegExp("^("+ae+")(?!px)[a-z%]+$","i"),zn=RegExp("^([+-])=("+ae+")","i"),jn={BODY:"block"},Un={position:"absolute",visibility:"hidden",display:"block"},Vn={letterSpacing:0,fontWeight:400},Wn=["Top","Right","Bottom","Left"],Gn=["Webkit","O","Moz","ms"];oe.fn.extend({css:function(e,t){return oe.access(this,function(e,t,n){var i,r={},o=0;if(oe.isArray(t)){for(i=Ln(e),n=t.length;o<n;o++)r[t[o]]=oe.css(e,t[o],!1,i);return r}return n!==L?oe.style(e,t,n):oe.css(e,t)},e,t,1<arguments.length)},show:function(){return E(this,!0)},hide:function(){return E(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){x(this)?oe(this).show():oe(this).hide()})}}),oe.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Hn(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:oe.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,a,s=oe.camelCase(t),l=e.style;if(t=oe.cssProps[s]||(oe.cssProps[s]=b(l,s)),a=oe.cssHooks[t]||oe.cssHooks[s],n===L)return a&&"get"in a&&(r=a.get(e,!1,i))!==L?r:l[t];if("string"===(o=typeof n)&&(r=zn.exec(n))&&(n=(r[1]+1)*r[2]+parseFloat(oe.css(e,t)),o="number"),!(null==n||"number"===o&&isNaN(n)||("number"!==o||oe.cssNumber[s]||(n+="px"),oe.support.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&(n=a.set(e,n,i))===L)))try{l[t]=n}catch(e){}}},css:function(e,t,n,i){var r,o=oe.camelCase(t);return t=oe.cssProps[o]||(oe.cssProps[o]=b(e.style,o)),(o=oe.cssHooks[t]||oe.cssHooks[o])&&"get"in o&&(r=o.get(e,!0,n)),r===L&&(r=Hn(e,t,i)),"normal"===r&&t in Vn&&(r=Vn[t]),""===n||n?(e=parseFloat(r),!0===n||oe.isNumeric(e)?e||0:r):r}}),f.getComputedStyle?(Ln=function(e){return f.getComputedStyle(e,null)},Hn=function(e,t,n){var i,r=(n=n||Ln(e))?n.getPropertyValue(t)||n[t]:L,o=e.style;return n&&(""!==r||oe.contains(e.ownerDocument,e)||(r=oe.style(e,t)),Bn.test(r)&&In.test(t)&&(e=o.width,t=o.minWidth,i=o.maxWidth,o.minWidth=o.maxWidth=o.width=r,r=n.width,o.width=e,o.minWidth=t,o.maxWidth=i)),r}):q.documentElement.currentStyle&&(Ln=function(e){return e.currentStyle},Hn=function(e,t,n){var i,r,o=(n=n||Ln(e))?n[t]:L,a=e.style;return null==o&&a&&a[t]&&(o=a[t]),Bn.test(o)&&!Nn.test(t)&&(n=a.left,(r=(i=e.runtimeStyle)&&i.left)&&(i.left=e.currentStyle.left),a.left="fontSize"===t?"1em":o,o=a.pixelLeft+"px",a.left=n,r&&(i.left=r)),""===o?"auto":o}),oe.each(["height","width"],function(e,r){oe.cssHooks[r]={get:function(e,t,n){if(t)return 0===e.offsetWidth&&kn.test(oe.css(e,"display"))?oe.swap(e,Un,function(){return C(e,r,n)}):C(e,r,n)},set:function(e,t,n){var i=n&&Ln(e);return T(e,t,n?w(e,r,n,oe.support.boxSizing&&"border-box"===oe.css(e,"boxSizing",!1,i),i):0)}}}),oe.support.opacity||(oe.cssHooks.opacity={get:function(e,t){return Pn.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,i=e.currentStyle,r=oe.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=i&&i.filter||n.filter||"";((n.zoom=1)<=t||""===t)&&""===oe.trim(o.replace(Fn,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||i&&!i.filter)||(n.filter=Fn.test(o)?o.replace(Fn,r):o+" "+r)}}),oe(function(){oe.support.reliableMarginRight||(oe.cssHooks.marginRight={get:function(e,t){if(t)return oe.swap(e,{display:"inline-block"},Hn,[e,"marginRight"])}}),!oe.support.pixelPosition&&oe.fn.position&&oe.each(["top","left"],function(e,n){oe.cssHooks[n]={get:function(e,t){if(t)return t=Hn(e,n),Bn.test(t)?oe(e).position()[n]+"px":t}}})}),oe.expr&&oe.expr.filters&&(oe.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!oe.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||oe.css(e,"display"))},oe.expr.filters.visible=function(e){return!oe.expr.filters.hidden(e)}),oe.each({margin:"",padding:"",border:"Width"},function(i,r){oe.cssHooks[i+r]={expand:function(e){var t=0,n={};for(e="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+Wn[t]+r]=e[t]||e[t-2]||e[0];return n}},In.test(i)||(oe.cssHooks[i+r].set=T)});var qn=/%20/g,Xn=/\[\]$/,$n=/\r?\n/g,Yn=/^(?:submit|button|image|reset|file)$/i,Jn=/^(?:input|select|textarea|keygen)/i;oe.fn.extend({serialize:function(){return oe.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=oe.prop(this,"elements");return e?oe.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!oe(this).is(":disabled")&&Jn.test(this.nodeName)&&!Yn.test(e)&&(this.checked||!Tn.test(e))}).map(function(e,t){var n=oe(this).val();return null==n?null:oe.isArray(n)?oe.map(n,function(e){return{name:t.name,value:e.replace($n,"\r\n")}}):{name:t.name,value:n.replace($n,"\r\n")}}).get()}}),oe.param=function(e,t){function n(e,t){t=oe.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)}var i,r=[];if(t===L&&(t=oe.ajaxSettings&&oe.ajaxSettings.traditional),oe.isArray(e)||e.jquery&&!oe.isPlainObject(e))oe.each(e,function(){n(this.name,this.value)});else for(i in e)R(i,e[i],t,n);return r.join("&").replace(qn,"+")},oe.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,n){oe.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}}),oe.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Zn,Qn,Kn=oe.now(),ei=/\?/,ti=/#.*$/,ni=/([?&])_=[^&]*/,ii=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,ri=/^(?:GET|HEAD)$/,oi=/^\/\//,ai=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,si=oe.fn.load,li={},ci={},ui="*/".concat("*");try{Qn=G.href}catch(e){(Qn=q.createElement("a")).href="",Qn=Qn.href}Zn=ai.exec(Qn.toLowerCase())||[],oe.fn.load=function(e,t,n){if("string"!=typeof e&&si)return si.apply(this,arguments);var i,r,o,a=this,s=e.indexOf(" ");return 0<=s&&(i=e.slice(s,e.length),e=e.slice(0,s)),oe.isFunction(t)?(n=t,t=L):t&&"object"==typeof t&&(o="POST"),0<a.length&&oe.ajax({url:e,type:o,dataType:"html",data:t}).done(function(e){r=arguments,a.html(i?oe("<div>").append(oe.parseHTML(e)).find(i):e)}).complete(n&&function(e,t){a.each(n,r||[e.responseText,t,e])}),this},oe.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){oe.fn[t]=function(e){return this.on(t,e)}}),oe.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Qn,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Zn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ui,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":oe.parseJSON,"text xml":oe.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?M(M(e,oe.ajaxSettings),t):M(oe.ajaxSettings,e)},ajaxPrefilter:A(li),ajaxTransport:A(ci),ajax:function(e,t){function n(e,t,n,i){var r,o,a,s=t;if(2!==A){if(A=2,b&&clearTimeout(b),E=L,y=i||"",M.readyState=0<e?4:0,i=200<=e&&e<300||304===e,n){for(var l,c,u,h,f=M,d=(a=T).contents,p=a.dataTypes;"*"===p[0];)p.shift(),c===L&&(c=a.mimeType||f.getResponseHeader("Content-Type"));if(c)for(h in d)if(d[h]&&d[h].test(c)){p.unshift(h);break}if(p[0]in n)u=p[0];else{for(h in n){if(!p[0]||a.converters[h+" "+p[0]]){u=h;break}l=l||h}u=u||l}a=u?(u!==p[0]&&p.unshift(u),n[u]):void 0}e:{l=a,c=M,u=i;var m,g,v,f={};if((d=(n=T).dataTypes.slice())[1])for(g in n.converters)f[g.toLowerCase()]=n.converters[g];for(h=d.shift();h;)if(n.responseFields[h]&&(c[n.responseFields[h]]=l),!v&&u&&n.dataFilter&&(l=n.dataFilter(l,n.dataType)),v=h,h=d.shift())if("*"===h)h=v;else if("*"!==v&&v!==h){if(!(g=f[v+" "+h]||f["* "+h]))for(m in f)if((a=m.split(" "))[1]===h&&(g=f[v+" "+a[0]]||f["* "+a[0]])){!0===g?g=f[m]:!0!==f[m]&&(h=a[0],d.unshift(a[1]));break}if(!0!==g)if(g&&n.throws)l=g(l);else try{l=g(l)}catch(e){a={state:"parsererror",error:g?e:"No conversion from "+v+" to "+h};break e}}a={state:"success",data:l}}i?(T.ifModified&&((s=M.getResponseHeader("Last-Modified"))&&(oe.lastModified[_]=s),(s=M.getResponseHeader("etag"))&&(oe.etag[_]=s)),204===e||"HEAD"===T.type?s="nocontent":304===e?s="notmodified":(s=a.state,r=a.data,i=!(o=a.error))):(o=s,!e&&s||(s="error",e<0&&(e=0))),M.status=e,M.statusText=(t||s)+"",i?S.resolveWith(w,[r,s,M]):S.rejectWith(w,[M,s,o]),M.statusCode(R),R=L,x&&C.trigger(i?"ajaxSuccess":"ajaxError",[M,T,i?r:o]),D.fireWith(w,[M,s]),x&&(C.trigger("ajaxComplete",[M,T]),--oe.active||oe.event.trigger("ajaxStop"))}}"object"==typeof e&&(t=e,e=L),t=t||{};var i,r,_,y,b,x,E,o,T=oe.ajaxSetup({},t),w=T.context||T,C=T.context&&(w.nodeType||w.jquery)?oe(w):oe.event,S=oe.Deferred(),D=oe.Callbacks("once memory"),R=T.statusCode||{},a={},s={},A=0,l="canceled",M={readyState:0,getResponseHeader:function(e){var t;if(2===A){if(!o)for(o={};t=ii.exec(y);)o[t[1].toLowerCase()]=t[2];t=o[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===A?y:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return A||(e=s[n]=s[n]||e,a[e]=t),this},overrideMimeType:function(e){return A||(T.mimeType=e),this},statusCode:function(e){var t;if(e)if(A<2)for(t in e)R[t]=[R[t],e[t]];else M.always(e[M.status]);return this},abort:function(e){return e=e||l,E&&E.abort(e),n(0,e),this}};if(S.promise(M).complete=D.add,M.success=M.done,M.error=M.fail,T.url=((e||T.url||Qn)+"").replace(ti,"").replace(oi,Zn[1]+"//"),T.type=t.method||t.type||T.method||T.type,T.dataTypes=oe.trim(T.dataType||"*").toLowerCase().match(se)||[""],null==T.crossDomain&&(i=ai.exec(T.url.toLowerCase()),T.crossDomain=!(!i||i[1]===Zn[1]&&i[2]===Zn[2]&&(i[3]||("http:"===i[1]?"80":"443"))===(Zn[3]||("http:"===Zn[1]?"80":"443")))),T.data&&T.processData&&"string"!=typeof T.data&&(T.data=oe.param(T.data,T.traditional)),H(li,T,t,M),2===A)return M;for(r in(x=T.global)&&0==oe.active++&&oe.event.trigger("ajaxStart"),T.type=T.type.toUpperCase(),T.hasContent=!ri.test(T.type),_=T.url,T.hasContent||(T.data&&(_=T.url+=(ei.test(_)?"&":"?")+T.data,delete T.data),!1===T.cache&&(T.url=ni.test(_)?_.replace(ni,"$1_="+Kn++):_+(ei.test(_)?"&":"?")+"_="+Kn++)),T.ifModified&&(oe.lastModified[_]&&M.setRequestHeader("If-Modified-Since",oe.lastModified[_]),oe.etag[_]&&M.setRequestHeader("If-None-Match",oe.etag[_])),(T.data&&T.hasContent&&!1!==T.contentType||t.contentType)&&M.setRequestHeader("Content-Type",T.contentType),M.setRequestHeader("Accept",T.dataTypes[0]&&T.accepts[T.dataTypes[0]]?T.accepts[T.dataTypes[0]]+("*"!==T.dataTypes[0]?", "+ui+"; q=0.01":""):T.accepts["*"]),T.headers)M.setRequestHeader(r,T.headers[r]);if(T.beforeSend&&(!1===T.beforeSend.call(w,M,T)||2===A))return M.abort();for(r in l="abort",{success:1,error:1,complete:1})M[r](T[r]);if(E=H(ci,T,t,M)){M.readyState=1,x&&C.trigger("ajaxSend",[M,T]),T.async&&0<T.timeout&&(b=setTimeout(function(){M.abort("timeout")},T.timeout));try{A=1,E.send(a,n)}catch(e){if(!(A<2))throw e;n(-1,e)}}else n(-1,"No Transport");return M},getJSON:function(e,t,n){return oe.get(e,t,n,"json")},getScript:function(e,t){return oe.get(e,L,t,"script")}}),oe.each(["get","post"],function(e,r){oe[r]=function(e,t,n,i){return oe.isFunction(t)&&(i=i||n,n=t,t=L),oe.ajax({url:e,type:r,dataType:i,data:t,success:n})}}),oe.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return oe.globalEval(e),e}}}),oe.ajaxPrefilter("script",function(e){e.cache===L&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),oe.ajaxTransport("script",function(t){if(t.crossDomain){var i,r=q.head||oe("head")[0]||q.documentElement;return{send:function(e,n){(i=q.createElement("script")).async=!0,t.scriptCharset&&(i.charset=t.scriptCharset),i.src=t.url,i.onload=i.onreadystatechange=function(e,t){!t&&i.readyState&&!/loaded|complete/.test(i.readyState)||(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),i=null,t||n(200,"success"))},r.insertBefore(i,r.firstChild)},abort:function(){i&&i.onload(L,!0)}}}});var hi=[],fi=/(=)\?(?=&|$)|\?\?/;oe.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=hi.pop()||oe.expando+"_"+Kn++;return this[e]=!0,e}}),oe.ajaxPrefilter("json jsonp",function(e,t,n){var i,r,o,a=!1!==e.jsonp&&(fi.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&fi.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return i=e.jsonpCallback=oe.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(fi,"$1"+i):!1!==e.jsonp&&(e.url+=(ei.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return o||oe.error(i+" was not called"),o[0]},e.dataTypes[0]="json",r=f[i],f[i]=function(){o=arguments},n.always(function(){f[i]=r,e[i]&&(e.jsonpCallback=t.jsonpCallback,hi.push(i)),o&&oe.isFunction(r)&&r(o[0]),o=r=L}),"script"});var di,pi,mi=0,gi=f.ActiveXObject&&function(){for(var e in di)di[e](L,!0)};oe.ajaxSettings.xhr=f.ActiveXObject?function(){var e;if(!(e=!this.isLocal&&F()))e:{try{e=new f.ActiveXObject("Microsoft.XMLHTTP");break e}catch(e){}e=void 0}return e}:F,pi=oe.ajaxSettings.xhr(),oe.support.cors=!!pi&&"withCredentials"in pi,(pi=oe.support.ajax=!!pi)&&oe.ajaxTransport(function(c){var u;if(!c.crossDomain||oe.support.cors)return{send:function(e,a){var s,t,l=c.xhr();if(c.username?l.open(c.type,c.url,c.async,c.username,c.password):l.open(c.type,c.url,c.async),c.xhrFields)for(t in c.xhrFields)l[t]=c.xhrFields[t];c.mimeType&&l.overrideMimeType&&l.overrideMimeType(c.mimeType),c.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");try{for(t in e)l.setRequestHeader(t,e[t])}catch(e){}l.send(c.hasContent&&c.data||null),u=function(e,t){var n,i,r,o;try{if(u&&(t||4===l.readyState))if(u=L,s&&(l.onreadystatechange=oe.noop,gi&&delete di[s]),t)4!==l.readyState&&l.abort();else{o={},n=l.status,i=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(o.text=l.responseText);try{r=l.statusText}catch(e){r=""}n||!c.isLocal||c.crossDomain?1223===n&&(n=204):n=o.text?200:404}}catch(e){t||a(-1,e)}o&&a(n,r,o,i)},c.async?4===l.readyState?setTimeout(u):(s=++mi,gi&&(di||(di={},oe(f).unload(gi)),di[s]=u),l.onreadystatechange=u):u()},abort:function(){u&&u(L,!0)}}});var vi,_i,yi=/^(?:toggle|show|hide)$/,bi=RegExp("^(?:([+-])=|)("+ae+")([a-z%]*)$","i"),xi=/queueHooks$/,Ei=[function(t,e,n){var i,r,o,a,s,l=this,c={},u=t.style,h=t.nodeType&&x(t),f=oe._data(t,"fxshow");for(i in n.queue||(null==(a=oe._queueHooks(t,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,l.always(function(){l.always(function(){a.unqueued--,oe.queue(t,"fx").length||a.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(n.overflow=[u.overflow,u.overflowX,u.overflowY],"inline"===oe.css(t,"display")&&"none"===oe.css(t,"float")&&(oe.support.inlineBlockNeedsLayout&&"inline"!==S(t.nodeName)?u.zoom=1:u.display="inline-block")),n.overflow&&(u.overflow="hidden",oe.support.shrinkWrapBlocks||l.always(function(){u.overflow=n.overflow[0],u.overflowX=n.overflow[1],u.overflowY=n.overflow[2]})),e)r=e[i],yi.exec(r)&&(delete e[i],o=o||"toggle"===r,r!==(h?"hide":"show"))&&(c[i]=f&&f[i]||oe.style(t,i));if(!oe.isEmptyObject(c))for(i in f?"hidden"in f&&(h=f.hidden):f=oe._data(t,"fxshow",{}),o&&(f.hidden=!h),h?oe(t).show():l.done(function(){oe(t).hide()}),l.done(function(){var e;for(e in oe._removeData(t,"fxshow"),c)oe.style(t,e,c[e])}),c)e=N(h?f[i]:0,i,l),i in f||(f[i]=e.start,h&&(e.end=e.start,e.start="width"===i||"height"===i?1:0))}],Ti={"*":[function(e,t){var n=this.createTween(e,t),i=n.cur(),r=bi.exec(t),o=r&&r[3]||(oe.cssNumber[e]?"":"px"),a=(oe.cssNumber[e]||"px"!==o&&+i)&&bi.exec(oe.css(n.elem,e)),s=1,l=20;if(a&&a[3]!==o)for(o=o||a[3],r=r||[],a=+i||1;a/=s=s||".5",oe.style(n.elem,e,a+o),s!==(s=n.cur()/i)&&1!==s&&--l;);return r&&(a=n.start=+a||+i||0,n.unit=o,n.end=r[1]?a+(r[1]+1)*r[2]:+r[2]),n}]};oe.Animation=oe.extend(k,{tweener:function(e,t){for(var n,i=0,r=(e=oe.isFunction(e)?(t=e,["*"]):e.split(" ")).length;i<r;i++)n=e[i],Ti[n]=Ti[n]||[],Ti[n].unshift(t)},prefilter:function(e,t){t?Ei.unshift(e):Ei.push(e)}}),(oe.Tween=I).prototype={constructor:I,init:function(e,t,n,i,r,o){this.elem=e,this.prop=n,this.easing=r||"swing",this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=o||(oe.cssNumber[n]?"":"px")},cur:function(){var e=I.propHooks[this.prop];return e&&e.get?e.get(this):I.propHooks._default.get(this)},run:function(e){var t,n=I.propHooks[this.prop];return this.pos=t=this.options.duration?oe.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):I.propHooks._default.set(this),this}},I.prototype.init.prototype=I.prototype,I.propHooks={_default:{get:function(e){return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(e=oe.css(e.elem,e.prop,""))&&"auto"!==e?e:0:e.elem[e.prop]},set:function(e){oe.fx.step[e.prop]?oe.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[oe.cssProps[e.prop]]||oe.cssHooks[e.prop])?oe.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},I.propHooks.scrollTop=I.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},oe.each(["toggle","show","hide"],function(e,i){var r=oe.fn[i];oe.fn[i]=function(e,t,n){return null==e||"boolean"==typeof e?r.apply(this,arguments):this.animate(O(i,!0),e,t,n)}}),oe.fn.extend({fadeTo:function(e,t,n,i){return this.filter(x).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(t,e,n,i){var r=oe.isEmptyObject(t),o=oe.speed(e,n,i);return(e=function(){var e=k(this,oe.extend({},t),o);(r||oe._data(this,"finish"))&&e.stop(!0)}).finish=e,r||!1===o.queue?this.each(e):this.queue(o.queue,e)},stop:function(r,e,o){function a(e){var t=e.stop;delete e.stop,t(o)}return"string"!=typeof r&&(o=e,e=r,r=L),e&&!1!==r&&this.queue(r||"fx",[]),this.each(function(){var e=!0,t=null!=r&&r+"queueHooks",n=oe.timers,i=oe._data(this);if(t)i[t]&&i[t].stop&&a(i[t]);else for(t in i)i[t]&&i[t].stop&&xi.test(t)&&a(i[t]);for(t=n.length;t--;)n[t].elem!==this||null!=r&&n[t].queue!==r||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||oe.dequeue(this,r)})},finish:function(o){return!1!==o&&(o=o||"fx"),this.each(function(){var e=oe._data(this),t=e[o+"queue"],n=e[o+"queueHooks"],i=oe.timers,r=t?t.length:0;for(e.finish=!0,oe.queue(this,o,[]),n&&n.stop&&n.stop.call(this,!0),n=i.length;n--;)i[n].elem===this&&i[n].queue===o&&(i[n].anim.stop(!0),i.splice(n,1));for(n=0;n<r;n++)t[n]&&t[n].finish&&t[n].finish.call(this);delete e.finish})}}),oe.each({slideDown:O("show"),slideUp:O("hide"),slideToggle:O("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,i){oe.fn[e]=function(e,t,n){return this.animate(i,e,t,n)}}),oe.speed=function(e,t,n){var i=e&&"object"==typeof e?oe.extend({},e):{complete:n||!n&&t||oe.isFunction(e)&&e,duration:e,easing:n&&t||t&&!oe.isFunction(t)&&t};return i.duration=oe.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in oe.fx.speeds?oe.fx.speeds[i.duration]:oe.fx.speeds._default,null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){oe.isFunction(i.old)&&i.old.call(this),i.queue&&oe.dequeue(this,i.queue)},i},oe.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},oe.timers=[],oe.fx=I.prototype.init,oe.fx.tick=function(){var e,t=oe.timers,n=0;for(vi=oe.now();n<t.length;n++)(e=t[n])()||t[n]!==e||t.splice(n--,1);t.length||oe.fx.stop(),vi=L},oe.fx.timer=function(e){e()&&oe.timers.push(e)&&oe.fx.start()},oe.fx.interval=13,oe.fx.start=function(){_i=_i||setInterval(oe.fx.tick,oe.fx.interval)},oe.fx.stop=function(){clearInterval(_i),_i=null},oe.fx.speeds={slow:600,fast:200,_default:400},oe.fx.step={},oe.expr&&oe.expr.filters&&(oe.expr.filters.animated=function(t){return oe.grep(oe.timers,function(e){return t===e.elem}).length}),oe.fn.offset=function(t){if(arguments.length)return t===L?this:this.each(function(e){oe.offset.setOffset(this,t,e)});var e,n,i={top:0,left:0},r=(n=this[0])&&n.ownerDocument;return r?(e=r.documentElement,oe.contains(e,n)?(typeof n.getBoundingClientRect!==W&&(i=n.getBoundingClientRect()),n=B(r),{top:i.top+(n.pageYOffset||e.scrollTop)-(e.clientTop||0),left:i.left+(n.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}):i):void 0},oe.offset={setOffset:function(e,t,n){var i=oe.css(e,"position");"static"===i&&(e.style.position="relative");var r=oe(e),o=r.offset(),a=oe.css(e,"top"),s=oe.css(e,"left"),l={},c={},s=("absolute"===i||"fixed"===i)&&-1<oe.inArray("auto",[a,s])?(i=(c=r.position()).top,c.left):(i=parseFloat(a)||0,parseFloat(s)||0);oe.isFunction(t)&&(t=t.call(e,n,o)),null!=t.top&&(l.top=t.top-o.top+i),null!=t.left&&(l.left=t.left-o.left+s),"using"in t?t.using.call(e,l):r.css(l)}},oe.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},i=this[0];return"fixed"===oe.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),oe.nodeName(e[0],"html")||(n=e.offset()),n.top+=oe.css(e[0],"borderTopWidth",!0),n.left+=oe.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-oe.css(i,"marginTop",!0),left:t.left-n.left-oe.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||X;e&&!oe.nodeName(e,"html")&&"static"===oe.css(e,"position");)e=e.offsetParent;return e||X})}}),oe.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,r){var o=/Y/.test(r);oe.fn[t]=function(e){return oe.access(this,function(e,t,n){var i=B(e);if(n===L)return i?r in i?i[r]:i.document.documentElement[t]:e[t];i?i.scrollTo(o?oe(i).scrollLeft():n,o?n:oe(i).scrollTop()):e[t]=n},t,e,arguments.length,null)}}),oe.each({Height:"height",Width:"width"},function(o,a){oe.each({padding:"inner"+o,content:a,"":"outer"+o},function(r,e){oe.fn[e]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return oe.access(this,function(e,t,n){return oe.isWindow(e)?e.document.documentElement["client"+o]:9===e.nodeType?(t=e.documentElement,Math.max(e.body["scroll"+o],t["scroll"+o],e.body["offset"+o],t["offset"+o],t["client"+o])):n===L?oe.css(e,t,i):oe.style(e,t,n,i)},a,n?e:L,n,null)}})}),oe.fn.size=function(){return this.length},oe.fn.andSelf=oe.fn.addBack,e.jQuery=oe}(window,ChemDoodle.lib),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(ChemDoodle.lib.jQuery)}(function(s){function t(e){var t=e||window.event,n=f.call(arguments,1),i=0,r=0,o=0,a=0;if((e=s.event.fix(t)).type="mousewheel","detail"in t&&(o=-1*t.detail),"wheelDelta"in t&&(o=t.wheelDelta),"wheelDeltaY"in t&&(o=t.wheelDeltaY),"wheelDeltaX"in t&&(r=-1*t.wheelDeltaX),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(r=-1*o,o=0),i=0===o?r:o,"deltaY"in t&&(i=o=-1*t.deltaY),"deltaX"in t&&(r=t.deltaX,0===o&&(i=-1*r)),0!==o||0!==r)return 1===t.deltaMode?(i*=t=s.data(this,"mousewheel-line-height"),o*=t,r*=t):2===t.deltaMode&&(i*=t=s.data(this,"mousewheel-page-height"),o*=t,r*=t),a=Math.max(Math.abs(o),Math.abs(r)),h&&!(a<h)||120===(h=a)&&(c=!0,h/=40),c&&(i/=40,r/=40,o/=40),i=Math[1<=i?"floor":"ceil"](i/h),r=Math[1<=r?"floor":"ceil"](r/h),o=Math[1<=o?"floor":"ceil"](o/h),e.deltaX=r,e.deltaY=o,e.deltaFactor=h,e.deltaMode=0,n.unshift(e,i,r,o),u&&clearTimeout(u),u=setTimeout(l,200),(s.event.dispatch||s.event.handle).apply(this,n)}function l(){c=h=null}var c,u,h,e=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],n="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],f=Array.prototype.slice;if(s.event.fixHooks)for(var i=e.length;i;)s.event.fixHooks[e[--i]]=s.event.mouseHooks;var r=s.event.special.mousewheel={version:"3.1.8",setup:function(){if(this.addEventListener)for(var e=n.length;e;)this.addEventListener(n[--e],t,!1);else this.onmousewheel=t;s.data(this,"mousewheel-line-height",r.getLineHeight(this)),s.data(this,"mousewheel-page-height",r.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var e=n.length;e;)this.removeEventListener(n[--e],t,!1);else this.onmousewheel=null},getLineHeight:function(e){return parseInt(s(e)["offsetParent"in s.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(e){return s(e).height()}};s.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),function(e,t){"object"==typeof exports?module.exports=t(global):"function"==typeof define&&define.amd?define([],function(){return t(e)}):t(e)}(ChemDoodle.lib,function(e){function t(e){return v=e}function n(){return v="undefined"!=typeof Float32Array?Float32Array:Array}var i,r,o={};"undefined"!=typeof Float32Array?(i=new Float32Array(1),r=new Int32Array(i.buffer),o.invsqrt=function(e){i[0]=e,r[0]=1597463007-(r[0]>>1);var t=i[0];return t*(1.5-.5*e*t*t)}):o.invsqrt=function(e){return 1/Math.sqrt(e)};var v=null;n();var a={create:function(e){var t=new v(3);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):t[0]=t[1]=t[2]=0,t},createFrom:function(e,t,n){var i=new v(3);return i[0]=e,i[1]=t,i[2]=n,i},set:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},equal:function(e,t){return e===t||Math.abs(e[0]-t[0])<1e-6&&Math.abs(e[1]-t[1])<1e-6&&Math.abs(e[2]-t[2])<1e-6},add:function(e,t,n){return n&&e!==n?(n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n):(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e)},subtract:function(e,t,n){return n&&e!==n?(n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n):(e[0]-=t[0],e[1]-=t[1],e[2]-=t[2],e)},multiply:function(e,t,n){return n&&e!==n?(n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n):(e[0]*=t[0],e[1]*=t[1],e[2]*=t[2],e)},negate:function(e,t){return(t=t||e)[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},scale:function(e,t,n){return n&&e!==n?(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n):(e[0]*=t,e[1]*=t,e[2]*=t,e)},normalize:function(e,t){t=t||e;var n=e[0],i=e[1],r=e[2],o=Math.sqrt(n*n+i*i+r*r);return o?1===o?(t[0]=n,t[1]=i,t[2]=r):(o=1/o,t[0]=n*o,t[1]=i*o,t[2]=r*o):(t[0]=0,t[1]=0,t[2]=0),t},cross:function(e,t,n){n=n||e;var i=e[0],r=e[1];e=e[2];var o=t[0],a=t[1];return t=t[2],n[0]=r*t-e*a,n[1]=e*o-i*t,n[2]=i*a-r*o,n},length:function(e){var t=e[0],n=e[1];return e=e[2],Math.sqrt(t*t+n*n+e*e)},squaredLength:function(e){var t=e[0],n=e[1];return t*t+n*n+(e=e[2])*e},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},direction:function(e,t,n){n=n||e;var i=e[0]-t[0],r=e[1]-t[1];return e=e[2]-t[2],(t=Math.sqrt(i*i+r*r+e*e))?(t=1/t,n[0]=i*t,n[1]=r*t,n[2]=e*t):(n[0]=0,n[1]=0,n[2]=0),n},lerp:function(e,t,n,i){return(i=i||e)[0]=e[0]+n*(t[0]-e[0]),i[1]=e[1]+n*(t[1]-e[1]),i[2]=e[2]+n*(t[2]-e[2]),i},dist:function(e,t){var n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2];return Math.sqrt(n*n+i*i+r*r)}},s=null,l=new v(4);a.unproject=function(e,t,n,i,r){r=r||e;var o=s=s||p.create();return l[0]=2*(e[0]-i[0])/i[2]-1,l[1]=2*(e[1]-i[1])/i[3]-1,l[2]=2*e[2]-1,l[3]=1,p.multiply(n,t,o),p.inverse(o)?(p.multiplyVec4(o,l),0===l[3]?null:(r[0]=l[0]/l[3],r[1]=l[1]/l[3],r[2]=l[2]/l[3],r)):null};var c=a.createFrom(1,0,0),u=a.createFrom(0,1,0),h=a.createFrom(0,0,1),f=a.create();a.rotationTo=function(e,t,n){n=n||d.create();var i,r=a.dot(e,t);return 1<=r?d.set(g,n):r<-.999999?(a.cross(c,e,f),a.length(f)<1e-6&&a.cross(u,e,f),a.length(f)<1e-6&&a.cross(h,e,f),a.normalize(f),d.fromAngleAxis(Math.PI,f,n)):(i=1/(r=Math.sqrt(2*(1+r))),a.cross(e,t,f),n[0]=f[0]*i,n[1]=f[1]*i,n[2]=f[2]*i,n[3]=.5*r,d.normalize(n)),1<n[3]?n[3]=1:n[3]<-1&&(n[3]=-1),n},a.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+"]"};var m={create:function(e){var t=new v(9);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8]):t[0]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=0,t},createFrom:function(e,t,n,i,r,o,a,s,l){var c=new v(9);return c[0]=e,c[1]=t,c[2]=n,c[3]=i,c[4]=r,c[5]=o,c[6]=a,c[7]=s,c[8]=l,c},determinant:function(e){var t=e[3],n=e[4],i=e[5],r=e[6],o=e[7],a=e[8];return e[0]*(a*n-i*o)+e[1]*(-a*t+i*r)+e[2]*(o*t-n*r)},inverse:function(e,t){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=u*a-s*c,f=-u*o+s*l,d=c*o-a*l,p=n*h+i*f+r*d;return p?(p=1/p,(t=t||m.create())[0]=h*p,t[1]=(-u*i+r*c)*p,t[2]=(s*i-r*a)*p,t[3]=f*p,t[4]=(u*n-r*l)*p,t[5]=(-s*n+r*o)*p,t[6]=d*p,t[7]=(-c*n+i*l)*p,t[8]=(a*n-i*o)*p,t):null},multiply:function(e,t,n){n=n||e;var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7];e=e[8];var h=t[0],f=t[1],d=t[2],p=t[3],m=t[4],g=t[5],v=t[6],_=t[7];return t=t[8],n[0]=h*i+f*a+d*c,n[1]=h*r+f*s+d*u,n[2]=h*o+f*l+d*e,n[3]=p*i+m*a+g*c,n[4]=p*r+m*s+g*u,n[5]=p*o+m*l+g*e,n[6]=v*i+_*a+t*c,n[7]=v*r+_*s+t*u,n[8]=v*o+_*l+t*e,n},multiplyVec2:function(e,t,n){n=n||t;var i=t[0];return t=t[1],n[0]=i*e[0]+t*e[3]+e[6],n[1]=i*e[1]+t*e[4]+e[7],n},multiplyVec3:function(e,t,n){n=n||t;var i=t[0],r=t[1];return t=t[2],n[0]=i*e[0]+r*e[3]+t*e[6],n[1]=i*e[1]+r*e[4]+t*e[7],n[2]=i*e[2]+r*e[5]+t*e[8],n},set:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},equal:function(e,t){return e===t||Math.abs(e[0]-t[0])<1e-6&&Math.abs(e[1]-t[1])<1e-6&&Math.abs(e[2]-t[2])<1e-6&&Math.abs(e[3]-t[3])<1e-6&&Math.abs(e[4]-t[4])<1e-6&&Math.abs(e[5]-t[5])<1e-6&&Math.abs(e[6]-t[6])<1e-6&&Math.abs(e[7]-t[7])<1e-6&&Math.abs(e[8]-t[8])<1e-6},identity:function(e){return(e=e||m.create())[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},transpose:function(e,t){if(t&&e!==t)return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t;var n=e[1],i=e[2],r=e[5];return e[1]=e[3],e[2]=e[6],e[3]=n,e[5]=e[7],e[6]=i,e[7]=r,e},toMat4:function(e,t){return(t=t||p.create())[15]=1,t[14]=0,t[13]=0,t[12]=0,t[11]=0,t[10]=e[8],t[9]=e[7],t[8]=e[6],t[7]=0,t[6]=e[5],t[5]=e[4],t[4]=e[3],t[3]=0,t[2]=e[2],t[1]=e[1],t[0]=e[0],t},str:function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+"]"}},p={create:function(e){var t=new v(16);return e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t},createFrom:function(e,t,n,i,r,o,a,s,l,c,u,h,f,d,p,m){var g=new v(16);return g[0]=e,g[1]=t,g[2]=n,g[3]=i,g[4]=r,g[5]=o,g[6]=a,g[7]=s,g[8]=l,g[9]=c,g[10]=u,g[11]=h,g[12]=f,g[13]=d,g[14]=p,g[15]=m,g},set:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},equal:function(e,t){return e===t||Math.abs(e[0]-t[0])<1e-6&&Math.abs(e[1]-t[1])<1e-6&&Math.abs(e[2]-t[2])<1e-6&&Math.abs(e[3]-t[3])<1e-6&&Math.abs(e[4]-t[4])<1e-6&&Math.abs(e[5]-t[5])<1e-6&&Math.abs(e[6]-t[6])<1e-6&&Math.abs(e[7]-t[7])<1e-6&&Math.abs(e[8]-t[8])<1e-6&&Math.abs(e[9]-t[9])<1e-6&&Math.abs(e[10]-t[10])<1e-6&&Math.abs(e[11]-t[11])<1e-6&&Math.abs(e[12]-t[12])<1e-6&&Math.abs(e[13]-t[13])<1e-6&&Math.abs(e[14]-t[14])<1e-6&&Math.abs(e[15]-t[15])<1e-6},identity:function(e){return(e=e||p.create())[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},transpose:function(e,t){if(t&&e!==t)return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t;var n=e[1],i=e[2],r=e[3],o=e[6],a=e[7],s=e[11];return e[1]=e[4],e[2]=e[8],e[3]=e[12],e[4]=n,e[6]=e[9],e[7]=e[13],e[8]=i,e[9]=o,e[11]=e[14],e[12]=r,e[13]=a,e[14]=s,e},determinant:function(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=e[6],l=e[7],c=e[8],u=e[9],h=e[10],f=e[11],d=e[12],p=e[13],m=e[14];return d*u*s*r-c*p*s*r-d*a*h*r+o*p*h*r+c*a*m*r-o*u*m*r-d*u*i*l+c*p*i*l+d*n*h*l-t*p*h*l-c*n*m*l+t*u*m*l+d*a*i*f-o*p*i*f-d*n*s*f+t*p*s*f+o*n*m*f-t*a*m*f-c*a*i*(e=e[15])+o*u*i*e+c*n*s*e-t*u*s*e-o*n*h*e+t*a*h*e},inverse:function(e,t){t=t||e;var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],d=e[11],p=e[12],m=e[13],g=e[14],v=e[15],_=n*s-i*a,y=n*l-r*a,b=n*c-o*a,x=i*l-r*s,E=i*c-o*s,T=r*c-o*l,w=u*m-h*p,C=u*g-f*p,S=u*v-d*p,D=h*g-f*m,R=h*v-d*m,A=f*v-d*g,M=_*A-y*R+b*D+x*S-E*C+T*w;return M?(M=1/M,t[0]=(s*A-l*R+c*D)*M,t[1]=(-i*A+r*R-o*D)*M,t[2]=(m*T-g*E+v*x)*M,t[3]=(-h*T+f*E-d*x)*M,t[4]=(-a*A+l*S-c*C)*M,t[5]=(n*A-r*S+o*C)*M,t[6]=(-p*T+g*b-v*y)*M,t[7]=(u*T-f*b+d*y)*M,t[8]=(a*R-s*S+c*w)*M,t[9]=(-n*R+i*S-o*w)*M,t[10]=(p*E-m*b+v*_)*M,t[11]=(-u*E+h*b-d*_)*M,t[12]=(-a*D+s*C-l*w)*M,t[13]=(n*D-i*C+r*w)*M,t[14]=(-p*x+m*y-g*_)*M,t[15]=(u*x-h*y+f*_)*M,t):null},toRotationMat:function(e,t){return(t=t||p.create())[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},toMat3:function(e,t){return(t=t||m.create())[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},toInverseMat3:function(e,t){var n=e[0],i=e[1],r=e[2],o=e[4],a=e[5],s=e[6],l=e[8],c=e[9],u=e[10],h=u*a-s*c,f=-u*o+s*l,d=c*o-a*l,p=n*h+i*f+r*d;return p?(p=1/p,(t=t||m.create())[0]=h*p,t[1]=(-u*i+r*c)*p,t[2]=(s*i-r*a)*p,t[3]=f*p,t[4]=(u*n-r*l)*p,t[5]=(-s*n+r*o)*p,t[6]=d*p,t[7]=(-c*n+i*l)*p,t[8]=(a*n-i*o)*p,t):null},multiply:function(e,t,n){n=n||e;var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],d=e[10],p=e[11],m=e[12],g=e[13],v=e[14];e=e[15];var _=t[0],y=t[1],b=t[2],x=t[3];return n[0]=_*i+y*s+b*h+x*m,n[1]=_*r+y*l+b*f+x*g,n[2]=_*o+y*c+b*d+x*v,n[3]=_*a+y*u+b*p+x*e,_=t[4],y=t[5],b=t[6],x=t[7],n[4]=_*i+y*s+b*h+x*m,n[5]=_*r+y*l+b*f+x*g,n[6]=_*o+y*c+b*d+x*v,n[7]=_*a+y*u+b*p+x*e,_=t[8],y=t[9],b=t[10],x=t[11],n[8]=_*i+y*s+b*h+x*m,n[9]=_*r+y*l+b*f+x*g,n[10]=_*o+y*c+b*d+x*v,n[11]=_*a+y*u+b*p+x*e,_=t[12],y=t[13],b=t[14],x=t[15],n[12]=_*i+y*s+b*h+x*m,n[13]=_*r+y*l+b*f+x*g,n[14]=_*o+y*c+b*d+x*v,n[15]=_*a+y*u+b*p+x*e,n},multiplyVec3:function(e,t,n){n=n||t;var i=t[0],r=t[1];return t=t[2],n[0]=e[0]*i+e[4]*r+e[8]*t+e[12],n[1]=e[1]*i+e[5]*r+e[9]*t+e[13],n[2]=e[2]*i+e[6]*r+e[10]*t+e[14],n},multiplyVec4:function(e,t,n){n=n||t;var i=t[0],r=t[1],o=t[2];return t=t[3],n[0]=e[0]*i+e[4]*r+e[8]*o+e[12]*t,n[1]=e[1]*i+e[5]*r+e[9]*o+e[13]*t,n[2]=e[2]*i+e[6]*r+e[10]*o+e[14]*t,n[3]=e[3]*i+e[7]*r+e[11]*o+e[15]*t,n},translate:function(e,t,n){var i,r,o,a,s,l,c,u,h,f,d,p,m=t[0],g=t[1];return t=t[2],n&&e!==n?(i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],d=e[10],p=e[11],n[0]=i,n[1]=r,n[2]=o,n[3]=a,n[4]=s,n[5]=l,n[6]=c,n[7]=u,n[8]=h,n[9]=f,n[10]=d,n[11]=p,n[12]=i*m+s*g+h*t+e[12],n[13]=r*m+l*g+f*t+e[13],n[14]=o*m+c*g+d*t+e[14],n[15]=a*m+u*g+p*t+e[15],n):(e[12]=e[0]*m+e[4]*g+e[8]*t+e[12],e[13]=e[1]*m+e[5]*g+e[9]*t+e[13],e[14]=e[2]*m+e[6]*g+e[10]*t+e[14],e[15]=e[3]*m+e[7]*g+e[11]*t+e[15],e)},scale:function(e,t,n){var i=t[0],r=t[1];return t=t[2],n&&e!==n?(n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7]*r,n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11]*t,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n):(e[0]*=i,e[1]*=i,e[2]*=i,e[3]*=i,e[4]*=r,e[5]*=r,e[6]*=r,e[7]*=r,e[8]*=t,e[9]*=t,e[10]*=t,e[11]*=t,e)},rotate:function(e,t,n,i){var r=n[0],o=n[1];n=n[2];var a,s,l,c,u,h,f,d,p,m,g,v,_,y,b,x,E,T,w,C,S=Math.sqrt(r*r+o*o+n*n);return S?(1!==S&&(r*=S=1/S,o*=S,n*=S),a=Math.sin(t),l=1-(s=Math.cos(t)),t=e[0],S=e[1],c=e[2],u=e[3],h=e[4],f=e[5],d=e[6],p=e[7],m=e[8],g=e[9],v=e[10],_=e[11],y=r*r*l+s,b=o*r*l+n*a,x=n*r*l-o*a,E=r*o*l-n*a,T=o*o*l+s,w=n*o*l+r*a,C=r*n*l+o*a,r=o*n*l-r*a,o=n*n*l+s,i?e!==i&&(i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]):i=e,i[0]=t*y+h*b+m*x,i[1]=S*y+f*b+g*x,i[2]=c*y+d*b+v*x,i[3]=u*y+p*b+_*x,i[4]=t*E+h*T+m*w,i[5]=S*E+f*T+g*w,i[6]=c*E+d*T+v*w,i[7]=u*E+p*T+_*w,i[8]=t*C+h*r+m*o,i[9]=S*C+f*r+g*o,i[10]=c*C+d*r+v*o,i[11]=u*C+p*r+_*o,i):null},rotateX:function(e,t,n){var i=Math.sin(t);t=Math.cos(t);var r=e[4],o=e[5],a=e[6],s=e[7],l=e[8],c=e[9],u=e[10],h=e[11];return n?e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[4]=r*t+l*i,n[5]=o*t+c*i,n[6]=a*t+u*i,n[7]=s*t+h*i,n[8]=r*-i+l*t,n[9]=o*-i+c*t,n[10]=a*-i+u*t,n[11]=s*-i+h*t,n},rotateY:function(e,t,n){var i=Math.sin(t);t=Math.cos(t);var r=e[0],o=e[1],a=e[2],s=e[3],l=e[8],c=e[9],u=e[10],h=e[11];return n?e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[0]=r*t+l*-i,n[1]=o*t+c*-i,n[2]=a*t+u*-i,n[3]=s*t+h*-i,n[8]=r*i+l*t,n[9]=o*i+c*t,n[10]=a*i+u*t,n[11]=s*i+h*t,n},rotateZ:function(e,t,n){var i=Math.sin(t);t=Math.cos(t);var r=e[0],o=e[1],a=e[2],s=e[3],l=e[4],c=e[5],u=e[6],h=e[7];return n?e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[0]=r*t+l*i,n[1]=o*t+c*i,n[2]=a*t+u*i,n[3]=s*t+h*i,n[4]=r*-i+l*t,n[5]=o*-i+c*t,n[6]=a*-i+u*t,n[7]=s*-i+h*t,n},frustum:function(e,t,n,i,r,o,a){var s=t-e,l=i-n,c=o-r;return(a=a||p.create())[0]=2*r/s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*r/l,a[6]=0,a[7]=0,a[8]=(t+e)/s,a[9]=(i+n)/l,a[10]=-(o+r)/c,a[11]=-1,a[12]=0,a[13]=0,a[14]=-2*o*r/c,a[15]=0,a},perspective:function(e,t,n,i,r){return t*=e=n*Math.tan(e*Math.PI/360),p.frustum(-t,t,-e,e,n,i,r)},ortho:function(e,t,n,i,r,o,a){var s=t-e,l=i-n,c=o-r;return(a=a||p.create())[0]=2/s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2/l,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=-2/c,a[11]=0,a[12]=-(e+t)/s,a[13]=-(i+n)/l,a[14]=-(o+r)/c,a[15]=1,a},lookAt:function(e,t,n,i){i=i||p.create();var r,o,a,s,l,c,u,h,f=e[0],d=e[1];return e=e[2],a=n[0],s=n[1],o=n[2],u=t[0],n=t[1],r=t[2],f===u&&d===n&&e===r?p.identity(i):(t=f-u,n=d-n,u=e-r,r=s*(u*=h=1/Math.sqrt(t*t+n*n+u*u))-o*(n*=h),o=o*(t*=h)-a*u,a=a*n-s*t,(h=Math.sqrt(r*r+o*o+a*a))?(r*=h=1/h,o*=h,a*=h):a=o=r=0,s=n*a-u*o,l=u*r-t*a,c=t*o-n*r,(h=Math.sqrt(s*s+l*l+c*c))?(s*=h=1/h,l*=h,c*=h):c=l=s=0,i[0]=r,i[1]=s,i[2]=t,i[3]=0,i[4]=o,i[5]=l,i[6]=n,i[7]=0,i[8]=a,i[9]=c,i[10]=u,i[11]=0,i[12]=-(r*f+o*d+a*e),i[13]=-(s*f+l*d+c*e),i[14]=-(t*f+n*d+u*e),i[15]=1,i)},fromRotationTranslation:function(e,t,n){n=n||p.create();var i=e[0],r=e[1],o=e[2],a=e[3],s=o+o;e=i*(u=i+i);var l=i*(h=r+r),i=i*s,c=r*h,r=r*s,o=o*s,u=a*u,h=a*h,a=a*s;return n[0]=1-(c+o),n[1]=l+a,n[2]=i-h,n[3]=0,n[4]=l-a,n[5]=1-(e+o),n[6]=r+u,n[7]=0,n[8]=i+h,n[9]=r-u,n[10]=1-(e+c),n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n},str:function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+"]"}},d={create:function(e){var t=new v(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):t[0]=t[1]=t[2]=t[3]=0,t},createFrom:function(e,t,n,i){var r=new v(4);return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r},set:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},equal:function(e,t){return e===t||Math.abs(e[0]-t[0])<1e-6&&Math.abs(e[1]-t[1])<1e-6&&Math.abs(e[2]-t[2])<1e-6&&Math.abs(e[3]-t[3])<1e-6},identity:function(e){return(e=e||d.create())[0]=0,e[1]=0,e[2]=0,e[3]=1,e}},g=d.identity();d.calculateW=function(e,t){var n=e[0],i=e[1],r=e[2];return t&&e!==t?(t[0]=n,t[1]=i,t[2]=r,t[3]=-Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t):(e[3]=-Math.sqrt(Math.abs(1-n*n-i*i-r*r)),e)},d.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},d.inverse=function(e,t){var n=e[0],i=e[1],r=e[2],o=e[3],n=(n=n*n+i*i+r*r+o*o)?1/n:0;return t&&e!==t?(t[0]=-e[0]*n,t[1]=-e[1]*n,t[2]=-e[2]*n,t[3]=e[3]*n,t):(e[0]*=-n,e[1]*=-n,e[2]*=-n,e[3]*=n,e)},d.conjugate=function(e,t){return t&&e!==t?(t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t):(e[0]*=-1,e[1]*=-1,e[2]*=-1,e)},d.length=function(e){var t=e[0],n=e[1],i=e[2];return e=e[3],Math.sqrt(t*t+n*n+i*i+e*e)},d.normalize=function(e,t){t=t||e;var n=e[0],i=e[1],r=e[2],o=e[3],a=Math.sqrt(n*n+i*i+r*r+o*o);return 0===a?(t[0]=0,t[1]=0,t[2]=0,t[3]=0):(a=1/a,t[0]=n*a,t[1]=i*a,t[2]=r*a,t[3]=o*a),t},d.add=function(e,t,n){return n&&e!==n?(n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n):(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e[3]+=t[3],e)},d.multiply=function(e,t,n){n=n||e;var i=e[0],r=e[1],o=e[2];e=e[3];var a=t[0],s=t[1],l=t[2];return t=t[3],n[0]=i*t+e*a+r*l-o*s,n[1]=r*t+e*s+o*a-i*l,n[2]=o*t+e*l+i*s-r*a,n[3]=e*t-i*a-r*s-o*l,n},d.multiplyVec3=function(e,t,n){n=n||t;var i=t[0],r=t[1],o=t[2];t=e[0];var a=e[1],s=e[2],l=(e=e[3])*i+a*o-s*r,c=e*r+s*i-t*o,u=e*o+t*r-a*i,i=-t*i-a*r-s*o;return n[0]=l*e+i*-t+c*-s-u*-a,n[1]=c*e+i*-a+u*-t-l*-s,n[2]=u*e+i*-s+l*-a-c*-t,n},d.scale=function(e,t,n){return n&&e!==n?(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n):(e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e)},d.toMat3=function(e,t){t=t||m.create();var n=e[0],i=e[1],r=(l=e[2])+l,o=n*(c=n+n),a=n*(u=i+i),n=n*r,s=i*u,i=i*r,l=l*r,c=(h=e[3])*c,u=h*u,h=h*r;return t[0]=1-(s+l),t[1]=a+h,t[2]=n-u,t[3]=a-h,t[4]=1-(o+l),t[5]=i+c,t[6]=n+u,t[7]=i-c,t[8]=1-(o+s),t},d.toMat4=function(e,t){t=t||p.create();var n=e[0],i=e[1],r=(l=e[2])+l,o=n*(c=n+n),a=n*(u=i+i),n=n*r,s=i*u,i=i*r,l=l*r,c=(h=e[3])*c,u=h*u,h=h*r;return t[0]=1-(s+l),t[1]=a+h,t[2]=n-u,t[3]=0,t[4]=a-h,t[5]=1-(o+l),t[6]=i+c,t[7]=0,t[8]=n+u,t[9]=i-c,t[10]=1-(o+s),t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},d.slerp=function(e,t,n,i){i=i||e;var r,o,a=e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3];return 1<=Math.abs(a)?(i!==e&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]),i):(r=Math.acos(a),o=Math.sqrt(1-a*a),Math.abs(o)<.001?(i[0]=.5*e[0]+.5*t[0],i[1]=.5*e[1]+.5*t[1],i[2]=.5*e[2]+.5*t[2],i[3]=.5*e[3]+.5*t[3]):(a=Math.sin((1-n)*r)/o,n=Math.sin(n*r)/o,i[0]=e[0]*a+t[0]*n,i[1]=e[1]*a+t[1]*n,i[2]=e[2]*a+t[2]*n,i[3]=e[3]*a+t[3]*n),i)},d.fromRotationMatrix=function(e,t){t=t||d.create();var n,i,r,o=e[0]+e[4]+e[8];return 0<o?(r=Math.sqrt(o+1),t[3]=.5*r,r=.5/r,t[0]=(e[7]-e[5])*r,t[1]=(e[2]-e[6])*r,t[2]=(e[3]-e[1])*r):(r=d.fromRotationMatrix.s_iNext=d.fromRotationMatrix.s_iNext||[1,2,0],o=0,e[4]>e[0]&&(o=1),e[8]>e[3*o+o]&&(o=2),i=r[n=r[o]],r=Math.sqrt(e[3*o+o]-e[3*n+n]-e[3*i+i]+1),t[o]=.5*r,r=.5/r,t[3]=(e[3*i+n]-e[3*n+i])*r,t[n]=(e[3*n+o]+e[3*o+n])*r,t[i]=(e[3*i+o]+e[3*o+i])*r),t},m.toQuat4=d.fromRotationMatrix;var _=m.create();d.fromAxes=function(e,t,n,i){return _[0]=t[0],_[3]=t[1],_[6]=t[2],_[1]=n[0],_[4]=n[1],_[7]=n[2],_[2]=e[0],_[5]=e[1],_[8]=e[2],d.fromRotationMatrix(_,i)},d.identity=function(e){return(e=e||d.create())[0]=0,e[1]=0,e[2]=0,e[3]=1,e},d.fromAngleAxis=function(e,t,n){n=n||d.create(),e*=.5;var i=Math.sin(e);return n[3]=Math.cos(e),n[0]=i*t[0],n[1]=i*t[1],n[2]=i*t[2],n},d.toAngleAxis=function(e,t){t=t||e;var n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];return 0<n?(t[3]=2*Math.acos(e[3]),n=o.invsqrt(n),t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n):(t[3]=0,t[0]=1,t[1]=0,t[2]=0),t},d.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"};var y={create:function(e){var t=new v(2);return e?(t[0]=e[0],t[1]=e[1]):(t[0]=0,t[1]=0),t},createFrom:function(e,t){var n=new v(2);return n[0]=e,n[1]=t,n},add:function(e,t,n){return(n=n||t)[0]=e[0]+t[0],n[1]=e[1]+t[1],n},subtract:function(e,t,n){return(n=n||t)[0]=e[0]-t[0],n[1]=e[1]-t[1],n},multiply:function(e,t,n){return(n=n||t)[0]=e[0]*t[0],n[1]=e[1]*t[1],n},divide:function(e,t,n){return(n=n||t)[0]=e[0]/t[0],n[1]=e[1]/t[1],n},scale:function(e,t,n){return(n=n||e)[0]=e[0]*t,n[1]=e[1]*t,n},dist:function(e,t){var n=t[0]-e[0],i=t[1]-e[1];return Math.sqrt(n*n+i*i)},set:function(e,t){return t[0]=e[0],t[1]=e[1],t},equal:function(e,t){return e===t||Math.abs(e[0]-t[0])<1e-6&&Math.abs(e[1]-t[1])<1e-6},negate:function(e,t){return(t=t||e)[0]=-e[0],t[1]=-e[1],t},normalize:function(e,t){t=t||e;var n=e[0]*e[0]+e[1]*e[1];return 0<n?(n=Math.sqrt(n),t[0]=e[0]/n,t[1]=e[1]/n):t[0]=t[1]=0,t},cross:function(e,t,n){return e=e[0]*t[1]-e[1]*t[0],n?(n[0]=n[1]=0,n[2]=e,n):e},length:function(e){var t=e[0];return e=e[1],Math.sqrt(t*t+e*e)},squaredLength:function(e){var t=e[0];return t*t+(e=e[1])*e},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]},direction:function(e,t,n){n=n||e;var i=e[0]-t[0];return(t=i*i+(e=e[1]-t[1])*e)?(t=1/Math.sqrt(t),n[0]=i*t,n[1]=e*t):(n[0]=0,n[1]=0,n[2]=0),n},lerp:function(e,t,n,i){return(i=i||e)[0]=e[0]+n*(t[0]-e[0]),i[1]=e[1]+n*(t[1]-e[1]),i},str:function(e){return"["+e[0]+", "+e[1]+"]"}},b={create:function(e){var t=new v(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):t[0]=t[1]=t[2]=t[3]=0,t},createFrom:function(e,t,n,i){var r=new v(4);return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r},set:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},equal:function(e,t){return e===t||Math.abs(e[0]-t[0])<1e-6&&Math.abs(e[1]-t[1])<1e-6&&Math.abs(e[2]-t[2])<1e-6&&Math.abs(e[3]-t[3])<1e-6},identity:function(e){return(e=e||b.create())[0]=1,e[1]=0,e[2]=0,e[3]=1,e},transpose:function(e,t){if(t&&e!==t)return t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t;var n=e[1];return e[1]=e[2],e[2]=n,e},determinant:function(e){return e[0]*e[3]-e[2]*e[1]},inverse:function(e,t){t=t||e;var n=e[0],i=e[1],r=e[2],o=e[3],a=n*o-r*i;return a?(a=1/a,t[0]=o*a,t[1]=-i*a,t[2]=-r*a,t[3]=n*a,t):null},multiply:function(e,t,n){n=n||e;var i=e[0],r=e[1],o=e[2];return e=e[3],n[0]=i*t[0]+r*t[2],n[1]=i*t[1]+r*t[3],n[2]=o*t[0]+e*t[2],n[3]=o*t[1]+e*t[3],n},rotate:function(e,t,n){n=n||e;var i=e[0],r=e[1],o=e[2];e=e[3];var a=Math.sin(t);return t=Math.cos(t),n[0]=i*t+r*a,n[1]=i*-a+r*t,n[2]=o*t+e*a,n[3]=o*-a+e*t,n},multiplyVec2:function(e,t,n){n=n||t;var i=t[0];return t=t[1],n[0]=i*e[0]+t*e[1],n[1]=i*e[2]+t*e[3],n},scale:function(e,t,n){n=n||e;var i=e[1],r=e[2],o=e[3],a=t[0];return t=t[1],n[0]=e[0]*a,n[1]=i*t,n[2]=r*a,n[3]=o*t,n},str:function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"}},x={create:function(e){var t=new v(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t},createFrom:function(e,t,n,i){var r=new v(4);return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r},add:function(e,t,n){return(n=n||t)[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n},subtract:function(e,t,n){return(n=n||t)[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n},multiply:function(e,t,n){return(n=n||t)[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n[3]=e[3]*t[3],n},divide:function(e,t,n){return(n=n||t)[0]=e[0]/t[0],n[1]=e[1]/t[1],n[2]=e[2]/t[2],n[3]=e[3]/t[3],n},scale:function(e,t,n){return(n=n||e)[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n},set:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},equal:function(e,t){return e===t||Math.abs(e[0]-t[0])<1e-6&&Math.abs(e[1]-t[1])<1e-6&&Math.abs(e[2]-t[2])<1e-6&&Math.abs(e[3]-t[3])<1e-6},negate:function(e,t){return(t=t||e)[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},length:function(e){var t=e[0],n=e[1],i=e[2];return e=e[3],Math.sqrt(t*t+n*n+i*i+e*e)},squaredLength:function(e){var t=e[0],n=e[1],i=e[2];return t*t+n*n+i*i+(e=e[3])*e},lerp:function(e,t,n,i){return(i=i||e)[0]=e[0]+n*(t[0]-e[0]),i[1]=e[1]+n*(t[1]-e[1]),i[2]=e[2]+n*(t[2]-e[2]),i[3]=e[3]+n*(t[3]-e[3]),i},str:function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"}};return e&&(e.glMatrixArrayType=v,e.MatrixArray=v,e.setMatrixArrayType=t,e.determineMatrixArrayType=n,e.glMath=o,e.vec2=y,e.vec3=a,e.vec4=x,e.mat2=b,e.mat3=m,e.mat4=p,e.quat4=d),{glMatrixArrayType:v,MatrixArray:v,setMatrixArrayType:t,determineMatrixArrayType:n,glMath:o,vec2:y,vec3:a,vec4:x,mat2:b,mat3:m,mat4:p,quat4:d}}),ChemDoodle.animations=function(o){var e={};return o.requestAnimFrame=o.requestAnimationFrame||o.webkitRequestAnimationFrame||o.mozRequestAnimationFrame||o.oRequestAnimationFrame||o.msRequestAnimationFrame||function(e){o.setTimeout(e,1e3/60)},e.requestInterval=function(t,n){if(!(o.requestAnimationFrame||o.webkitRequestAnimationFrame||o.mozRequestAnimationFrame&&o.mozCancelRequestAnimationFrame||o.oRequestAnimationFrame||o.msRequestAnimationFrame))return o.setInterval(t,n);var i=(new Date).getTime(),r={};return r.value=o.requestAnimFrame(function e(){(new Date).getTime()-i>=n&&(t.call(),i=(new Date).getTime()),r.value=o.requestAnimFrame(e)}),r},e.clearRequestInterval=function(e){o.cancelAnimationFrame?o.cancelAnimationFrame(e.value):o.webkitCancelAnimationFrame?o.webkitCancelAnimationFrame(e.value):o.webkitCancelRequestAnimationFrame?o.webkitCancelRequestAnimationFrame(e.value):o.mozCancelRequestAnimationFrame?o.mozCancelRequestAnimationFrame(e.value):o.oCancelRequestAnimationFrame?o.oCancelRequestAnimationFrame(e.value):o.msCancelRequestAnimationFrame?o.msCancelRequestAnimationFrame(e.value):clearInterval(e)},e.requestTimeout=function(t,n){if(!(o.requestAnimationFrame||o.webkitRequestAnimationFrame||o.mozRequestAnimationFrame&&o.mozCancelRequestAnimationFrame||o.oRequestAnimationFrame||o.msRequestAnimationFrame))return o.setTimeout(t,n);var i=(new Date).getTime(),r={};return r.value=o.requestAnimFrame(function e(){(new Date).getTime()-i>=n?t.call():r.value=o.requestAnimFrame(e)}),r},e.clearRequestTimeout=function(e){o.cancelAnimationFrame?o.cancelAnimationFrame(e.value):o.webkitCancelAnimationFrame?o.webkitCancelAnimationFrame(e.value):o.webkitCancelRequestAnimationFrame?o.webkitCancelRequestAnimationFrame(e.value):o.mozCancelRequestAnimationFrame?o.mozCancelRequestAnimationFrame(e.value):o.oCancelRequestAnimationFrame?o.oCancelRequestAnimationFrame(e.value):o.msCancelRequestAnimationFrame?o.msCancelRequestAnimationFrame(e.value):clearTimeout(e)},e}(window),ChemDoodle.extensions=function(d,r,o){return{stringStartsWith:function(e,t){return e.slice(0,t.length)===t},vec3AngleFrom:function(e,t){var n=r.length(e),i=r.length(t),n=r.dot(e,t)/n/i;return o.acos(n)},contextHashTo:function(e,t,n,i,r,o,a){var s=0,l=new d.Point(t,n).distance(new d.Point(i,r)),c=!1,u=t,h=n;for(t=i-t,n=r-n;s<l;){if(c){if(l<s+a){e.moveTo(i,r);break}var f=a/l,u=u+f*t,h=h+f*n;e.moveTo(u,h),s+=a}else{if(l<s+o){e.lineTo(i,r);break}u+=(f=o/l)*t,h+=f*n,e.lineTo(u,h),s+=o}c=!c}},contextRoundRect:function(e,t,n,i,r,o){e.beginPath(),e.moveTo(t+o,n),e.lineTo(t+i-o,n),e.quadraticCurveTo(t+i,n,t+i,n+o),e.lineTo(t+i,n+r-o),e.quadraticCurveTo(t+i,n+r,t+i-o,n+r),e.lineTo(t+o,n+r),e.quadraticCurveTo(t,n+r,t,n+r-o),e.lineTo(t,n+o),e.quadraticCurveTo(t,n,t+o,n),e.closePath()},contextEllipse:function(e,t,n,i,r){var o=i/2*.5522848,a=r/2*.5522848,s=t+i,l=n+r;i=t+i/2,r=n+r/2,e.beginPath(),e.moveTo(t,r),e.bezierCurveTo(t,r-a,i-o,n,i,n),e.bezierCurveTo(i+o,n,s,r-a,s,r),e.bezierCurveTo(s,r+a,i+o,l,i,l),e.bezierCurveTo(i-o,l,t,r+a,t,r),e.closePath()},getFontString:function(e,t,n,i){var r=[];for(n&&r.push("bold "),i&&r.push("italic "),r.push(e+"px "),e=0,n=t.length;e<n;e++)-1!==(i=t[e]).indexOf(" ")&&(i='"'+i+'"'),r.push((0!==e?",":"")+i);return r.join("")}}}(ChemDoodle.structures,ChemDoodle.lib.vec3,Math),ChemDoodle.math=function(e,r,o,t,s){var a={},l={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return a.angleBetweenLargest=function(e){if(0===e.length)return{angle:0,largest:2*s.PI};if(1===e.length)return{angle:e[0]+s.PI,largest:2*s.PI};for(var t=0,n=0,i=0,r=e.length-1;i<r;i++){var o=e[i+1]-e[i];t<o&&(t=o,n=(e[i+1]+e[i])/2)}return t<(i=e[0]+2*s.PI-e[e.length-1])&&(t=i,(n=e[0]-i/2)<0&&(n+=2*s.PI)),{angle:n,largest:t}},a.isBetween=function(e,t,n){var i;return n<t&&(i=t,t=n,n=i),t<=e&&e<=n},t(document).ready(function(){e.iChemLabs.checkForUpdates({})}),a.getRGB=function(e,t){var n=[0,0,0];if(l[e.toLowerCase()]&&(e=l[e.toLowerCase()]),"#"===e.charAt(0))return 4===e.length&&(e="#"+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)+e.charAt(3)+e.charAt(3)),[parseInt(e.substring(1,3),16)/255*t,parseInt(e.substring(3,5),16)/255*t,parseInt(e.substring(5,7),16)/255*t];if(r.stringStartsWith(e,"rgb")){var i=e.replace(/rgb\(|\)/g,"").split(",");return 3!==i.length?n:[parseInt(i[0])/255*t,parseInt(i[1])/255*t,parseInt(i[2])/255*t]}return n},a.idx2color=function(e){for(var t=0,n=6-(e=e.toString(16)).length;t<n;t++)e="0"+e;return"#"+e},a.distanceFromPointToLineInclusive=function(e,t,n){var i=t.distance(n);return n=t.angle(n),n=s.PI/2-n,n=t.angle(e)+n,e=t.distance(e),e=new o.Point(e*s.cos(n),-e*s.sin(n)),a.isBetween(-e.y,0,i)?s.abs(e.x):-1},a.calculateDistanceInterior=function(e,t,n){if(this.isBetween(t.x,n.x,n.x+n.w)&&this.isBetween(t.y,n.y,n.y+n.w))return e.distance(t);var i=[];i.push({x1:n.x,y1:n.y,x2:n.x+n.w,y2:n.y}),i.push({x1:n.x,y1:n.y+n.h,x2:n.x+n.w,y2:n.y+n.h}),i.push({x1:n.x,y1:n.y,x2:n.x,y2:n.y+n.h}),i.push({x1:n.x+n.w,y1:n.y,x2:n.x+n.w,y2:n.y+n.h}),n=[];for(var r=0;r<4;r++){var o=i[r];(o=this.intersectLines(t.x,t.y,e.x,e.y,o.x1,o.y1,o.x2,o.y2))&&n.push(o)}if(0===n.length)return 0;for(r=t=0,i=n.length;r<i;r++){var o=n[r],a=e.x-o.x,o=e.y-o.y;t=s.max(t,s.sqrt(a*a+o*o))}return t},a.intersectLines=function(e,t,n,i,r,o,a,s){var l=(i-=t)*(a-=r)-(n-=e)*(s-=o);return 0!=l&&(a=(s*(e-r)-a*(t-o))/l,0<=(r=(i*(e-r)-n*(t-o))/l)&&r<=1&&0<=a&&a<=1&&{x:e+a*n,y:t+a*i})},a.hsl2rgb=function(e,t,n){function i(e,t,n){return n<0?n+=1:1<n&&--n,n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}var r,o;return 0===t?n=t=e=n:(n=i(o=2*n-(r=n<.5?n*(1+t):n+t-n*t),r,e+1/3),t=i(o,r,e),e=i(o,r,e-1/3)),[255*n,255*t,255*e]},a.isPointInPoly=function(e,t){for(var n=!1,i=-1,r=e.length,o=r-1;++i<r;o=i)(e[i].y<=t.y&&t.y<e[o].y||e[o].y<=t.y&&t.y<e[i].y)&&t.x<(e[o].x-e[i].x)*(t.y-e[i].y)/(e[o].y-e[i].y)+e[i].x&&(n=!n);return n},a.clamp=function(e,t,n){return e<t?t:n<e?n:e},a.rainbowAt=function(e,t,n){n.length<1?n.push("#000000","#FFFFFF"):n.length<2&&n.push("#FFFFFF");var i=t/(n.length-1);return e=(e-(t=s.floor(e/i))*i)/i,i=a.getRGB(n[t],1),n=a.getRGB(n[t+1],1),"rgb("+[255*(i[0]+(n[0]-i[0])*e),255*(i[1]+(n[1]-i[1])*e),255*(i[2]+(n[2]-i[2])*e)].join()+")"},a.angleBounds=function(e,t,n){for(var i=2*s.PI;e<0;)e+=i;for(;i<e;)e-=i;return n&&e>s.PI&&(e=2*s.PI-e),t&&(e=180*e/s.PI),e},a}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.lib.jQuery,Math),function(r,a){r.Bounds=function(){};var e=r.Bounds.prototype;e.minX=e.minY=e.minZ=1/0,e.maxX=e.maxY=e.maxZ=-1/0,e.expand=function(e,t,n,i){e instanceof r.Bounds?(this.minX=a.min(this.minX,e.minX),this.minY=a.min(this.minY,e.minY),this.maxX=a.max(this.maxX,e.maxX),this.maxY=a.max(this.maxY,e.maxY),1/0!==e.maxZ&&(this.minZ=a.min(this.minZ,e.minZ),this.maxZ=a.max(this.maxZ,e.maxZ))):(this.minX=a.min(this.minX,e),this.maxX=a.max(this.maxX,e),this.minY=a.min(this.minY,t),this.maxY=a.max(this.maxY,t),void 0!==n&&void 0!==i&&(this.minX=a.min(this.minX,n),this.maxX=a.max(this.maxX,n),this.minY=a.min(this.minY,i),this.maxY=a.max(this.maxY,i)))},e.expand3D=function(e,t,n,i,r,o){this.minX=a.min(this.minX,e),this.maxX=a.max(this.maxX,e),this.minY=a.min(this.minY,t),this.maxY=a.max(this.maxY,t),this.minZ=a.min(this.minZ,n),this.maxZ=a.max(this.maxZ,n),void 0!==i&&void 0!==r&&void 0!==o&&(this.minX=a.min(this.minX,i),this.maxX=a.max(this.maxX,i),this.minY=a.min(this.minY,r),this.maxY=a.max(this.maxY,r),this.minZ=a.min(this.minZ,o),this.maxZ=a.max(this.maxZ,o))}}(ChemDoodle.math,Math),function(){function i(e,t){for(var n=[],i=t.length-1,r=2*i-1,o=[],a=[],s=[],l=[],c=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],u=0;u<=i;u++)o[u]=f(t[u],e);for(u=0;u<=i-1;u++)a[u]=f(t[u+1],t[u]),a[u]=m(a[u],3);for(u=0;u<=i-1;u++)for(var h=0;h<=i;h++)s[u]||(s[u]=[]),s[u][h]=d(a[u],o[h]);for(u=0;u<=r;u++)l[u]||(l[u]=[]),l[u].y=0,l[u].x=parseFloat(u)/r;for(r=i-1,o=0;o<=i+r;o++)for(u=Math.max(0,o-r),a=Math.min(o,i);u<=a;u++)l[u+(h=o-u)].y+=s[h][u]*c[h][u];for(i=t.length-1,l=v(l,2*i-1,n,0),r=f(e,t[0]),s=p(r),u=c=0;u<l;u++)r=f(e,_(t,i,n[u],null,null)),(r=p(r))<s&&(s=r,c=n[u]);return r=f(e,t[i]),(r=p(r))<s&&(s=r,c=1),{location:c,distance:s}}function s(e,t){var n=e.length-1,i=h[n];if(!i){var r=function(e){return function(){return e}},o=function(){return function(e){return e}},a=function(){return function(e){return 1-e}},s=function(i){return function(e){for(var t=1,n=0;n<i.length;n++)t*=i[n](e);return t}};(i=[]).push(new function(){return function(e){return Math.pow(e,n)}});for(var l=1;l<n;l++){for(var c=[new r(n)],u=0;u<n-l;u++)c.push(new o);for(u=0;u<l;u++)c.push(new a);i.push(new s(c))}i.push(new function(){return function(e){return Math.pow(1-e,n)}}),h[n]=i}for(a=o=r=0;a<e.length;a++)r+=e[a].x*i[a](t),o+=e[a].y*i[a](t);return{x:r,y:o}}function l(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function r(e,t,n){for(var i=s(e,t),r=0,o=0<n?1:-1,a=null;r<Math.abs(n);)a=s(e,t+=.005*o),r+=l(a,i),i=a;return{point:a,location:t}}function o(e,t){var n=s(e,t),i=s(e.slice(0,e.length-1),t),r=i.y-n.y,n=i.x-n.x;return 0==r?1/0:Math.atan(r/n)}var f=function(e,t){return{x:e.x-t.x,y:e.y-t.y}},d=function(e,t){return e.x*t.x+e.y*t.y},p=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},m=function(e,t){return{x:e.x*t,y:e.y*t}},g=Math.pow(2,-65),v=function(e,t,n,i){var r=[],o=[],a=[],s=[],l=0;d=0==e[0].y?0:0<e[0].y?1:-1;for(var c=1;c<=t;c++)(f=0==e[c].y?0:0<e[c].y?1:-1)!=d&&l++,d=f;switch(l){case 0:return 0;case 1:if(64<=i)return n[0]=(e[0].x+e[t].x)/2,1;for(var u,h,l=e[0].y-e[t].y,f=e[t].x-e[0].x,d=e[0].x*e[t].y-e[t].x*e[0].y,c=u=0,p=1;p<t;p++)u<(h=l*e[p].x+f*e[p].y+d)?u=h:h<c&&(c=h);if(u=1/(p=0*(h=f)-l)*(d-u-0*h),l=1/(p=0*(h=f)-l)*(d-c-0*h),f=Math.min(u,l),Math.max(u,l)-f<g)return a=e[t].x-e[0].x,s=e[t].y-e[0].y,n[0]=0+(a*e[0].y-s*e[0].x)*(1/(0*a-s)),1}for(_(e,t,.5,r,o),e=v(r,t,a,i+1),t=v(o,t,s,i+1),i=0;i<e;i++)n[i]=a[i];for(i=0;i<t;i++)n[i+e]=s[i];return e+t},_=function(e,t,n,i,r){for(var o=[[]],a=0;a<=t;a++)o[0][a]=e[a];for(e=1;e<=t;e++)for(a=0;a<=t-e;a++)o[e]||(o[e]=[]),o[e][a]||(o[e][a]={}),o[e][a].x=(1-n)*o[e-1][a].x+n*o[e-1][a+1].x,o[e][a].y=(1-n)*o[e-1][a].y+n*o[e-1][a+1].y;if(null!=i)for(a=0;a<=t;a++)i[a]=o[a][0];if(null!=r)for(a=0;a<=t;a++)r[a]=o[t-a][a];return o[t][0]},h={};ChemDoodle.math.jsBezier={distanceFromCurve:i,gradientAtPoint:o,gradientAtPointAlongCurveFrom:function(e,t,n){return 1<(t=r(e,t,n)).location&&(t.location=1),t.location<0&&(t.location=0),o(e,t.location)},nearestPointOnCurve:function(e,t){var n=i(e,t);return{point:_(t,t.length-1,n.location,null,null),location:n.location}},pointOnCurve:s,pointAlongCurveFrom:function(e,t,n){return r(e,t,n).point},perpendicularToCurveAt:function(e,t,n,i){return t=r(e,t,null==i?0:i),e=o(e,t.location),i=Math.atan(-1/e),e=n/2*Math.sin(i),n=n/2*Math.cos(i),[{x:t.point.x+n,y:t.point.y+e},{x:t.point.x-n,y:t.point.y-e}]},locationAlongCurveFrom:function(e,t,n){return r(e,t,n).location},getLength:function(e){for(var t=s(e,0),n=0,i=0,r=null;i<1;)r=s(e,i+=.005),n+=l(r,t),t=r;return n}}}(ChemDoodle.math),ChemDoodle.featureDetection=function(e,t,n){var i={supports_canvas:function(){return!!t.createElement("canvas").getContext},supports_canvas_text:function(){return!!i.supports_canvas()&&"function"==typeof t.createElement("canvas").getContext("2d").fillText},supports_webgl:function(){var e=t.createElement("canvas");try{if(e.getContext("webgl")||e.getContext("experimental-webgl"))return!0}catch(e){}return!1},supports_xhr2:function(){return e.support.cors},supports_touch:function(){return"ontouchstart"in n&&navigator.userAgent.match(/iPhone|iPad|iPod|Android|BlackBerry|BB10/i)},supports_gesture:function(){return"ongesturestart"in n}};return i}((ChemDoodle.iChemLabs,ChemDoodle.lib.jQuery),document,window),ChemDoodle.SYMBOLS="H He Li Be B C N O F Ne Na Mg Al Si P S Cl Ar K Ca Sc Ti V Cr Mn Fe Co Ni Cu Zn Ga Ge As Se Br Kr Rb Sr Y Zr Nb Mo Tc Ru Rh Pd Ag Cd In Sn Sb Te I Xe Cs Ba La Ce Pr Nd Pm Sm Eu Gd Tb Dy Ho Er Tm Yb Lu Hf Ta W Re Os Ir Pt Au Hg Tl Pb Bi Po At Rn Fr Ra Ac Th Pa U Np Pu Am Cm Bk Cf Es Fm Md No Lr Rf Db Sg Bh Hs Mt Ds Rg Cn Uut Uuq Uup Uuh Uus Uuo".split(" "),ChemDoodle.ELEMENT=function(){function e(e,t,n,i,r,o,a,s,l){this.symbol=e,this.name=t,this.atomicNumber=n,this.addH=i,this.jmolColor=this.pymolColor=r,this.covalentRadius=o,this.vdWRadius=a,this.valency=s,this.mass=l}var t=[];return t.H=new e("H","Hydrogen",1,!1,"#FFFFFF",.31,1.2,1,1),t.He=new e("He","Helium",2,!1,"#D9FFFF",.28,1.4,0,4),t.Li=new e("Li","Lithium",3,!1,"#CC80FF",1.28,1.82,1,7),t.Be=new e("Be","Beryllium",4,!1,"#C2FF00",.96,0,2,9),t.B=new e("B","Boron",5,!0,"#FFB5B5",.84,0,3,11),t.C=new e("C","Carbon",6,!0,"#909090",.76,1.7,4,12),t.N=new e("N","Nitrogen",7,!0,"#3050F8",.71,1.55,3,14),t.O=new e("O","Oxygen",8,!0,"#FF0D0D",.66,1.52,2,16),t.F=new e("F","Fluorine",9,!0,"#90E050",.57,1.47,1,19),t.Ne=new e("Ne","Neon",10,!1,"#B3E3F5",.58,1.54,0,20),t.Na=new e("Na","Sodium",11,!1,"#AB5CF2",1.66,2.27,1,23),t.Mg=new e("Mg","Magnesium",12,!1,"#8AFF00",1.41,1.73,0,24),t.Al=new e("Al","Aluminum",13,!1,"#BFA6A6",1.21,0,0,27),t.Si=new e("Si","Silicon",14,!0,"#F0C8A0",1.11,2.1,4,28),t.P=new e("P","Phosphorus",15,!0,"#FF8000",1.07,1.8,3,31),t.S=new e("S","Sulfur",16,!0,"#FFFF30",1.05,1.8,2,32),t.Cl=new e("Cl","Chlorine",17,!0,"#1FF01F",1.02,1.75,1,35),t.Ar=new e("Ar","Argon",18,!1,"#80D1E3",1.06,1.88,0,40),t.K=new e("K","Potassium",19,!1,"#8F40D4",2.03,2.75,0,39),t.Ca=new e("Ca","Calcium",20,!1,"#3DFF00",1.76,0,0,40),t.Sc=new e("Sc","Scandium",21,!1,"#E6E6E6",1.7,0,0,45),t.Ti=new e("Ti","Titanium",22,!1,"#BFC2C7",1.6,0,1,48),t.V=new e("V","Vanadium",23,!1,"#A6A6AB",1.53,0,1,51),t.Cr=new e("Cr","Chromium",24,!1,"#8A99C7",1.39,0,2,52),t.Mn=new e("Mn","Manganese",25,!1,"#9C7AC7",1.39,0,3,55),t.Fe=new e("Fe","Iron",26,!1,"#E06633",1.32,0,2,56),t.Co=new e("Co","Cobalt",27,!1,"#F090A0",1.26,0,1,59),t.Ni=new e("Ni","Nickel",28,!1,"#50D050",1.24,1.63,1,58),t.Cu=new e("Cu","Copper",29,!1,"#C88033",1.32,1.4,0,63),t.Zn=new e("Zn","Zinc",30,!1,"#7D80B0",1.22,1.39,0,64),t.Ga=new e("Ga","Gallium",31,!1,"#C28F8F",1.22,1.87,0,69),t.Ge=new e("Ge","Germanium",32,!1,"#668F8F",1.2,0,4,74),t.As=new e("As","Arsenic",33,!0,"#BD80E3",1.19,1.85,3,75),t.Se=new e("Se","Selenium",34,!0,"#FFA100",1.2,1.9,2,80),t.Br=new e("Br","Bromine",35,!0,"#A62929",1.2,1.85,1,79),t.Kr=new e("Kr","Krypton",36,!1,"#5CB8D1",1.16,2.02,0,84),t.Rb=new e("Rb","Rubidium",37,!1,"#702EB0",2.2,0,0,85),t.Sr=new e("Sr","Strontium",38,!1,"#00FF00",1.95,0,0,88),t.Y=new e("Y","Yttrium",39,!1,"#94FFFF",1.9,0,0,89),t.Zr=new e("Zr","Zirconium",40,!1,"#94E0E0",1.75,0,0,90),t.Nb=new e("Nb","Niobium",41,!1,"#73C2C9",1.64,0,1,93),t.Mo=new e("Mo","Molybdenum",42,!1,"#54B5B5",1.54,0,2,98),t.Tc=new e("Tc","Technetium",43,!1,"#3B9E9E",1.47,0,3,0),t.Ru=new e("Ru","Ruthenium",44,!1,"#248F8F",1.46,0,2,102),t.Rh=new e("Rh","Rhodium",45,!1,"#0A7D8C",1.42,0,1,103),t.Pd=new e("Pd","Palladium",46,!1,"#006985",1.39,1.63,0,106),t.Ag=new e("Ag","Silver",47,!1,"#C0C0C0",1.45,1.72,0,107),t.Cd=new e("Cd","Cadmium",48,!1,"#FFD98F",1.44,1.58,0,114),t.In=new e("In","Indium",49,!1,"#A67573",1.42,1.93,0,115),t.Sn=new e("Sn","Tin",50,!1,"#668080",1.39,2.17,4,120),t.Sb=new e("Sb","Antimony",51,!1,"#9E63B5",1.39,0,3,121),t.Te=new e("Te","Tellurium",52,!0,"#D47A00",1.38,2.06,2,130),t.I=new e("I","Iodine",53,!0,"#940094",1.39,1.98,1,127),t.Xe=new e("Xe","Xenon",54,!1,"#429EB0",1.4,2.16,0,132),t.Cs=new e("Cs","Cesium",55,!1,"#57178F",2.44,0,0,133),t.Ba=new e("Ba","Barium",56,!1,"#00C900",2.15,0,0,138),t.La=new e("La","Lanthanum",57,!1,"#70D4FF",2.07,0,0,139),t.Ce=new e("Ce","Cerium",58,!1,"#FFFFC7",2.04,0,0,140),t.Pr=new e("Pr","Praseodymium",59,!1,"#D9FFC7",2.03,0,0,141),t.Nd=new e("Nd","Neodymium",60,!1,"#C7FFC7",2.01,0,0,142),t.Pm=new e("Pm","Promethium",61,!1,"#A3FFC7",1.99,0,0,0),t.Sm=new e("Sm","Samarium",62,!1,"#8FFFC7",1.98,0,0,152),t.Eu=new e("Eu","Europium",63,!1,"#61FFC7",1.98,0,0,153),t.Gd=new e("Gd","Gadolinium",64,!1,"#45FFC7",1.96,0,0,158),t.Tb=new e("Tb","Terbium",65,!1,"#30FFC7",1.94,0,0,159),t.Dy=new e("Dy","Dysprosium",66,!1,"#1FFFC7",1.92,0,0,164),t.Ho=new e("Ho","Holmium",67,!1,"#00FF9C",1.92,0,0,165),t.Er=new e("Er","Erbium",68,!1,"#00E675",1.89,0,0,166),t.Tm=new e("Tm","Thulium",69,!1,"#00D452",1.9,0,0,169),t.Yb=new e("Yb","Ytterbium",70,!1,"#00BF38",1.87,0,0,174),t.Lu=new e("Lu","Lutetium",71,!1,"#00AB24",1.87,0,0,175),t.Hf=new e("Hf","Hafnium",72,!1,"#4DC2FF",1.75,0,0,180),t.Ta=new e("Ta","Tantalum",73,!1,"#4DA6FF",1.7,0,1,181),t.W=new e("W","Tungsten",74,!1,"#2194D6",1.62,0,2,184),t.Re=new e("Re","Rhenium",75,!1,"#267DAB",1.51,0,3,187),t.Os=new e("Os","Osmium",76,!1,"#266696",1.44,0,2,192),t.Ir=new e("Ir","Iridium",77,!1,"#175487",1.41,0,3,193),t.Pt=new e("Pt","Platinum",78,!1,"#D0D0E0",1.36,1.75,0,195),t.Au=new e("Au","Gold",79,!1,"#FFD123",1.36,1.66,1,197),t.Hg=new e("Hg","Mercury",80,!1,"#B8B8D0",1.32,1.55,0,202),t.Tl=new e("Tl","Thallium",81,!1,"#A6544D",1.45,1.96,0,205),t.Pb=new e("Pb","Lead",82,!1,"#575961",1.46,2.02,4,208),t.Bi=new e("Bi","Bismuth",83,!1,"#9E4FB5",1.48,0,3,209),t.Po=new e("Po","Polonium",84,!1,"#AB5C00",1.4,0,2,0),t.At=new e("At","Astatine",85,!0,"#754F45",1.5,0,1,0),t.Rn=new e("Rn","Radon",86,!1,"#428296",1.5,0,0,0),t.Fr=new e("Fr","Francium",87,!1,"#420066",2.6,0,0,0),t.Ra=new e("Ra","Radium",88,!1,"#007D00",2.21,0,0,0),t.Ac=new e("Ac","Actinium",89,!1,"#70ABFA",2.15,0,0,0),t.Th=new e("Th","Thorium",90,!1,"#00BAFF",2.06,0,0,232),t.Pa=new e("Pa","Protactinium",91,!1,"#00A1FF",2,0,0,231),t.U=new e("U","Uranium",92,!1,"#008FFF",1.96,1.86,0,238),t.Np=new e("Np","Neptunium",93,!1,"#0080FF",1.9,0,0,0),t.Pu=new e("Pu","Plutonium",94,!1,"#006BFF",1.87,0,0,0),t.Am=new e("Am","Americium",95,!1,"#545CF2",1.8,0,0,0),t.Cm=new e("Cm","Curium",96,!1,"#785CE3",1.69,0,0,0),t.Bk=new e("Bk","Berkelium",97,!1,"#8A4FE3",0,0,0,0),t.Cf=new e("Cf","Californium",98,!1,"#A136D4",0,0,0,0),t.Es=new e("Es","Einsteinium",99,!1,"#B31FD4",0,0,0,0),t.Fm=new e("Fm","Fermium",100,!1,"#B31FBA",0,0,0,0),t.Md=new e("Md","Mendelevium",101,!1,"#B30DA6",0,0,0,0),t.No=new e("No","Nobelium",102,!1,"#BD0D87",0,0,0,0),t.Lr=new e("Lr","Lawrencium",103,!1,"#C70066",0,0,0,0),t.Rf=new e("Rf","Rutherfordium",104,!1,"#CC0059",0,0,0,0),t.Db=new e("Db","Dubnium",105,!1,"#D1004F",0,0,0,0),t.Sg=new e("Sg","Seaborgium",106,!1,"#D90045",0,0,0,0),t.Bh=new e("Bh","Bohrium",107,!1,"#E00038",0,0,0,0),t.Hs=new e("Hs","Hassium",108,!1,"#E6002E",0,0,0,0),t.Mt=new e("Mt","Meitnerium",109,!1,"#EB0026",0,0,0,0),t.Ds=new e("Ds","Darmstadtium",110,!1,"#000000",0,0,0,0),t.Rg=new e("Rg","Roentgenium",111,!1,"#000000",0,0,0,0),t.Cn=new e("Cn","Copernicium",112,!1,"#000000",0,0,0,0),t.Uut=new e("Uut","Ununtrium",113,!1,"#000000",0,0,0,0),t.Uuq=new e("Uuq","Ununquadium",114,!1,"#000000",0,0,0,0),t.Uup=new e("Uup","Ununpentium",115,!1,"#000000",0,0,0,0),t.Uuh=new e("Uuh","Ununhexium",116,!1,"#000000",0,0,0,0),t.Uus=new e("Uus","Ununseptium",117,!1,"#000000",0,0,0,0),t.Uuo=new e("Uuo","Ununoctium",118,!1,"#000000",0,0,0,0),t.H.pymolColor="#E6E6E6",t.C.pymolColor="#33FF33",t.N.pymolColor="#3333FF",t.O.pymolColor="#FF4D4D",t.F.pymolColor="#B3FFFF",t.S.pymolColor="#E6C640",t}(ChemDoodle.SYMBOLS),ChemDoodle.RESIDUE=function(){function e(e,t,n,i,r,o){this.symbol=e,this.name=t,this.polar=n,this.aminoColor=i,this.shapelyColor=r,this.acidity=o}var t=[];return t.Ala=new e("Ala","Alanine",!1,"#C8C8C8","#8CFF8C",0),t.Arg=new e("Arg","Arginine",!0,"#145AFF","#00007C",1),t.Asn=new e("Asn","Asparagine",!0,"#00DCDC","#FF7C70",0),t.Asp=new e("Asp","Aspartic Acid",!0,"#E60A0A","#A00042",-1),t.Cys=new e("Cys","Cysteine",!0,"#E6E600","#FFFF70",0),t.Gln=new e("Gln","Glutamine",!0,"#00DCDC","#FF4C4C",0),t.Glu=new e("Glu","Glutamic Acid",!0,"#E60A0A","#660000",-1),t.Gly=new e("Gly","Glycine",!1,"#EBEBEB","#FFFFFF",0),t.His=new e("His","Histidine",!0,"#8282D2","#7070FF",1),t.Ile=new e("Ile","Isoleucine",!1,"#0F820F","#004C00",0),t.Leu=new e("Leu","Leucine",!1,"#0F820F","#455E45",0),t.Lys=new e("Lys","Lysine",!0,"#145AFF","#4747B8",1),t.Met=new e("Met","Methionine",!1,"#E6E600","#B8A042",0),t.Phe=new e("Phe","Phenylalanine",!1,"#3232AA","#534C52",0),t.Pro=new e("Pro","Proline",!1,"#DC9682","#525252",0),t.Ser=new e("Ser","Serine",!0,"#FA9600","#FF7042",0),t.Thr=new e("Thr","Threonine",!0,"#FA9600","#B84C00",0),t.Trp=new e("Trp","Tryptophan",!0,"#B45AB4","#4F4600",0),t.Tyr=new e("Tyr","Tyrosine",!0,"#3232AA","#8C704C",0),t.Val=new e("Val","Valine",!1,"#0F820F","#FF8CFF",0),t.Asx=new e("Asx","Asparagine/Aspartic Acid",!0,"#FF69B4","#FF00FF",0),t.Glx=new e("Glx","Glutamine/Glutamic Acid",!0,"#FF69B4","#FF00FF",0),t["*"]=new e("*","Other",!1,"#BEA06E","#FF00FF",0),t.A=new e("A","Adenine",!1,"#BEA06E","#A0A0FF",0),t.G=new e("G","Guanine",!1,"#BEA06E","#FF7070",0),t.I=new e("I","",!1,"#BEA06E","#80FFFF",0),t.C=new e("C","Cytosine",!1,"#BEA06E","#FF8C4B",0),t.T=new e("T","Thymine",!1,"#BEA06E","#A0FFA0",0),t.U=new e("U","Uracil",!1,"#BEA06E","#FF8080",0),t}(),function(e){e.Queue=function(){this.queue=[]},(e=e.Queue.prototype).queueSpace=0,e.getSize=function(){return this.queue.length-this.queueSpace},e.isEmpty=function(){return 0===this.queue.length},e.enqueue=function(e){this.queue.push(e)},e.dequeue=function(){var e;return this.queue.length&&(e=this.queue[this.queueSpace],2*++this.queueSpace>=this.queue.length&&(this.queue=this.queue.slice(this.queueSpace),this.queueSpace=0)),e},e.getOldestElement=function(){var e;return this.queue.length&&(e=this.queue[this.queueSpace]),e}}(ChemDoodle.structures),function(e,i){e.Point=function(e,t){this.x=e||0,this.y=t||0};var t=e.Point.prototype;t.sub=function(e){this.x-=e.x,this.y-=e.y},t.add=function(e){this.x+=e.x,this.y+=e.y},t.distance=function(e){var t=e.x-this.x;return e=e.y-this.y,i.sqrt(t*t+e*e)},t.angleForStupidCanvasArcs=function(e){var t=e.x-this.x;e=e.y-this.y;for(var n=0,n=0==t?0===e?0:0<e?i.PI/2:3*i.PI/2:0===e?0<t?0:i.PI:t<0?i.atan(e/t)+i.PI:e<0?i.atan(e/t)+2*i.PI:i.atan(e/t);n<0;)n+=2*i.PI;return n%(2*i.PI)},t.angle=function(e){var t=e.x-this.x;e=this.y-e.y;for(var n=0,n=0==t?0===e?0:0<e?i.PI/2:3*i.PI/2:0===e?0<t?0:i.PI:t<0?i.atan(e/t)+i.PI:e<0?i.atan(e/t)+2*i.PI:i.atan(e/t);n<0;)n+=2*i.PI;return n%(2*i.PI)}}(ChemDoodle.structures,Math),function(o,p,m,e,g,a){e.Atom=function(e,t,n,i){this.label=e?e.replace(/\s/g,""):"C",o[this.label]||(this.label="C"),this.x=t||0,this.y=n||0,this.z=i||0},(e=e.Atom.prototype=new e.Point(0,0)).charge=0,e.numLonePair=0,e.numRadical=0,e.mass=-1,e.coordinationNumber=0,e.bondNumber=0,e.angleOfLeastInterference=0,e.isHidden=!1,e.altLabel=void 0,e.any=!1,e.rgroup=-1,e.isLone=!1,e.isHover=!1,e.isSelected=!1,e.add3D=function(e){this.x+=e.x,this.y+=e.y,this.z+=e.z},e.sub3D=function(e){this.x-=e.x,this.y-=e.y,this.z-=e.z},e.distance3D=function(e){var t=e.x-this.x,n=e.y-this.y;return e=e.z-this.z,g.sqrt(t*t+n*n+e*e)},e.draw=function(e,t){this.isLassoed&&((o=e.createRadialGradient(this.x-1,this.y-1,0,this.x,this.y,7)).addColorStop(0,"rgba(212, 99, 0, 0)"),o.addColorStop(.7,"rgba(212, 99, 0, 0.8)"),e.fillStyle=o,e.beginPath(),e.arc(this.x,this.y,5,0,2*g.PI,!1),e.fill()),this.textBounds=[],this.specs&&(t=this.specs);var n,i,r,o,a,s,l,c,u,h,f,d=p.getFontString(t.atoms_font_size_2D,t.atoms_font_families_2D,t.atoms_font_bold_2D,t.atoms_font_italic_2D);if(e.font=d,e.fillStyle=this.getElementColor(t.atoms_useJMOLColors,t.atoms_usePYMOLColors,t.atoms_color,2),"H"===this.label&&t.atoms_HBlack_2D&&(e.fillStyle="black"),this.isLone&&!t.atoms_displayAllCarbonLabels_2D||t.atoms_circles_2D?(e.beginPath(),e.arc(this.x,this.y,t.atoms_circleDiameter_2D/2,0,2*g.PI,!1),e.fill(),0<t.atoms_circleBorderWidth_2D&&(e.lineWidth=t.atoms_circleBorderWidth_2D,e.strokeStyle="black",e.stroke())):this.isLabelVisible(t)&&(e.textAlign="center",e.textBaseline="middle",void 0!==this.altLabel?(e.fillText(this.altLabel,this.x,this.y),i=e.measureText(this.altLabel).width,this.textBounds.push({x:this.x-i/2,y:this.y-t.atoms_font_size_2D/2+1,w:i,h:t.atoms_font_size_2D-2})):this.any?(e.font=p.getFontString(t.atoms_font_size_2D+5,t.atoms_font_families_2D,!0),e.fillText("*",this.x+1,this.y+3),i=e.measureText("*").width,this.textBounds.push({x:this.x-i/2,y:this.y-t.atoms_font_size_2D/2+1,w:i,h:t.atoms_font_size_2D-2})):-1!==this.rgroup?(o="R"+this.rgroup,e.fillText(o,this.x,this.y),i=e.measureText(o).width,this.textBounds.push({x:this.x-i/2,y:this.y-t.atoms_font_size_2D/2+1,w:i,h:t.atoms_font_size_2D-2})):(e.fillText(this.label,this.x,this.y),i=e.measureText(this.label).width,this.textBounds.push({x:this.x-i/2,y:this.y-t.atoms_font_size_2D/2+1,w:i,h:t.atoms_font_size_2D-2}),r=0,-1!==this.mass&&(o=e.font,e.font=p.getFontString(.7*t.atoms_font_size_2D,t.atoms_font_families_2D,t.atoms_font_bold_2D,t.atoms_font_italic_2D),r=e.measureText(this.mass).width,e.fillText(this.mass,this.x-r-.5,this.y-t.atoms_font_size_2D/2+1),this.textBounds.push({x:this.x-i/2-r-.5,y:this.y-1.7*t.atoms_font_size_2D/2+1,w:r,h:t.atoms_font_size_2D/2-1}),e.font=o),o=i/2,a=this.getImplicitHydrogenCount(),t.atoms_implicitHydrogens_2D&&0<a&&(n=0,s=e.measureText("H").width,l=!0,1<a?(c=i/2+s/2,u=0,h=p.getFontString(.8*t.atoms_font_size_2D,t.atoms_font_families_2D,t.atoms_font_bold_2D,t.atoms_font_italic_2D),e.font=h,f=e.measureText(a).width,1===this.bondNumber?this.angleOfLeastInterference>g.PI/2&&this.angleOfLeastInterference<3*g.PI/2&&(c=-i/2-f-s/2-r/2,l=!1,n=g.PI):this.angleOfLeastInterference<=g.PI/4||(this.angleOfLeastInterference<3*g.PI/4?(c=0,u=.9*-t.atoms_font_size_2D,0!==this.charge&&(u-=.3*t.atoms_font_size_2D),l=!1,n=g.PI/2):this.angleOfLeastInterference<=5*g.PI/4?(c=-i/2-f-s/2-r/2,l=!1,n=g.PI):this.angleOfLeastInterference<7*g.PI/4&&(c=0,u=.9*t.atoms_font_size_2D,l=!1,n=3*g.PI/2)),e.font=d,e.fillText("H",this.x+c,this.y+u),e.font=h,e.fillText(a,this.x+c+s/2+f/2,this.y+u+.3*t.atoms_font_size_2D),this.textBounds.push({x:this.x+c-s/2,y:this.y+u-t.atoms_font_size_2D/2+1,w:s,h:t.atoms_font_size_2D-2}),this.textBounds.push({x:this.x+c+s/2,y:this.y+u+.3*t.atoms_font_size_2D-t.atoms_font_size_2D/2+1,w:f,h:.8*t.atoms_font_size_2D-2})):(c=i/2+s/2,u=0,1===this.bondNumber?this.angleOfLeastInterference>g.PI/2&&this.angleOfLeastInterference<3*g.PI/2&&(c=-i/2-s/2-r/2,l=!1,n=g.PI):this.angleOfLeastInterference<=g.PI/4||(this.angleOfLeastInterference<3*g.PI/4?(c=0,u=.9*-t.atoms_font_size_2D,l=!1,n=g.PI/2):this.angleOfLeastInterference<=5*g.PI/4?(c=-i/2-s/2-r/2,l=!1,n=g.PI):this.angleOfLeastInterference<7*g.PI/4&&(c=0,u=.9*t.atoms_font_size_2D,l=!1,n=3*g.PI/2)),e.fillText("H",this.x+c,this.y+u),this.textBounds.push({x:this.x+c-s/2,y:this.y+u-t.atoms_font_size_2D/2+1,w:s,h:t.atoms_font_size_2D-2})),l&&(o+=s)),0!==this.charge&&(d="1"===(d=this.charge.toFixed(0))?"+":"-1"===d?"–":p.stringStartsWith(d,"-")?d.substring(1)+"–":d+"+",o+=(i=e.measureText(d).width)/2,e.textAlign="center",e.textBaseline="middle",e.font=p.getFontString(g.floor(.8*t.atoms_font_size_2D),t.atoms_font_families_2D,t.atoms_font_bold_2D,t.atoms_font_italic_2D),e.fillText(d,this.x+o-1,this.y-t.atoms_font_size_2D/2+1),this.textBounds.push({x:this.x+o-i/2-1,y:this.y-1.8*t.atoms_font_size_2D/2+5,w:i,h:t.atoms_font_size_2D/2-1})))),0<this.numLonePair||0<this.numRadical){for(e.fillStyle="black",a=this.angles.slice(0),o=this.angleOfLeastInterference,d=this.largestAngle,void 0!==n&&(a.push(n),a.sort(),o=(d=m.angleBetweenLargest(a)).angle%(2*g.PI),d=d.largest),i=[],r=0;r<this.numLonePair;r++)i.push({t:2});for(r=0;r<this.numRadical;r++)i.push({t:1});if(void 0===n&&g.abs(d-2*g.PI/a.length)<g.PI/60)for(a=g.ceil(i.length/a.length),r=0,s=i.length;r<s;r+=a,o+=d)this.drawElectrons(e,t,i.slice(r,g.min(i.length,r+a)),o,d,n);else this.drawElectrons(e,t,i,o,d,n)}},e.drawElectrons=function(e,t,n,i,r,o){r=i-r/2+(o=r/(n.length+(0===this.bonds.length&&void 0===o?0:1)));for(var a=0;a<n.length;a++){var s=n[a];i=r+a*o;var l=this.x+Math.cos(i)*t.atoms_lonePairDistance_2D,c=this.y-Math.sin(i)*t.atoms_lonePairDistance_2D;2===s.t?(s=i+Math.PI/2,i=Math.cos(s)*t.atoms_lonePairSpread_2D/2,s=-Math.sin(s)*t.atoms_lonePairSpread_2D/2,e.beginPath(),e.arc(l+i,c+s,t.atoms_lonePairDiameter_2D,0,2*g.PI,!1),e.fill(),e.beginPath(),e.arc(l-i,c-s,t.atoms_lonePairDiameter_2D,0,2*g.PI,!1),e.fill()):1===s.t&&(e.beginPath(),e.arc(l,c,t.atoms_lonePairDiameter_2D,0,2*g.PI,!1),e.fill())}},e.drawDecorations=function(e){(this.isHover||this.isSelected)&&(e.strokeStyle=this.isHover?"#885110":"#0060B2",e.lineWidth=1.2,e.beginPath(),e.arc(this.x,this.y,this.isHover?7:15,0,2*g.PI,!1),e.stroke()),this.isOverlap&&(e.strokeStyle="#C10000",e.lineWidth=1.2,e.beginPath(),e.arc(this.x,this.y,7,0,2*g.PI,!1),e.stroke())},e.render=function(e,t,n){this.specs&&(t=this.specs);var i=a.translate(e.modelViewMatrix,[this.x,this.y,this.z],[]),r=t.atoms_useVDWDiameters_3D?o[this.label].vdWRadius*t.atoms_vdwMultiplier_3D:t.atoms_sphereDiameter_3D/2;0===r&&(r=1),a.scale(i,[r,r,r]),n||(n=t.atoms_color,t.atoms_useJMOLColors?n=o[this.label].jmolColor:t.atoms_usePYMOLColors&&(n=o[this.label].pymolColor),e.material.setDiffuseColor(n)),e.setMatrixUniforms(i),e.drawElements(e.TRIANGLES,(this.renderAsStar?e.starBuffer:e.sphereBuffer).vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)},e.renderHighlight=function(e,t){var n,i;(this.isSelected||this.isHover)&&(this.specs&&(t=this.specs),n=a.translate(e.modelViewMatrix,[this.x,this.y,this.z],[]),0===(i=t.atoms_useVDWDiameters_3D?o[this.label].vdWRadius*t.atoms_vdwMultiplier_3D:t.atoms_sphereDiameter_3D/2)&&(i=1),i*=1.3,a.scale(n,[i,i,i]),e.setMatrixUniforms(n),e.material.setDiffuseColor(this.isHover?"#885110":"#0060B2"),e.drawElements(e.TRIANGLES,(this.renderAsStar?e.starBuffer:e.sphereBuffer).vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0))},e.isLabelVisible=function(e){return!!(e.atoms_displayAllCarbonLabels_2D||"C"!==this.label||this.altLabel||this.any||-1!==this.rgroup||-1!==this.mass||0!==this.charge||e.atoms_showAttributedCarbons_2D&&(0!==this.numRadical||0!==this.numLonePair)||this.isHidden&&e.atoms_showHiddenCarbons_2D||e.atoms_displayTerminalCarbonLabels_2D&&1===this.bondNumber)},e.getImplicitHydrogenCount=function(){if("H"===this.label||!o[this.label]||!o[this.label].addH)return 0;var e=o[this.label].valency,t=e-this.coordinationNumber;return 0<this.numRadical&&(t=g.max(0,t-this.numRadical)),0<this.charge?(e=4-e,t=this.charge<=e?t+this.charge:4-this.coordinationNumber-this.charge+e):t+=this.charge,t<0?0:g.floor(t)},e.getBounds=function(){var e=new m.Bounds;if(e.expand(this.x,this.y),this.textBounds)for(var t=0,n=this.textBounds.length;t<n;t++){var i=this.textBounds[t];e.expand(i.x,i.y,i.x+i.w,i.y+i.h)}return e},e.getBounds3D=function(){var e=new m.Bounds;return e.expand3D(this.x,this.y,this.z),e},e.getElementColor=function(e,t,n,i){return 2==i&&this.any||-1!==this.rgroup||(e?n=o[this.label].jmolColor:t&&(n=o[this.label].pymolColor)),n}}(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,Math,ChemDoodle.lib.mat4),function(e,E,y,b,T,w,C){y.Bond=function(e,t,n){this.a1=e,this.a2=t,this.bondOrder=void 0!==n?n:1},y.Bond.STEREO_NONE="none",y.Bond.STEREO_PROTRUDING="protruding",y.Bond.STEREO_RECESSED="recessed",y.Bond.STEREO_AMBIGUOUS="ambiguous",(e=y.Bond.prototype).stereo=y.Bond.STEREO_NONE,e.isHover=!1,e.ring=void 0,e.getCenter=function(){return new y.Point((this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2)},e.getLength=function(){return this.a1.distance(this.a2)},e.getLength3D=function(){return this.a1.distance3D(this.a2)},e.contains=function(e){return e===this.a1||e===this.a2},e.getNeighbor=function(e){return e===this.a1?this.a2:e===this.a2?this.a1:void 0},e.draw=function(e,t){if(this.a1.x!==this.a2.x||this.a1.y!==this.a2.y){this.specs&&(t=this.specs);var n,i,r,o,a,s,l,c,u,h,f=this.a1.x,d=this.a2.x,p=this.a1.y,m=this.a2.y,g=this.a1.distance(this.a2),v=d-f,_=m-p;if(this.a1.isLassoed&&this.a2.isLassoed&&((n=e.createLinearGradient(f,p,d,m)).addColorStop(0,"rgba(212, 99, 0, 0)"),n.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),n.addColorStop(1,"rgba(212, 99, 0, 0)"),i=2.5,h=this.a1.angle(this.a2)+T.PI/2,r=f-(u=T.cos(h))*i,o=p+(h=T.sin(h))*i,a=f+u*i,s=p-h*i,l=d+u*i,c=m-h*i,u=d-u*i,h=m+h*i,e.fillStyle=n,e.beginPath(),e.moveTo(r,o),e.lineTo(a,s),e.lineTo(l,c),e.lineTo(u,h),e.closePath(),e.fill()),t.atoms_display&&!t.atoms_circles_2D&&this.a1.isLabelVisible(t)&&this.a1.textBounds){for(i=u=0,r=this.a1.textBounds.length;i<r;i++)u=Math.max(u,b.calculateDistanceInterior(this.a1,this.a2,this.a1.textBounds[i]));u+=t.bonds_atomLabelBuffer_2D,f+=v*(u/=g),p+=_*u}if(t.atoms_display&&!t.atoms_circles_2D&&this.a2.isLabelVisible(t)&&this.a2.textBounds){for(i=u=0,r=this.a2.textBounds.length;i<r;i++)u=Math.max(u,b.calculateDistanceInterior(this.a2,this.a1,this.a2.textBounds[i]));u+=t.bonds_atomLabelBuffer_2D,d-=v*(u/=g),m-=_*u}if(t.bonds_clearOverlaps_2D&&(u=f+.15*v,h=p+.15*_,i=d-.15*v,g=m-.15*_,e.strokeStyle=t.backgroundColor,e.lineWidth=t.bonds_width_2D+2*t.bonds_overlapClearWidth_2D,e.lineCap="round",e.beginPath(),e.moveTo(u,h),e.lineTo(i,g),e.closePath(),e.stroke()),e.strokeStyle=t.bonds_color,e.fillStyle=t.bonds_color,e.lineWidth=t.bonds_width_2D,e.lineCap=t.bonds_ends_2D,(t.bonds_useJMOLColors||t.bonds_usePYMOLColors)&&(u=e.createLinearGradient(f,p,d,m),h=this.a1.getElementColor(t.bonds_useJMOLColors,t.bonds_usePYMOLColors,t.atoms_color,2),i=this.a2.getElementColor(t.bonds_useJMOLColors,t.bonds_usePYMOLColors,t.atoms_color,2),u.addColorStop(0,h),t.bonds_colorGradient||(u.addColorStop(.5,h),u.addColorStop(.51,i)),u.addColorStop(1,i),e.strokeStyle=u,e.fillStyle=u),t.bonds_lewisStyle_2D&&0==this.bondOrder%1)this.drawLewisStyle(e,t,f,p,d,m);else switch(this.bondOrder){case 0:for(d-=f,m-=p,d=((d=T.sqrt(d*d+m*m))-((m=T.floor(d/t.bonds_dotSize_2D))-1)*t.bonds_dotSize_2D)/2,1==m%2?d+=t.bonds_dotSize_2D/4:(d-=t.bonds_dotSize_2D/4,m+=2),m/=2,_=this.a1.angle(this.a2),u=f+d*Math.cos(_),h=p-d*Math.sin(_),e.beginPath(),i=0;i<m;i++)e.arc(u,h,t.bonds_dotSize_2D/2,0,2*T.PI,!1),u+=2*t.bonds_dotSize_2D*Math.cos(_),h-=2*t.bonds_dotSize_2D*Math.sin(_);e.fill();break;case.5:e.beginPath(),e.moveTo(f,p),E.contextHashTo(e,f,p,d,m,t.bonds_hashSpacing_2D,t.bonds_hashSpacing_2D),e.stroke();break;case 1:if(this.stereo===y.Bond.STEREO_PROTRUDING||this.stereo===y.Bond.STEREO_RECESSED)_=t.bonds_width_2D/2,i=this.a1.distance(this.a2)*t.bonds_wedgeThickness_2D/2,h=this.a1.angle(this.a2)+T.PI/2,r=f-(u=T.cos(h))*_,o=p+(h=T.sin(h))*_,a=f+u*_,s=p-h*_,l=d+u*i,c=m-h*i,u=d-u*i,h=m+h*i,e.beginPath(),e.moveTo(r,o),e.lineTo(a,s),e.lineTo(l,c),e.lineTo(u,h),e.closePath(),this.stereo===y.Bond.STEREO_PROTRUDING?e.fill():(e.save(),e.clip(),e.lineWidth=2*i,e.lineCap="butt",e.beginPath(),e.moveTo(f,p),E.contextHashTo(e,f,p,d,m,t.bonds_hashWidth_2D,t.bonds_hashSpacing_2D),e.stroke(),e.restore());else{if(this.stereo===y.Bond.STEREO_AMBIGUOUS){for(e.beginPath(),e.moveTo(f,p),d=T.floor(T.sqrt(v*v+_*_)/t.bonds_wavyLength_2D),h=this.a1.angle(this.a2)+T.PI/2,u=T.cos(h),h=T.sin(h),m=v/d,_/=d,i=0,r=d;i<r;i++)f+=m,p+=_,d=t.bonds_wavyLength_2D*u+f-.5*m,g=t.bonds_wavyLength_2D*-h+p-.5*_,v=t.bonds_wavyLength_2D*-u+f-.5*m,o=t.bonds_wavyLength_2D*h+p-.5*_,0==i%2?e.quadraticCurveTo(d,g,f,p):e.quadraticCurveTo(v,o,f,p);e.stroke();break}e.beginPath(),e.moveTo(f,p),e.lineTo(d,m),e.stroke()}break;case 1.5:case 2:this.stereo===y.Bond.STEREO_AMBIGUOUS?(i=this.a1.distance(this.a2)*t.bonds_saturationWidth_2D/2,h=this.a1.angle(this.a2)+T.PI/2,r=f-(u=T.cos(h))*i,o=p+(h=T.sin(h))*i,a=f+u*i,s=p-h*i,l=d+u*i,c=m-h*i,u=d-u*i,h=m+h*i,e.beginPath(),e.moveTo(r,o),e.lineTo(l,c),e.moveTo(a,s),e.lineTo(u,h),e.stroke()):!t.bonds_symmetrical_2D&&(this.ring||"C"===this.a1.label&&"C"===this.a2.label)?(e.beginPath(),e.moveTo(f,p),e.lineTo(d,m),u=0,g=this.a1.distance(this.a2),h=(_=this.a1.angle(this.a2))+T.PI/2,i=g*t.bonds_saturationWidth_2D,(v=t.bonds_saturationAngle_2D)<T.PI/2&&(u=-(i/T.tan(v))),T.abs(u)<g/2&&(v=f-T.cos(_)*u,f=d+T.cos(_)*u,d=p+T.sin(_)*u,p=m-T.sin(_)*u,r=v-(u=T.cos(h))*i,o=d+(h=T.sin(h))*i,a=v+u*i,s=d-h*i,l=f-u*i,c=p+h*i,u=f+u*i,h=p-h*i,!this.ring||this.ring.center.angle(this.a1)>this.ring.center.angle(this.a2)&&!(this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)>T.PI)||this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)<-T.PI?(e.moveTo(r,o),2===this.bondOrder?e.lineTo(l,c):E.contextHashTo(e,r,o,l,c,t.bonds_hashSpacing_2D,t.bonds_hashSpacing_2D)):(e.moveTo(a,s),2===this.bondOrder?e.lineTo(u,h):E.contextHashTo(e,a,s,u,h,t.bonds_hashSpacing_2D,t.bonds_hashSpacing_2D)),e.stroke())):(i=this.a1.distance(this.a2)*t.bonds_saturationWidth_2D/2,h=this.a1.angle(this.a2)+T.PI/2,r=f-(u=T.cos(h))*i,o=p+(h=T.sin(h))*i,a=f+u*i,s=p-h*i,l=d+u*i,c=m-h*i,u=d-u*i,h=m+h*i,e.beginPath(),e.moveTo(r,o),e.lineTo(u,h),e.moveTo(a,s),2===this.bondOrder?e.lineTo(l,c):E.contextHashTo(e,a,s,l,c,t.bonds_hashSpacing_2D,t.bonds_hashSpacing_2D),e.stroke());break;case 3:i=this.a1.distance(this.a2)*t.bonds_saturationWidth_2D,h=this.a1.angle(this.a2)+T.PI/2,r=f-(u=T.cos(h))*i,o=p+(h=T.sin(h))*i,a=f+u*i,s=p-h*i,l=d+u*i,c=m-h*i,u=d-u*i,h=m+h*i,e.beginPath(),e.moveTo(r,o),e.lineTo(u,h),e.moveTo(a,s),e.lineTo(l,c),e.moveTo(f,p),e.lineTo(d,m),e.stroke()}}},e.drawDecorations=function(e){var t,n,i;(this.isHover||this.isSelected)&&(t=2*T.PI,n=(this.a1.angleForStupidCanvasArcs(this.a2)+T.PI/2)%t,e.strokeStyle=this.isHover?"#885110":"#0060B2",e.lineWidth=1.2,e.beginPath(),i=(i=(n+T.PI)%t)%(2*T.PI),e.arc(this.a1.x,this.a1.y,7,n,i,!1),e.stroke(),e.beginPath(),i=((n+=T.PI)+T.PI)%t,e.arc(this.a2.x,this.a2.y,7,n,i,!1),e.stroke())},e.drawLewisStyle=function(e,t,n,i,r,o){var a=this.a1.angle(this.a2),s=a+T.PI/2;for(r-=n,o-=i,n+=o=(r=T.sqrt(r*r+o*o)/(this.bondOrder+1))*T.cos(a),i+=a=-r*T.sin(a),r=0;r<this.bondOrder;r++){var l=t.atoms_lonePairSpread_2D/2,c=n-T.cos(s)*l,u=i+T.sin(s)*l,h=n+T.cos(s)*l,l=i-T.sin(s)*l;e.beginPath(),e.arc(c-t.atoms_lonePairDiameter_2D/2,u-t.atoms_lonePairDiameter_2D/2,t.atoms_lonePairDiameter_2D,0,2*T.PI,!1),e.fill(),e.beginPath(),e.arc(h-t.atoms_lonePairDiameter_2D/2,l-t.atoms_lonePairDiameter_2D/2,t.atoms_lonePairDiameter_2D,0,2*T.PI,!1),e.fill(),n+=o,i+=a}},e.render=function(e,t,n){this.specs&&(t=this.specs);var i=this.a1.distance3D(this.a2);if(0!==i){var r,o,a=t.bonds_cylinderDiameter_3D/2,s=t.bonds_color,l=w.translate(e.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),c=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],u=[0,1,0],h=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(u=[0,0,1],this.a2.y<this.a1.y&&(h=T.PI)):(h=E.vec3AngleFrom(u,c),u=C.cross(u,c,[]));var f=t.bonds_useJMOLColors,d=t.bonds_usePYMOLColors;(f||d)&&((s=this.a1.getElementColor(f,d,s))!=(r=this.a2.getElementColor(f,d,t.bonds_color))&&(o=w.translate(e.modelViewMatrix,[this.a2.x,this.a2.y,this.a2.z],[])));var p,f=[0];if(n){t.bonds_showBondOrders_3D&&1<this.bondOrder&&(f=[t.bonds_cylinderDiameter_3D],p=[0,0,1],n=w.inverse(e.rotationMatrix,[]),w.multiplyVec3(n,p),p=C.cross(c,p,[]),C.normalize(p));var a=1,m=t.bonds_pillSpacing_3D,c=t.bonds_pillHeight_3D;0==this.bondOrder&&(t.bonds_renderAsLines_3D?c=m:((c=t.bonds_pillDiameter_3D)<t.bonds_cylinderDiameter_3D&&(c/=2),i/=a=c/2,m/=a/2)),n=c+m;var d=T.floor(i/n),g=(m+t.bonds_pillDiameter_3D+(i-n*d))/2,v=d;for(o&&(v=T.floor(d/2)),i=0,m=f.length;i<m;i++){var _=w.set(l,[]);0!==f[i]&&w.translate(_,C.scale(p,f[i],[])),0!==h&&w.rotate(_,h,u),1!=a&&w.scale(_,[a,a,a]),s&&e.material.setDiffuseColor(s),w.translate(_,[0,g,0]);for(var y=0;y<v;y++)t.bonds_renderAsLines_3D?0==this.bondOrder?(e.setMatrixUniforms(_),e.drawArrays(e.POINTS,0,1)):(w.scale(_,[1,c,1]),e.setMatrixUniforms(_),e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems),w.scale(_,[1,1/c,1])):(e.setMatrixUniforms(_),0==this.bondOrder?e.drawElements(e.TRIANGLES,e.sphereBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0):e.drawElements(e.TRIANGLES,e.pillBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)),w.translate(_,[0,n,0]);if(o){var b,x=t.bonds_renderAsLines_3D?(b=c,b/=2,0):(1-(b=2/3))/2;for(0!=d%2&&(w.scale(_,[1,b,1]),e.setMatrixUniforms(_),t.bonds_renderAsLines_3D?0==this.bondOrder?e.drawArrays(e.POINTS,0,1):e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems):0==this.bondOrder?e.drawElements(e.TRIANGLES,e.sphereBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0):e.drawElements(e.TRIANGLES,e.pillBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0),w.translate(_,[0,n*(1+x),0]),w.scale(_,[1,1/b,1])),w.set(o,_),0!==f[i]&&w.translate(_,C.scale(p,f[i],[])),w.rotate(_,h+T.PI,u),1!=a&&w.scale(_,[a,a,a]),r&&e.material.setDiffuseColor(r),w.translate(_,[0,g,0]),y=0;y<v;y++)t.bonds_renderAsLines_3D?0==this.bondOrder?(e.setMatrixUniforms(_),e.drawArrays(e.POINTS,0,1)):(w.scale(_,[1,c,1]),e.setMatrixUniforms(_),e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems),w.scale(_,[1,1/c,1])):(e.setMatrixUniforms(_),0==this.bondOrder?e.drawElements(e.TRIANGLES,e.sphereBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0):e.drawElements(e.TRIANGLES,e.pillBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)),w.translate(_,[0,n,0]);0!=d%2&&(w.scale(_,[1,b,1]),e.setMatrixUniforms(_),t.bonds_renderAsLines_3D?0==this.bondOrder?e.drawArrays(e.POINTS,0,1):e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems):0==this.bondOrder?e.drawElements(e.TRIANGLES,e.sphereBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0):e.drawElements(e.TRIANGLES,e.pillBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0),w.translate(_,[0,n*(1+x),0]),w.scale(_,[1,1/b,1]))}}}else{if(t.bonds_showBondOrders_3D){switch(this.bondOrder){case 1.5:f=[-t.bonds_cylinderDiameter_3D];break;case 2:f=[-t.bonds_cylinderDiameter_3D,t.bonds_cylinderDiameter_3D];break;case 3:f=[-1.2*t.bonds_cylinderDiameter_3D,0,1.2*t.bonds_cylinderDiameter_3D]}1<this.bondOrder&&(p=[0,0,1],n=w.inverse(e.rotationMatrix,[]),w.multiplyVec3(n,p),p=C.cross(c,p,[]),C.normalize(p))}else switch(this.bondOrder){case 0:a*=.25;break;case.5:case 1.5:a*=.5}for(o&&(i/=2),a=[a,i,a],i=0,m=f.length;i<m;i++)_=w.set(l,[]),0!==f[i]&&w.translate(_,C.scale(p,f[i],[])),0!==h&&w.rotate(_,h,u),w.scale(_,a),s&&e.material.setDiffuseColor(s),e.setMatrixUniforms(_),t.bonds_renderAsLines_3D?e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems):e.drawArrays(e.TRIANGLE_STRIP,0,e.cylinderBuffer.vertexPositionBuffer.numItems),o&&(w.set(o,_),0!==f[i]&&w.translate(_,C.scale(p,f[i],[])),w.rotate(_,h+T.PI,u),w.scale(_,a),r&&e.material.setDiffuseColor(r),e.setMatrixUniforms(_),t.bonds_renderAsLines_3D?e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems):e.drawArrays(e.TRIANGLE_STRIP,0,e.cylinderBuffer.vertexPositionBuffer.numItems))}}},e.renderHighlight=function(e,t){var n,i,r,o,a,s;(this.isSelected||this.isHover)&&(this.specs&&(t=this.specs),this.specs&&(t=this.specs),0!==(n=this.a1.distance3D(this.a2))&&(i=t.bonds_cylinderDiameter_3D/1.2,r=w.translate(e.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),o=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],a=[0,1,0],s=0,this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(o=[0,0,1],this.a2.y<this.a1.y&&(s=T.PI)):(s=E.vec3AngleFrom(a,o),o=C.cross(a,o,[])),n=[i,n,i],0!==s&&w.rotate(r,s,o),w.scale(r,n),e.setMatrixUniforms(r),e.material.setDiffuseColor(this.isHover?"#885110":"#0060B2"),e.drawArrays(e.TRIANGLE_STRIP,0,e.cylinderBuffer.vertexPositionBuffer.numItems)))},e.renderPicker=function(e,t){this.specs&&(t=this.specs);var n=this.a1.distance3D(this.a2);if(0!==n){var i=t.bonds_cylinderDiameter_3D/2,r=w.translate(e.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),o=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],a=[0,1,0],s=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(a=[0,0,1],this.a2.y<this.a1.y&&(s=T.PI)):(s=E.vec3AngleFrom(a,o),a=C.cross(a,o,[]));var l,c,u=[0];if(t.bonds_showBondOrders_3D)if(t.bonds_renderAsLines_3D){switch(this.bondOrder){case 1.5:case 2:u=[-t.bonds_cylinderDiameter_3D,t.bonds_cylinderDiameter_3D];break;case 3:u=[-1.2*t.bonds_cylinderDiameter_3D,0,1.2*t.bonds_cylinderDiameter_3D]}1<this.bondOrder&&(l=[0,0,1],c=w.inverse(e.rotationMatrix,[]),w.multiplyVec3(c,l),l=C.cross(o,l,[]),C.normalize(l))}else switch(this.bondOrder){case 1.5:case 2:i*=3;break;case 3:i*=3.4}else switch(this.bondOrder){case 0:i*=.25;break;case.5:case 1.5:i*=.5}for(n=[i,n,i],i=0,o=u.length;i<o;i++)c=w.set(r,[]),0!==u[i]&&w.translate(c,C.scale(l,u[i],[])),0!==s&&w.rotate(c,s,a),w.scale(c,n),e.setMatrixUniforms(c),t.bonds_renderAsLines_3D?e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems):e.drawArrays(e.TRIANGLE_STRIP,0,e.cylinderBuffer.vertexPositionBuffer.numItems)}}}(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3),function(a,s){a.Ring=function(){this.atoms=[],this.bonds=[]};var e=a.Ring.prototype;e.center=void 0,e.setupBonds=function(){for(var e=0,t=this.bonds.length;e<t;e++)this.bonds[e].ring=this;this.center=this.getCenter()},e.getCenter=function(){for(var e=1/0,t=1/0,n=-1/0,i=-1/0,r=0,o=this.atoms.length;r<o;r++)e=s.min(this.atoms[r].x,e),t=s.min(this.atoms[r].y,t),n=s.max(this.atoms[r].x,n),i=s.max(this.atoms[r].y,i);return new a.Point((n+e)/2,(i+t)/2)}}(ChemDoodle.structures,Math),function(a,c,f,u,d){f.Molecule=function(){this.atoms=[],this.bonds=[],this.rings=[]};var e=f.Molecule.prototype;e.findRings=!0,e.draw=function(e,t){if(this.specs&&(t=this.specs),t.atoms_display&&!t.atoms_circles_2D)for(var n=0,i=this.atoms.length;n<i;n++)this.atoms[n].draw(e,t);if(t.bonds_display)for(n=0,i=this.bonds.length;n<i;n++)this.bonds[n].draw(e,t);if(t.atoms_display&&t.atoms_circles_2D)for(n=0,i=this.atoms.length;n<i;n++)this.atoms[n].draw(e,t)},e.render=function(e,t){this.specs&&(t=this.specs);var n=0<this.atoms.length&&void 0!==this.atoms[0].hetatm;if(n){if(t.macro_displayBonds){0<this.bonds.length&&(t.bonds_renderAsLines_3D&&!this.residueSpecs||this.residueSpecs&&this.residueSpecs.bonds_renderAsLines_3D?(e.lineWidth(this.residueSpecs?this.residueSpecs.bonds_width_2D:t.bonds_width_2D),e.lineBuffer.bindBuffers(e)):e.cylinderBuffer.bindBuffers(e),e.material.setTempColors(t.bonds_materialAmbientColor_3D,void 0,t.bonds_materialSpecularColor_3D,t.bonds_materialShininess_3D));for(var i=0,r=this.bonds.length;i<r;i++){!(l=this.bonds[i]).a1.hetatm&&(-1===t.macro_atomToLigandDistance||void 0!==l.a1.closestDistance&&t.macro_atomToLigandDistance>=l.a1.closestDistance&&t.macro_atomToLigandDistance>=l.a2.closestDistance)&&l.render(e,this.residueSpecs?this.residueSpecs:t)}}if(t.macro_displayAtoms)for(0<this.atoms.length&&(e.sphereBuffer.bindBuffers(e),e.material.setTempColors(t.atoms_materialAmbientColor_3D,void 0,t.atoms_materialSpecularColor_3D,t.atoms_materialShininess_3D)),i=0,r=this.atoms.length;i<r;i++)!(l=this.atoms[i]).hetatm&&(-1===t.macro_atomToLigandDistance||void 0!==l.closestDistance&&t.macro_atomToLigandDistance>=l.closestDistance)&&l.render(e,this.residueSpecs?this.residueSpecs:t)}if(t.bonds_display){var o=[],a=[];for(0<this.bonds.length&&(t.bonds_renderAsLines_3D?(e.lineWidth(t.bonds_width_2D),e.lineBuffer.bindBuffers(e)):e.cylinderBuffer.bindBuffers(e),e.material.setTempColors(t.bonds_materialAmbientColor_3D,void 0,t.bonds_materialSpecularColor_3D,t.bonds_materialShininess_3D)),i=0,r=this.bonds.length;i<r;i++)l=this.bonds[i],n&&!l.a1.hetatm||(t.bonds_showBondOrders_3D?0==l.bondOrder?a.push(l):.5==l.bondOrder?o.push(l):(1.5==l.bondOrder&&o.push(l),l.render(e,t)):l.render(e,t));if(0<o.length)for(t.bonds_renderAsLines_3D||e.pillBuffer.bindBuffers(e),i=0,r=o.length;i<r;i++)o[i].render(e,t,!0);if(0<a.length)for(t.bonds_renderAsLines_3D||e.sphereBuffer.bindBuffers(e),i=0,r=a.length;i<r;i++)a[i].render(e,t,!0)}if(t.atoms_display){for(i=0,r=this.atoms.length;i<r;i++)(l=this.atoms[i]).bondNumber=0,l.renderAsStar=!1;for(i=0,r=this.bonds.length;i<r;i++)(l=this.bonds[i]).a1.bondNumber++,l.a2.bondNumber++;for(0<this.atoms.length&&(e.sphereBuffer.bindBuffers(e),e.material.setTempColors(t.atoms_materialAmbientColor_3D,void 0,t.atoms_materialSpecularColor_3D,t.atoms_materialShininess_3D)),o=[],i=0,r=this.atoms.length;i<r;i++)l=this.atoms[i],n&&(!l.hetatm||!t.macro_showWater&&l.isWater)||(t.atoms_nonBondedAsStars_3D&&0===l.bondNumber?(l.renderAsStar=!0,o.push(l)):l.render(e,t));if(0<o.length)for(e.starBuffer.bindBuffers(e),i=0,r=o.length;i<r;i++)o[i].render(e,t)}if(this.chains){if(e.setMatrixUniforms(e.modelViewMatrix),t.proteins_displayRibbon)for(e.material.setTempColors(t.proteins_materialAmbientColor_3D,void 0,t.proteins_materialSpecularColor_3D,t.proteins_materialShininess_3D),n=0,o=this.ribbons.length;n<o;n++)if(l=t.proteins_ribbonCartoonize?this.cartoons[n]:this.ribbons[n],"none"!==t.proteins_residueColor){for(l.front.bindBuffers(e),a="rainbow"===t.proteins_residueColor,i=0,r=l.front.segments.length;i<r;i++)a&&e.material.setDiffuseColor(c.rainbowAt(i,r,t.macro_rainbowColors)),l.front.segments[i].render(e,t);for(l.back.bindBuffers(e),i=0,r=l.back.segments.length;i<r;i++)a&&e.material.setDiffuseColor(c.rainbowAt(i,r,t.macro_rainbowColors)),l.back.segments[i].render(e,t)}else if(t.proteins_ribbonCartoonize){for(l.front.bindBuffers(e),i=0,r=l.front.cartoonSegments.length;i<r;i++)l.front.cartoonSegments[i].render(e,t);for(l.back.bindBuffers(e),i=0,r=l.back.cartoonSegments.length;i<r;i++)l.back.cartoonSegments[i].render(e,t)}else l.front.render(e,t),l.back.render(e,t);if(t.proteins_displayBackbone){if(!this.alphaCarbonTrace)for(this.alphaCarbonTrace={nodes:[],edges:[]},n=0,o=this.chains.length;n<o;n++)if(!(2<(a=this.chains[n]).length&&u[a[2].name]&&"#BEA06E"===u[a[2].name].aminoColor)&&0<a.length)for(i=1,r=a.length-2;i<r;i++)(l=a[i].cp1).chainColor=a.chainColor,this.alphaCarbonTrace.nodes.push(l),(l=new f.Bond(a[i].cp1,a[i+1].cp1)).residueName=a[i].name,l.chainColor=a.chainColor,this.alphaCarbonTrace.edges.push(l),i===a.length-3&&((l=a[i+1].cp1).chainColor=a.chainColor,this.alphaCarbonTrace.nodes.push(l));if(0<this.alphaCarbonTrace.nodes.length){for((n=new f.VisualSpecifications).atoms_display=!0,n.bonds_display=!0,n.atoms_sphereDiameter_3D=t.proteins_backboneThickness,n.bonds_cylinderDiameter_3D=t.proteins_backboneThickness,n.bonds_useJMOLColors=!1,n.atoms_color=t.proteins_backboneColor,n.bonds_color=t.proteins_backboneColor,n.atoms_useVDWDiameters_3D=!1,e.material.setTempColors(t.proteins_materialAmbientColor_3D,void 0,t.proteins_materialSpecularColor_3D,t.proteins_materialShininess_3D),e.material.setDiffuseColor(t.proteins_backboneColor),i=0,r=this.alphaCarbonTrace.nodes.length;i<r;i++)l=this.alphaCarbonTrace.nodes[i],t.macro_colorByChain&&(n.atoms_color=l.chainColor),e.sphereBuffer.bindBuffers(e),l.render(e,n);for(i=0,r=this.alphaCarbonTrace.edges.length;i<r;i++){var s,l=this.alphaCarbonTrace.edges[i],o=u[l.residueName]?u[l.residueName]:u["*"];t.macro_colorByChain?s=l.chainColor:"shapely"===t.proteins_residueColor?s=o.shapelyColor:"amino"===t.proteins_residueColor?s=o.aminoColor:"polarity"===t.proteins_residueColor?s=o.polar?"#C10000":"#FFFFFF":"acidity"===t.proteins_residueColor?s=1===o.acidity?"#0000FF":-1===o.acidity?"#FF0000":o.polar?"#FFFFFF":"#773300":"rainbow"===t.proteins_residueColor&&(s=c.rainbowAt(i,r,t.macro_rainbowColors)),s&&(n.bonds_color=s),e.cylinderBuffer.bindBuffers(e),l.render(e,n)}}}if(t.nucleics_display)for(e.material.setTempColors(t.nucleics_materialAmbientColor_3D,void 0,t.nucleics_materialSpecularColor_3D,t.nucleics_materialShininess_3D),n=0,o=this.tubes.length;n<o;n++)e.setMatrixUniforms(e.modelViewMatrix),(l=this.tubes[n]).render(e,t)}if(t.crystals_displayUnitCell&&this.unitCell&&(e.setMatrixUniforms(e.modelViewMatrix),this.unitCell.bindBuffers(e),e.material.setDiffuseColor(t.crystals_unitCellColor),e.lineWidth(t.crystals_unitCellLineWidth),e.drawElements(e.LINES,this.unitCell.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)),t.atoms_display){for(s=!1,i=0,r=this.atoms.length;i<r;i++)if((l=this.atoms[i]).isHover||l.isSelected){s=!0;break}if(!s)for(i=0,r=this.bonds.length;i<r;i++)if((l=this.bonds[i]).isHover||l.isSelected){s=!0;break}if(s){for(e.sphereBuffer.bindBuffers(e),e.blendFunc(e.SRC_ALPHA,e.ONE),e.material.setTempColors(t.atoms_materialAmbientColor_3D,void 0,"#000000",0),e.enable(e.BLEND),e.depthMask(!1),e.material.setAlpha(.4),e.sphereBuffer.bindBuffers(e),i=0,r=this.atoms.length;i<r;i++)((l=this.atoms[i]).isHover||l.isSelected)&&l.renderHighlight(e,t);for(e.cylinderBuffer.bindBuffers(e),i=0,r=this.bonds.length;i<r;i++)((l=this.bonds[i]).isHover||l.isSelected)&&l.renderHighlight(e,t);e.depthMask(!0),e.disable(e.BLEND),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)}}this.surface&&t.surfaces_display&&(e.setMatrixUniforms(e.modelViewMatrix),this.surface.bindBuffers(e),e.material.setTempColors(t.surfaces_materialAmbientColor_3D,t.surfaces_color,t.surfaces_materialSpecularColor_3D,t.surfaces_materialShininess_3D),"Dot"===t.surfaces_style?e.drawArrays(e.POINTS,0,this.surface.vertexPositionBuffer.numItems):e.drawElements(e.TRIANGLES,this.surface.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0))},e.renderPickFrame=function(e,t,n,i,r){this.specs&&(t=this.specs);var o=0<this.atoms.length&&void 0!==this.atoms[0].hetatm;if(r&&t.bonds_display){0<this.bonds.length&&(t.bonds_renderAsLines_3D?(e.lineWidth(t.bonds_width_2D),e.lineBuffer.bindBuffers(e)):e.cylinderBuffer.bindBuffers(e)),r=0;for(var a=this.bonds.length;r<a;r++){var s=this.bonds[r];o&&!s.a1.hetatm||(e.material.setDiffuseColor(c.idx2color(n.length)),s.renderPicker(e,t),n.push(s))}}if(i&&t.atoms_display){for(r=0,a=this.atoms.length;r<a;r++)(i=this.atoms[r]).bondNumber=0,i.renderAsStar=!1;for(r=0,a=this.bonds.length;r<a;r++)(s=this.bonds[r]).a1.bondNumber++,s.a2.bondNumber++;for(0<this.atoms.length&&e.sphereBuffer.bindBuffers(e),s=[],r=0,a=this.atoms.length;r<a;r++)i=this.atoms[r],o&&(!i.hetatm||!t.macro_showWater&&i.isWater)||(t.atoms_nonBondedAsStars_3D&&0===i.bondNumber?(i.renderAsStar=!0,s.push(i)):(e.material.setDiffuseColor(c.idx2color(n.length)),i.render(e,t,!0),n.push(i)));if(0<s.length)for(e.starBuffer.bindBuffers(e),r=0,a=s.length;r<a;r++)i=s[r],e.material.setDiffuseColor(c.idx2color(n.length)),i.render(e,t,!0),n.push(i)}},e.getCenter3D=function(){if(1===this.atoms.length)return new f.Atom("C",this.atoms[0].x,this.atoms[0].y,this.atoms[0].z);var e=1/0,t=1/0,n=1/0,i=-1/0,r=-1/0,o=-1/0;if(this.chains)for(var a=0,s=this.chains.length;a<s;a++)for(var l=this.chains[a],c=0,u=l.length;c<u;c++)var h=l[c],e=d.min(h.cp1.x,h.cp2.x,e),t=d.min(h.cp1.y,h.cp2.y,t),n=d.min(h.cp1.z,h.cp2.z,n),i=d.max(h.cp1.x,h.cp2.x,i),r=d.max(h.cp1.y,h.cp2.y,r),o=d.max(h.cp1.z,h.cp2.z,o);for(a=0,s=this.atoms.length;a<s;a++)e=d.min(this.atoms[a].x,e),t=d.min(this.atoms[a].y,t),n=d.min(this.atoms[a].z,n),i=d.max(this.atoms[a].x,i),r=d.max(this.atoms[a].y,r),o=d.max(this.atoms[a].z,o);return new f.Atom("C",(i+e)/2,(r+t)/2,(o+n)/2)},e.getCenter=function(){if(1===this.atoms.length)return new f.Point(this.atoms[0].x,this.atoms[0].y);for(var e=1/0,t=1/0,n=-1/0,i=-1/0,r=0,o=this.atoms.length;r<o;r++)e=d.min(this.atoms[r].x,e),t=d.min(this.atoms[r].y,t),n=d.max(this.atoms[r].x,n),i=d.max(this.atoms[r].y,i);return new f.Point((n+e)/2,(i+t)/2)},e.getDimension=function(){if(1===this.atoms.length)return new f.Point(0,0);var e=1/0,t=1/0,n=-1/0,i=-1/0;if(this.chains){for(var r=0,o=this.chains.length;r<o;r++)for(var a=this.chains[r],s=0,l=a.length;s<l;s++)var c=a[s],e=d.min(c.cp1.x,c.cp2.x,e),t=d.min(c.cp1.y,c.cp2.y,t),n=d.max(c.cp1.x,c.cp2.x,n),i=d.max(c.cp1.y,c.cp2.y,i);e-=30,t-=30,n+=30,i+=30}for(r=0,o=this.atoms.length;r<o;r++)e=d.min(this.atoms[r].x,e),t=d.min(this.atoms[r].y,t),n=d.max(this.atoms[r].x,n),i=d.max(this.atoms[r].y,i);return new f.Point(n-e,i-t)},e.check=function(e){if(e&&this.doChecks){if(this.findRings)if(this.bonds.length-this.atoms.length!==this.fjNumCache){this.rings=new a.informatics.SSSRFinder(this).rings;for(var t=0,n=this.bonds.length;t<n;t++)this.bonds[t].ring=void 0;for(t=0,n=this.rings.length;t<n;t++)this.rings[t].setupBonds()}else for(t=0,n=this.rings.length;t<n;t++){var i=this.rings[t];i.center=i.getCenter()}for(t=0,n=this.atoms.length;t<n;t++)if(this.atoms[t].isLone=!1,"C"===this.atoms[t].label){for(var r=i=0,o=this.bonds.length;r<o;r++)this.bonds[r].a1!==this.atoms[t]&&this.bonds[r].a2!==this.atoms[t]||i++;0===i&&(this.atoms[t].isLone=!0)}for(i=!1,t=0,n=this.atoms.length;t<n;t++)0!==this.atoms[t].z&&(i=!0);i&&(this.sortAtomsByZ(),this.sortBondsByZ()),this.setupMetaData(),this.atomNumCache=this.atoms.length,this.bondNumCache=this.bonds.length,this.fjNumCache=this.bonds.length-this.atoms.length}this.doChecks=!e},e.getAngles=function(e){for(var t=[],n=0,i=this.bonds.length;n<i;n++)this.bonds[n].contains(e)&&t.push(e.angle(this.bonds[n].getNeighbor(e)));return t.sort(),t},e.getCoordinationNumber=function(e){for(var t=0,n=0,i=e.length;n<i;n++)t+=e[n].bondOrder;return t},e.getBonds=function(e){for(var t=[],n=0,i=this.bonds.length;n<i;n++)this.bonds[n].contains(e)&&t.push(this.bonds[n]);return t},e.sortAtomsByZ=function(){for(var e=1,t=this.atoms.length;e<t;e++)for(var n=e;0<n&&this.atoms[n].z<this.atoms[n-1].z;){var i=this.atoms[n];this.atoms[n]=this.atoms[n-1],this.atoms[n-1]=i,n--}},e.sortBondsByZ=function(){for(var e=1,t=this.bonds.length;e<t;e++)for(var n=e;0<n&&this.bonds[n].a1.z+this.bonds[n].a2.z<this.bonds[n-1].a1.z+this.bonds[n-1].a2.z;){var i=this.bonds[n];this.bonds[n]=this.bonds[n-1],this.bonds[n-1]=i,n--}},e.setupMetaData=function(){for(var e=this.getCenter(),t=0,n=this.atoms.length;t<n;t++){var i=this.atoms[t];i.bonds=this.getBonds(i),i.angles=this.getAngles(i),i.isHidden=2===i.bonds.length&&d.abs(d.abs(i.angles[1]-i.angles[0])-d.PI)<d.PI/30&&i.bonds[0].bondOrder===i.bonds[1].bondOrder;var r=c.angleBetweenLargest(i.angles);i.angleOfLeastInterference=r.angle%(2*d.PI),i.largestAngle=r.largest,i.coordinationNumber=this.getCoordinationNumber(i.bonds),i.bondNumber=i.bonds.length,i.molCenter=e}for(t=0,n=this.bonds.length;t<n;t++)this.bonds[t].molCenter=e},e.scaleToAverageBondLength=function(e){if(0!==(t=this.getAverageBondLength())){e/=t;for(var t=0,n=this.atoms.length;t<n;t++)this.atoms[t].x*=e,this.atoms[t].y*=e}},e.getAverageBondLength=function(){if(0===this.bonds.length)return 0;for(var e=0,t=0,n=this.bonds.length;t<n;t++)e+=this.bonds[t].getLength();return e/this.bonds.length},e.getBounds=function(){for(var e=new c.Bounds,t=0,n=this.atoms.length;t<n;t++)e.expand(this.atoms[t].getBounds());if(this.chains){for(t=0,n=this.chains.length;t<n;t++)for(var i=this.chains[t],r=0,o=i.length;r<o;r++){var a=i[r];e.expand(a.cp1.x,a.cp1.y),e.expand(a.cp2.x,a.cp2.y)}e.minX-=30,e.minY-=30,e.maxX+=30,e.maxY+=30}return e},e.getBounds3D=function(){for(var e=new c.Bounds,t=0,n=this.atoms.length;t<n;t++)e.expand(this.atoms[t].getBounds3D());if(this.chains)for(t=0,n=this.chains.length;t<n;t++)for(var i=this.chains[t],r=0,o=i.length;r<o;r++){var a=i[r];e.expand3D(a.cp1.x,a.cp1.y,a.cp1.z),e.expand3D(a.cp2.x,a.cp2.y,a.cp2.z)}return e}}(ChemDoodle,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.RESIDUE,Math),function(p,m,g,v){var _,s=-1;p.Residue=function(e){this.resSeq=e};var e=p.Residue.prototype;e.setup=function(e,t){this.horizontalResolution=t;var n=[e.x-this.cp1.x,e.y-this.cp1.y,e.z-this.cp1.z],i=v.cross(n,[this.cp2.x-this.cp1.x,this.cp2.y-this.cp1.y,this.cp2.z-this.cp1.z],[]);for(this.D=v.cross(i,n,[]),v.normalize(i),v.normalize(this.D),this.guidePointsSmall=[],this.guidePointsLarge=[],n=[(e.x+this.cp1.x)/2,(e.y+this.cp1.y)/2,(e.z+this.cp1.z)/2],this.helix&&(v.scale(i,1.5),v.add(n,i)),this.guidePointsSmall[0]=new p.Atom("",n[0]-this.D[0]/2,n[1]-this.D[1]/2,n[2]-this.D[2]/2),i=1;i<t;i++)this.guidePointsSmall[i]=new p.Atom("",this.guidePointsSmall[0].x+this.D[0]*i/t,this.guidePointsSmall[0].y+this.D[1]*i/t,this.guidePointsSmall[0].z+this.D[2]*i/t);for(v.scale(this.D,4),this.guidePointsLarge[0]=new p.Atom("",n[0]-this.D[0]/2,n[1]-this.D[1]/2,n[2]-this.D[2]/2),i=1;i<t;i++)this.guidePointsLarge[i]=new p.Atom("",this.guidePointsLarge[0].x+this.D[0]*i/t,this.guidePointsLarge[0].y+this.D[1]*i/t,this.guidePointsLarge[0].z+this.D[2]*i/t)},e.getGuidePointSet=function(e){return 0===e?this.helix||this.sheet?this.guidePointsLarge:this.guidePointsSmall:1===e?this.guidePointsSmall:2===e?this.guidePointsLarge:void 0},e.computeLineSegments=function(e,t,n,i,r){var o,a;r!==s&&(a=(o=r*r)*r,_=g.multiply([-1/6,.5,-.5,1/6,.5,-1,.5,0,-.5,0,.5,0,1/6,2/3,1/6,0],[6/a,0,0,0,6/a,2/o,0,0,1/a,1/o,1/r,0,0,0,0,1],[]),s=r),this.split=t.helix!==this.helix||t.sheet!==this.sheet,this.lineSegments=this.innerCompute(0,e,t,n,!1,r),i&&(this.lineSegmentsCartoon=this.innerCompute(t.helix||t.sheet?2:1,e,t,n,!0,r))},e.innerCompute=function(e,t,n,i,r,o){var a=[],s=this.getGuidePointSet(e);t=t.getGuidePointSet(e),n=n.getGuidePointSet(e);for(var l=i.getGuidePointSet(e),c=0,u=this.guidePointsLarge.length;c<u;c++){for(var h=g.multiply([t[c].x,t[c].y,t[c].z,1,s[c].x,s[c].y,s[c].z,1,n[c].x,n[c].y,n[c].z,1,l[c].x,l[c].y,l[c].z,1],_,[]),f=[],d=0;d<o;d++){for(e=3;0<e;e--)for(i=0;i<4;i++)h[4*e+i]+=h[4*(e-1)+i];f[d]=new p.Atom("",h[12]/h[15],h[13]/h[15],h[14]/h[15])}a[c]=f}if(r&&this.arrow)for(e=0;e<o;e++)for(r=1.5-1.3*e/o,t=a[s=m.floor(this.horizontalResolution/2)],i=0,n=a.length;i<n;i++)i!==s&&(l=t[e],u=[(c=a[i][e]).x-l.x,c.y-l.y,c.z-l.z],v.scale(u,r),c.x=l.x+u[0],c.y=l.y+u[1],c.z=l.z+u[2]);return a}}(ChemDoodle.structures,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3),function(m,g,l,e,v){g.Spectrum=function(){this.data=[],this.metadata=[],this.dataDisplay=[],this.memory={offsetTop:0,offsetLeft:0,offsetBottom:0,flipXAxis:!1,scale:1,width:0,height:0}},(e=g.Spectrum.prototype).title=void 0,e.xUnit=void 0,e.yUnit=void 0,e.continuous=!0,e.integrationSensitivity=.01,e.draw=function(e,t,n,i){this.specs&&(t=this.specs);var r=5,o=0,a=0;e.fillStyle=t.text_color,e.textAlign="center",e.textBaseline="alphabetic",e.font=m.getFontString(t.text_font_size,t.text_font_families),this.xUnit&&(a+=t.text_font_size,e.fillText(this.xUnit,n/2,i-2)),this.yUnit&&t.plots_showYAxis&&(o+=t.text_font_size,e.save(),e.translate(t.text_font_size,i/2),e.rotate(-v.PI/2),e.fillText(this.yUnit,0,0),e.restore()),this.title&&(r+=t.text_font_size,e.fillText(this.title,n/2,t.text_font_size)),a+=5+t.text_font_size,t.plots_showYAxis&&(o+=5+e.measureText("1000").width),t.plots_showGrid&&(e.strokeStyle=t.plots_gridColor,e.lineWidth=t.plots_gridLineWidth,e.strokeRect(o,r,n-o,i-a-r)),e.textAlign="center",e.textBaseline="top";for(var s=(h=this.maxX-this.minX)/100,l=.001;l<s||25<h/l;)l*=10;for(var c=0,u=t.plots_flipXAxis?n:0,h=v.round(this.minX/l)*l;h<=this.maxX;h+=l/2){var f=this.getTransformedX(h,t,n,o);if(o<f)if(e.strokeStyle="black",e.lineWidth=1,0==c%2){for(e.beginPath(),e.moveTo(f,i-a),e.lineTo(f,i-a+2),e.stroke(),s=h.toFixed(5);"0"===s.charAt(s.length-1);)s=s.substring(0,s.length-1);"."===s.charAt(s.length-1)&&(s=s.substring(0,s.length-1));var d=e.measureText(s).width;t.plots_flipXAxis&&(d*=-1);var p=f-d/2;(t.plots_flipXAxis?p<u:u<p)&&(e.fillText(s,f,i-a+2),u=f+d/2),t.plots_showGrid&&(e.strokeStyle=t.plots_gridColor,e.lineWidth=t.plots_gridLineWidth,e.beginPath(),e.moveTo(f,i-a),e.lineTo(f,r),e.stroke())}else e.beginPath(),e.moveTo(f,i-a),e.lineTo(f,i-a+2),e.stroke();c++}if(t.plots_showYAxis||t.plots_showGrid)for(l=1/t.scale,e.textAlign="right",e.textBaseline="middle",h=0;h<=10;h++)if(c=r+(i-a-r)*(1-(s=l/10*h)*t.scale),t.plots_showGrid&&(e.strokeStyle=t.plots_gridColor,e.lineWidth=t.plots_gridLineWidth,e.beginPath(),e.moveTo(o,c),e.lineTo(n,c),e.stroke()),t.plots_showYAxis){if(e.strokeStyle="black",e.lineWidth=1,e.beginPath(),e.moveTo(o,c),e.lineTo(o-3,c),e.stroke(),s*=100,u=v.max(0,3-v.floor(s).toString().length),s=s.toFixed(u),0<u)for(;"0"===s.charAt(s.length-1);)s=s.substring(0,s.length-1);"."===s.charAt(s.length-1)&&(s=s.substring(0,s.length-1)),e.fillText(s,o-3,c)}if(e.strokeStyle="black",e.lineWidth=1,e.beginPath(),e.moveTo(n,i-a),e.lineTo(o,i-a),t.plots_showYAxis&&e.lineTo(o,r),e.stroke(),0<this.dataDisplay.length)for(e.textAlign="left",e.textBaseline="top",h=s=0,l=this.dataDisplay.length;h<l;h++)if(this.dataDisplay[h].value)e.fillText([this.dataDisplay[h].display,": ",this.dataDisplay[h].value].join(""),o+10,r+10+s*(t.text_font_size+5)),s++;else if(this.dataDisplay[h].tag)for(c=0,u=this.metadata.length;c<u;c++)if(m.stringStartsWith(this.metadata[c],this.dataDisplay[h].tag)){u=this.metadata[c],this.dataDisplay[h].display&&(u=this.metadata[c].indexOf("="),u=[this.dataDisplay[h].display,": ",-1<u?this.metadata[c].substring(u+2):this.metadata[c]].join("")),e.fillText(u,o+10,r+10+s*(t.text_font_size+5)),s++;break}this.drawPlot(e,t,n,i,r,o,a),this.memory.offsetTop=r,this.memory.offsetLeft=o,this.memory.offsetBottom=a,this.memory.flipXAxis=t.plots_flipXAxis,this.memory.scale=t.scale,this.memory.width=n,this.memory.height=i},e.drawPlot=function(e,t,n,i,r,o,a){this.specs&&(t=this.specs),e.strokeStyle=t.plots_color,e.lineWidth=t.plots_width;var s=[];if(e.beginPath(),this.continuous)for(var l=!1,c=0,u=!1,h=0,f=this.data.length;h<f;h++){var d,p=this.getTransformedX(this.data[h].x,t,n,o);if(h<f&&!l&&(d=this.getTransformedX(this.data[h+1].x,t,n,o)),o<=p&&p<n||void 0!==d&&o<=d&&d<n){var m=this.getTransformedY(this.data[h].y,t,i,a,r);if(t.plots_showIntegration&&v.abs(this.data[h].y)>this.integrationSensitivity&&s.push(new g.Point(this.data[h].x,this.data[h].y)),l||(e.moveTo(p,m),l=!0),e.lineTo(p,m),0==++c%1e3&&(e.stroke(),e.beginPath(),e.moveTo(p,m)),u)break}else l&&(u=!0)}else for(h=0,f=this.data.length;h<f;h++)o<=(p=this.getTransformedX(this.data[h].x,t,n,o))&&p<n&&(e.moveTo(p,i-a),e.lineTo(p,this.getTransformedY(this.data[h].y,t,i,a,r)));if(e.stroke(),t.plots_showIntegration&&1<s.length){if(e.strokeStyle=t.plots_integrationColor,e.lineWidth=t.plots_integrationLineWidth,e.beginPath(),h=s[1].x>s[0].x,this.flipXAxis&&!h||!this.flipXAxis&&h){for(h=s.length-2;0<=h;h--)s[h].y+=s[h+1].y;l=s[0].y}else{for(h=1,f=s.length;h<f;h++)s[h].y+=s[h-1].y;l=s[s.length-1].y}for(h=0,f=s.length;h<f;h++)p=this.getTransformedX(s[h].x,t,n,o),m=this.getTransformedY(s[h].y/t.scale/l,t,i,a,r),0===h?e.moveTo(p,m):e.lineTo(p,m);e.stroke()}},e.getTransformedY=function(e,t,n,i,r){return r+(n-i-r)*(1-e*t.scale)},e.getInverseTransformedY=function(e){return(1-(e-this.memory.offsetTop)/(this.memory.height-this.memory.offsetBottom-this.memory.offsetTop))/this.memory.scale*100},e.getTransformedX=function(e,t,n,i){return e=i+(e-this.minX)/(this.maxX-this.minX)*(n-i),t.plots_flipXAxis&&(e=n+i-e),e},e.getInverseTransformedX=function(e){return this.memory.flipXAxis&&(e=this.memory.width+this.memory.offsetLeft-e),(e-this.memory.offsetLeft)*(this.maxX-this.minX)/(this.memory.width-this.memory.offsetLeft)+this.minX},e.setup=function(){for(var e=Number.MAX_VALUE,t=Number.MIN_VALUE,n=Number.MIN_VALUE,i=0,r=this.data.length;i<r;i++)e=v.min(e,this.data[i].x),t=v.max(t,this.data[i].x),n=v.max(n,this.data[i].y);for(this.continuous?(this.minX=e,this.maxX=t):(this.minX=e-1,this.maxX=t+1),i=0,r=this.data.length;i<r;i++)this.data[i].y/=n},e.zoom=function(e,t,n,i){if(e=this.getInverseTransformedX(e),t=this.getInverseTransformedX(t),this.minX=v.min(e,t),this.maxX=v.max(e,t),i){for(i=Number.MIN_VALUE,t=0,e=this.data.length;t<e;t++)l.isBetween(this.data[t].x,this.minX,this.maxX)&&(i=v.max(i,this.data[t].y));return 1/i}},e.translate=function(e,t){var n=e/(t-this.memory.offsetLeft)*(this.maxX-this.minX)*(this.memory.flipXAxis?1:-1);this.minX+=n,this.maxX+=n},e.alertMetadata=function(){alert(this.metadata.join("\n"))},e.getInternalCoordinates=function(e,t){return new ChemDoodle.structures.Point(this.getInverseTransformedX(e),this.getInverseTransformedY(t))},e.getClosestPlotInternalCoordinates=function(e){var t=this.getInverseTransformedX(e-1);(e=this.getInverseTransformedX(e+1))<t&&(n=t,t=e,e=n);for(var n=-1,i=-1/0,r=!1,o=0,a=this.data.length;o<a;o++){var s=this.data[o];if(l.isBetween(s.x,t,e))s.y>i&&(r=!0,i=s.y,n=o);else if(r)break}if(-1!==n)return s=this.data[n],new ChemDoodle.structures.Point(s.x,100*s.y)},e.getClosestPeakInternalCoordinates=function(e){for(var t=this.getInverseTransformedX(e),n=1/(e=0),i=0,r=this.data.length;i<r;i++){var o=v.abs(this.data[i].x-t);if(!(o<=n))break;n=o,e=i}for(t=highestRight=e,n=maxRight=this.data[e].y,i=e+1,r=this.data.length;i<r&&this.data[i].y+.05>maxRight;i++)maxRight=this.data[i].y,highestRight=i;for(i=e-1;0<=i&&this.data[i].y+.05>n;i--)n=this.data[i].y,t=i;return e=this.data[t-e>highestRight-e?highestRight:t],new ChemDoodle.structures.Point(e.x,100*e.y)}}(ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,ChemDoodle.lib.jQuery,Math),function(o,e,r){e._Shape=function(){},(e=e._Shape.prototype).drawDecorations=function(e,t){if(this.isHover)for(var n=this.getPoints(),i=0,r=n.length;i<r;i++){var o=n[i];this.drawAnchor(e,t,o,o===this.hoverPoint)}},e.getBounds=function(){for(var e=new o.Bounds,t=this.getPoints(),n=0,i=t.length;n<i;n++){var r=t[n];e.expand(r.x,r.y)}return e},e.drawAnchor=function(e,t,n,i){e.save(),e.translate(n.x,n.y),e.rotate(r.PI/4),e.scale(1/t.scale,1/t.scale),e.beginPath(),e.moveTo(-4,-4),e.lineTo(4,-4),e.lineTo(4,4),e.lineTo(-4,4),e.closePath(),e.fillStyle=i?"#885110":"white",e.fill(),e.beginPath(),e.moveTo(-4,-2),e.lineTo(-4,-4),e.lineTo(-2,-4),e.moveTo(2,-4),e.lineTo(4,-4),e.lineTo(4,-2),e.moveTo(4,2),e.lineTo(4,4),e.lineTo(2,4),e.moveTo(-2,4),e.lineTo(-4,4),e.lineTo(-4,2),e.moveTo(-4,-2),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=5,e.stroke(),e.strokeStyle="blue",e.lineWidth=1,e.stroke(),e.restore()}}(ChemDoodle.math,ChemDoodle.structures.d2,Math),function(l,t,n,e,c){e.Bracket=function(e,t){this.p1=e||new n.Point,this.p2=t||new n.Point},(e=e.Bracket.prototype=new e._Shape).charge=0,e.mult=0,e.repeat=0,e.draw=function(e,t){var n=c.min(this.p1.x,this.p2.x),i=c.max(this.p1.x,this.p2.x),r=c.min(this.p1.y,this.p2.y),o=c.max(this.p1.y,this.p2.y),a=o-r,s=a/10;e.beginPath(),e.moveTo(n+s,r),e.lineTo(n,r),e.lineTo(n,o),e.lineTo(n+s,o),e.moveTo(i-s,o),e.lineTo(i,o),e.lineTo(i,r),e.lineTo(i-s,r),this.isLassoed&&((s=e.createLinearGradient(this.p1.x,this.p1.y,this.p2.x,this.p2.y)).addColorStop(0,"rgba(212, 99, 0, 0)"),s.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),s.addColorStop(1,"rgba(212, 99, 0, 0)"),e.lineWidth=t.shapes_lineWidth_2D+5,e.strokeStyle=s,e.lineJoin="miter",e.lineCap="square",e.stroke()),e.strokeStyle=t.shapes_color,e.lineWidth=t.shapes_lineWidth_2D,e.lineJoin="miter",e.lineCap="butt",e.stroke(),0!==this.charge&&(e.fillStyle=t.text_color,e.textAlign="left",e.textBaseline="alphabetic",e.font=l.getFontString(t.text_font_size,t.text_font_families),s="1"===(s=this.charge.toFixed(0))?"+":"-1"===s?"–":l.stringStartsWith(s,"-")?s.substring(1)+"–":s+"+",e.fillText(s,i+5,r+5)),0!==this.mult&&(e.fillStyle=t.text_color,e.textAlign="right",e.textBaseline="middle",e.font=l.getFontString(t.text_font_size,t.text_font_families),e.fillText(this.mult.toFixed(0),n-5,r+a/2)),0!==this.repeat&&(e.fillStyle=t.text_color,e.textAlign="left",e.textBaseline="top",e.font=l.getFontString(t.text_font_size,t.text_font_families),s=this.repeat.toFixed(0),e.fillText(s,i+5,o-5))},e.getPoints=function(){return[this.p1,this.p2]},e.isOver=function(e){return t.isBetween(e.x,this.p1.x,this.p2.x)&&t.isBetween(e.y,this.p1.y,this.p2.y)}}(ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math),function(i,n,y,b){y.Line=function(e,t){this.p1=e||new n.Point,this.p2=t||new n.Point},y.Line.ARROW_SYNTHETIC="synthetic",y.Line.ARROW_RETROSYNTHETIC="retrosynthetic",y.Line.ARROW_RESONANCE="resonance",y.Line.ARROW_EQUILIBRIUM="equilibrium";var e=y.Line.prototype=new y._Shape;e.arrowType=void 0,e.topText=void 0,e.bottomText=void 0,e.draw=function(e,t){var n,i,r,o,a,s,l,c,u,h,f,d,p,m,g,v,_;this.isLassoed&&((n=e.createLinearGradient(this.p1.x,this.p1.y,this.p2.x,this.p2.y)).addColorStop(0,"rgba(212, 99, 0, 0)"),n.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),n.addColorStop(1,"rgba(212, 99, 0, 0)"),_=2.5,a=this.p1.angle(this.p2)+b.PI/2,o=b.cos(a),a=b.sin(a),s=this.p1.x-o*_,l=this.p1.y+a*_,c=this.p1.x+o*_,u=this.p1.y-a*_,h=this.p2.x+o*_,f=this.p2.y-a*_,d=this.p2.x-o*_,p=this.p2.y+a*_,e.fillStyle=n,e.beginPath(),e.moveTo(s,l),e.lineTo(c,u),e.lineTo(h,f),e.lineTo(d,p),e.closePath(),e.fill()),e.strokeStyle=t.shapes_color,e.fillStyle=t.shapes_color,e.lineWidth=t.shapes_lineWidth_2D,e.lineJoin="miter",e.lineCap="butt",this.p1.x===this.p2.x&&this.p1.y===this.p2.y||(this.arrowType===y.Line.ARROW_RETROSYNTHETIC?(n=2*b.sqrt(2),_=t.shapes_arrowLength_2D/n,a=(o=this.p1.angle(this.p2))+b.PI/2,n=t.shapes_arrowLength_2D/n,i=b.cos(o),r=b.sin(o),o=b.cos(a),a=b.sin(a),s=this.p1.x-o*_,l=this.p1.y+a*_,c=this.p1.x+o*_,u=this.p1.y-a*_,h=this.p2.x+o*_-i*n,f=this.p2.y-a*_+r*n,d=this.p2.x-o*_-i*n,p=this.p2.y+a*_+r*n,m=this.p2.x+2*o*_-2*i*n,g=this.p2.y-2*a*_+2*r*n,v=this.p2.x-2*o*_-2*i*n,_=this.p2.y+2*a*_+2*r*n,e.beginPath(),e.moveTo(c,u),e.lineTo(h,f),e.moveTo(m,g),e.lineTo(this.p2.x,this.p2.y),e.lineTo(v,_),e.moveTo(d,p),e.lineTo(s,l)):this.arrowType===y.Line.ARROW_EQUILIBRIUM?(n=2*b.sqrt(2),_=t.shapes_arrowLength_2D/n/2,a=(o=this.p1.angle(this.p2))+b.PI/2,n=2*t.shapes_arrowLength_2D/b.sqrt(3),i=b.cos(o),r=b.sin(o),o=b.cos(a),a=b.sin(a),s=this.p1.x-o*_,l=this.p1.y+a*_,c=this.p1.x+o*_,u=this.p1.y-a*_,h=this.p2.x+o*_,f=this.p2.y-a*_,d=this.p2.x-o*_,p=this.p2.y+a*_,e.beginPath(),e.moveTo(c,u),e.lineTo(h,f),e.moveTo(d,p),e.lineTo(s,l),e.stroke(),c=h-.8*i*n,u=f+.8*r*n,m=h+o*t.shapes_arrowLength_2D/3-i*n,g=f-a*t.shapes_arrowLength_2D/3+r*n,e.beginPath(),e.moveTo(h,f),e.lineTo(m,g),e.lineTo(c,u),e.closePath(),e.fill(),e.stroke(),c=s+.8*i*n,u=l-.8*r*n,m=s-o*t.shapes_arrowLength_2D/3+i*n,g=l+a*t.shapes_arrowLength_2D/3-r*n,e.beginPath(),e.moveTo(s,l),e.lineTo(m,g),e.lineTo(c,u),e.closePath(),e.fill()):this.arrowType===y.Line.ARROW_SYNTHETIC?(a=(o=this.p1.angle(this.p2))+b.PI/2,n=2*t.shapes_arrowLength_2D/b.sqrt(3),i=b.cos(o),r=b.sin(o),o=b.cos(a),a=b.sin(a),e.beginPath(),e.moveTo(this.p1.x,this.p1.y),e.lineTo(this.p2.x-i*n/2,this.p2.y+r*n/2),e.stroke(),c=this.p2.x-.8*i*n,u=this.p2.y+.8*r*n,m=this.p2.x+o*t.shapes_arrowLength_2D/3-i*n,g=this.p2.y-a*t.shapes_arrowLength_2D/3+r*n,v=this.p2.x-o*t.shapes_arrowLength_2D/3-i*n,_=this.p2.y+a*t.shapes_arrowLength_2D/3+r*n,e.beginPath(),e.moveTo(this.p2.x,this.p2.y),e.lineTo(v,_),e.lineTo(c,u),e.lineTo(m,g),e.closePath(),e.fill()):this.arrowType===y.Line.ARROW_RESONANCE?(a=(o=this.p1.angle(this.p2))+b.PI/2,n=2*t.shapes_arrowLength_2D/b.sqrt(3),i=b.cos(o),r=b.sin(o),o=b.cos(a),a=b.sin(a),e.beginPath(),e.moveTo(this.p1.x+i*n/2,this.p1.y-r*n/2),e.lineTo(this.p2.x-i*n/2,this.p2.y+r*n/2),e.stroke(),c=this.p2.x-.8*i*n,u=this.p2.y+.8*r*n,m=this.p2.x+o*t.shapes_arrowLength_2D/3-i*n,g=this.p2.y-a*t.shapes_arrowLength_2D/3+r*n,v=this.p2.x-o*t.shapes_arrowLength_2D/3-i*n,_=this.p2.y+a*t.shapes_arrowLength_2D/3+r*n,e.beginPath(),e.moveTo(this.p2.x,this.p2.y),e.lineTo(v,_),e.lineTo(c,u),e.lineTo(m,g),e.closePath(),e.fill(),e.stroke(),c=this.p1.x+.8*i*n,u=this.p1.y-.8*r*n,m=this.p1.x-o*t.shapes_arrowLength_2D/3+i*n,g=this.p1.y+a*t.shapes_arrowLength_2D/3-r*n,v=this.p1.x+o*t.shapes_arrowLength_2D/3+i*n,_=this.p1.y-a*t.shapes_arrowLength_2D/3-r*n,e.beginPath(),e.moveTo(this.p1.x,this.p1.y),e.lineTo(v,_),e.lineTo(c,u),e.lineTo(m,g),e.closePath(),e.fill()):(e.beginPath(),e.moveTo(this.p1.x,this.p1.y),e.lineTo(this.p2.x,this.p2.y)),e.stroke(),this.topText&&(e.textAlign="center",e.textBaseline="bottom",e.fillText(this.topText,(this.p1.x+this.p2.x)/2,this.p1.y-5)),this.bottomText&&(e.textAlign="center",e.textBaseline="top",e.fillText(this.bottomText,(this.p1.x+this.p2.x)/2,this.p1.y+5)))},e.getPoints=function(){return[this.p1,this.p2]},e.isOver=function(e,t){var n=i.distanceFromPointToLineInclusive(e,this.p1,this.p2);return-1!==n&&n<t}}(ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math),function(g,r,v,e,_){function y(e){var t=[];if(e instanceof v.Atom){if(0===e.bondNumber)t.push(_.PI);else if(e.angles){if(1===e.angles.length)t.push(e.angles[0]+_.PI);else{for(var n=1,i=e.angles.length;n<i;n++)t.push(e.angles[n-1]+(e.angles[n]-e.angles[n-1])/2);n=e.angles[e.angles.length-1],t.push(n+(e.angles[0]+2*_.PI-n)/2)}if(e.largestAngle>_.PI&&(t=[e.angleOfLeastInterference]),e.bonds)for(n=0,i=e.bonds.length;n<i;n++){var r=e.bonds[n];if(2===r.bondOrder&&"O"===(r=r.getNeighbor(e)).label){t=[r.angle(e)];break}}}}else e=e.a1.angle(e.a2),t.push(e+_.PI/2),t.push(e+3*_.PI/2);for(n=0,i=t.length;n<i;n++){for(;t[n]>2*_.PI;)t[n]-=2*_.PI;for(;t[n]<0;)t[n]+=2*_.PI}return t}function b(e,t){var n=3;return e instanceof v.Atom?(e.isLabelVisible(t)&&(n=8),0===e.charge&&0===e.numRadical&&0===e.numLonePair||(n=13)):e instanceof v.Point?n=0:1<e.bondOrder&&(n=5),n}function x(e,t,n,i,r,o,a,s,l,c){var u=o.angle(r),h=a.angle(s),f=_.cos(u),u=_.sin(u),d=b(n,t);r.x-=f*d,r.y+=u*d,d=h+_.PI/2,n=2*t.shapes_arrowLength_2D/_.sqrt(3);var f=_.cos(h),u=_.sin(h),p=_.cos(d),m=_.sin(d);s.x-=5*f,s.y+=5*u,h=new v.Point(s.x,s.y),d=b(i,t)/3,h.x-=f*d,h.y+=u*d,s.x-=f*(.8*n+d),s.y+=u*(.8*n+d),i=h.x-.8*f*n;var d=h.y+.8*u*n,g=new v.Point(h.x+p*t.shapes_arrowLength_2D/3-f*n,h.y-m*t.shapes_arrowLength_2D/3+u*n);t=new v.Point(h.x-p*t.shapes_arrowLength_2D/3-f*n,h.y+m*t.shapes_arrowLength_2D/3+u*n),u=f=!0,1===l&&(g.distance(o)>t.distance(o)?u=!1:f=!1),e.beginPath(),e.moveTo(h.x,h.y),u&&e.lineTo(t.x,t.y),e.lineTo(i,d),f&&e.lineTo(g.x,g.y),e.closePath(),e.fill(),e.stroke(),e.beginPath(),e.moveTo(r.x,r.y),e.bezierCurveTo(o.x,o.y,a.x,a.y,s.x,s.y),e.stroke(),c.push([r,o,a,s])}e.Pusher=function(e,t,n){this.o1=e,this.o2=t,this.numElectron=n||1},(e=e.Pusher.prototype=new e._Shape).drawDecorations=function(e,t){if(this.isHover)for(var n=[n=this.o1 instanceof v.Atom?new v.Point(this.o1.x,this.o1.y):this.o1.getCenter(),i=this.o2 instanceof v.Atom?new v.Point(this.o2.x,this.o2.y):this.o2.getCenter()],i=0,r=n.length;i<r;i++){var o=n[i];this.drawAnchor(e,t,o,o===this.hoverPoint)}},e.draw=function(e,t){if(this.o1&&this.o2){e.strokeStyle=t.shapes_color,e.fillStyle=t.shapes_color,e.lineWidth=t.shapes_lineWidth_2D,e.lineJoin="miter",e.lineCap="butt";for(var n,i,r=this.o1 instanceof v.Atom?new v.Point(this.o1.x,this.o1.y):this.o1.getCenter(),o=this.o2 instanceof v.Atom?new v.Point(this.o2.x,this.o2.y):this.o2.getCenter(),a=y(this.o1),s=y(this.o2),l=1/0,c=0,u=a.length;c<u;c++)for(var h=0,f=s.length;h<f;h++){var d=new v.Point(r.x+35*_.cos(a[c]),r.y-35*_.sin(a[c])),p=new v.Point(o.x+35*_.cos(s[h]),o.y-35*_.sin(s[h])),m=d.distance(p);m<l&&(l=m,n=d,i=p)}this.caches=[],-1===this.numElectron?(c=r.distance(o)/2,a=(s=r.angle(o))+_.PI/2,u=_.cos(s),h=_.sin(s),s=new v.Point(r.x+(c-1)*u,r.y-(c-1)*h),l=new v.Point(s.x+35*_.cos(a+_.PI/6),s.y-35*_.sin(a+_.PI/6)),c=new v.Point(r.x+(c+1)*u,r.y-(c+1)*h),a=new v.Point(c.x+35*_.cos(a-_.PI/6),c.y-35*_.sin(a-_.PI/6)),x(e,t,this.o1,s,r,n,l,s,1,this.caches),x(e,t,this.o2,c,o,i,a,c,1,this.caches)):(g.intersectLines(r.x,r.y,n.x,n.y,o.x,o.y,i.x,i.y)&&(a=n,n=i,i=a),a=n.angle(r),s=i.angle(o),l=_.max(a,s)-_.min(a,s),_.abs(l-_.PI)<.001&&this.o1.molCenter===this.o2.molCenter&&(a+=_.PI/2,s-=_.PI/2,n.x=r.x+35*_.cos(a+_.PI),n.y=r.y-35*_.sin(a+_.PI),i.x=o.x+35*_.cos(s+_.PI),i.y=o.y-35*_.sin(s+_.PI)),x(e,t,this.o1,this.o2,r,n,i,o,this.numElectron,this.caches))}},e.getPoints=function(){return[]},e.isOver=function(e,t){for(var n=0,i=this.caches.length;n<i;n++)if(r.distanceFromCurve(e,this.caches[n]).distance<t)return!0;return!1}}(ChemDoodle.math,ChemDoodle.math.jsBezier,ChemDoodle.structures,ChemDoodle.structures.d2,Math),function(e){e._Mesh=function(){},(e=e._Mesh.prototype).storeData=function(e,t,n){this.positionData=e,this.normalData=t,this.indexData=n},e.setupBuffers=function(e){if(this.vertexPositionBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.vertexPositionBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.positionData),e.STATIC_DRAW),this.vertexPositionBuffer.itemSize=3,this.vertexPositionBuffer.numItems=this.positionData.length/3,this.vertexNormalBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.vertexNormalBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.normalData),e.STATIC_DRAW),this.vertexNormalBuffer.itemSize=3,this.vertexNormalBuffer.numItems=this.normalData.length/3,this.indexData&&(this.vertexIndexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexData),e.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexData.length),this.partitions)for(var t=0,n=this.partitions.length;t<n;t++){var i=this.partitions[t],r=this.generateBuffers(e,i.positionData,i.normalData,i.indexData);i.vertexPositionBuffer=r[0],i.vertexNormalBuffer=r[1],i.vertexIndexBuffer=r[2]}},e.generateBuffers=function(e,t,n,i){var r,o=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),o.itemSize=3,o.numItems=t.length/3,t=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW),t.itemSize=3,t.numItems=n.length/3,i&&(r=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(i),e.STATIC_DRAW),r.itemSize=1,r.numItems=i.length),[o,t,r]},e.bindBuffers=function(e){this.vertexPositionBuffer||this.setupBuffers(e),e.bindBuffer(e.ARRAY_BUFFER,this.vertexPositionBuffer),e.vertexAttribPointer(e.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.vertexNormalBuffer),e.vertexAttribPointer(e.shader.vertexNormalAttribute,this.vertexNormalBuffer.itemSize,e.FLOAT,!1,0,0),this.vertexIndexBuffer&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)}}(ChemDoodle.structures.d3,Math),function(e){e._Measurement=function(){},(e._Measurement.prototype=new e._Mesh).render=function(e,t){var n;e.setMatrixUniforms(e.modelViewMatrix),t.measurement_update_3D&&(this.text=this.vertexPositionBuffer=void 0),this.vertexPositionBuffer||this.calculateData(t),this.bindBuffers(e),e.material.setDiffuseColor(t.shapes_color),e.lineWidth(1),e.drawElements(e.LINES,this.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0),t.measurement_displayText_3D&&(this.text||(this.text=this.getText(t)),n={position:[],texCoord:[],translation:[]},e.textImage.pushVertexData(this.text.value,this.text.pos,1,n),e.textMesh.storeData(e,n.position,n.texCoord,n.translation),e.enable(e.BLEND),e.depthMask(!1),e.enableVertexAttribArray(e.shader.vertexTexCoordAttribute),e.textImage.useTexture(e),e.textMesh.render(e),e.disableVertexAttribArray(e.shader.vertexTexCoordAttribute),e.disable(e.BLEND),e.depthMask(!0))}}(ChemDoodle.structures.d3),function(e,l,t,n,c,u){t.Angle=function(e,t,n){this.a1=e,this.a2=t,this.a3=n},(e=t.Angle.prototype=new t._Measurement).calculateData=function(e){var t=[],n=[],i=[],r=this.a2.distance3D(this.a1),o=this.a2.distance3D(this.a3);for(this.distUse=c.min(r,o)/2,this.vec1=u.normalize([this.a1.x-this.a2.x,this.a1.y-this.a2.y,this.a1.z-this.a2.z]),this.vec2=u.normalize([this.a3.x-this.a2.x,this.a3.y-this.a2.y,this.a3.z-this.a2.z]),this.angle=l.vec3AngleFrom(this.vec1,this.vec2),r=u.normalize(u.cross(this.vec1,this.vec2,[])),r=u.normalize(u.cross(r,this.vec1,[])),e=e.measurement_angleBands_3D,o=0;o<=e;++o){var a=this.angle*o/e,s=u.scale(this.vec1,c.cos(a),[]),a=u.scale(r,c.sin(a),[]),s=u.scale(u.normalize(u.add(s,a,[])),this.distUse);t.push(this.a2.x+s[0],this.a2.y+s[1],this.a2.z+s[2]),n.push(0,0,0),o<e&&i.push(o,o+1)}this.storeData(t,n,i)},e.getText=function(){var e=u.scale(u.normalize(u.add(this.vec1,this.vec2,[])),this.distUse+.3);return{pos:[this.a2.x+e[0],this.a2.y+e[1],this.a2.z+e[2]],value:[n.angleBounds(this.angle,!0).toFixed(2)," °"].join("")}}}(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures.d3,ChemDoodle.math,Math,(ChemDoodle.lib.mat4,ChemDoodle.lib.vec3)),function(e,u){e.Arrow=function(e,t){for(var n=[],i=[],r=0;r<=t;r++){var o=2*r*u.PI/t,a=u.sin(o),o=u.cos(o);i.push(0,0,-1,0,0,-1,o,a,0,o,a,0,0,0,-1,0,0,-1,o,a,1,o,a,1),n.push(0,0,0,e*o,e*a,0,e*o,e*a,0,e*o,e*a,2,e*o,e*a,2,2*e*o,2*e*a,2,2*e*o,2*e*a,2,0,0,3)}for(r=[],a=0;a<t;a++)for(var o=8*a,s=0;s<7;s++){var l=s+o,c=l+7+2;r.push(l,c,l+1,c,l,c-1)}this.storeData(n,i,r)},e.Arrow.prototype=new e._Mesh}(ChemDoodle.structures.d3,Math),function(f,d,p){f.LineArrow=function(){this.storeData([0,0,-3,.1,0,-2.8,0,0,-3,-.1,0,-2.8,0,0,-3,0,0,3,0,0,3,.1,0,2.8,0,0,3,-.1,0,2.8],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},f.LineArrow.prototype=new f._Mesh,f.Compass=function(e,t){this.textImage=new f.TextImage,this.textImage.init(e),this.textImage.updateFont(e,t.text_font_size,t.text_font_families,t.text_font_bold,t.text_font_italic,t.text_font_stroke_3D),this.textMesh=new f.TextMesh,this.textMesh.init(e);var n,i=3/(t.compass_size_3D/e.canvas.clientHeight),r=d.tan(t.projectionPerspectiveVerticalFieldOfView_3D/360*d.PI),o=i/r,a=d.max(o-i,.1),s=e.canvas.clientWidth/e.canvas.clientHeight,l=t.projectionPerspective_3D?(u=a,p.frustum):(u=o,p.ortho),c=u/e.canvas.clientHeight*2*r,u=-(r=r*u),h=s*u,s=s*r;0===t.compass_type_3D&&(h-=n=(-(e.canvas.clientWidth-t.compass_size_3D)/2+this.textImage.charHeight)*c,s-=n,u-=c=(-(e.canvas.clientHeight-t.compass_size_3D)/2+this.textImage.charHeight)*c,r-=c),this.projectionMatrix=l(h,s,u,r,a,o+i),this.translationMatrix=p.translate(p.identity([]),[0,0,-o]),i={position:[],texCoord:[],translation:[]},this.textImage.pushVertexData("X",[3.5,0,0],0,i),this.textImage.pushVertexData("Y",[0,3.5,0],0,i),this.textImage.pushVertexData("Z",[0,0,3.5],0,i),this.textMesh.storeData(e,i.position,i.texCoord,i.translation)};var e=f.Compass.prototype;e.renderArrow=function(e,t,n,i){e.material.setDiffuseColor(n),e.setMatrixUniforms(i),1===t?e.drawArrays(e.LINES,0,e.lineArrowBuffer.vertexPositionBuffer.numItems):e.drawElements(e.TRIANGLES,e.arrowBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)},e.render=function(e,t){1===t.compass_type_3D?e.lineArrowBuffer.bindBuffers(e):e.arrowBuffer.bindBuffers(e),e.material.setTempColors(t.bonds_materialAmbientColor_3D,void 0,t.bonds_materialSpecularColor_3D,t.bonds_materialShininess_3D);var n=p.multiply(this.translationMatrix,e.rotationMatrix,[]),i=d.PI/2;e.fogging.setMode(0),this.renderArrow(e,t.compass_type_3D,t.compass_axisXColor_3D,p.rotateY(n,i,[])),this.renderArrow(e,t.compass_type_3D,t.compass_axisYColor_3D,p.rotateX(n,-i,[])),this.renderArrow(e,t.compass_type_3D,t.compass_axisZColor_3D,n)},e.renderAxis=function(e){var t=p.multiply(this.translationMatrix,e.rotationMatrix,[]);e.setMatrixUniforms(t),this.textImage.useTexture(e),this.textMesh.render(e)}}(ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4),function(e,l){e.Cylinder=function(e,t,n){for(var i=[],r=[],o=0;o<n;o++){var a=2*o*l.PI/n,s=l.cos(a),a=l.sin(a);r.push(s,0,a),i.push(e*s,0,e*a),r.push(s,0,a),i.push(e*s,t,e*a)}r.push(1,0,0),i.push(e,0,0),r.push(1,0,0),i.push(e,t,0),this.storeData(i,r)},e.Cylinder.prototype=new e._Mesh}(ChemDoodle.structures.d3,Math),function(n,e,i,r){e.Distance=function(e,t,n,i){this.a1=e,this.a2=t,this.node=n,this.offset=i||0},(e=e.Distance.prototype=new e._Measurement).calculateData=function(e){var t=[this.a1.x,this.a1.y,this.a1.z,this.a2.x,this.a2.y,this.a2.z];this.node&&(this.move=this.offset+i.max(e.atoms_useVDWDiameters_3D?n[this.a1.label].vdWRadius*e.atoms_vdwMultiplier_3D:e.atoms_sphereDiameter_3D/2,e.atoms_useVDWDiameters_3D?n[this.a2.label].vdWRadius*e.atoms_vdwMultiplier_3D:e.atoms_sphereDiameter_3D/2),this.displacement=[(this.a1.x+this.a2.x)/2-this.node.x,(this.a1.y+this.a2.y)/2-this.node.y,(this.a1.z+this.a2.z)/2-this.node.z],r.normalize(this.displacement),e=r.scale(this.displacement,this.move,[]),t[0]+=e[0],t[1]+=e[1],t[2]+=e[2],t[3]+=e[0],t[4]+=e[1],t[5]+=e[2]),this.storeData(t,[0,0,0,0,0,0],[0,1])},e.getText=function(){var e,t=this.a1.distance3D(this.a2),n=[(this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2,(this.a1.z+this.a2.z)/2];return this.node&&(e=r.scale(this.displacement,this.move+.1,[]),n[0]+=e[0],n[1]+=e[1],n[2]+=e[2]),{pos:n,value:[t.toFixed(2)," Å"].join("")}}}(ChemDoodle.ELEMENT,ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3),function(r,e){e.Fog=function(e){this.gl=e,this.mUL=e.getUniformLocation(e.program,"u_fog_mode"),this.cUL=e.getUniformLocation(e.program,"u_fog_color"),this.sUL=e.getUniformLocation(e.program,"u_fog_start"),this.eUL=e.getUniformLocation(e.program,"u_fog_end"),this.dUL=e.getUniformLocation(e.program,"u_fog_density")};var t=e.Fog.prototype;t.setTempParameter=function(e,t,n,i){this.cCache&&this.cCache===e||(this.cCache=e,e=r.getRGB(e,1),this.gl.uniform3f(this.cUL,e[0],e[1],e[2])),this.sCache&&this.sCache===t||(this.sCache=t,this.gl.uniform1f(this.sUL,t)),this.eCache&&this.eCache===n||(this.eCache=n,this.gl.uniform1f(this.eUL,n)),this.dCache&&this.dCache===i||(this.dCache=i,this.gl.uniform1f(this.dUL,i))},t.setMode=function(e){this.mCache&&this.mCache===e||(this.mCache=e,this.gl.uniform1i(this.mUL,e))}}(ChemDoodle.math,ChemDoodle.structures.d3,ChemDoodle.lib.vec3),function(v,e){e.Label=function(){this.textImage=new e.TextImage};var t=e.Label.prototype;t.init=function(e,t){this.textImage.init(e),this.textImage.updateFont(e,t.atoms_font_size_2D,t.atoms_font_families_2D,t.atoms_font_bold_2D,t.atoms_font_italic_2D,t.text_font_stroke_3D)},t.updateVerticesBuffer=function(e,t,n){for(var i=0,r=t.length;i<r;i++){for(var o=t[i],a=o.labelMesh,s=o.atoms,l=this.textImage,c={position:[],texCoord:[],translation:[]},u=0<s.length&&null!=s[0].hetatm,h=0,f=s.length;h<f;h++){var d,p=s[h],m=p.label,g=.05;if(n.atoms_useVDWDiameters_3D?(0===(d=v[m].vdWRadius*n.atoms_vdwMultiplier_3D)&&(d=1),g+=d):n.atoms_sphereDiameter_3D&&(g+=n.atoms_sphereDiameter_3D/2*1.5),u)if(p.hetatm){if(p.isWater&&!n.macro_showWaters)continue}else if(!n.macro_displayAtoms)continue;l.pushVertexData(m,[p.x,p.y,p.z],g,c)}if((o=o.chains)&&(n.proteins_displayRibbon||n.proteins_displayBackbone))for(h=0,f=o.length;h<f;h++)for(u=0,m=(s=o[h]).length;u<m;u++)(g=s[u]).name&&(p=g.cp1,l.pushVertexData(g.name,[p.x,p.y,p.z],2,c));a.storeData(e,c.position,c.texCoord,c.translation,c.zDepth)}},t.render=function(e,t,n){e.setMatrixUniforms(e.modelViewMatrix),this.textImage.useTexture(e),t=0;for(var i=n.length;t<i;t++)n[t].labelMesh&&n[t].labelMesh.render(e)}}(ChemDoodle.ELEMENT,ChemDoodle.structures.d3),function(e,f){e.Sphere=function(e,t,n){for(var i=[],r=[],o=0;o<=t;o++)for(var a=o*f.PI/t,s=f.sin(a),l=f.cos(a),a=0;a<=n;a++){var c=2*a*f.PI/n,u=f.sin(c),c=f.cos(c)*s,h=l,u=u*s;r.push(c,h,u),i.push(e*c,e*h,e*u)}for(e=[],n+=1,o=0;o<t;o++)for(a=0;a<n;a++)l=(s=o*n+a%n)+n,e.push(s,s+1,l),a<n-1&&e.push(l,s+1,l+1);this.storeData(i,r,e)},e.Sphere.prototype=new e._Mesh}(ChemDoodle.structures.d3,Math),function(i,e,b,x){function E(e,t,n,i){this.entire=e,this.name=t,this.indexes=n,this.pi=i}function o(e,t){e.bindBuffer(e.ARRAY_BUFFER,t.vertexPositionBuffer),e.vertexAttribPointer(e.shader.vertexPositionAttribute,t.vertexPositionBuffer.itemSize,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,t.vertexNormalBuffer),e.vertexAttribPointer(e.shader.vertexNormalAttribute,t.vertexNormalBuffer.itemSize,e.FLOAT,!1,0,0),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.vertexIndexBuffer)}var t=E.prototype;t.getColor=function(e){return e.macro_colorByChain?this.chainColor:this.name?this.getResidueColor(i[this.name]?this.name:"*",e):this.helix?this.entire.front?e.proteins_ribbonCartoonHelixPrimaryColor:e.proteins_ribbonCartoonHelixSecondaryColor:this.sheet?e.proteins_ribbonCartoonSheetColor:this.entire.front?e.proteins_primaryColor:e.proteins_secondaryColor},t.getResidueColor=function(e,t){var n=i[e];if("shapely"===t.proteins_residueColor)return n.shapelyColor;if("amino"===t.proteins_residueColor)return n.aminoColor;if("polarity"===t.proteins_residueColor){if(n.polar)return"#C10000"}else if("acidity"===t.proteins_residueColor){if(1===n.acidity)return"#0000FF";if(-1===n.acidity)return"#FF0000";if(!n.polar)return"#773300"}return"#FFFFFF"},t.render=function(e,t,n){this.entire.partitions&&this.pi!==this.entire.partitions.lastRender&&(o(e,this.entire.partitions[this.pi]),this.entire.partitions.lastRender=this.pi),this.vertexIndexBuffer||(this.vertexIndexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexes),e.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexes.length),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),n||"rainbow"===t.proteins_residueColor||e.material.setDiffuseColor(this.getColor(t)),e.drawElements(e.TRIANGLES,this.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)},e.Ribbon=function(e,t,n){var i=e[0].lineSegments.length,r=e[0].lineSegments[0].length;this.partitions=[],this.partitions.lastRender=0,this.front=0<t;for(var o,a,s=0,l=e.length-1;s<l;s++){(!a||65e3<a.positionData.length)&&(0<this.partitions.length&&s--,a={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(a));var c=e[s];a.count++;for(var u=0;u<i;u++)for(var h=n?c.lineSegmentsCartoon[u]:c.lineSegments[u],f=0===u,d=!1,p=0;p<r;p++){var m=h[p],g=s,v=p+1;s===e.length-2&&p===r-1?v--:p===r-1&&(g++,v=0);var v=n?e[g].lineSegmentsCartoon[u][v]:e[g].lineSegments[u][v],g=!1,_=u+1;u===i-1&&(_-=2,g=!0);var _=n?c.lineSegmentsCartoon[_][p]:c.lineSegments[_][p],v=[v.x-m.x,v.y-m.y,v.z-m.z],_=[_.x-m.x,_.y-m.y,_.z-m.z],y=x.cross(v,_,[]);0===p&&(x.normalize(v),x.scale(v,-1),a.normalData.push(v[0],v[1],v[2]),a.positionData.push(m.x,m.y,m.z)),f||d?(x.normalize(_),x.scale(_,-1),a.normalData.push(_[0],_[1],_[2]),a.positionData.push(m.x,m.y,m.z),f&&p===r-1&&(f=!1,p=-1)):(x.normalize(y),(g&&!this.front||!g&&this.front)&&x.scale(y,-1),a.normalData.push(y[0],y[1],y[2]),x.scale(y,b.abs(t)),a.positionData.push(m.x+y[0],m.y+y[1],m.z+y[2]),u===i-1&&p===r-1&&(d=!0,p=-1)),-1!==p&&p!==r-1||(x.normalize(v),a.normalData.push(v[0],v[1],v[2]),a.positionData.push(m.x,m.y,m.z))}}for(i+=2,r+=2,n&&(this.cartoonSegments=[]),this.segments=[],t=0,c=this.partitions.length;t<c;t++){for(n&&(o=[]),s=0,l=(a=this.partitions[t]).count-1;s<l;s++){for(h=s,u=0;u<t;u++)h+=this.partitions[u].count-1;for(u=e[h],0<s&&n&&u.split&&(p=new E(this,void 0,o,t),u.helix&&(p.helix=!0),u.sheet&&(p.sheet=!0),this.cartoonSegments.push(p),o=[]),f=s*i*r,d=[],u=0,m=i-1;u<m;u++)for(g=f+u*r,p=0;p<r;p++)v=1,s===a.count-1?v=0:p===r-1&&(v=i*r-p),v=[g+p,g+r+p,g+r+p+v,g+p,g+p+v,g+r+p+v],p!==r-1&&(this.front?d.push(v[0],v[1],v[2],v[3],v[5],v[4]):d.push(v[0],v[2],v[1],v[3],v[4],v[5])),p===r-2&&s<a.count-1&&(_=i*r-p,v[2]+=_,v[4]+=_,v[5]+=_),this.front?a.indexData.push(v[0],v[1],v[2],v[3],v[5],v[4]):a.indexData.push(v[0],v[2],v[1],v[3],v[4],v[5]),n&&(this.front?o.push(v[0],v[1],v[2],v[3],v[5],v[4]):o.push(v[0],v[2],v[1],v[3],v[4],v[5]));this.segments.push(new E(this,e[h+1].name,d,t))}if(n){for(p=new E(this,void 0,o,t),h=a.count-1,u=0;u<t;u++)h+=this.partitions[u].count-1;(u=e[h]).helix&&(p.helix=!0),u.sheet&&(p.sheet=!0),this.cartoonSegments.push(p)}}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData),1===this.partitions.length&&(this.partitions=void 0)},(e.Ribbon.prototype=new e._Mesh).render=function(e,t){if(this.bindBuffers(e),n=(n=t.macro_colorByChain?this.chainColor:void 0)||(this.front?t.proteins_primaryColor:t.proteins_secondaryColor),e.material.setDiffuseColor(n),e.drawElements(e.TRIANGLES,this.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0),this.partitions)for(var n=1,i=this.partitions.length;n<i;n++){var r=this.partitions[n];o(e,r),e.drawElements(e.TRIANGLES,r.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)}}}(ChemDoodle.RESIDUE,ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3),function(i,e,r){e.Light=function(e,t,n){this.diffuseRGB=i.getRGB(e,1),this.specularRGB=i.getRGB(t,1),this.direction=n},e.Light.prototype.lightScene=function(e){e.uniform3f(e.getUniformLocation(e.program,"u_light_diffuse_color"),this.diffuseRGB[0],this.diffuseRGB[1],this.diffuseRGB[2]),e.uniform3f(e.getUniformLocation(e.program,"u_light_specular_color"),this.specularRGB[0],this.specularRGB[1],this.specularRGB[2]);var t=r.create(this.direction);r.normalize(t),r.negate(t),e.uniform3f(e.getUniformLocation(e.program,"u_light_direction"),t[0],t[1],t[2]);var n=[0,0,0],t=[n[0]+t[0],n[1]+t[1],n[2]+t[2]];0===(n=r.length(t))?t=[0,0,1]:r.scale(1/n),e.uniform3f(e.getUniformLocation(e.program,"u_light_half_vector"),t[0],t[1],t[2])}}(ChemDoodle.math,ChemDoodle.structures.d3,ChemDoodle.lib.vec3),function(e){e.Line=function(){this.storeData([0,0,0,0,1,0],[0,0,0,0,0,0])},e.Line.prototype=new e._Mesh}(ChemDoodle.structures.d3),function(r,e){e.Material=function(e){this.gl=e,this.aUL=e.getUniformLocation(e.program,"u_material_ambient_color"),this.dUL=e.getUniformLocation(e.program,"u_material_diffuse_color"),this.sUL=e.getUniformLocation(e.program,"u_material_specular_color"),this.snUL=e.getUniformLocation(e.program,"u_material_shininess"),this.alUL=e.getUniformLocation(e.program,"u_material_alpha")};var t=e.Material.prototype;t.setTempColors=function(e,t,n,i){this.aCache&&this.aCache===e||(this.aCache=e,e=r.getRGB(e,1),this.gl.uniform3f(this.aUL,e[0],e[1],e[2])),!t||this.dCache&&this.dCache===t||(this.dCache=t,e=r.getRGB(t,1),this.gl.uniform3f(this.dUL,e[0],e[1],e[2])),this.sCache&&this.sCache===n||(this.sCache=n,e=r.getRGB(n,1),this.gl.uniform3f(this.sUL,e[0],e[1],e[2])),this.snCache&&this.snCache===i||(this.snCache=i,this.gl.uniform1f(this.snUL,i)),this.alCache=1,this.gl.uniform1f(this.alUL,1)},t.setDiffuseColor=function(e){this.dCache&&this.dCache===e||(this.dCache=e,e=r.getRGB(e,1),this.gl.uniform3f(this.dUL,e[0],e[1],e[2]))},t.setAlpha=function(e){this.alCache&&this.alCache===e||(this.alCache=e,this.gl.uniform1f(this.alUL,e))}}(ChemDoodle.math,ChemDoodle.structures.d3),function(T,e,w,C){e.MolecularSurface=function(e,t,n,i,r){function o(e,t,n,i){var r=e.index;if(e.contained)for(var r=-1,o=1/0,a=0,s=t.length;a<s;a++)for(var l=t[a],c=0,u=l.length;c<u;c++){var h,f=l[c];f.contained||f.index===n||f.index===i||(h=f.distance3D(e))<o&&(r=f.index,o=h)}return r}for(var a=[],s=[],l=[],c=[],u=0;u<=t;u++)for(var h=u*C.PI/t,f=C.sin(h),d=C.cos(h),h=0;h<=n;h++){var p=2*h*C.PI/n;c.push(C.cos(p)*f,d,C.sin(p)*f)}for(f=[],u=0,h=e.atoms.length;u<h;u++){for(var m,d=[],g=e.atoms[u],v=w[g.label][r]+i,_=[],p=0,y=e.atoms.length;p<y;p++){p!==u&&((m=e.atoms[p]).index=p,g.distance3D(m)<v+w[m.label][r]+i&&_.push(m))}for(p=0,y=c.length;p<y;p+=3){for(var b=new T.Atom("C",g.x+v*c[p],g.y+v*c[p+1],g.z+v*c[p+2]),x=0,E=_.length;x<E;x++)if(m=_[x],b.distance3D(m)<w[m.label][r]+i){b.contained=!0;break}d.push(b)}f.push(d)}for(e=[],n++,u=0;u<t;u++)for(h=0;h<n;h++)i=(r=u*n+h%n)+n,e.push(r),e.push(i),e.push(r+1),h<n-1&&(e.push(i),e.push(i+1),e.push(r+1));for(u=x=0,h=f.length;u<h;u++){for(p=0,y=(d=f[u]).length;p<y;p++)(b=d[p]).contained||(b.index=x,x++,a.push(b.x,b.y,b.z),s.push(c[3*p],c[3*p+1],c[3*p+2]));for(p=0,y=e.length;p<y;p+=3)r=d[e[p]],i=d[e[p+1]],b=d[e[p+2]],r.contained||i.contained||b.contained||l.push(r.index,i.index,b.index)}for(c=[],u=0,h=f.length;u<h;u++)for(d=f[u],p=0,y=e.length;p<y;p+=3){for(r=d[e[p]],i=d[e[p+1]],b=d[e[p+2]],_=[],x=0,E=f.length;x<E;x++)x!==u&&_.push(f[x]);if((!r.contained||!i.contained||!b.contained)&&(r.contained||i.contained||b.contained)&&(t=o(r,_,-1,-1),n=o(i,_,t,-1),_=o(b,_,t,n),-1!==t&&-1!==n&&-1!==_)){for(i=!1,x=0,E=c.length;x<E;x+=3)if(r=c[x],b=c[x+1],g=c[x+2],v=n===r||n===b||n===g,m=_===r||_===b||_===g,(t===r||t===b||t===g)&&v&&m){i=!0;break}i||c.push(t,n,_)}}l=l.concat(c),this.storeData(a,s,l)},e.MolecularSurface.prototype=new e._Mesh}(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.ELEMENT,Math),function(e){e.Picker=function(){},(e=e.Picker.prototype).init=function(e){this.framebuffer=e.createFramebuffer();var t=e.createTexture(),n=e.createRenderbuffer();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindRenderbuffer(e.RENDERBUFFER,n),e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,n),e.bindTexture(e.TEXTURE_2D,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null)},e.setDimension=function(e,t,n){e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer);var i=e.getFramebufferAttachmentParameter(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);e.isRenderbuffer(i)&&(e.bindRenderbuffer(e.RENDERBUFFER,i),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,t,n),e.bindRenderbuffer(e.RENDERBUFFER,null)),i=e.getFramebufferAttachmentParameter(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME),e.isTexture(i)&&(e.bindTexture(e.TEXTURE_2D,i),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,n,0,e.RGBA,e.UNSIGNED_BYTE,null),e.bindTexture(e.TEXTURE_2D,null)),e.bindFramebuffer(e.FRAMEBUFFER,null)},e.pick=function(e,t,n,i,r,o,a){var s=void 0,l=e.getParameter(e.COLOR_CLEAR_VALUE);e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer),e.clearColor(1,1,1,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.fogging.setMode(0),e.disableVertexAttribArray(e.shader.vertexNormalAttribute);var c=[];e.material.setAlpha(255);for(var u=0,h=t.length;u<h;u++)t[u].renderPickFrame(e,n,c,o,a);return e.flush(),t=new Uint8Array(4),e.readPixels(i-2,r+2,1,1,e.RGBA,e.UNSIGNED_BYTE,t),0<t[3]&&(s=c[t[2]|t[1]<<8|t[0]<<16]),e.enableVertexAttribArray(e.shader.vertexNormalAttribute),e.fogging.setMode(n.fog_mode_3D),e.bindFramebuffer(e.FRAMEBUFFER,null),e.clearColor(l[0],l[1],l[2],l[3]),s}}(ChemDoodle.structures.d3,(ChemDoodle.math,document)),function(e,p){e.Pill=function(e,t,n,i){var r=1;(t-=o=2*e)<0?(r=0,t+=o):t<o&&(r=t/o,t=o);for(var o=[],a=[],s=0;s<=n;s++)for(var l=s*p.PI/n,c=p.sin(l),u=p.cos(l)*r,l=0;l<=i;l++){var h=2*l*p.PI/i,f=p.sin(h),h=p.cos(h)*c,d=u,f=f*c;a.push(h,d,f),o.push(e*h,e*d+(s<n/2?t:0),e*f)}for(e=[],i+=1,s=0;s<n;s++)for(l=0;l<i;l++)r=(t=s*i+l%i)+i,e.push(t,t+1,r),l<i-1&&e.push(r,t+1,r+1);this.storeData(o,a,e)},e.Pill.prototype=new e._Mesh}(ChemDoodle.structures.d3,Math),function(e,o){e.Shader=function(){};var t=e.Shader.prototype;t.init=function(e){var t=(t=this.getShader(e,"vertex-shader"))||this.loadDefaultVertexShader(e),n=(n=this.getShader(e,"fragment-shader"))||this.loadDefaultFragmentShader(e);e.attachShader(e.program,t),e.attachShader(e.program,n),this.vertexPositionAttribute=0,e.bindAttribLocation(e.program,this.vertexPositionAttribute,"a_vertex_position"),e.linkProgram(e.program),e.getProgramParameter(e.program,e.LINK_STATUS)||alert("Could not initialize shaders: "+e.getProgramInfoLog(e.program)),e.useProgram(e.program),e.enableVertexAttribArray(this.vertexPositionAttribute),this.vertexTexCoordAttribute=e.getAttribLocation(e.program,"a_vertex_texcoord"),this.vertexNormalAttribute=e.getAttribLocation(e.program,"a_vertex_normal"),e.enableVertexAttribArray(this.vertexNormalAttribute),this.dimensionUniform=e.getUniformLocation(e.program,"u_dimension")},t.getShader=function(e,t){var n=o.getElementById(t);if(n){for(var i=[],r=n.firstChild;r;)3===r.nodeType&&i.push(r.textContent),r=r.nextSibling;if("x-shader/x-fragment"===n.type)r=e.createShader(e.FRAGMENT_SHADER);else{if("x-shader/x-vertex"!==n.type)return;r=e.createShader(e.VERTEX_SHADER)}if(e.shaderSource(r,i.join("")),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS))return r;alert(n.type+" "+e.getShaderInfoLog(r))}},t.loadDefaultVertexShader=function(e){var t=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(t,"precision mediump float;attribute vec3 a_vertex_position;attribute vec3 a_vertex_normal;attribute vec2 a_vertex_texcoord;uniform vec3 u_light_diffuse_color;uniform vec3 u_material_ambient_color;uniform vec3 u_material_diffuse_color;uniform mat4 u_model_view_matrix;uniform mat4 u_projection_matrix;uniform mat3 u_normal_matrix;uniform vec2 u_dimension;varying vec2 v_texcoord;varying vec3 v_diffuse;varying vec4 v_ambient;varying vec3 v_normal;void main() {v_texcoord = a_vertex_texcoord;if(length(a_vertex_texcoord) != 0.) {gl_Position = u_model_view_matrix * vec4(a_vertex_position, 1.);vec4 depth_pos = vec4(gl_Position);depth_pos.z += a_vertex_normal.z;gl_Position = u_projection_matrix * gl_Position;depth_pos = u_projection_matrix * depth_pos;gl_Position /= gl_Position.w;gl_Position.xy += a_vertex_normal.xy / u_dimension * 2.;gl_Position.z = depth_pos.z / depth_pos.w;} else {v_normal = length(a_vertex_normal)==0. ? a_vertex_normal : normalize(u_normal_matrix * a_vertex_normal);v_ambient = vec4(u_material_ambient_color, 1.);v_diffuse = u_material_diffuse_color * u_light_diffuse_color;gl_Position = u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.);gl_Position /= gl_Position.w;gl_PointSize = 2.;}}"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS))return t;alert("Vertex shader failed to compile: "+e.getShaderInfoLog(t))},t.loadDefaultFragmentShader=function(e){var t=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(t,"precision mediump float;\nuniform vec3 u_light_specular_color;uniform vec3 u_light_direction;uniform vec3 u_light_half_vector;uniform vec3 u_material_specular_color;uniform float u_material_shininess;uniform float u_material_alpha;uniform int u_fog_mode;uniform vec3 u_fog_color;uniform float u_fog_density;uniform float u_fog_start;uniform float u_fog_end;uniform sampler2D u_image;varying vec2 v_texcoord;varying vec3 v_diffuse;varying vec4 v_ambient;varying vec3 v_normal;void main(void){if(length(v_texcoord)!=0.) {gl_FragColor = texture2D(u_image, v_texcoord);}else if(length(v_normal)==0.){gl_FragColor = vec4(v_diffuse, u_material_alpha);}else{float nDotL = max(dot(v_normal, u_light_direction), 0.);vec4 color = vec4(v_diffuse*nDotL, 1.);float nDotHV = max(dot(v_normal, u_light_half_vector), 0.);vec3 specular = u_material_specular_color * u_light_specular_color;color+=vec4(specular * pow(nDotHV, u_material_shininess), 1.);gl_FragColor = color+v_ambient;gl_FragColor.a*=u_material_alpha;float fogCoord = gl_FragCoord.z/gl_FragCoord.w;float fogFactor = 1.;if(u_fog_mode == 1){if(fogCoord < u_fog_start){fogFactor = 1.;}else if(fogCoord > u_fog_end){fogFactor = 0.;}else{fogFactor = clamp((u_fog_end - fogCoord) / (u_fog_end - u_fog_start), 0., 1.);}}else if(u_fog_mode == 2) {fogFactor = clamp(exp(-u_fog_density*fogCoord), 0., 1.);}else if(u_fog_mode == 3) {fogFactor = clamp(exp(-pow(u_fog_density*fogCoord, 2.)), 0., 1.);}gl_FragColor = mix(vec4(u_fog_color, 1.), gl_FragColor, fogFactor);}}"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS))return t;alert("Fragment shader failed to compile: "+e.getShaderInfoLog(t))}}(ChemDoodle.structures.d3,document),function(f,e,d){e.Shape=function(e,t){for(var n=e.length,i=[],r=[],o=new f.Point,a=0,s=n;a<s;a++){var l=a+1;a===s-1&&(l=0);for(var c=e[a],l=e[l],u=d.cross([0,0,1],[l.x-c.x,l.y-c.y,0]),h=0;h<2;h++)i.push(c.x,c.y,t/2),i.push(c.x,c.y,-t/2),i.push(l.x,l.y,t/2),i.push(l.x,l.y,-t/2);for(h=0;h<4;h++)r.push(u[0],u[1],u[2]);r.push(0,0,1),r.push(0,0,-1),r.push(0,0,1),r.push(0,0,-1),o.add(c)}for(o.x/=n,o.y/=n,r.push(0,0,1),i.push(o.x,o.y,t/2),r.push(0,0,-1),i.push(o.x,o.y,-t/2),o=[],c=8*n,a=0,s=n;a<s;a++)n=8*a,o.push(n),o.push(n+3),o.push(n+1),o.push(n),o.push(n+2),o.push(n+3),o.push(n+4),o.push(c),o.push(n+6),o.push(n+5),o.push(n+7),o.push(c+1);this.storeData(i,r,o)},e.Shape.prototype=new e._Mesh}(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.lib.vec3),function(e,h){e.Star=function(){for(var e=[.8944,.4472,0,.2764,.4472,.8506,.2764,.4472,-.8506,-.7236,.4472,.5257,-.7236,.4472,-.5257,-.3416,.4472,0,-.1056,.4472,.3249,-.1056,.4472,-.3249,.2764,.4472,.2008,.2764,.4472,-.2008,-.8944,-.4472,0,-.2764,-.4472,.8506,-.2764,-.4472,-.8506,.7236,-.4472,.5257,.7236,-.4472,-.5257,.3416,-.4472,0,.1056,-.4472,.3249,.1056,-.4472,-.3249,-.2764,-.4472,.2008,-.2764,-.4472,-.2008,-.5527,.1058,0,-.1708,.1058,.5527,-.1708,.1058,-.5527,.4471,.1058,.3249,.4471,.1058,-.3249,.5527,-.1058,0,.1708,-.1058,.5527,.1708,-.1058,-.5527,-.4471,-.1058,.3249,-.4471,-.1058,-.3249,0,1,0,0,-1,0],t=[0,9,8,2,7,9,4,5,7,3,6,5,1,8,6,0,8,23,30,6,8,3,21,6,11,26,21,13,23,26,2,9,24,30,8,9,1,23,8,13,25,23,14,24,25,4,7,22,30,9,7,0,24,9,14,27,24,12,22,27,3,5,20,30,7,5,2,22,7,12,29,22,10,20,29,1,6,21,30,5,6,4,20,5,10,28,20,11,21,28,10,19,18,12,17,19,14,15,17,13,16,15,11,18,16,31,19,17,14,17,27,2,27,22,4,22,29,10,29,19,31,18,19,12,19,29,4,29,20,3,20,28,11,28,18,31,16,18,10,18,28,3,28,21,1,21,26,13,26,16,31,15,16,11,16,26,1,26,23,0,23,25,14,25,15,31,17,15,13,15,25,0,25,24,2,24,27,12,27,17],n=[],i=[],r=[],o=0,a=t.length;o<a;o+=3){var s=[e[s=3*t[o]],e[s+1],e[s+2]],l=[e[l=3*t[o+1]],e[l+1],e[l+2]],c=[e[c=3*t[o+2]],e[c+1],e[c+2]],u=h.cross([c[0]-l[0],c[1]-l[1],c[2]-l[2]],[s[0]-l[0],s[1]-l[1],s[2]-l[2]],[]);h.normalize(u),n.push(s[0],s[1],s[2],l[0],l[1],l[2],c[0],c[1],c[2]),i.push(u[0],u[1],u[2],u[0],u[1],u[2],u[0],u[1],u[2]),r.push(o,o+1,o+2)}this.storeData(n,i,r)},e.Star.prototype=new e._Mesh}(ChemDoodle.structures.d3,(Math,ChemDoodle.lib.vec3)),function(e,g,t){e.TextImage=function(){this.ctx=t.createElement("canvas").getContext("2d"),this.data=[],this.text="",this.charHeight=0},(e=e.TextImage.prototype).init=function(e){this.textureImage=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.textureImage),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.bindTexture(e.TEXTURE_2D,null),this.updateFont(e,12,["Sans-serif"],!1,!1,!1)},e.charData=function(e){return 0<=(e=this.text.indexOf(e))?this.data[e]:null},e.updateFont=function(e,t,n,i,r,o){var a=this.ctx,s=this.ctx.canvas,l=[],c="";r=g.getFontString(t,n,i,r),a.font=r,a.save();var u=0;for(t*=1.5,n=32,i=127;n<i;n++){var h=String.fromCharCode(n),f=a.measureText(h).width;l.push({text:h,width:f,height:t}),u+=2*f}var d=["°","Å","®"];for(n=0,i=d.length;n<i;n++)h=d[n],f=a.measureText(h).width,l.push({text:h,width:f,height:t}),u+=2*f;for(n=Math.sqrt(u*t),n=Math.ceil(n/t),u=Math.ceil(u/(n-1)),s.width=u,s.height=n*t,a.font=r,a.textAlign="left",a.textBaseline="middle",a.strokeStyle="#000",a.lineWidth=1.4,a.fillStyle="#fff",n=h=r=0,i=l.length;n<i;n++){d=2*(f=l[n]).width,t=f.height;var p=f.text;u<h+d&&(r++,h=0);var m=r*t;o&&a.strokeText(p,h,m+t/2),a.fillText(p,h,m+t/2),f.x=h,f.y=m,c+=p,h+=d}this.text=c,this.data=l,this.charHeight=t,e.bindTexture(e.TEXTURE_2D,this.textureImage),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,s),e.bindTexture(e.TEXTURE_2D,null)},e.pushVertexData=function(e,t,n,i){var r=e.toString().split(""),o=this.getHeight(),a=this.getWidth();e=-this.textWidth(e)/2;for(var s=-this.charHeight/2,l=0,c=r.length;l<c;l++){var u=(p=this.charData(r[l])).width,h=p.x/a,f=h+1.8*p.width/a,d=p.y/o,p=d+p.height/o,m=e+1.8*u,g=this.charHeight/2;i.position.push(t[0],t[1],t[2],t[0],t[1],t[2],t[0],t[1],t[2],t[0],t[1],t[2],t[0],t[1],t[2],t[0],t[1],t[2]),i.texCoord.push(h,d,f,p,f,d,h,d,h,p,f,p),i.translation.push(e,g,n,m,s,n,m,g,n,e,g,n,e,s,n,m,s,n),e=m+u-1.8*u}},e.getCanvas=function(){return this.ctx.canvas},e.getHeight=function(){return this.getCanvas().height},e.getWidth=function(){return this.getCanvas().width},e.textWidth=function(e){return this.ctx.measureText(e).width},e.test=function(){t.body.appendChild(this.getCanvas())},e.useTexture=function(e){e.bindTexture(e.TEXTURE_2D,this.textureImage)}}(ChemDoodle.structures.d3,ChemDoodle.extensions,document),function(e){e.TextMesh=function(){},(e=e.TextMesh.prototype).init=function(e){this.vertexPositionBuffer=e.createBuffer(),this.vertexTexCoordBuffer=e.createBuffer(),this.vertexTranslationBuffer=e.createBuffer()},e.setVertexData=function(e,t,n,i){e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW),t.itemSize=i,t.numItems=n.length/i},e.storeData=function(e,t,n,i){this.setVertexData(e,this.vertexPositionBuffer,t,3),this.setVertexData(e,this.vertexTexCoordBuffer,n,2),this.setVertexData(e,this.vertexTranslationBuffer,i,3)},e.bindBuffers=function(e){e.bindBuffer(e.ARRAY_BUFFER,this.vertexPositionBuffer),e.vertexAttribPointer(e.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.vertexTexCoordBuffer),e.vertexAttribPointer(e.shader.vertexTexCoordAttribute,this.vertexTexCoordBuffer.itemSize,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.vertexTranslationBuffer),e.vertexAttribPointer(e.shader.vertexNormalAttribute,this.vertexTranslationBuffer.itemSize,e.FLOAT,!1,0,0)},e.render=function(e){var t=this.vertexPositionBuffer.numItems;t&&(this.bindBuffers(e),e.drawArrays(e.TRIANGLES,0,t))}}(ChemDoodle.structures.d3,Math),function(e,t,n,h,f){n.Torsion=function(e,t,n,i){this.a1=e,this.a2=t,this.a3=n,this.a4=i},(e=n.Torsion.prototype=new n._Measurement).calculateData=function(e){var t=[],n=[],i=[],r=this.a2.distance3D(this.a1),o=this.a2.distance3D(this.a3);this.distUse=h.min(r,o)/2;var o=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],r=[this.a3.x-this.a2.x,this.a3.y-this.a2.y,this.a3.z-this.a2.z],a=[this.a4.x-this.a3.x,this.a4.y-this.a3.y,this.a4.z-this.a3.z],s=f.cross(o,r,[]),a=f.cross(r,a,[]);f.scale(o,f.length(r)),this.torsion=h.atan2(f.dot(o,a),f.dot(s,a)),o=f.normalize(f.cross(s,r,[])),s=f.normalize(f.cross(r,o,[])),this.pos=f.add([this.a2.x,this.a2.y,this.a2.z],f.scale(f.normalize(r,[]),this.distUse));var a=[],l=e.measurement_angleBands_3D;for(e=0;e<=l;++e){var c=this.torsion*e/l,u=f.scale(o,h.cos(c),[]),c=f.scale(s,h.sin(c),[]),u=f.scale(f.normalize(f.add(u,c,[])),this.distUse);0==e&&(a=u),t.push(this.pos[0]+u[0],this.pos[1]+u[1],this.pos[2]+u[2]),n.push(0,0,0),e<l&&i.push(e,e+1)}this.vecText=f.normalize(f.add(a,u,[])),r=f.normalize(r,[]),f.scale(r,.0625),c=this.torsion-2*h.asin(.125)*this.torsion/h.abs(this.torsion),u=f.scale(o,h.cos(c),[]),c=f.scale(s,h.sin(c),[]),u=f.scale(f.normalize(f.add(u,c,[])),this.distUse),t.push(this.pos[0]+r[0]+u[0],this.pos[1]+r[1]+u[1],this.pos[2]+r[2]+u[2]),n.push(0,0,0),t.push(this.pos[0]-r[0]+u[0],this.pos[1]-r[1]+u[1],this.pos[2]-r[2]+u[2]),n.push(0,0,0),i.push(--e,e+1,e,e+2),this.storeData(t,n,i)},e.getText=function(){return f.add(this.pos,f.scale(this.vecText,this.distUse+.3,[])),{pos:this.pos,value:[t.angleBounds(this.torsion,!0,!0).toFixed(2)," °"].join("")}}}(ChemDoodle.ELEMENT,ChemDoodle.math,(ChemDoodle.extensions,ChemDoodle.structures.d3),Math,(ChemDoodle.lib.mat4,ChemDoodle.lib.vec3)),function(_,y,b,e,x,E,T,w){function C(e,t,n){var i=x.sqrt(t[1]*t[1]+t[2]*t[2]),r=[1,0,0,0,0,t[2]/i,-t[1]/i,0,0,t[1]/i,t[2]/i,0,0,0,0,1],o=[1,0,0,0,0,t[2]/i,t[1]/i,0,0,-t[1]/i,t[2]/i,0,0,0,0,1],a=[i,0,-t[0],0,0,1,0,0,t[0],0,i,0,0,0,0,1];t=[i,0,t[0],0,0,1,0,0,-t[0],0,i,0,0,0,0,1],n=[x.cos(n),-x.sin(n),0,0,x.sin(n),x.cos(n),0,0,0,0,1,0,0,0,0,1];var s=E.multiply(r,E.multiply(a,E.multiply(n,E.multiply(t,o,[]))));this.rotate=function(){return E.multiplyVec3(s,e)}}e.Tube=function(h,f,e){var t,n=h[0].lineSegments[0].length;this.partitions=[],this.ends=[],this.ends.push(h[0].lineSegments[0][0]),this.ends.push(h[h.length-2].lineSegments[0][0]);for(var i=[1,0,0],r=0,o=h.length-1;r<o;r++){(!t||65e3<t.positionData.length)&&(0<this.partitions.length&&r--,t={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(t));var a=h[r];t.count++;for(var s=1/0,l=new b.Atom("",h[r+1].cp1.x,h[r+1].cp1.y,h[r+1].cp1.z),c=0;c<n;c++){var u=a.lineSegments[0][c],d=c===n-1?r===h.length-2?a.lineSegments[0][c-1]:h[r+1].lineSegments[0][0]:a.lineSegments[0][c+1];d=[d.x-u.x,d.y-u.y,d.z-u.z],T.normalize(d),r===h.length-2&&c===n-1&&T.scale(d,-1);var p=T.cross(d,i,[]);T.normalize(p),T.scale(p,f/2),p=new C(p,d,2*Math.PI/e),d=0;for(var m=e;d<m;d++){var g=p.rotate();d===x.floor(e/4)&&(i=[g[0],g[1],g[2]]),t.normalData.push(g[0],g[1],g[2]),t.positionData.push(u.x+g[0],u.y+g[1],u.z+g[2])}l&&((d=u.distance3D(l))<s&&(s=d,h[r+1].pPoint=u))}}for(i=0,a=this.partitions.length;i<a;i++)for(r=0,o=(t=this.partitions[i]).count-1;r<o;r++)for(s=r*n*e,c=0,l=n;c<l;c++)for(u=s+c*e,d=0;d<e;d++)p=u+d,t.indexData.push(p),t.indexData.push(p+e),t.indexData.push(p+e+1),t.indexData.push(p),t.indexData.push(p+e+1),t.indexData.push(p+1);for(this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData),e=[new b.Point(2,0)],r=0;r<60;r++)n=r/60*x.PI,e.push(new b.Point(2*x.cos(n),-2*x.sin(n)));e.push(new b.Point(-2,0),new b.Point(-2,4),new b.Point(2,4));var v=new b.d3.Shape(e,1);this.render=function(e,t){if(this.bindBuffers(e),e.material.setDiffuseColor(t.macro_colorByChain?this.chainColor:t.nucleics_tubeColor),e.drawElements(e.TRIANGLES,this.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0),this.partitions)for(var n=1,i=this.partitions.length;n<i;n++){var r=s=this.partitions[n];(u=e).bindBuffer(u.ARRAY_BUFFER,r.vertexPositionBuffer),u.vertexAttribPointer(u.shader.vertexPositionAttribute,r.vertexPositionBuffer.itemSize,u.FLOAT,!1,0,0),u.bindBuffer(u.ARRAY_BUFFER,r.vertexNormalBuffer),u.vertexAttribPointer(u.shader.vertexNormalAttribute,r.vertexNormalBuffer.itemSize,u.FLOAT,!1,0,0),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,r.vertexIndexBuffer),e.drawElements(e.TRIANGLES,s.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)}for(e.sphereBuffer.bindBuffers(e),n=0;n<2;n++)s=this.ends[n],s=E.translate(e.modelViewMatrix,[s.x,s.y,s.z],[]),i=f/2,E.scale(s,[i,i,i]),e.setMatrixUniforms(s),e.drawElements(e.TRIANGLES,e.sphereBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0);for(e.cylinderBuffer.bindBuffers(e),n=1,i=h.length-1;n<i;n++){var o=(r=h[n]).pPoint,a=new b.Atom("",r.cp2.x,r.cp2.y,r.cp2.z),s=1.001*o.distance3D(a),r=[f/4,s,f/4],s=E.translate(e.modelViewMatrix,[o.x,o.y,o.z],[]),l=[0,1,0],c=0,u=[a.x-o.x,a.y-o.y,a.z-o.z];o.x===a.x&&o.z===a.z?(l=[0,0,1],o.y<o.y&&(c=x.PI)):(c=_.vec3AngleFrom(l,u),l=T.cross(l,u,[])),0!==c&&E.rotate(s,c,l),E.scale(s,r),e.setMatrixUniforms(s),e.drawArrays(e.TRIANGLE_STRIP,0,e.cylinderBuffer.vertexPositionBuffer.numItems)}for(v.bindBuffers(e),"none"!==t.nucleics_residueColor||t.macro_colorByChain||e.material.setDiffuseColor(t.nucleics_baseColor),n=1,i=h.length-1;n<i;n++)a=(r=h[n]).cp2,s=E.translate(e.modelViewMatrix,[a.x,a.y,a.z],[]),l=[0,1,0],c=0,u=[(o=r.cp3).x-a.x,o.y-a.y,o.z-a.z],a.x===o.x&&a.z===o.z?(l=[0,0,1],a.y<a.y&&(c=x.PI)):(c=_.vec3AngleFrom(l,u),l=T.cross(l,u,[])),0!==c&&E.rotate(s,c,l),a=[1,0,0],c=E.rotate(E.identity([]),c,l),E.multiplyVec3(c,a),c=r.cp4,o=r.cp5,c.y===o.y&&c.z===o.z||(c=[o.x-c.x,o.y-c.y,o.z-c.z],o=_.vec3AngleFrom(a,c),T.dot(u,T.cross(a,c))<0&&(o*=-1),E.rotateY(s,o)),t.macro_colorByChain||("shapely"===t.nucleics_residueColor?y[r.name]?e.material.setDiffuseColor(y[r.name].shapelyColor):e.material.setDiffuseColor(y["*"].shapelyColor):"rainbow"===t.nucleics_residueColor&&e.material.setDiffuseColor(w.rainbowAt(n,i,t.macro_rainbowColors))),e.setMatrixUniforms(s),e.drawElements(e.TRIANGLES,v.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)}},e.Tube.prototype=new e._Mesh}(ChemDoodle.extensions,ChemDoodle.RESIDUE,ChemDoodle.structures,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3,ChemDoodle.math),function(e){e.UnitCell=function(e){var r=[],o=[],t=function(e,t,n,i){for(r.push(e[0],e[1],e[2]),r.push(t[0],t[1],t[2]),r.push(n[0],n[1],n[2]),r.push(i[0],i[1],i[2]),e=0;e<4;e++)o.push(0,0,0)};for(t(e.o,e.x,e.xy,e.y),t(e.o,e.y,e.yz,e.z),t(e.o,e.z,e.xz,e.x),t(e.yz,e.y,e.xy,e.xyz),t(e.xyz,e.xz,e.z,e.yz),t(e.xy,e.x,e.xz,e.xyz),e=[],t=0;t<6;t++){var n=4*t;e.push(n,1+n,1+n,2+n,2+n,3+n,3+n,n)}this.storeData(r,o,e)},e.UnitCell.prototype=new e._Mesh}(ChemDoodle.structures.d3,ChemDoodle.lib.vec3),function(e,o,a){e.Plate=function(e){for(this.lanes=Array(e),i=0,ii=e;i<ii;i++)this.lanes[i]=[]};var t=e.Plate.prototype;t.sort=function(){for(i=0,ii=this.lanes.length;i<ii;i++)this.lanes[i].sort(function(e,t){return e-t})},t.draw=function(e){var t=e.canvas.width,n=e.canvas.height;for(this.origin=9*n/10,this.front=n/10,this.laneLength=this.origin-this.front,e.strokeStyle="#000000",e.beginPath(),e.moveTo(0,this.front),o.contextHashTo(e,0,this.front,t,this.front,3,3),e.closePath(),e.stroke(),e.beginPath(),e.moveTo(0,this.origin),e.lineTo(t,this.origin),e.closePath(),e.stroke(),i=0,ii=this.lanes.length;i<ii;i++)for(n=(i+1)*t/(ii+1),e.beginPath(),e.moveTo(n,this.origin),e.lineTo(n,this.origin+3),e.closePath(),e.stroke(),s=0,ss=this.lanes[i].length;s<ss;s++){var r=this.origin-this.laneLength*this.lanes[i][s].rf;switch(this.lanes[i][s].type){case"compact":e.beginPath(),e.arc(n,r,3,0,2*a.PI,!1),e.closePath();break;case"expanded":e.beginPath(),e.arc(n,r,7,0,2*a.PI,!1),e.closePath();break;case"widened":o.contextOval(e,n-18,r-10,36,10);break;case"cresent":e.beginPath(),e.arc(n,r,9,0,a.PI,!0),e.closePath()}switch(this.lanes[i][s].style){case"solid":e.fillStyle="#000000",e.fill();break;case"transparent":e.stroke()}}},e.Plate.Spot=function(e,t,n){this.type=e,this.rf=t,this.style=n||"solid"}}(ChemDoodle.structures,ChemDoodle.extensions,Math),function(t,e,n){t.default_backgroundColor="#FFFFFF",t.default_scale=1,t.default_rotateAngle=0,t.default_bondLength_2D=20,t.default_angstromsPerBondLength=1.25,t.default_lightDirection_3D=[-.1,-.1,-1],t.default_lightDiffuseColor_3D="#FFFFFF",t.default_lightSpecularColor_3D="#FFFFFF",t.default_projectionPerspective_3D=!0,t.default_projectionPerspectiveVerticalFieldOfView_3D=45,t.default_projectionOrthoWidth_3D=40,t.default_projectionWidthHeightRatio_3D=void 0,t.default_projectionFrontCulling_3D=.1,t.default_projectionBackCulling_3D=1e4,t.default_cullBackFace_3D=!0,t.default_fog_mode_3D=0,t.default_fog_color_3D="#000000",t.default_fog_start_3D=0,t.default_fog_end_3D=1,t.default_fog_density_3D=1,t.default_atoms_display=!0,t.default_atoms_color="#000000",t.default_atoms_font_size_2D=12,t.default_atoms_font_families_2D=["Helvetica","Arial","Dialog"],t.default_atoms_font_bold_2D=!1,t.default_atoms_font_italic_2D=!1,t.default_atoms_circles_2D=!1,t.default_atoms_circleDiameter_2D=10,t.default_atoms_circleBorderWidth_2D=1,t.default_atoms_lonePairDistance_2D=8,t.default_atoms_lonePairSpread_2D=4,t.default_atoms_lonePairDiameter_2D=1,t.default_atoms_useJMOLColors=!1,t.default_atoms_usePYMOLColors=!1,t.default_atoms_resolution_3D=60,t.default_atoms_sphereDiameter_3D=.8,t.default_atoms_useVDWDiameters_3D=!1,t.default_atoms_vdwMultiplier_3D=1,t.default_atoms_materialAmbientColor_3D="#000000",t.default_atoms_materialSpecularColor_3D="#555555",t.default_atoms_materialShininess_3D=32,t.default_atoms_implicitHydrogens_2D=!0,t.default_atoms_displayTerminalCarbonLabels_2D=!1,t.default_atoms_showHiddenCarbons_2D=!0,t.default_atoms_showAttributedCarbons_2D=!0,t.default_atoms_displayAllCarbonLabels_2D=!1,t.default_atoms_nonBondedAsStars_3D=!1,t.default_atoms_displayLabels_3D=!1,t.default_atoms_HBlack_2D=!0,t.default_bonds_display=!0,t.default_bonds_color="#000000",t.default_bonds_width_2D=1,t.default_bonds_saturationWidth_2D=.2,t.default_bonds_ends_2D="round",t.default_bonds_useJMOLColors=!1,t.default_bonds_usePYMOLColors=!1,t.default_bonds_colorGradient=!1,t.default_bonds_saturationAngle_2D=n.PI/3,t.default_bonds_symmetrical_2D=!1,t.default_bonds_clearOverlaps_2D=!1,t.default_bonds_overlapClearWidth_2D=.5,t.default_bonds_atomLabelBuffer_2D=1,t.default_bonds_wedgeThickness_2D=.22,t.default_bonds_hashWidth_2D=1,t.default_bonds_hashSpacing_2D=2.5,t.default_bonds_dotSize_2D=2,t.default_bonds_lewisStyle_2D=!1,t.default_bonds_showBondOrders_3D=!1,t.default_bonds_resolution_3D=60,t.default_bonds_renderAsLines_3D=!1,t.default_bonds_cylinderDiameter_3D=.3,t.default_bonds_pillLatitudeResolution_3D=10,t.default_bonds_pillLongitudeResolution_3D=20,t.default_bonds_pillHeight_3D=.3,t.default_bonds_pillSpacing_3D=.1,t.default_bonds_pillDiameter_3D=.3,t.default_bonds_materialAmbientColor_3D="#222222",t.default_bonds_materialSpecularColor_3D="#555555",t.default_bonds_materialShininess_3D=32,t.default_proteins_displayRibbon=!0,t.default_proteins_displayBackbone=!1,t.default_proteins_backboneThickness=1.5,t.default_proteins_backboneColor="#CCCCCC",t.default_proteins_ribbonCartoonize=!1,t.default_proteins_residueColor="none",t.default_proteins_primaryColor="#FF0D0D",t.default_proteins_secondaryColor="#FFFF30",t.default_proteins_ribbonCartoonHelixPrimaryColor="#00E740",t.default_proteins_ribbonCartoonHelixSecondaryColor="#9905FF",t.default_proteins_ribbonCartoonSheetColor="#E8BB99",t.default_proteins_ribbonThickness=.2,t.default_proteins_verticalResolution=10,t.default_proteins_horizontalResolution=9,t.default_proteins_materialAmbientColor_3D="#222222",t.default_proteins_materialSpecularColor_3D="#555555",t.default_proteins_materialShininess_3D=32,t.default_nucleics_display=!0,t.default_nucleics_tubeColor="#CCCCCC",t.default_nucleics_baseColor="#C10000",t.default_nucleics_residueColor="none",t.default_nucleics_tubeThickness=1.5,t.default_nucleics_tubeResolution_3D=60,t.default_nucleics_verticalResolution=10,t.default_nucleics_materialAmbientColor_3D="#222222",t.default_nucleics_materialSpecularColor_3D="#555555",t.default_nucleics_materialShininess_3D=32,t.default_macro_displayAtoms=!1,t.default_macro_displayBonds=!1,t.default_macro_atomToLigandDistance=-1,t.default_macro_showWater=!1,t.default_macro_colorByChain=!1,t.default_macro_rainbowColors=["#0000FF","#00FFFF","#00FF00","#FFFF00","#FF0000"],t.default_surfaces_display=!0,t.default_surfaces_style="Dot",t.default_surfaces_color="#E9B862",t.default_surfaces_materialAmbientColor_3D="#000000",t.default_surfaces_materialSpecularColor_3D="#000000",t.default_surfaces_materialShininess_3D=32,t.default_crystals_displayUnitCell=!0,t.default_crystals_unitCellColor="green",t.default_crystals_unitCellLineWidth=1,t.default_plots_color="#000000",t.default_plots_width=1,t.default_plots_showIntegration=!1,t.default_plots_integrationColor="#c10000",t.default_plots_integrationLineWidth=1,t.default_plots_showGrid=!1,t.default_plots_gridColor="grey",t.default_plots_gridLineWidth=.5,t.default_plots_showYAxis=!0,t.default_plots_flipXAxis=!1,t.default_text_font_size=12,t.default_text_font_families=["Helvetica","Arial","Dialog"],t.default_text_font_bold=!0,t.default_text_font_italic=!1,t.default_text_font_stroke_3D=!0,t.default_text_color="#000000",t.default_shapes_color="#000000",t.default_shapes_lineWidth_2D=1,t.default_shapes_arrowLength_2D=8,t.default_compass_display=!1,t.default_compass_axisXColor_3D="#FF0000",t.default_compass_axisYColor_3D="#00FF00",t.default_compass_axisZColor_3D="#0000FF",t.default_compass_size_3D=50,t.default_compass_resolution_3D=10,t.default_compass_displayText_3D=!0,t.default_compass_type_3D=0,t.default_measurement_update_3D=!1,t.default_measurement_angleBands_3D=10,t.default_measurement_displayText_3D=!0,e.VisualSpecifications=function(){this.backgroundColor=t.default_backgroundColor,this.scale=t.default_scale,this.rotateAngle=t.default_rotateAngle,this.bondLength=t.default_bondLength_2D,this.angstromsPerBondLength=t.default_angstromsPerBondLength,this.lightDirection_3D=t.default_lightDirection_3D.slice(0),this.lightDiffuseColor_3D=t.default_lightDiffuseColor_3D,this.lightSpecularColor_3D=t.default_lightSpecularColor_3D,this.projectionPerspective_3D=t.default_projectionPerspective_3D,this.projectionPerspectiveVerticalFieldOfView_3D=t.default_projectionPerspectiveVerticalFieldOfView_3D,this.projectionOrthoWidth_3D=t.default_projectionOrthoWidth_3D,this.projectionWidthHeightRatio_3D=t.default_projectionWidthHeightRatio_3D,this.projectionFrontCulling_3D=t.default_projectionFrontCulling_3D,this.projectionBackCulling_3D=t.default_projectionBackCulling_3D,this.cullBackFace_3D=t.default_cullBackFace_3D,this.fog_mode_3D=t.default_fog_mode_3D,this.fog_color_3D=t.default_fog_color_3D,this.fog_start_3D=t.default_fog_start_3D,this.fog_end_3D=t.default_fog_end_3D,this.fog_density_3D=t.default_fog_density_3D,this.atoms_display=t.default_atoms_display,this.atoms_color=t.default_atoms_color,this.atoms_font_size_2D=t.default_atoms_font_size_2D,this.atoms_font_families_2D=t.default_atoms_font_families_2D.slice(0),this.atoms_font_bold_2D=t.default_atoms_font_bold_2D,this.atoms_font_italic_2D=t.default_atoms_font_italic_2D,this.atoms_circles_2D=t.default_atoms_circles_2D,this.atoms_circleDiameter_2D=t.default_atoms_circleDiameter_2D,this.atoms_circleBorderWidth_2D=t.default_atoms_circleBorderWidth_2D,this.atoms_lonePairDistance_2D=t.default_atoms_lonePairDistance_2D,this.atoms_lonePairSpread_2D=t.default_atoms_lonePairSpread_2D,this.atoms_lonePairDiameter_2D=t.default_atoms_lonePairDiameter_2D,this.atoms_useJMOLColors=t.default_atoms_useJMOLColors,this.atoms_usePYMOLColors=t.default_atoms_usePYMOLColors,this.atoms_resolution_3D=t.default_atoms_resolution_3D,this.atoms_sphereDiameter_3D=t.default_atoms_sphereDiameter_3D,this.atoms_useVDWDiameters_3D=t.default_atoms_useVDWDiameters_3D,this.atoms_vdwMultiplier_3D=t.default_atoms_vdwMultiplier_3D,this.atoms_materialAmbientColor_3D=t.default_atoms_materialAmbientColor_3D,this.atoms_materialSpecularColor_3D=t.default_atoms_materialSpecularColor_3D,this.atoms_materialShininess_3D=t.default_atoms_materialShininess_3D,this.atoms_implicitHydrogens_2D=t.default_atoms_implicitHydrogens_2D,this.atoms_displayTerminalCarbonLabels_2D=t.default_atoms_displayTerminalCarbonLabels_2D,this.atoms_showHiddenCarbons_2D=t.default_atoms_showHiddenCarbons_2D,this.atoms_showAttributedCarbons_2D=t.default_atoms_showAttributedCarbons_2D,this.atoms_displayAllCarbonLabels_2D=t.default_atoms_displayAllCarbonLabels_2D,this.atoms_nonBondedAsStars_3D=t.default_atoms_nonBondedAsStars_3D,this.atoms_displayLabels_3D=t.default_atoms_displayLabels_3D,this.atoms_HBlack_2D=t.default_atoms_HBlack_2D,this.bonds_display=t.default_bonds_display,this.bonds_color=t.default_bonds_color,this.bonds_width_2D=t.default_bonds_width_2D,this.bonds_saturationWidth_2D=t.default_bonds_saturationWidth_2D,this.bonds_ends_2D=t.default_bonds_ends_2D,this.bonds_useJMOLColors=t.default_bonds_useJMOLColors,this.bonds_usePYMOLColors=t.default_bonds_usePYMOLColors,this.bonds_colorGradient=t.default_bonds_colorGradient,this.bonds_saturationAngle_2D=t.default_bonds_saturationAngle_2D,this.bonds_symmetrical_2D=t.default_bonds_symmetrical_2D,this.bonds_clearOverlaps_2D=t.default_bonds_clearOverlaps_2D,this.bonds_overlapClearWidth_2D=t.default_bonds_overlapClearWidth_2D,this.bonds_atomLabelBuffer_2D=t.default_bonds_atomLabelBuffer_2D,this.bonds_wedgeThickness_2D=t.default_bonds_wedgeThickness_2D,this.bonds_hashWidth_2D=t.default_bonds_hashWidth_2D,this.bonds_hashSpacing_2D=t.default_bonds_hashSpacing_2D,this.bonds_dotSize_2D=t.default_bonds_dotSize_2D,this.bonds_lewisStyle_2D=t.default_bonds_lewisStyle_2D,this.bonds_showBondOrders_3D=t.default_bonds_showBondOrders_3D,this.bonds_resolution_3D=t.default_bonds_resolution_3D,this.bonds_renderAsLines_3D=t.default_bonds_renderAsLines_3D,this.bonds_cylinderDiameter_3D=t.default_bonds_cylinderDiameter_3D,this.bonds_pillHeight_3D=t.default_bonds_pillHeight_3D,this.bonds_pillLatitudeResolution_3D=t.default_bonds_pillLatitudeResolution_3D,this.bonds_pillLongitudeResolution_3D=t.default_bonds_pillLongitudeResolution_3D,this.bonds_pillSpacing_3D=t.default_bonds_pillSpacing_3D,this.bonds_pillDiameter_3D=t.default_bonds_pillDiameter_3D,this.bonds_materialAmbientColor_3D=t.default_bonds_materialAmbientColor_3D,this.bonds_materialSpecularColor_3D=t.default_bonds_materialSpecularColor_3D,this.bonds_materialShininess_3D=t.default_bonds_materialShininess_3D,this.proteins_displayRibbon=t.default_proteins_displayRibbon,this.proteins_displayBackbone=t.default_proteins_displayBackbone,this.proteins_backboneThickness=t.default_proteins_backboneThickness,this.proteins_backboneColor=t.default_proteins_backboneColor,this.proteins_ribbonCartoonize=t.default_proteins_ribbonCartoonize,this.proteins_residueColor=t.default_proteins_residueColor,this.proteins_primaryColor=t.default_proteins_primaryColor,this.proteins_secondaryColor=t.default_proteins_secondaryColor,this.proteins_ribbonCartoonHelixPrimaryColor=t.default_proteins_ribbonCartoonHelixPrimaryColor,this.proteins_ribbonCartoonHelixSecondaryColor=t.default_proteins_ribbonCartoonHelixSecondaryColor,this.proteins_ribbonCartoonSheetColor=t.default_proteins_ribbonCartoonSheetColor,this.proteins_ribbonThickness=t.default_proteins_ribbonThickness,this.proteins_verticalResolution=t.default_proteins_verticalResolution,this.proteins_horizontalResolution=t.default_proteins_horizontalResolution,this.proteins_materialAmbientColor_3D=t.default_proteins_materialAmbientColor_3D,this.proteins_materialSpecularColor_3D=t.default_proteins_materialSpecularColor_3D,this.proteins_materialShininess_3D=t.default_proteins_materialShininess_3D,this.macro_displayAtoms=t.default_macro_displayAtoms,this.macro_displayBonds=t.default_macro_displayBonds,this.macro_atomToLigandDistance=t.default_macro_atomToLigandDistance,this.nucleics_display=t.default_nucleics_display,this.nucleics_tubeColor=t.default_nucleics_tubeColor,this.nucleics_baseColor=t.default_nucleics_baseColor,this.nucleics_residueColor=t.default_nucleics_residueColor,this.nucleics_tubeThickness=t.default_nucleics_tubeThickness,this.nucleics_tubeResolution_3D=t.default_nucleics_tubeResolution_3D,this.nucleics_verticalResolution=t.default_nucleics_verticalResolution,this.nucleics_materialAmbientColor_3D=t.default_nucleics_materialAmbientColor_3D,this.nucleics_materialSpecularColor_3D=t.default_nucleics_materialSpecularColor_3D,this.nucleics_materialShininess_3D=t.default_nucleics_materialShininess_3D,this.macro_showWater=t.default_macro_showWater,this.macro_colorByChain=t.default_macro_colorByChain,this.macro_rainbowColors=t.default_macro_rainbowColors.slice(0),this.surfaces_display=t.default_surfaces_display,this.surfaces_style=t.default_surfaces_style,this.surfaces_color=t.default_surfaces_color,this.surfaces_materialAmbientColor_3D=t.default_surfaces_materialAmbientColor_3D,this.surfaces_materialSpecularColor_3D=t.default_surfaces_materialSpecularColor_3D,this.surfaces_materialShininess_3D=t.default_surfaces_materialShininess_3D,this.crystals_displayUnitCell=t.default_crystals_displayUnitCell,this.crystals_unitCellColor=t.default_crystals_unitCellColor,this.crystals_unitCellLineWidth=t.default_crystals_unitCellLineWidth,this.plots_color=t.default_plots_color,this.plots_width=t.default_plots_width,this.plots_showIntegration=t.default_plots_showIntegration,this.plots_integrationColor=t.default_plots_integrationColor,this.plots_integrationLineWidth=t.default_plots_integrationLineWidth,this.plots_showGrid=t.default_plots_showGrid,this.plots_gridColor=t.default_plots_gridColor,this.plots_gridLineWidth=t.default_plots_gridLineWidth,this.plots_showYAxis=t.default_plots_showYAxis,this.plots_flipXAxis=t.default_plots_flipXAxis,this.text_font_size=t.default_text_font_size,this.text_font_families=t.default_text_font_families.slice(0),this.text_font_bold=t.default_text_font_bold,this.text_font_italic=t.default_text_font_italic,this.text_font_stroke_3D=t.default_text_font_stroke_3D,this.text_color=t.default_text_color,this.shapes_color=t.default_shapes_color,this.shapes_lineWidth_2D=t.default_shapes_lineWidth_2D,this.shapes_arrowLength_2D=t.default_shapes_arrowLength_2D,this.compass_display=t.default_compass_display,this.compass_axisXColor_3D=t.default_compass_axisXColor_3D,this.compass_axisYColor_3D=t.default_compass_axisYColor_3D,this.compass_axisZColor_3D=t.default_compass_axisZColor_3D,this.compass_size_3D=t.default_compass_size_3D,this.compass_resolution_3D=t.default_compass_resolution_3D,this.compass_displayText_3D=t.default_compass_displayText_3D,this.compass_type_3D=t.default_compass_type_3D,this.measurement_update_3D=t.default_measurement_update_3D,this.measurement_angleBands_3D=t.default_measurement_angleBands_3D,this.measurement_displayText_3D=t.default_measurement_displayText_3D},e.VisualSpecifications.prototype.set3DRepresentation=function(e){this.bonds_display=this.atoms_display=!0,this.bonds_color="#777777",this.bonds_showBondOrders_3D=this.bonds_useJMOLColors=this.atoms_useJMOLColors=this.atoms_useVDWDiameters_3D=!0,this.bonds_renderAsLines_3D=!1,"Ball and Stick"===e?(this.atoms_vdwMultiplier_3D=.3,this.bonds_useJMOLColors=!1,this.bonds_cylinderDiameter_3D=.3,this.bonds_materialAmbientColor_3D=t.default_atoms_materialAmbientColor_3D,this.bonds_pillDiameter_3D=.15):"van der Waals Spheres"===e?(this.bonds_display=!1,this.atoms_vdwMultiplier_3D=1):"Stick"===e?(this.bonds_showBondOrders_3D=this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=this.atoms_sphereDiameter_3D=.8,this.bonds_materialAmbientColor_3D=this.atoms_materialAmbientColor_3D):"Wireframe"===e?(this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=this.bonds_pillDiameter_3D=.05,this.atoms_sphereDiameter_3D=.15,this.bonds_materialAmbientColor_3D=t.default_atoms_materialAmbientColor_3D):"Line"===e?(this.atoms_display=!1,this.bonds_renderAsLines_3D=!0,this.bonds_width_2D=1,this.bonds_cylinderDiameter_3D=.05):alert('"'+e+'" is not recognized. Use one of the following strings:\n\n1. Ball and Stick\n2. van der Waals Spheres\n3. Stick\n4. Wireframe\n5. Line\n')}}(ChemDoodle,ChemDoodle.structures,Math),function(e,l,c,u){c.getPointsPerAngstrom=function(){return e.default_bondLength_2D/e.default_angstromsPerBondLength},c.BondDeducer=function(){};var t=c.BondDeducer.prototype;t.margin=1.1,t.deduceCovalentBonds=function(e,t){var n=c.getPointsPerAngstrom();t&&(n=t);for(var i=0,r=e.atoms.length;i<r;i++)for(var o=i+1;o<r;o++){var a=e.atoms[i],s=e.atoms[o];a.distance3D(s)<(l[a.label].covalentRadius+l[s.label].covalentRadius)*n*this.margin&&e.bonds.push(new u.Bond(a,s,1))}}}(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.informatics,ChemDoodle.structures),function(e){e.HydrogenDeducer=function(){},e.HydrogenDeducer.prototype.removeHydrogens=function(e){for(var t=[],n=[],i=0,r=e.bonds.length;i<r;i++)"H"!==e.bonds[i].a1.label&&"H"!==e.bonds[i].a2.label&&n.push(e.bonds[i]);for(i=0,r=e.atoms.length;i<r;i++)"H"!==e.atoms[i].label&&t.push(e.atoms[i]);e.atoms=t,e.bonds=n}}(ChemDoodle.informatics),function(e,o){e.MolecularSurfaceGenerator=function(){},e.MolecularSurfaceGenerator.prototype.generateSurface=function(e,t,n,i,r){return new o.MolecularSurface(e,t,n,i,r)}}(ChemDoodle.informatics,ChemDoodle.structures.d3),function(e,u){e.Splitter=function(){},e.Splitter.prototype.split=function(e){for(var t=[],n=0,i=e.atoms.length;n<i;n++)e.atoms[n].visited=!1;for(n=0,i=e.bonds.length;n<i;n++)e.bonds[n].visited=!1;for(n=0,i=e.atoms.length;n<i;n++){if(!(a=e.atoms[n]).visited){var r=new u.Molecule;r.atoms.push(a),a.visited=!0;var o=new u.Queue;for(o.enqueue(a);!o.isEmpty();)for(var a=o.dequeue(),s=0,l=e.bonds.length;s<l;s++){var c=e.bonds[s];c.contains(a)&&!c.visited&&(c.visited=!0,r.bonds.push(c),(c=c.getNeighbor(a)).visited||(c.visited=!0,r.atoms.push(c),o.enqueue(c)))}t.push(r)}}return t}}(ChemDoodle.informatics,ChemDoodle.structures),function(e,n){e.StructureBuilder=function(){},e.StructureBuilder.prototype.copy=function(e){var t=new n.JSONInterpreter;return t.molFrom(t.molTo(e))}}(ChemDoodle.informatics,ChemDoodle.io,ChemDoodle.structures),function(e){e._Counter=function(){},(e=e._Counter.prototype).value=0,e.molecule=void 0,e.setMolecule=function(e){this.value=0,this.molecule=e,this.innerCalculate&&this.innerCalculate()}}(ChemDoodle.informatics),function(e){e.FrerejacqueNumberCounter=function(e){this.setMolecule(e)},(e.FrerejacqueNumberCounter.prototype=new e._Counter).innerCalculate=function(){this.value=this.molecule.bonds.length-this.molecule.atoms.length+new e.NumberOfMoleculesCounter(this.molecule).value}}(ChemDoodle.informatics),function(s,e){e.NumberOfMoleculesCounter=function(e){this.setMolecule(e)},(e.NumberOfMoleculesCounter.prototype=new e._Counter).innerCalculate=function(){for(var e=0,t=this.molecule.atoms.length;e<t;e++)this.molecule.atoms[e].visited=!1;for(e=0,t=this.molecule.atoms.length;e<t;e++)if(!this.molecule.atoms[e].visited){this.value++;var n=new s.Queue;for(this.molecule.atoms[e].visited=!0,n.enqueue(this.molecule.atoms[e]);!n.isEmpty();)for(var i=n.dequeue(),r=0,o=this.molecule.bonds.length;r<o;r++){var a=this.molecule.bonds[r];a.contains(i)&&((a=a.getNeighbor(i)).visited||(a.visited=!0,n.enqueue(a)))}}}}(ChemDoodle.structures,ChemDoodle.informatics),function(e){e._RingFinder=function(){},(e=e._RingFinder.prototype).atoms=void 0,e.bonds=void 0,e.rings=void 0,e.reduce=function(e){for(var t=0,n=e.atoms.length;t<n;t++)e.atoms[t].visited=!1;for(t=0,n=e.bonds.length;t<n;t++)e.bonds[t].visited=!1;for(var i=!0;i;)for(i=!1,t=0,n=e.atoms.length;t<n;t++){for(var r,o=0,a=0,s=e.bonds.length;a<s;a++)if(e.bonds[a].contains(e.atoms[t])&&!e.bonds[a].visited){if(2===++o)break;r=e.bonds[a]}1===o&&(i=!0,r.visited=!0,e.atoms[t].visited=!0)}for(t=0,n=e.atoms.length;t<n;t++)e.atoms[t].visited||this.atoms.push(e.atoms[t]);for(t=0,n=e.bonds.length;t<n;t++)e.bonds[t].visited||this.bonds.push(e.bonds[t]);0===this.bonds.length&&0!==this.atoms.length&&(this.atoms=[])},e.setMolecule=function(e){this.atoms=[],this.bonds=[],this.rings=[],this.reduce(e),2<this.atoms.length&&this.innerGetRings&&this.innerGetRings()},e.fuse=function(){for(var e=0,t=this.rings.length;e<t;e++)for(var n=0,i=this.bonds.length;n<i;n++)-1!==this.rings[e].atoms.indexOf(this.bonds[n].a1)&&-1!==this.rings[e].atoms.indexOf(this.bonds[n].a2)&&this.rings[e].bonds.push(this.bonds[n])}}(ChemDoodle.informatics),function(e,s){function m(e,t){if(this.atoms=[],t)for(var n=0,i=t.atoms.length;n<i;n++)this.atoms[n]=t.atoms[n];this.atoms.push(e)}var t=m.prototype;t.grow=function(e,t){for(var n,i=this.atoms[this.atoms.length-1],r=[],o=0,a=e.length;o<a;o++){e[o].contains(i)&&(n=e[o].getNeighbor(i),-1===t.indexOf(n)&&r.push(n))}for(i=[],o=0,a=r.length;o<a;o++)i.push(new m(r[o],this));return i},t.check=function(e,t,n){for(var i,r=0,o=t.atoms.length-1;r<o;r++)if(-1!==this.atoms.indexOf(t.atoms[r]))return;if(t.atoms[t.atoms.length-1]===this.atoms[this.atoms.length-1]){for((i=new s.Ring).atoms[0]=n,r=0,o=this.atoms.length;r<o;r++)i.atoms.push(this.atoms[r]);for(r=t.atoms.length-2;0<=r;r--)i.atoms.push(t.atoms[r])}else{for(var a=[],r=0,o=e.length;r<o;r++)e[r].contains(t.atoms[t.atoms.length-1])&&a.push(e[r]);for(r=0,o=a.length;r<o;r++)if((1===t.atoms.length||!a[r].contains(t.atoms[t.atoms.length-2]))&&a[r].contains(this.atoms[this.atoms.length-1])){for((i=new s.Ring).atoms[0]=n,e=0,n=this.atoms.length;e<n;e++)i.atoms.push(this.atoms[e]);for(e=t.atoms.length-1;0<=e;e--)i.atoms.push(t.atoms[e]);break}}return i},e.EulerFacetRingFinder=function(e){this.setMolecule(e)},(t=e.EulerFacetRingFinder.prototype=new e._RingFinder).fingerBreak=5,t.innerGetRings=function(){for(var e=0,t=this.atoms.length;e<t;e++){for(var n=[],i=0,r=this.bonds.length;i<r;i++)this.bonds[i].contains(this.atoms[e])&&n.push(this.bonds[i].getNeighbor(this.atoms[e]));for(i=0,r=n.length;i<r;i++)for(var o=i+1;o<n.length;o++){var a=[];a[0]=new m(n[i]),a[1]=new m(n[o]);var s=[];s[0]=this.atoms[e];for(var l=0,c=n.length;l<c;l++)l!==i&&l!==o&&s.push(n[l]);var u=[];for((l=a[0].check(this.bonds,a[1],this.atoms[e]))&&(u[0]=l);0===u.length&&0<a.length&&a[0].atoms.length<this.fingerBreak;){for(var h=[],l=0,c=a.length;l<c;l++)for(var f=a[l].grow(this.bonds,s),d=0,p=f.length;d<p;d++)h.push(f[d]);for(l=0,c=(a=h).length;l<c;l++)for(d=l+1;d<c;d++)(p=a[l].check(this.bonds,a[d],this.atoms[e]))&&u.push(p);if(0===u.length){for(h=[],l=0,c=s.length;l<c;l++)for(d=0,p=this.bonds.length;d<p;d++)this.bonds[d].contains(s[l])&&(n=this.bonds[d].getNeighbor(s[l]),-1===s.indexOf(n)&&-1===h.indexOf(n)&&h.push(n));for(l=0,c=h.length;l<c;l++)s.push(h[l])}}if(0<u.length){for(a=void 0,l=0,c=u.length;l<c;l++)(!a||a.atoms.length>u[l].atoms.length)&&(a=u[l]);for(u=!1,l=0,c=this.rings.length;l<c;l++){for(s=!0,d=0,p=a.atoms.length;d<p;d++)if(-1===this.rings[l].atoms.indexOf(a.atoms[d])){s=!1;break}if(s){u=!0;break}}u||this.rings.push(a)}}}this.fuse()}}(ChemDoodle.informatics,ChemDoodle.structures),function(s){s.SSSRFinder=function(e){if(this.rings=[],0<e.atoms.length){var t=new s.FrerejacqueNumberCounter(e).value,n=new s.EulerFacetRingFinder(e).rings;n.sort(function(e,t){return e.atoms.length-t.atoms.length});for(var i=0,r=e.bonds.length;i<r;i++)e.bonds[i].visited=!1;for(i=0,r=n.length;i<r;i++){e=!1;for(var o=0,a=n[i].bonds.length;o<a;o++)if(!n[i].bonds[o].visited){e=!0;break}if(e){for(o=0,a=n[i].bonds.length;o<a;o++)n[i].bonds[o].visited=!0;this.rings.push(n[i])}if(this.rings.length===t)break}}}}(ChemDoodle.informatics),function(e){e._Interpreter=function(){},e._Interpreter.prototype.fit=function(e,t,n){for(var i=e.length,r=[],o=0;o<t-i;o++)r.push(" ");return n?e+r.join(""):r.join("")+e}}(ChemDoodle.io),function(w,C,e,S,D,R){function A(e){return 0!==e.length}function M(e){var t=0,n=0,i=0,r=0,o=e.indexOf("x"),a=e.indexOf("y"),s=e.indexOf("z");if(-1!==o&&(n++,0<o&&"+"!==e.charAt(o-1)&&(n*=-1)),-1!==a&&(i++,0<a&&"+"!==e.charAt(a-1)&&(i*=-1)),-1!==s&&(r++,0<s&&"+"!==e.charAt(s-1)&&(r*=-1)),2<e.length)for(o="+",a=0,s=e.length;a<s;a++){var l=e.charAt(a);"-"!==l&&"/"!==l||a!==e.length-1&&!e.charAt(a+1).match(c)||(o=l),l.match(c)&&("+"===o?t+=parseInt(l):"-"===o?t-=parseInt(l):"/"===o&&(t/=parseInt(l)))}return[t,n,i,r]}var L=/\s+/g,H=/\(|\)|\s+/g,F=/\'|\s+/g,P=/,|\'|\s+/g,N=/^\s+/,c=/[0-9]/g,k=/[0-9]|\+|\-/g,I={P:[],A:[[0,.5,.5]],B:[[.5,0,.5]],C:[[.5,.5,0]],I:[[.5,.5,.5]],R:[[2/3,1/3,1/3],[1/3,2/3,2/3]],S:[[1/3,1/3,2/3],[2/3,2/3,1/3]],T:[[1/3,2/3,1/3],[2/3,1/3,2/3]],F:[[0,.5,.5],[.5,0,.5],[.5,.5,0]]};e.CIFInterpreter=function(){},(e.CIFInterpreter.prototype=new e._Interpreter).read=function(e,t,n,i){t=t||1,n=n||1,i=i||1;var r=new S.Molecule;if(!e)return r;for(var o,a,s,l=e.split("\n"),c=0,u=0,h=0,f=e=0,d=0,p="P",m=!0;0<l.length;)if(m?s=l.shift():m=!0,0<s.length)if(C.stringStartsWith(s,"_cell_length_a"))c=parseFloat(s.split(H)[1]);else if(C.stringStartsWith(s,"_cell_length_b"))u=parseFloat(s.split(H)[1]);else if(C.stringStartsWith(s,"_cell_length_c"))h=parseFloat(s.split(H)[1]);else if(C.stringStartsWith(s,"_cell_angle_alpha"))e=D.PI*parseFloat(s.split(H)[1])/180;else if(C.stringStartsWith(s,"_cell_angle_beta"))f=D.PI*parseFloat(s.split(H)[1])/180;else if(C.stringStartsWith(s,"_cell_angle_gamma"))d=D.PI*parseFloat(s.split(H)[1])/180;else if(C.stringStartsWith(s,"_symmetry_space_group_name_H-M"))p=s.split(F)[1];else if(C.stringStartsWith(s,"loop_")){for(var g={fields:[],lines:[]},v=!1;void 0!==(s=l.shift())&&!C.stringStartsWith(s=s.replace(N,""),"loop_")&&0<s.length;)if(C.stringStartsWith(s,"_")){if(v)break;g.fields=g.fields.concat(s.split(L).filter(A))}else v=!0,g.lines.push(s);0!==l.length&&(C.stringStartsWith(s,"loop_")||C.stringStartsWith(s,"_"))&&(m=!1),-1!==g.fields.indexOf("_symmetry_equiv_pos_as_xyz")||-1!==g.fields.indexOf("_space_group_symop_operation_xyz")?o=g:-1!==g.fields.indexOf("_atom_site_label")?E=g:-1!==g.fields.indexOf("_geom_bond_atom_site_label_1")&&(a=g)}if(s=c,e=(D.cos(e)-D.cos(d)*D.cos(f))/D.sin(d),e=[s,0,0,0,u*D.cos(d),u*D.sin(d),0,0,h*D.cos(f),h*e,h*D.sqrt(1-D.pow(D.cos(f),2)-e*e),0,0,0,0,1],E){for(g=m=c=l=h=-1,d=0,f=E.fields.length;d<f;d++)"_atom_site_type_symbol"===(s=E.fields[d])?h=d:"_atom_site_label"===s?l=d:"_atom_site_fract_x"===s?c=d:"_atom_site_fract_y"===s?m=d:"_atom_site_fract_z"===s&&(g=d);for(d=0,f=E.lines.length;d<f;d++)u=(s=E.lines[d]).split(L).filter(A),s=new S.Atom(u[-1===h?l:h].split(k)[0],parseFloat(u[c]),parseFloat(u[m]),parseFloat(u[g])),r.atoms.push(s),-1!==l&&(s.cifId=u[l],s.cifPart=0)}if(o&&!a){for(d=u=0,f=o.fields.length;d<f;d++)"_symmetry_equiv_pos_as_xyz"!==(s=o.fields[d])&&"_space_group_symop_operation_xyz"!==s||(u=d);for(m=I[p],l=[],d=0,f=o.lines.length;d<f;d++){s=o.lines[d].split(P).filter(A);for(var g=M(s[u]),v=M(s[u+1]),_=M(s[u+2]),p=0,c=r.atoms.length;p<c;p++){var y=(s=r.atoms[p]).x*g[1]+s.y*g[2]+s.z*g[3]+g[0],b=s.x*v[1]+s.y*v[2]+s.z*v[3]+v[0],x=s.x*_[1]+s.y*_[2]+s.z*_[3]+_[0],E=new S.Atom(s.label,y,b,x);if(l.push(E),void 0!==s.cifId&&(E.cifId=s.cifId,E.cifPart=d+1),m)for(E=0,h=m.length;E<h;E++){var T=m[E],T=new S.Atom(s.label,y+T[0],b+T[1],x+T[2]);l.push(T),void 0!==s.cifId&&(T.cifId=s.cifId,T.cifPart=d+1)}}}for(d=0,f=l.length;d<f;d++){for(s=l[d];1<=s.x;)s.x--;for(;s.x<0;)s.x++;for(;1<=s.y;)s.y--;for(;s.y<0;)s.y++;for(;1<=s.z;)s.z--;for(;s.z<0;)s.z++}for(E=[],d=0,f=l.length;d<f;d++){for(h=!1,s=l[d],p=0,c=r.atoms.length;p<c;p++)if(r.atoms[p].distance3D(s)<1e-4){h=!0;break}if(!h){for(p=0,c=E.length;p<c;p++)if(E[p].distance3D(s)<1e-4){h=!0;break}h||E.push(s)}}r.atoms=r.atoms.concat(E)}for(f=[],d=0;d<t;d++)for(p=0;p<n;p++)for(E=0;E<i;E++)if(0!==d||0!==p||0!==E)for(h=0,u=r.atoms.length;h<u;h++)s=r.atoms[h],l=new S.Atom(s.label,s.x+d,s.y+p,s.z+E),f.push(l),void 0!==s.cifId&&(l.cifId=s.cifId,l.cifPart=s.cifPart+(o?o.lines.length:0)+d+10*p+100*E);for(r.atoms=r.atoms.concat(f),d=0,f=r.atoms.length;d<f;d++)s=r.atoms[d],o=R.multiplyVec3(e,[s.x,s.y,s.z]),s.x=o[0],s.y=o[1],s.z=o[2];if(a){for(l=o=-1,d=0,f=a.fields.length;d<f;d++)"_geom_bond_atom_site_label_1"===(s=a.fields[d])?o=d:"_geom_bond_atom_site_label_2"===s&&(l=d);for(E=0,h=a.lines.length;E<h;E++)for(s=(u=a.lines[E].split(L).filter(A))[o],u=u[l],d=0,f=r.atoms.length;d<f;d++)for(p=d+1;p<f&&(c=r.atoms[d],m=r.atoms[p],c.cifPart===m.cifPart);p++)(c.cifId===s&&m.cifId===u||c.cifId===u&&m.cifId===s)&&r.bonds.push(new S.Bond(c,m))}else(new w.informatics.BondDeducer).deduceCovalentBonds(r,1);return t=[-t/2,-n/2,-i/2],r.unitCellVectors={o:R.multiplyVec3(e,t,[]),x:R.multiplyVec3(e,[t[0]+1,t[1],t[2]]),y:R.multiplyVec3(e,[t[0],t[1]+1,t[2]]),z:R.multiplyVec3(e,[t[0],t[1],t[2]+1]),xy:R.multiplyVec3(e,[t[0]+1,t[1]+1,t[2]]),xz:R.multiplyVec3(e,[t[0]+1,t[1],t[2]+1]),yz:R.multiplyVec3(e,[t[0],t[1]+1,t[2]+1]),xyz:R.multiplyVec3(e,[t[0]+1,t[1]+1,t[2]+1])},r};var r=new e.CIFInterpreter;w.readCIF=function(e,t,n,i){return r.read(e,t,n,i)}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3),function(e,t,v,_){t.CMLInterpreter=function(){};var n=t.CMLInterpreter.prototype=new t._Interpreter;n.read=function(e){var t=[];e=_.parseXML(e);for(var n=0,i=(e=_(e).find("cml")).length;n<i;n++)for(var r=_(e[n]).find("molecule"),o=0,a=r.length;o<a;o++){for(var s=t[o]=new v.Molecule,l=[],c=_(r[o]).find("atom"),u=0,h=c.length;u<h;u++){var f,d,p=_(c[u]),m=p.attr("elementType"),g=null==p.attr("x2")?(f=p.attr("x3"),d=p.attr("y3"),p.attr("z3")):(f=p.attr("x2"),d=p.attr("y2"),0),m=t[o].atoms[u]=new v.Atom(m,f,d,g);l[u]=p.attr("id"),null!=p.attr("formalCharge")&&(m.charge=p.attr("formalCharge"))}for(u=0,h=(c=_(r[o]).find("bond")).length;u<h;u++){switch(f=(p=_(c[u])).attr("atomRefs2").split(" "),m=s.atoms[_.inArray(f[0],l)],f=s.atoms[_.inArray(f[1],l)],p.attr("order")){case"2":case"D":d=2;break;case"3":case"T":d=3;break;case"A":d=1.5;break;default:d=1}switch(m=t[o].bonds[u]=new v.Bond(m,f,d),p.find("bondStereo").text()){case"W":m.stereo=v.Bond.STEREO_PROTRUDING;break;case"H":m.stereo=v.Bond.STEREO_RECESSED}}}return t},n.write=function(e){var t=[];t.push('<?xml version="1.0" encoding="UTF-8"?>\n'),t.push('<cml convention="conventions:molecular" xmlns="http://www.xml-cml.org/schema" xmlns:conventions="http://www.xml-cml.org/convention/" xmlns:dc="http://purl.org/dc/elements/1.1/">\n');for(var n=0,i=e.length;n<i;n++){t.push('<molecule id="m'),t.push(n),t.push('">'),t.push("<atomArray>");for(var r=0,o=e[n].atoms.length;r<o;r++){var a=e[n].atoms[r];t.push('<atom elementType="'),t.push(a.label),t.push('" id="a'),t.push(r),t.push('" '),t.push('x3="'),t.push(a.x),t.push('" y3="'),t.push(a.y),t.push('" z3="'),t.push(a.z),t.push('" '),0!=a.charge&&(t.push('formalCharge="'),t.push(a.charge),t.push('" ')),t.push("/>")}for(t.push("</atomArray>"),t.push("<bondArray>"),r=0,o=e[n].bonds.length;r<o;r++){switch(a=e[n].bonds[r],t.push('<bond atomRefs2="a'),t.push(e[n].atoms.indexOf(a.a1)),t.push(" a"),t.push(e[n].atoms.indexOf(a.a2)),t.push('" order="'),a.bondOrder){case 1.5:t.push("A");break;case 1:case 2:case 3:t.push(a.bondOrder);break;default:t.push("S")}t.push('"/>')}t.push("</bondArray>"),t.push("</molecule>")}return t.push("</cml>"),t.join("")};var i=new t.CMLInterpreter;e.readCML=function(e){return i.read(e)},e.writeCML=function(e){return i.write(e)}}(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery),function(u,h,e,f){e.MOLInterpreter=function(){};var t=e.MOLInterpreter.prototype=new e._Interpreter;t.read=function(e,t){t=t||u.default_bondLength_2D;var n=new f.Molecule;if(!e)return n;for(var i=e.split("\n"),r=i[3],o=parseInt(r.substring(0,3)),r=parseInt(r.substring(3,6)),a=0;a<o;a++){var s=i[4+a];switch(n.atoms[a]=new f.Atom(s.substring(31,34),parseFloat(s.substring(0,10))*t,(1===t?1:-1)*parseFloat(s.substring(10,20))*t,parseFloat(s.substring(20,30))*t),0!==(c=parseInt(s.substring(34,36)))&&h[n.atoms[a].label]&&(n.atoms[a].mass=h[n.atoms[a].label].mass+c),parseInt(s.substring(36,39))){case 1:n.atoms[a].charge=3;break;case 2:n.atoms[a].charge=2;break;case 3:n.atoms[a].charge=1;break;case 5:n.atoms[a].charge=-1;break;case 6:n.atoms[a].charge=-2;break;case 7:n.atoms[a].charge=-3}}for(a=0;a<r;a++){var s=i[4+o+a],l=parseInt(s.substring(6,9)),c=parseInt(s.substring(9,12));if(3<l)switch(l){case 4:l=1.5;break;default:l=1}switch(s=new f.Bond(n.atoms[parseInt(s.substring(0,3))-1],n.atoms[parseInt(s.substring(3,6))-1],l),c){case 3:s.stereo=f.Bond.STEREO_AMBIGUOUS;break;case 1:s.stereo=f.Bond.STEREO_PROTRUDING;break;case 6:s.stereo=f.Bond.STEREO_RECESSED}n.bonds[a]=s}return n},t.write=function(e){var t=[];t.push("Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n"),t.push(this.fit(e.atoms.length.toString(),3)),t.push(this.fit(e.bonds.length.toString(),3)),t.push("  0  0  0  0            999 V2000\n");for(var n=e.getCenter(),i=0,r=e.atoms.length;i<r;i++){var o,a=e.atoms[i],s=" 0";if(-1===a.mass||!h[a.label]||(o=a.mass-h[a.label].mass)<5&&-4<o&&(s=(-1<o?" ":"")+o),o="  0",0!==a.charge)switch(a.charge){case 3:o="  1";break;case 2:o="  2";break;case 1:o="  3";break;case-1:o="  5";break;case-2:o="  6";break;case-3:o="  7"}t.push(this.fit(((a.x-n.x)/u.default_bondLength_2D).toFixed(4),10)),t.push(this.fit((-(a.y-n.y)/u.default_bondLength_2D).toFixed(4),10)),t.push(this.fit((a.z/u.default_bondLength_2D).toFixed(4),10)),t.push(" "),t.push(this.fit(a.label,3,!0)),t.push(s),t.push(o),t.push("  0  0  0  0\n")}for(i=0,r=e.bonds.length;i<r;i++)n=0,(a=e.bonds[i]).stereo===f.Bond.STEREO_AMBIGUOUS?n=3:a.stereo===f.Bond.STEREO_PROTRUDING?n=1:a.stereo===f.Bond.STEREO_RECESSED&&(n=6),t.push(this.fit((e.atoms.indexOf(a.a1)+1).toString(),3)),t.push(this.fit((e.atoms.indexOf(a.a2)+1).toString(),3)),1.5==(a=a.bondOrder)?a=4:(3<a||0!=a%1)&&(a=1),t.push(this.fit(a,3)),t.push("  "),t.push(n),t.push("     0  0\n");return t.push("M  END"),t.join("")};var n=new e.MOLInterpreter;u.readMOL=function(e,t){return n.read(e,t)},u.writeMOL=function(e){return n.write(e)}}(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.io,ChemDoodle.structures),function(b,x,e,E,T,w,C){function S(e,t,n,i,r){for(var o=0,a=t.length;o<a;o++){var s=t[o];if(s.id===n&&i>=s.start&&i<=s.end){r?e.helix=!0:e.sheet=!0,i+1===s.end&&(e.arrow=!0);break}}}e.PDBInterpreter=function(){};var t=e.PDBInterpreter.prototype=new e._Interpreter;t.calculateRibbonDistances=!1,t.deduceResidueBonds=!1,t.read=function(e,t){var n=new E.Molecule;if(n.chains=[],!e)return n;var i=e.split("\n");t=t||1;for(var r,o=[],a=[],s=[],l=[],c=[],u=0,h=i.length;u<h;u++){var f,d=i[u];if(x.stringStartsWith(d,"HELIX"))o.push({id:d.substring(19,20),start:parseInt(d.substring(21,25)),end:parseInt(d.substring(33,37))});else if(x.stringStartsWith(d,"SHEET"))a.push({id:d.substring(21,22),start:parseInt(d.substring(22,26)),end:parseInt(d.substring(33,37))});else if(x.stringStartsWith(d,"ATOM")){if(" "===(v=d.substring(16,17))||"A"===v){0===(v=w(d.substring(76,78))).length&&("HD"===(f=w(d.substring(12,14)))?v="H":0<f.length&&(v=1<f.length?f.charAt(0)+f.substring(1).toLowerCase():f)),(f=new E.Atom(v,parseFloat(d.substring(30,38))*t,parseFloat(d.substring(38,46))*t,parseFloat(d.substring(46,54))*t)).hetatm=!1,l.push(f);var p=parseInt(d.substring(22,26));if(0===s.length)for(v=0;v<2;v++){(m=new E.Residue(-1)).cp1=f,m.cp2=f,s.push(m)}p!==Number.NaN&&s[s.length-1].resSeq!==p&&((v=new E.Residue(p)).name=w(d.substring(17,20)),3===v.name.length?v.name=v.name.substring(0,1)+v.name.substring(1).toLowerCase():2===v.name.length&&"D"===v.name.charAt(0)&&(v.name=v.name.substring(1)),s.push(v),S(v,o,m=d.substring(21,22),p,!0),S(v,a,m,p,!1)),d=w(d.substring(12,16)),v=s[s.length-1],"CA"===d||"P"===d||"O5'"===d?v.cp1||(v.cp1=f):"N3"===d&&("C"===v.name||"U"===v.name||"T"===v.name)||"N1"===d&&("A"===v.name||"G"===v.name)?v.cp3=f:"C2"===d?v.cp4=f:"C4"===d&&("C"===v.name||"U"===v.name||"T"===v.name)||"C6"===d&&("A"===v.name||"G"===v.name)?v.cp5=f:"O"===d||"C6"===d&&("C"===v.name||"U"===v.name||"T"===v.name)||"N9"===d?s[s.length-1].cp2||("C6"!==d&&"N9"!==d||(r=f),v.cp2=f):"C"===d&&(r=f)}}else if(x.stringStartsWith(d,"HETATM"))0===(v=w(d.substring(76,78))).length&&(v=w(d.substring(12,16))),1<v.length&&(v=v.substring(0,1)+v.substring(1).toLowerCase()),(v=new E.Atom(v,parseFloat(d.substring(30,38))*t,parseFloat(d.substring(38,46))*t,parseFloat(d.substring(46,54))*t)).hetatm=!0,"HOH"===w(d.substring(17,20))&&(v.isWater=!0),n.atoms.push(v),c[parseInt(w(d.substring(6,11)))]=v;else if(x.stringStartsWith(d,"CONECT")){if(c[v=parseInt(w(d.substring(6,11)))])for(f=c[v],p=0;p<4;p++)if(0!==(v=w(d.substring(11+5*p,16+5*p))).length&&c[v=parseInt(v)]){for(var m=c[v],g=!1,v=0,_=n.bonds.length;v<_;v++){var y=n.bonds[v];if(y.a1===f&&y.a2===m||y.a1===m&&y.a2===f){g=!0;break}}g||n.bonds.push(new E.Bond(f,m))}}else if(x.stringStartsWith(d,"TER"))this.endChain(n,s,r,l),s=[];else if(x.stringStartsWith(d,"ENDMDL"))break}if(this.endChain(n,s,r,l),0===n.bonds.size&&(new b.informatics.BondDeducer).deduceCovalentBonds(n,t),this.deduceResidueBonds)for(u=0,h=l.length;u<h;u++)for(i=C.min(h,u+20),v=u+1;v<i;v++)o=l[u],a=l[v],o.distance3D(a)<1.1*(T[o.label].covalentRadius+T[a.label].covalentRadius)&&n.bonds.push(new E.Bond(o,a,1));return n.atoms=n.atoms.concat(l),this.calculateRibbonDistances&&this.calculateDistances(n,l),n},t.endChain=function(e,t,n,i){if(0<t.length){var r=t[t.length-1];for(r.cp1||(r.cp1=i[i.length-2]),r.cp2||(r.cp2=i[i.length-1]),i=0;i<4;i++)(r=new E.Residue(-1)).cp1=n,r.cp2=t[t.length-1].cp2,t.push(r);e.chains.push(t)}},t.calculateDistances=function(e,t){for(var n=[],i=0,r=e.atoms.length;i<r;i++){var o=e.atoms[i];o.hetatm&&(o.isWater||n.push(o))}for(i=0,r=t.length;i<r;i++)if((o=t[i]).closestDistance=Number.POSITIVE_INFINITY,0===n.length)o.closestDistance=0;else for(var a=0,s=n.length;a<s;a++)o.closestDistance=Math.min(o.closestDistance,o.distance3D(n[a]))};var n=new e.PDBInterpreter;b.readPDB=function(e,t){return n.read(e,t)}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.ELEMENT,ChemDoodle.lib.jQuery.trim,Math),function(e,H,t,F,n,P){var N={"@":0,A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,a:-1,b:-2,c:-3,d:-4,e:-5,f:-6,g:-7,h:-8,i:-9},k={"%":0,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,j:-1,k:-2,l:-3,m:-4,n:-5,o:-6,p:-7,q:-8,r:-9},I={S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,s:9};t.JCAMPInterpreter=function(){},(n=t.JCAMPInterpreter.prototype=new t._Interpreter).convertHZ2PPM=!1,n.read=function(e){this.isBreak=function(e){return void 0!==N[e]||void 0!==k[e]||void 0!==I[e]||" "===e||"-"===e||"+"===e},this.getValue=function(e,t){var n=e.charAt(0),i=e.substring(1);return void 0!==N[n]?parseFloat(N[n]+i):void 0!==k[n]?parseFloat(k[n]+i)+t:parseFloat(i)};var t=new F.Spectrum;if(void 0===e||0===e.length)return t;for(var n,i,r,o,a=[],s=1,l=1,c=1,u=-1,h=-1,f=-1,d=!0,p=!1,m=0,g=(e=e.split("\n")).length;m<g;m++){if(-1!==(_=(v=P(e[m])).indexOf("$$"))&&(v=v.substring(0,_)),0!==a.length&&H.stringStartsWith(e[m],"##")){if(_=a.join(""),d&&_.length<100&&t.metadata.push(_),a=[v],H.stringStartsWith(_,"##TITLE="))t.title=P(_.substring(8));else if(H.stringStartsWith(_,"##XUNITS="))t.xUnit=P(_.substring(9)),this.convertHZ2PPM&&"HZ"===t.xUnit.toUpperCase()&&(t.xUnit="PPM",p=!0);else if(H.stringStartsWith(_,"##YUNITS="))t.yUnit=P(_.substring(9));else if(!H.stringStartsWith(_,"##XYPAIRS="))if(H.stringStartsWith(_,"##FIRSTX="))i=parseFloat(P(_.substring(9)));else if(H.stringStartsWith(_,"##LASTX="))n=parseFloat(P(_.substring(8)));else if(H.stringStartsWith(_,"##FIRSTY="))r=parseFloat(P(_.substring(9)));else if(H.stringStartsWith(_,"##NPOINTS="))o=parseFloat(P(_.substring(10)));else if(H.stringStartsWith(_,"##XFACTOR="))s=parseFloat(P(_.substring(10)));else if(H.stringStartsWith(_,"##YFACTOR="))l=parseFloat(P(_.substring(10)));else if(H.stringStartsWith(_,"##DELTAX="))u=parseFloat(P(_.substring(9)));else if(H.stringStartsWith(_,"##.OBSERVE FREQUENCY="))this.convertHZ2PPM&&(c=parseFloat(P(_.substring(21))));else if(H.stringStartsWith(_,"##.SHIFT REFERENCE="))this.convertHZ2PPM&&(f=_.substring(19).split(","),h=parseInt(P(f[2])),f=parseFloat(P(f[3])));else if(H.stringStartsWith(_,"##XYDATA=")){p||(c=1);var v=d=!1,_=_.split("\n"),y=(n-i)/(o-1);if(-1!==u)for(var b=1,x=_.length;b<x;b++)if("|"===_[b].charAt(0)){y=u;break}for(var E,T=i-y,w=r,C=0,b=1,x=_.length;b<x;b++){for(var S=[],a=[],D=!1,R=0,A=(T=P(_[b])).length;R<A;R++)this.isBreak(T.charAt(R))?(0<a.length&&(1!==a.length||" "!==a[0])&&S.push(a.join("")),a=[T.charAt(R)]):"|"===T.charAt(R)?D=!0:a.push(T.charAt(R));for(S.push(a.join("")),T=parseFloat(S[0])*s-y,R=1,A=S.length;R<A;R++)if(w=S[R],void 0!==I[w.charAt(0)])for(var M=parseInt(I[w.charAt(0)]+w.substring(1))-1,L=0;L<M;L++)T+=y,w=(C=this.getValue(E,C))*l,t.data[t.data.length-1]=new F.Point(T/c,w);else void 0!==N[w.charAt(0)]&&v?(w=this.getValue(w,C)*l,D&&(T+=y,t.data.push(new F.Point(T/c,w)))):(v=void 0!==k[w.charAt(0)],E=w,T+=y,w=(C=this.getValue(w,C))*l,t.data.push(new F.Point(T/c,w)))}if(-1!==h)for(v=f-t.data[h-1].x,m=0,g=t.data.length;m<g;m++)t.data[m].x+=v}else if(H.stringStartsWith(_,"##PEAK TABLE=")){d=!1,t.continuous=!1;for(b=1,x=(_=_.split("\n")).length;b<x;b++)for((v=_[b].split(/[\s,]+/)).length,R=0,A=v.length;R+1<A;R+=2)t.data.push(new F.Point(parseFloat(P(v[R])),parseFloat(P(v[R+1]))))}}else 0!==a.length&&a.push("\n"),a.push(P(v))}return t.setup(),t};var i=new t.JCAMPInterpreter;i.convertHZ2PPM=!0,e.readJCAMP=function(e){return i.read(e)}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery,ChemDoodle.lib.jQuery.trim),function(e,t,p,m,g,n){t.JSONInterpreter=function(){};var i=t.JSONInterpreter.prototype;i.contentTo=function(e,t){for(var n=0,i=0,r=0,o=e.length;r<o;r++){for(var a=e[r],s=0,l=a.atoms.length;s<l;s++)a.atoms[s].tmpid="a"+n++;for(s=0,l=a.bonds.length;s<l;s++)a.bonds[s].tmpid="b"+i++}for(r=n=0,o=t.length;r<o;r++)t[r].tmpid="s"+n++;if(n={},e&&0<e.length)for(n.m=[],r=0,o=e.length;r<o;r++)n.m.push(this.molTo(e[r]));if(t&&0<t.length)for(n.s=[],r=0,o=t.length;r<o;r++)n.s.push(this.shapeTo(t[r]));for(r=0,o=e.length;r<o;r++){for(s=0,l=(a=e[r]).atoms.length;s<l;s++)a.atoms[s].tmpid=void 0;for(s=0,l=a.bonds.length;s<l;s++)a.bonds[s].tmpid=void 0}for(r=0,o=t.length;r<o;r++)t[r].tmpid=void 0;return n},i.contentFrom=function(e){var t={molecules:[],shapes:[]};if(e.m)for(var n=0,i=e.m.length;n<i;n++)t.molecules.push(this.molFrom(e.m[n]));if(e.s)for(n=0,i=e.s.length;n<i;n++)t.shapes.push(this.shapeFrom(e.s[n],t.molecules));for(n=0,i=t.molecules.length;n<i;n++){for(var r=0,o=(e=t.molecules[n]).atoms.length;r<o;r++)e.atoms[r].tmpid=void 0;for(r=0,o=e.bonds.length;r<o;r++)e.bonds[r].tmpid=void 0}for(n=0,i=t.shapes.length;n<i;n++)t.shapes[n].tmpid=void 0;return t},i.molTo=function(e){for(var t={a:[]},n=0,i=e.atoms.length;n<i;n++){var r=e.atoms[n],o={x:r.x,y:r.y};r.tmpid&&(o.i=r.tmpid),"C"!==r.label&&(o.l=r.label),0!==r.z&&(o.z=r.z),0!==r.charge&&(o.c=r.charge),-1!==r.mass&&(o.m=r.mass),0!==r.numRadical&&(o.r=r.numRadical),0!==r.numLonePair&&(o.p=r.numLonePair),r.any&&(o.q=!0),-1!==r.rgroup&&(o.rg=r.rgroup),t.a.push(o)}if(0<e.bonds.length)for(t.b=[],n=0,i=e.bonds.length;n<i;n++)r=e.bonds[n],o={b:e.atoms.indexOf(r.a1),e:e.atoms.indexOf(r.a2)},r.tmpid&&(o.i=r.tmpid),1!==r.bondOrder&&(o.o=r.bondOrder),r.stereo!==p.Bond.STEREO_NONE&&(o.s=r.stereo),t.b.push(o);return t},i.molFrom=function(e){for(var t=new p.Molecule,n=0,i=e.a.length;n<i;n++){var r=e.a[n],o=new p.Atom(r.l?r.l:"C",r.x,r.y);r.i&&(o.tmpid=r.i),r.z&&(o.z=r.z),r.c&&(o.charge=r.c),r.m&&(o.mass=r.m),r.r&&(o.numRadical=r.r),r.p&&(o.numLonePair=r.p),r.q&&(o.any=!0),r.rg&&(o.rgroup=r.rg),void 0!==r.p_h&&(o.hetatm=r.p_h),void 0!==r.p_w&&(o.isWater=r.p_w),void 0!==r.p_d&&(o.closestDistance=r.p_d),t.atoms.push(o)}if(e.b)for(n=0,i=e.b.length;n<i;n++)r=e.b[n],o=new p.Bond(t.atoms[r.b],t.atoms[r.e],void 0===r.o?1:r.o),r.i&&(o.tmpid=r.i),r.s&&(o.stereo=r.s),t.bonds.push(o);return t},i.shapeTo=function(e){var t={};return e.tmpid&&(t.i=e.tmpid),e instanceof m.Line?(t.t="Line",t.x1=e.p1.x,t.y1=e.p1.y,t.x2=e.p2.x,t.y2=e.p2.y,t.a=e.arrowType):e instanceof m.Pusher?(t.t="Pusher",t.o1=e.o1.tmpid,t.o2=e.o2.tmpid,1!==e.numElectron&&(t.e=e.numElectron)):e instanceof m.Bracket?(t.t="Bracket",t.x1=e.p1.x,t.y1=e.p1.y,t.x2=e.p2.x,t.y2=e.p2.y,0!==e.charge&&(t.c=e.charge),0!==e.mult&&(t.m=e.mult),0!==e.repeat&&(t.r=e.repeat)):e instanceof g.Distance?(t.t="Distance",t.a1=e.a1.tmpid,t.a2=e.a2.tmpid,e.node&&(t.n=e.node,t.o=e.offset)):e instanceof g.Angle?(t.t="Angle",t.a1=e.a1.tmpid,t.a2=e.a2.tmpid,t.a3=e.a3.tmpid):e instanceof g.Torsion&&(t.t="Torsion",t.a1=e.a1.tmpid,t.a2=e.a2.tmpid,t.a3=e.a3.tmpid,t.a4=e.a4.tmpid),t},i.shapeFrom=function(e,t){var n,i,r;if("Line"===e.t)(s=new m.Line(new p.Point(e.x1,e.y1),new p.Point(e.x2,e.y2))).arrowType=e.a;else if("Pusher"===e.t){for(var o,a,s=0,l=t.length;s<l;s++){for(var c=t[s],u=0,h=c.atoms.length;u<h;u++){var f=c.atoms[u];f.tmpid===e.o1?o=f:f.tmpid===e.o2&&(a=f)}for(u=0,h=c.bonds.length;u<h;u++){var d=c.bonds[u];d.tmpid===e.o1?o=d:d.tmpid===e.o2&&(a=d)}}s=new m.Pusher(o,a),e.e&&(s.numElectron=e.e)}else if("Bracket"===e.t)s=new m.Bracket(new p.Point(e.x1,e.y1),new p.Point(e.x2,e.y2)),void 0!==e.c&&(s.charge=e.c),void 0!==e.m&&(s.mult=e.m),void 0!==e.r&&(s.repeat=e.r);else if("Distance"===e.t){for(s=0,l=t.length;s<l;s++)for(u=0,h=(c=t[s]).atoms.length;u<h;u++)(f=c.atoms[u]).tmpid===e.a1?d=f:f.tmpid===e.a2&&(n=f);s=new g.Distance(d,n,e.n,e.o)}else if("Angle"===e.t){for(s=0,l=t.length;s<l;s++)for(u=0,h=(c=t[s]).atoms.length;u<h;u++)(f=c.atoms[u]).tmpid===e.a1?d=f:f.tmpid===e.a2?n=f:f.tmpid===e.a3&&(i=f);s=new g.Angle(d,n,i)}else if("Torsion"===e.t){for(s=0,l=t.length;s<l;s++)for(u=0,h=(c=t[s]).atoms.length;u<h;u++)(f=c.atoms[u]).tmpid===e.a1?d=f:f.tmpid===e.a2?n=f:f.tmpid===e.a3?i=f:f.tmpid===e.a4&&(r=f);s=new g.Torsion(d,n,i,r)}return s},i.pdbFrom=function(e){var t=this.molFrom(e.mol);return t.findRings=!1,t.fromJSON=!0,t.chains=this.chainsFrom(e.ribbons),t},i.chainsFrom=function(e){for(var t=[],n=0,i=e.cs.length;n<i;n++){for(var r=e.cs[n],o=[],a=0,s=r.length;a<s;a++){var l=r[a],c=new p.Residue;c.name=l.n,c.cp1=new p.Atom("",l.x1,l.y1,l.z1),c.cp2=new p.Atom("",l.x2,l.y2,l.z2),l.x3&&(c.cp3=new p.Atom("",l.x3,l.y3,l.z3),c.cp4=new p.Atom("",l.x4,l.y4,l.z4),c.cp5=new p.Atom("",l.x5,l.y5,l.z5)),c.helix=l.h,c.sheet=l.s,c.arrow=l.a,o.push(c)}t.push(o)}return t};var r=new t.JSONInterpreter;e.readJSON=function(e){var t;try{t=n.parse(e)}catch(e){return}if(t)return t.m||t.s?r.contentFrom(t):t.a?{molecules:[r.molFrom(t)],shapes:[]}:{molecules:[],shapes:[]}},e.writeJSON=function(e,t){return n.stringify(r.contentTo(e,t))}}(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.structures.d2,ChemDoodle.structures.d3,JSON),function(d,e,p){e.RXNInterpreter=function(){};var t=e.RXNInterpreter.prototype=new e._Interpreter;t.read=function(e,t){t=t||d.default_bondLength_2D;var n=[];if(e){for(var i=(h=e.split("$MOL\n"))[0].split("\n")[4],r=parseInt(i.substring(0,3)),o=1,a=0,s=0,l=r+(i=parseInt(i.substring(3,6)));s<l;s++){n[s]=d.readMOL(h[o],t);a=a-((c=(c=n[s].getBounds()).maxX-c.minX)+40);o++}for(s=0,l=r;s<l;s++){for(var c=(c=n[s].getBounds()).maxX-c.minX,o=n[s].getCenter(),u=0,h=n[s].atoms.length;u<h;u++){var f=n[s].atoms[u];f.x+=a+c/2-o.x,f.y-=o.y}a+=c+40}for(h=new p.d2.Line(new p.Point(a,0),new p.Point(a+40,0)),a+=80,l=(s=r)+i;s<l;s++){for(c=(c=n[s].getBounds()).maxX-c.minX,o=n[s].getCenter(),u=0;u<n[s].atoms.length;u++)(f=n[s].atoms[u]).x+=a+c/2-o.x,f.y-=o.y;a+=c+40}}else n.push(new p.Molecule),h=new p.d2.Line(new p.Point(-20,0),new p.Point(20,0));return h.arrowType=p.d2.Line.ARROW_SYNTHETIC,{molecules:n,shapes:[h]}},t.write=function(e,t){var n=[[],[]],i=void 0;if(e&&t){for(r=0,o=t.length;r<o;r++)if(t[r]instanceof p.d2.Line){i=t[r].getPoints();break}if(!i)return"";for(var r=0,o=e.length;r<o;r++)e[r].getCenter().x<i[1].x?n[0].push(e[r]):n[1].push(e[r]);for((i=[]).push("$RXN\nReaction from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n"),i.push(this.fit(n[0].length.toString(),3)),i.push(this.fit(n[1].length.toString(),3)),i.push("\n"),r=0;r<2;r++)for(var o=0,a=n[r].length;o<a;o++)i.push("$MOL\n"),i.push(d.writeMOL(n[r][o])),i.push("\n");return i.join("")}};var n=new e.RXNInterpreter;d.readRXN=function(e,t){return n.read(e,t)},d.writeRXN=function(e,t){return n.write(e,t)}}(ChemDoodle,ChemDoodle.io,ChemDoodle.structures),function(o,e,a,t,s,l){t.XYZInterpreter=function(){},(e=t.XYZInterpreter.prototype=new t._Interpreter).deduceCovalentBonds=!0,e.read=function(e){var t=new s.Molecule;if(!e)return t;e=e.split("\n");for(var n=parseInt(l(e[0])),i=0;i<n;i++){var r=e[i+2].split(/\s+/g);t.atoms[i]=new s.Atom(isNaN(r[0])?r[0]:a[parseInt(r[0])-1],parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3]))}return this.deduceCovalentBonds&&(new o.informatics.BondDeducer).deduceCovalentBonds(t,1),t};var n=new t.XYZInterpreter;o.readXYZ=function(e){return n.read(e)}}(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.SYMBOLS,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery.trim),ChemDoodle.monitor=function(e,t,n){var i={CANVAS_DRAGGING:void 0,CANVAS_OVER:void 0,ALT:!1,SHIFT:!1,META:!1};return e.supports_touch()||t(n).ready(function(){t(n).mousemove(function(e){i.CANVAS_DRAGGING&&i.CANVAS_DRAGGING.drag&&(i.CANVAS_DRAGGING.prehandleEvent(e),i.CANVAS_DRAGGING.drag(e))}),t(n).mouseup(function(e){i.CANVAS_DRAGGING&&i.CANVAS_DRAGGING!==i.CANVAS_OVER&&i.CANVAS_DRAGGING.mouseup&&(i.CANVAS_DRAGGING.prehandleEvent(e),i.CANVAS_DRAGGING.mouseup(e)),i.CANVAS_DRAGGING=void 0}),t(n).keydown(function(e){i.SHIFT=e.shiftKey,i.ALT=e.altKey,i.META=e.metaKey||e.ctrlKey;var t=i.CANVAS_OVER;i.CANVAS_DRAGGING&&(t=i.CANVAS_DRAGGING),t&&t.keydown&&(t.prehandleEvent(e),t.keydown(e))}),t(n).keypress(function(e){var t=i.CANVAS_OVER;i.CANVAS_DRAGGING&&(t=i.CANVAS_DRAGGING),t&&t.keypress&&(t.prehandleEvent(e),t.keypress(e))}),t(n).keyup(function(e){i.SHIFT=e.shiftKey,i.ALT=e.altKey,i.META=e.metaKey||e.ctrlKey;var t=i.CANVAS_OVER;i.CANVAS_DRAGGING&&(t=i.CANVAS_DRAGGING),t&&t.keyup&&(t.prehandleEvent(e),t.keyup(e))})}),i}(ChemDoodle.featureDetection,ChemDoodle.lib.jQuery,document),function(o,a,i,s,l,c,u,h,f,d){o._Canvas=function(){};var e=o._Canvas.prototype;e.molecules=void 0,e.shapes=void 0,e.emptyMessage=void 0,e.image=void 0,e.repaint=function(){if(!this.test&&(t=h.getElementById(this.id)).getContext){var e=t.getContext("2d");if(1!==this.pixelRatio&&t.width===this.width&&(t.width=this.width*this.pixelRatio,t.height=this.height*this.pixelRatio,e.scale(this.pixelRatio,this.pixelRatio)),this.image?e.drawImage(this.image,0,0):(this.specs.backgroundColor&&this.bgCache!==t.style.backgroundColor&&(t.style.backgroundColor=this.specs.backgroundColor,this.bgCache=t.style.backgroundColor),e.fillStyle=this.specs.backgroundColor,e.fillRect(0,0,this.width,this.height)),this.innerRepaint)this.innerRepaint(e);else if(0!==this.molecules.length||0!==this.shapes.length){e.save(),e.translate(this.width/2,this.height/2),e.rotate(this.specs.rotateAngle),e.scale(this.specs.scale,this.specs.scale),e.translate(-this.width/2,-this.height/2);for(var t=0,n=this.molecules.length;t<n;t++)this.molecules[t].check(!0),this.molecules[t].draw(e,this.specs);for(t=0,n=this.shapes.length;t<n;t++)this.shapes[t].draw(e,this.specs);e.restore()}else this.emptyMessage&&(e.fillStyle="#737683",e.textAlign="center",e.textBaseline="middle",e.font="18px Helvetica, Verdana, Arial, Sans-serif",e.fillText(this.emptyMessage,this.width/2,this.height/2));this.drawChildExtras&&this.drawChildExtras(e)}},e.resize=function(e,t){if((n=c("#"+this.id)).attr({width:e,height:t}),n.css("width",e),n.css("height",t),this.width=e,this.height=t,o._Canvas3D&&this instanceof o._Canvas3D)this.gl.viewport(0,0,e,t),this.setupScene();else if(0<this.molecules.length){this.center();for(var n=0,i=this.molecules.length;n<i;n++)this.molecules[n].check()}this.repaint()},e.setBackgroundImage=function(e){this.image=new Image;var t=this;this.image.onload=function(){t.repaint()},this.image.src=e},e.loadMolecule=function(e){this.clear(),this.molecules.push(e),this.center(),o._Canvas3D&&this instanceof o._Canvas3D||e.check(),this.afterLoadContent&&this.afterLoadContent(),this.repaint()},e.loadContent=function(e,t){if(this.molecules=e||[],this.shapes=t||[],this.center(),!(o._Canvas3D&&this instanceof o._Canvas3D))for(var n=0,i=this.molecules.length;n<i;n++)this.molecules[n].check();this.afterLoadContent&&this.afterLoadContent(),this.repaint()},e.addMolecule=function(e){this.molecules.push(e),o._Canvas3D&&this instanceof o._Canvas3D||e.check(),this.repaint()},e.removeMolecule=function(t){this.molecules=c.grep(this.molecules,function(e){return e!==t}),this.repaint()},e.getMolecule=function(){return 0<this.molecules.length?this.molecules[0]:void 0},e.getMolecules=function(){return this.molecules},e.addShape=function(e){this.shapes.push(e),this.repaint()},e.removeShape=function(t){this.shapes=c.grep(this.shapes,function(e){return e!==t}),this.repaint()},e.getShapes=function(){return this.shapes},e.clear=function(){this.molecules=[],this.shapes=[],this.specs.scale=1,this.repaint()},e.center=function(){for(var e=this.getContentBounds(),t=new l.Point((this.width-e.minX-e.maxX)/2,(this.height-e.minY-e.maxY)/2),n=0,i=this.molecules.length;n<i;n++)for(var r=this.molecules[n],o=0,a=r.atoms.length;o<a;o++)r.atoms[o].add(t);for(n=0,i=this.shapes.length;n<i;n++)for(o=0,a=(r=this.shapes[n].getPoints()).length;o<a;o++)r[o].add(t);this.specs.scale=1,t=e.maxX-e.minX,e=e.maxY-e.minY,(t>this.width||e>this.height)&&(this.specs.scale=.85*u.min(this.width/t,this.height/e))},e.bondExists=function(e,t){for(var n=0,i=this.molecules.length;n<i;n++)for(var r=this.molecules[n],o=0,a=r.bonds.length;o<a;o++){var s=r.bonds[o];if(s.contains(e)&&s.contains(t))return!0}return!1},e.getBond=function(e,t){for(var n=0,i=this.molecules.length;n<i;n++)for(var r=this.molecules[n],o=0,a=r.bonds.length;o<a;o++){var s=r.bonds[o];if(s.contains(e)&&s.contains(t))return s}},e.getMoleculeByAtom=function(e){for(var t=0,n=this.molecules.length;t<n;t++){var i=this.molecules[t];if(-1!==i.atoms.indexOf(e))return i}},e.getAllAtoms=function(){for(var e=[],t=0,n=this.molecules.length;t<n;t++)e=e.concat(this.molecules[t].atoms);return e},e.getAllPoints=function(){for(var e=[],t=0,n=this.molecules.length;t<n;t++)e=e.concat(this.molecules[t].atoms);for(t=0,n=this.shapes.length;t<n;t++)e=e.concat(this.shapes[t].getPoints());return e},e.getContentBounds=function(){for(var e=new i.Bounds,t=0,n=this.molecules.length;t<n;t++)e.expand(this.molecules[t].getBounds());for(t=0,n=this.shapes.length;t<n;t++)e.expand(this.shapes[t].getBounds());return e},e.create=function(e,t,n){if(this.id=e,this.width=t,this.height=n,this.molecules=[],this.shapes=[],h.getElementById(e)){var i=c("#"+e);t?i.attr("width",t):this.width=i.attr("width"),n?i.attr("height",n):this.height=i.attr("height"),i.attr("class","ChemDoodleWebComponent")}else{if(!o.featureDetection.supports_canvas_text()&&-1!=d.indexOf("MSIE"))return void h.writeln('<div style="border: 1px solid black;" width="'+t+'" height="'+n+'">Please install <a href="http://code.google.com/chrome/chromeframe/">Google Chrome Frame</a>, then restart Internet Explorer.</div>');h.writeln('<canvas class="ChemDoodleWebComponent" id="'+e+'" width="'+t+'" height="'+n+'" alt="ChemDoodle Web Component">This browser does not support HTML5/Canvas.</canvas>')}(e=c("#"+e)).css("width",this.width),e.css("height",this.height),this.pixelRatio=f.devicePixelRatio?f.devicePixelRatio:1,this.specs=new l.VisualSpecifications;var r=this;a.supports_touch()?(e.bind("touchstart",function(e){var t,n,i=(new Date).getTime();a.supports_gesture()||2!==e.originalEvent.touches.length||(n=e.originalEvent.touches,t=new l.Point(n[0].pageX,n[0].pageY),n=new l.Point(n[1].pageX,n[1].pageY),r.implementedGestureDist=t.distance(n),r.implementedGestureAngle=t.angle(n),r.gesturestart&&(r.prehandleEvent(e),r.gesturestart(e))),r.lastTouch&&1===e.originalEvent.touches.length&&i-r.lastTouch<500?r.dbltap?(r.prehandleEvent(e),r.dbltap(e)):r.dblclick?(r.prehandleEvent(e),r.dblclick(e)):r.touchstart?(r.prehandleEvent(e),r.touchstart(e)):r.mousedown&&(r.prehandleEvent(e),r.mousedown(e)):r.touchstart?(r.prehandleEvent(e),r.touchstart(e),this.hold&&clearTimeout(this.hold),this.touchhold&&(this.hold=setTimeout(function(){r.touchhold(e)},1e3))):r.mousedown&&(r.prehandleEvent(e),r.mousedown(e)),r.lastTouch=i}),e.bind("touchmove",function(e){var t,n,i;if(this.hold&&(clearTimeout(this.hold),this.hold=void 0),!a.supports_gesture()&&2===e.originalEvent.touches.length&&r.gesturechange&&(n=e.originalEvent.touches,i=new l.Point(n[0].pageX,n[0].pageY),t=new l.Point(n[1].pageX,n[1].pageY),n=i.distance(t),i=i.angle(t),e.originalEvent.scale=n/r.implementedGestureDist,e.originalEvent.rotation=180*(r.implementedGestureAngle-i)/u.PI,r.prehandleEvent(e),r.gesturechange(e)),1<e.originalEvent.touches.length&&r.multitouchmove){for(i=e.originalEvent.touches.length,r.prehandleEvent(e),n=new l.Point(-e.offset.left*i,-e.offset.top*i),t=0;t<i;t++)n.x+=e.originalEvent.changedTouches[t].pageX,n.y+=e.originalEvent.changedTouches[t].pageY;n.x/=i,n.y/=i,e.p=n,r.multitouchmove(e,i)}else r.touchmove?(r.prehandleEvent(e),r.touchmove(e)):r.drag&&(r.prehandleEvent(e),r.drag(e))}),e.bind("touchend",function(e){this.hold&&(clearTimeout(this.hold),this.hold=void 0),!a.supports_gesture()&&r.implementedGestureDist&&(r.implementedGestureDist=void 0,r.implementedGestureAngle=void 0,r.gestureend&&(r.prehandleEvent(e),r.gestureend(e))),r.touchend?(r.prehandleEvent(e),r.touchend(e)):r.mouseup&&(r.prehandleEvent(e),r.mouseup(e)),(new Date).getTime()-r.lastTouch<250&&(r.tap?(r.prehandleEvent(e),r.tap(e)):r.click&&(r.prehandleEvent(e),r.click(e)))}),e.bind("gesturestart",function(e){r.gesturestart&&(r.prehandleEvent(e),r.gesturestart(e))}),e.bind("gesturechange",function(e){r.gesturechange&&(r.prehandleEvent(e),r.gesturechange(e))}),e.bind("gestureend",function(e){r.gestureend&&(r.prehandleEvent(e),r.gestureend(e))})):(e.click(function(e){switch(e.which){case 1:r.click&&(r.prehandleEvent(e),r.click(e));break;case 2:r.middleclick&&(r.prehandleEvent(e),r.middleclick(e));break;case 3:r.rightclick&&(r.prehandleEvent(e),r.rightclick(e))}}),e.dblclick(function(e){r.dblclick&&(r.prehandleEvent(e),r.dblclick(e))}),e.mousedown(function(e){switch(e.which){case 1:(s.CANVAS_DRAGGING=r).mousedown&&(r.prehandleEvent(e),r.mousedown(e));break;case 2:r.middlemousedown&&(r.prehandleEvent(e),r.middlemousedown(e));break;case 3:r.rightmousedown&&(r.prehandleEvent(e),r.rightmousedown(e))}}),e.mousemove(function(e){!s.CANVAS_DRAGGING&&r.mousemove&&(r.prehandleEvent(e),r.mousemove(e))}),e.mouseout(function(e){s.CANVAS_OVER=void 0,r.mouseout&&(r.prehandleEvent(e),r.mouseout(e))}),e.mouseover(function(e){(s.CANVAS_OVER=r).mouseover&&(r.prehandleEvent(e),r.mouseover(e))}),e.mouseup(function(e){switch(e.which){case 1:r.mouseup&&(r.prehandleEvent(e),r.mouseup(e));break;case 2:r.middlemouseup&&(r.prehandleEvent(e),r.middlemouseup(e));break;case 3:r.rightmouseup&&(r.prehandleEvent(e),r.rightmouseup(e))}}),e.mousewheel(function(e,t){r.mousewheel&&(r.prehandleEvent(e),r.mousewheel(e,t))})),this.subCreate&&this.subCreate()},e.prehandleEvent=function(e){e.originalEvent.changedTouches&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY),e.preventDefault(),e.offset=c("#"+this.id).offset(),e.p=new l.Point(e.pageX-e.offset.left,e.pageY-e.offset.top)}}(ChemDoodle,ChemDoodle.featureDetection,ChemDoodle.math,ChemDoodle.monitor,ChemDoodle.structures,ChemDoodle.lib.jQuery,Math,document,window,navigator.userAgent),function(e,n){e._AnimatorCanvas=function(e,t,n){e&&this.create(e,t,n)};var t=e._AnimatorCanvas.prototype=new e._Canvas;t.timeout=33,t.startAnimation=function(){this.stopAnimation(),this.lastTime=(new Date).getTime();var t=this;this.nextFrame&&(this.handle=n.requestInterval(function(){var e=(new Date).getTime();t.nextFrame(e-t.lastTime),t.repaint(),t.lastTime=e},this.timeout))},t.stopAnimation=function(){this.handle&&(n.clearRequestInterval(this.handle),this.handle=void 0)},t.isRunning=function(){return void 0!==this.handle}}(ChemDoodle,ChemDoodle.animations),function(e,r){e.FileCanvas=function(e,t,n,i){e&&this.create(e,t,n),r.writeln('<br><form name="FileForm" enctype="multipart/form-data" method="POST" action="'+i+'" target="HiddenFileFrame"><input type="file" name="f" /><input type="submit" name="submitbutton" value="Show File" /></form><iframe id="HFF-'+e+'" name="HiddenFileFrame" height="0" width="0" style="display:none;" onLoad="GetMolFromFrame(\'HFF-'+e+"', "+e+')"></iframe>'),this.emptyMessage="Click below to load file",this.repaint()},e.FileCanvas.prototype=new e._Canvas}(ChemDoodle,document),function(e){e.HyperlinkCanvas=function(e,t,n,i,r,o){e&&this.create(e,t,n),this.urlOrFunction=i,this.color=r||"blue",this.size=o||2},(e=e.HyperlinkCanvas.prototype=new e._Canvas).openInNewWindow=!0,e.hoverImage=void 0,e.drawChildExtras=function(e){this.e&&(this.hoverImage?e.drawImage(this.hoverImage,0,0):(e.strokeStyle=this.color,e.lineWidth=2*this.size,e.strokeRect(0,0,this.width,this.height)))},e.setHoverImage=function(e){this.hoverImage=new Image,this.hoverImage.src=e},e.click=function(){this.e=void 0,this.repaint(),this.urlOrFunction instanceof Function?this.urlOrFunction():this.openInNewWindow?window.open(this.urlOrFunction):location.href=this.urlOrFunction},e.mouseout=function(){this.e=void 0,this.repaint()},e.mouseover=function(e){this.e=e,this.repaint()}}(ChemDoodle),function(e,n,r,o){e.MolGrabberCanvas=function(e,t,n){e&&this.create(e,t,n),(t=[]).push('<br><input type="text" id="'),t.push(e),t.push('_query" size="32" value="" />'),t.push("<br><nobr>"),t.push('<select id="'),t.push(e),t.push('_select">'),t.push('<option value="chemexper">ChemExper'),t.push('<option value="chemspider">ChemSpider'),t.push('<option value="pubchem" selected>PubChem'),t.push("</select>"),t.push('<button id="'),t.push(e),t.push('_submit">Show Molecule</button>'),t.push("</nobr>"),o.getElementById(e),r("#"+e).after(t.join(""));var i=this;r("#"+e+"_submit").click(function(){i.search()}),r("#"+e+"_query").keypress(function(e){13===e.which&&i.search()}),this.emptyMessage="Enter search term below",this.repaint()},(e=e.MolGrabberCanvas.prototype=new e._Canvas).setSearchTerm=function(e){r("#"+this.id+"_query").val(e),this.search()},e.search=function(){this.emptyMessage="Searching...",this.clear();var t=this;n.getMoleculeFromDatabase(r("#"+this.id+"_query").val(),{database:r("#"+this.id+"_select").val()},function(e){t.loadMolecule(e)})}}(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.lib.jQuery,document),function(e,t,s){var l=[],c=[1,0,0],u=[0,1,0],h=[0,0,1];e.RotatorCanvas=function(e,t,n,i){e&&this.create(e,t,n),this.rotate3D=i},e=e.RotatorCanvas.prototype=new e._AnimatorCanvas,t=t.PI/15,e.xIncrement=t,e.yIncrement=t,e.zIncrement=t,e.nextFrame=function(e){if(0===this.molecules.length&&0===this.shapes.length)this.stopAnimation();else if(e/=1e3,this.rotate3D){s.identity(l),s.rotate(l,this.xIncrement*e,c),s.rotate(l,this.yIncrement*e,u),s.rotate(l,this.zIncrement*e,h),e=0;for(var t=this.molecules.length;e<t;e++){for(var n=this.molecules[e],i=0,r=n.atoms.length;i<r;i++){var o=n.atoms[i],a=[o.x-this.width/2,o.y-this.height/2,o.z];s.multiplyVec3(l,a),o.x=a[0]+this.width/2,o.y=a[1]+this.height/2,o.z=a[2]}for(i=0,r=n.rings.length;i<r;i++)n.rings[i].center=n.rings[i].getCenter();this.specs.atoms_display&&this.specs.atoms_circles_2D&&n.sortAtomsByZ(),this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&n.sortBondsByZ()}for(e=0,t=this.shapes.length;e<t;e++)for(i=0,r=(n=this.shapes[e].getPoints()).length;i<r;i++)a=[(o=n[i]).x-this.width/2,o.y-this.height/2,0],s.multiplyVec3(l,a),o.x=a[0]+this.width/2,o.y=a[1]+this.height/2}else this.specs.rotateAngle+=this.zIncrement*e},e.dblclick=function(){this.isRunning()?this.stopAnimation():this.startAnimation()}}(ChemDoodle,Math,ChemDoodle.lib.mat4),function(e,n){e.SlideshowCanvas=function(e,t,n){e&&this.create(e,t,n)},(e=e.SlideshowCanvas.prototype=new e._AnimatorCanvas).frames=[],e.curIndex=0,e.timeout=5e3,e.alpha=0,e.innerHandle=void 0,e.phase=0,e.drawChildExtras=function(e){var t=n.getRGB(this.specs.backgroundColor,255);e.fillStyle="rgba("+t[0]+", "+t[1]+", "+t[2]+", "+this.alpha+")",e.fillRect(0,0,this.width,this.height)},e.nextFrame=function(){var e,t;0===this.frames.length?this.stopAnimation():(this.phase=0,t=1,(e=this).innerHandle=setInterval(function(){e.alpha=t/15,e.repaint(),15===t&&e.breakInnerHandle(),t++},33))},e.breakInnerHandle=function(){var e,t,n;this.innerHandle&&(clearInterval(this.innerHandle),this.innerHandle=void 0),0===this.phase?(this.curIndex++,this.curIndex>this.frames.length-1&&(this.curIndex=0),this.alpha=1,e=this.frames[this.curIndex],this.loadContent(e.mols,e.shapes),this.phase=1,n=1,(t=this).innerHandle=setInterval(function(){t.alpha=(15-n)/15,t.repaint(),15===n&&t.breakInnerHandle(),n++},33)):1===this.phase&&(this.alpha=0,this.repaint())},e.addFrame=function(e,t){0===this.frames.length&&this.loadContent(e,t),this.frames.push({mols:e,shapes:t})}}(ChemDoodle,(ChemDoodle.animations,ChemDoodle.math)),function(e,s,h,l,c){e.TransformCanvas=function(e,t,n,i){e&&this.create(e,t,n),this.rotate3D=i},(e=e.TransformCanvas.prototype=new e._Canvas).lastPoint=void 0,e.rotationMultMod=1.3,e.lastPinchScale=1,e.lastGestureRotate=0,e.mousedown=function(e){this.lastPoint=e.p},e.dblclick=function(){this.center(),this.repaint()},e.drag=function(e){if(!this.lastPoint.multi){if(s.ALT){var t=new h.Point(e.p.x,e.p.y);t.sub(this.lastPoint);for(var n=0,i=this.molecules.length;n<i;n++){for(var r=this.molecules[n],o=0,a=r.atoms.length;o<a;o++)r.atoms[o].add(t);r.check()}for(n=0,i=this.shapes.length;n<i;n++)for(o=0,a=(r=this.shapes[n].getPoints()).length;o<a;o++)r[o].add(t);this.lastPoint=e.p}else if(!0===this.rotate3D)for(a=l.max(this.width/4,this.height/4),o=(e.p.x-this.lastPoint.x)/a*this.rotationMultMod,a=-(e.p.y-this.lastPoint.y)/a*this.rotationMultMod,t=[],c.identity(t),c.rotate(t,a,[1,0,0]),c.rotate(t,o,[0,1,0]),n=0,i=this.molecules.length;n<i;n++){for(o=0,a=(r=this.molecules[n]).atoms.length;o<a;o++)i=[(n=r.atoms[o]).x-this.width/2,n.y-this.height/2,n.z],c.multiplyVec3(t,i),n.x=i[0]+this.width/2,n.y=i[1]+this.height/2,n.z=i[2];for(n=0,i=r.rings.length;n<i;n++)r.rings[n].center=r.rings[n].getCenter();this.lastPoint=e.p,this.specs.atoms_display&&this.specs.atoms_circles_2D&&r.sortAtomsByZ(),this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&r.sortBondsByZ()}else o=(a=new h.Point(this.width/2,this.height/2)).angle(this.lastPoint),a=a.angle(e.p),this.specs.rotateAngle-=a-o,this.lastPoint=e.p;this.repaint()}},e.mousewheel=function(e,t){this.specs.scale+=t/50,this.specs.scale<.01&&(this.specs.scale=.01),this.repaint()},e.multitouchmove=function(e,t){if(2===t)if(this.lastPoint.multi){var n=new h.Point(e.p.x,e.p.y);n.sub(this.lastPoint);for(var i=0,r=this.molecules.length;i<r;i++){for(var o=this.molecules[i],a=0,s=o.atoms.length;a<s;a++)o.atoms[a].add(n);o.check()}for(i=0,r=this.shapes.length;i<r;i++)for(a=0,s=(o=this.shapes[i].getPoints()).length;a<s;a++)o[a].add(n);this.lastPoint=e.p,this.lastPoint.multi=!0,this.repaint()}else this.lastPoint=e.p,this.lastPoint.multi=!0},e.gesturechange=function(e){if(0!=e.originalEvent.scale-this.lastPinchScale&&(this.specs.scale*=e.originalEvent.scale/this.lastPinchScale,this.specs.scale<.01&&(this.specs.scale=.01),this.lastPinchScale=e.originalEvent.scale),0!=this.lastGestureRotate-e.originalEvent.rotation){for(var t=(this.lastGestureRotate-e.originalEvent.rotation)/180*o.PI,n=new h.Point(this.width/2,this.height/2),i=0,r=this.molecules.length;i<r;i++){for(var o=this.molecules[i],a=0,s=o.atoms.length;a<s;a++){var l=o.atoms[a],c=n.distance(l),u=n.angle(l)+t;l.x=n.x+c*o.cos(u),l.y=n.y-c*o.sin(u)}o.check()}this.lastGestureRotate=e.originalEvent.rotation}this.repaint()},e.gestureend=function(){this.lastPinchScale=1,this.lastGestureRotate=0}}(ChemDoodle,ChemDoodle.monitor,ChemDoodle.structures,Math,ChemDoodle.lib.mat4),function(e){e.ViewerCanvas=function(e,t,n){e&&this.create(e,t,n)},e.ViewerCanvas.prototype=new e._Canvas}(ChemDoodle),function(e){e._SpectrumCanvas=function(e,t,n){e&&this.create(e,t,n)},(e=e._SpectrumCanvas.prototype=new e._Canvas).spectrum=void 0,e.emptyMessage="No Spectrum Loaded or Recognized",e.loadMolecule=void 0,e.getMolecule=void 0,e.innerRepaint=function(e){this.spectrum&&0<this.spectrum.data.length?this.spectrum.draw(e,this.specs,this.width,this.height):this.emptyMessage&&(e.fillStyle="#737683",e.textAlign="center",e.textBaseline="middle",e.font="18px Helvetica, Verdana, Arial, Sans-serif",e.fillText(this.emptyMessage,this.width/2,this.height/2))},e.loadSpectrum=function(e){this.spectrum=e,this.repaint()},e.getSpectrum=function(){return this.spectrum},e.getSpectrumCoordinates=function(e,t){return spectrum.getInternalCoordinates(e,t,this.width,this.height)}}(ChemDoodle,document),function(e){e.ObserverCanvas=function(e,t,n){e&&this.create(e,t,n)},e.ObserverCanvas.prototype=new e._SpectrumCanvas}(ChemDoodle),function(e){e.OverlayCanvas=function(e,t,n){e&&this.create(e,t,n)},(e=e.OverlayCanvas.prototype=new e._SpectrumCanvas).overlaySpectra=[],e.superRepaint=e.innerRepaint,e.innerRepaint=function(e){if(this.superRepaint(e),this.spectrum&&0<this.spectrum.data.length)for(var t=0,n=this.overlaySpectra.length;t<n;t++){var i=this.overlaySpectra[t];i&&0<i.data.length&&(i.minX=this.spectrum.minX,i.maxX=this.spectrum.maxX,i.drawPlot(e,this.specs,this.width,this.height,this.spectrum.memory.offsetTop,this.spectrum.memory.offsetLeft,this.spectrum.memory.offsetBottom))}},e.addSpectrum=function(e){this.spectrum?this.overlaySpectra.push(e):this.spectrum=e}}(ChemDoodle),function(n,t,i){n.PerspectiveCanvas=function(e,t,n){e&&this.create(e,t,n)};var e=n.PerspectiveCanvas.prototype=new n._SpectrumCanvas;e.dragRange=void 0,e.rescaleYAxisOnZoom=!0,e.lastPinchScale=1,e.mousedown=function(e){this.dragRange=new n.structures.Point(e.p.x,e.p.x)},e.mouseup=function(e){this.dragRange&&this.dragRange.x!==this.dragRange.y&&(this.dragRange.multi||(e=this.spectrum.zoom(this.dragRange.x,e.p.x,this.width,this.rescaleYAxisOnZoom),this.rescaleYAxisOnZoom&&(this.specs.scale=e)),this.dragRange=void 0,this.repaint())},e.drag=function(e){this.dragRange&&(this.dragRange.multi?this.dragRange=void 0:(t.SHIFT&&(this.spectrum.translate(e.p.x-this.dragRange.x,this.width),this.dragRange.x=e.p.x),this.dragRange.y=e.p.x),this.repaint())},e.drawChildExtras=function(e){if(this.dragRange){var t=i.min(this.dragRange.x,this.dragRange.y),n=i.max(this.dragRange.x,this.dragRange.y);for(e.strokeStyle="grey",e.lineStyle=1,e.beginPath(),e.moveTo(t,this.height/2);t<=n;t++)t%10<5?e.lineTo(t,i.round(this.height/2)):e.moveTo(t,i.round(this.height/2));e.stroke()}},e.mousewheel=function(e,t){this.specs.scale+=t/10,this.specs.scale<.01&&(this.specs.scale=.01),this.repaint()},e.dblclick=function(){this.spectrum.setup(),this.specs.scale=1,this.repaint()},e.multitouchmove=function(e,t){2===t&&(this.dragRange&&this.dragRange.multi?(this.spectrum.translate(e.p.x-this.dragRange.x,this.width),this.dragRange.x=e.p.x,this.dragRange.y=e.p.x,this.repaint()):(this.dragRange=new n.structures.Point(e.p.x,e.p.x),this.dragRange.multi=!0))},e.gesturechange=function(e){this.specs.scale*=e.originalEvent.scale/this.lastPinchScale,this.specs.scale<.01&&(this.specs.scale=.01),this.lastPinchScale=e.originalEvent.scale,this.repaint()},e.gestureend=function(){this.lastPinchScale=1}}(ChemDoodle,ChemDoodle.monitor,Math),function(o,a,s){o.SeekerCanvas=function(e,t,n,i){e&&this.create(e,t,n),this.seekType=i};var e=o.SeekerCanvas.prototype=new o._SpectrumCanvas;e.superRepaint=e.innerRepaint,e.innerRepaint=function(e){if(this.superRepaint(e),this.spectrum&&0<this.spectrum.data.length&&this.p){var t,n;if(this.seekType===o.SeekerCanvas.SEEK_POINTER)t=this.p,n=this.spectrum.getInternalCoordinates(t.x,t.y);else if(this.seekType===o.SeekerCanvas.SEEK_PLOT||this.seekType===o.SeekerCanvas.SEEK_PEAK){if(!(n=this.seekType===o.SeekerCanvas.SEEK_PLOT?this.spectrum.getClosestPlotInternalCoordinates(this.p.x):this.spectrum.getClosestPeakInternalCoordinates(this.p.x)))return;t={x:this.spectrum.getTransformedX(n.x,this.specs,this.width,this.spectrum.memory.offsetLeft),y:this.spectrum.getTransformedY(n.y/100,this.specs,this.height,this.spectrum.memory.offsetBottom,this.spectrum.memory.offsetTop)}}e.fillStyle="white",e.strokeStyle=this.specs.plots_color,e.lineWidth=this.specs.plots_width,e.beginPath(),e.arc(t.x,t.y,3,0,2*s.PI,!1),e.fill(),e.stroke(),e.font=a.getFontString(this.specs.text_font_size,this.specs.text_font_families),e.textAlign="left",e.textBaseline="bottom",n="x:"+n.x.toFixed(3)+", y:"+n.y.toFixed(3);var i=t.x+3,r=e.measureText(n).width;i+r>this.width-2&&(i-=6+r),(t=t.y)-this.specs.text_font_size-2<0&&(t+=this.specs.text_font_size),e.fillRect(i,t-this.specs.text_font_size,r,this.specs.text_font_size),e.fillStyle="black",e.fillText(n,i,t)}},e.mouseout=function(){this.p=void 0,this.repaint()},e.mousemove=function(e){this.p={x:e.p.x-2,y:e.p.y-3},this.repaint()},e.touchstart=function(e){this.mousemove(e)},e.touchmove=function(e){this.mousemove(e)},e.touchend=function(e){this.mouseout(e)},o.SeekerCanvas.SEEK_POINTER="pointer",o.SeekerCanvas.SEEK_PLOT="plot",o.SeekerCanvas.SEEK_PEAK="peak"}(ChemDoodle,ChemDoodle.extensions,Math),function(f,d,p,m,g,v,_,t,y,b,x,E){f._Canvas3D=function(e,t,n){e&&this.create(e,t,n)};var e=f._Canvas3D.prototype=new f._Canvas;e.rotationMatrix=void 0,e.translationMatrix=void 0,e.lastPoint=void 0,e.emptyMessage="WebGL is Unavailable!",e.lastPinchScale=1,e.lastGestureRotate=0,e.afterLoadContent=function(){for(var e=new p.Bounds,t=0,n=this.molecules.length;t<n;t++)e.expand(this.molecules[t].getBounds3D());var i=x.dist([e.maxX,e.maxY,e.maxZ],[e.minX,e.minY,e.minZ])/2+1.5,t=45,n=Math.tan(t/360*Math.PI)/.8;this.depth=i/n;var n=_.max(this.depth-i,.1),i=this.depth+i,r=this.gl.canvas.clientWidth/this.gl.canvas.clientHeight;r<1&&(t/=r),this.specs.projectionOrthoWidth_3D=Math.tan(t/360*Math.PI)*this.depth*2*r,this.specs.projectionPerspectiveVerticalFieldOfView_3D=t,this.specs.projectionFrontCulling_3D=n,this.specs.projectionBackCulling_3D=i,this.specs.projectionWidthHeightRatio_3D=r,this.translationMatrix=y.translate(y.identity([]),[0,0,-this.depth]),this.maxDimension=_.max(e.maxX-e.minX,e.maxY-e.minY),this.setupScene()},e.setViewDistance=function(e){this.specs.projectionPerspectiveVerticalFieldOfView_3D=p.clamp(this.specs.projectionPerspectiveVerticalFieldOfView_3D/e,.1,179.9),this.specs.projectionOrthoWidth_3D=_.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*Math.PI)*this.depth*2*this.specs.projectionWidthHeightRatio_3D,this.updateScene()},e.repaint=function(){if(this.gl){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.modelViewMatrix=y.multiply(this.translationMatrix,this.rotationMatrix,[]),this.gl.rotationMatrix=this.rotationMatrix;var e=this.gl.getUniformLocation(this.gl.program,"u_projection_matrix");this.gl.uniformMatrix4fv(e,!1,this.gl.projectionMatrix),this.gl.fogging.setMode(this.specs.fog_mode_3D);for(var t=0,n=this.molecules.length;t<n;t++)this.molecules[t].render(this.gl,this.specs);for(t=0,n=this.shapes.length;t<n;t++)this.shapes[t].render(this.gl,this.specs);this.specs.compass_display&&(this.gl.uniformMatrix4fv(e,!1,this.compass.projectionMatrix),this.compass.render(this.gl,this.specs),this.gl.setMatrixUniforms(this.gl.modelViewMatrix),this.gl.uniformMatrix4fv(e,!1,this.gl.projectionMatrix)),this.gl.enable(this.gl.BLEND),this.gl.depthMask(!1),this.gl.enableVertexAttribArray(this.gl.shader.vertexTexCoordAttribute),this.specs.atoms_displayLabels_3D&&this.label3D.render(this.gl,this.specs,this.getMolecules()),this.specs.compass_display&&this.specs.compass_displayText_3D&&(this.gl.uniformMatrix4fv(e,!1,this.compass.projectionMatrix),this.compass.renderAxis(this.gl),this.gl.setMatrixUniforms(this.gl.modelViewMatrix),this.gl.uniformMatrix4fv(e,!1,this.gl.projectionMatrix)),this.gl.disableVertexAttribArray(this.gl.shader.vertexTexCoordAttribute),this.gl.disable(this.gl.BLEND),this.gl.depthMask(!0),this.gl.disable(this.gl.DEPTH_TEST),this.drawChildExtras&&this.drawChildExtras(this.gl),this.gl.enable(this.gl.DEPTH_TEST),this.gl.flush()}},e.pick=function(e,t,n,i){if(this.gl){y.multiply(this.translationMatrix,this.rotationMatrix,this.gl.modelViewMatrix),this.gl.rotationMatrix=this.rotationMatrix;var r=this.gl.getUniformLocation(this.gl.program,"u_projection_matrix");return this.gl.uniformMatrix4fv(r,!1,this.gl.projectionMatrix),this.picker.pick(this.gl,this.molecules,this.specs,e,this.height-t,n,i)}},e.center=function(){for(var e=new m.Atom,t=0,n=this.molecules.length;t<n;t++){var i=this.molecules[t];e.add3D(i.getCenter3D())}for(e.x/=this.molecules.length,e.y/=this.molecules.length,t=0,n=this.molecules.length;t<n;t++){for(var r=0,o=(i=this.molecules[t]).atoms.length;r<o;r++)i.atoms[r].sub3D(e);if(i.chains&&i.fromJSON)for(r=0,o=i.chains.length;r<o;r++)for(var a=i.chains[r],s=0,l=a.length;s<l;s++){var c=a[s];c.cp1.sub3D(e),c.cp2.sub3D(e),c.cp3&&(c.cp3.sub3D(e),c.cp4.sub3D(e),c.cp5.sub3D(e))}}},e.subCreate=function(){try{var e=t.getElementById(this.id);this.gl=e.getContext("webgl"),this.gl||(this.gl=e.getContext("experimental-webgl"))}catch(e){}this.gl?(this.rotationMatrix=y.identity([]),this.translationMatrix=y.identity([]),this.gl.viewport(0,0,this.width,this.height),this.gl.program=this.gl.createProgram(),this.gl.shader=new g.Shader,this.gl.shader.init(this.gl),this.gl.programLabel=this.gl.createProgram(),this.setupScene()):this.displayMessage()},f._Canvas.prototype.displayMessage=function(){var e=t.getElementById(this.id);e.getContext&&(e=e.getContext("2d"),this.specs.backgroundColor&&(e.fillStyle=this.specs.backgroundColor,e.fillRect(0,0,this.width,this.height)),this.emptyMessage&&(e.fillStyle="#737683",e.textAlign="center",e.textBaseline="middle",e.font="18px Helvetica, Verdana, Arial, Sans-serif",e.fillText(this.emptyMessage,this.width/2,this.height/2)))},e.renderText=function(e,t){var n;this.gl&&(n={position:[],texCoord:[],translation:[]},this.gl.textImage.pushVertexData(e,t,0,n),this.gl.textMesh.storeData(this.gl,n.position,n.texCoord,n.translation),this.gl.enable(this.gl.BLEND),this.gl.depthMask(!1),this.gl.enableVertexAttribArray(this.gl.shader.vertexTexCoordAttribute),this.gl.textImage.useTexture(this.gl),this.gl.textMesh.render(this.gl),this.gl.disableVertexAttribArray(this.gl.shader.vertexTexCoordAttribute),this.gl.disable(this.gl.BLEND),this.gl.depthMask(!0))},e.setupScene=function(){if(this.gl){E("#"+this.id).css("background-color",this.specs.backgroundColor);var e=p.getRGB(this.specs.backgroundColor,1);this.gl.clearColor(e[0],e[1],e[2],1),this.gl.clearDepth(1),this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LEQUAL),this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA),this.specs.cullBackFace_3D&&this.gl.enable(this.gl.CULL_FACE),this.gl.sphereBuffer=new g.Sphere(1,this.specs.atoms_resolution_3D,this.specs.atoms_resolution_3D),this.gl.starBuffer=new g.Star,this.gl.cylinderBuffer=new g.Cylinder(1,1,this.specs.bonds_resolution_3D),this.gl.pillBuffer=new g.Pill(this.specs.bonds_pillDiameter_3D/2,this.specs.bonds_pillHeight_3D,this.specs.bonds_pillLatitudeResolution_3D,this.specs.bonds_pillLongitudeResolution_3D),this.gl.lineBuffer=new g.Line,this.gl.lineArrowBuffer=new g.LineArrow,this.gl.arrowBuffer=new g.Arrow(.3,this.specs.compass_resolution_3D),this.gl.textMesh=new g.TextMesh,this.gl.textMesh.init(this.gl),this.gl.textImage=new g.TextImage,this.gl.textImage.init(this.gl),this.gl.textImage.updateFont(this.gl,this.specs.text_font_size,this.specs.text_font_families,this.specs.text_font_bold,this.specs.text_font_italic,this.specs.text_font_stroke_3D),this.label3D=new g.Label,this.label3D.init(this.gl,this.specs);for(var t=0,n=this.molecules.length;t<n;t++)if((e=this.molecules[t]).labelMesh instanceof g.TextMesh||(e.labelMesh=new g.TextMesh,e.labelMesh.init(this.gl)),e.unitCellVectors&&(e.unitCell=new g.UnitCell(e.unitCellVectors)),e.chains){e.ribbons=[],e.cartoons=[],e.tubes=[];for(var i=0,r=e.chains.length;i<r;i++){var o=e.chains[i],a=2<o.length&&v[o[2].name]&&"#BEA06E"===v[o[2].name].aminoColor;if(0<o.length&&!o[0].lineSegments){for(var s=0,l=o.length-1;s<l;s++)o[s].setup(o[s+1].cp1,a?1:this.specs.proteins_horizontalResolution);if(!a)for(s=1,l=o.length-1;s<l;s++)d.vec3AngleFrom(o[s-1].D,o[s].D)>_.PI/2&&(o[s].guidePointsSmall.reverse(),o[s].guidePointsLarge.reverse(),x.scale(o[s].D,-1));for(s=1,l=o.length-3;s<l;s++)o[s].computeLineSegments(o[s-1],o[s+1],o[s+2],!a,a?this.specs.nucleics_verticalResolution:this.specs.proteins_verticalResolution);o.pop(),o.pop(),o.pop(),o.shift()}var c="rgb("+(s=p.hsl2rgb(1===r?.5:i/r,1,.5))[0]+","+s[1]+","+s[2]+")";if(o.chainColor=c,a)(s=new g.Tube(o,this.specs.nucleics_tubeThickness,this.specs.nucleics_tubeResolution_3D)).chainColor=c,e.tubes.push(s);else{for((a={front:new g.Ribbon(o,this.specs.proteins_ribbonThickness,!1),back:new g.Ribbon(o,-this.specs.proteins_ribbonThickness,!1)}).front.chainColor=c,a.back.chainColor=c,s=0,l=a.front.segments.length;s<l;s++)a.front.segments[s].chainColor=c;for(s=0,l=a.back.segments.length;s<l;s++)a.back.segments[s].chainColor=c;for(e.ribbons.push(a),(o={front:new g.Ribbon(o,this.specs.proteins_ribbonThickness,!0),back:new g.Ribbon(o,-this.specs.proteins_ribbonThickness,!0)}).front.chainColor=c,o.back.chainColor=c,s=0,l=o.front.segments.length;s<l;s++)o.front.segments[s].chainColor=c;for(s=0,l=o.back.segments.length;s<l;s++)o.back.segments[s].chainColor=c;for(s=0,l=o.front.cartoonSegments.length;s<l;s++)o.front.cartoonSegments[s].chainColor=c;for(s=0,l=o.back.cartoonSegments.length;s<l;s++)o.back.cartoonSegments[s].chainColor=c;e.cartoons.push(o)}}}if(this.label3D.updateVerticesBuffer(this.gl,this.getMolecules(),this.specs),this instanceof f.MovieCanvas3D&&this.frames)for(s=0,l=this.frames.length;s<l;s++){for(i=0,r=(t=this.frames[s]).mols.length;i<r;i++)(e=t.mols[i]).labelMesh instanceof m.d3.TextMesh||(e.labelMesh=new m.d3.TextMesh,e.labelMesh.init(this.gl));this.label3D.updateVerticesBuffer(this.gl,t.mols,this.specs)}this.gl.lighting=new g.Light(this.specs.lightDiffuseColor_3D,this.specs.lightSpecularColor_3D,this.specs.lightDirection_3D),this.gl.lighting.lightScene(this.gl),this.gl.material=new g.Material(this.gl),this.gl.fogging=new g.Fog(this.gl),this.gl.fogging.setTempParameter(this.specs.fog_color_3D||this.specs.backgroundColor,this.specs.fog_start_3D,this.specs.fog_end_3D,this.specs.fog_density_3D),this.compass=new g.Compass(this.gl,this.specs),e=this.width/this.height,this.specs.projectionWidthHeightRatio_3D&&(e=this.specs.projectionWidthHeightRatio_3D),this.gl.projectionMatrix=this.specs.projectionPerspective_3D?y.perspective(this.specs.projectionPerspectiveVerticalFieldOfView_3D,e,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D):y.ortho(-this.specs.projectionOrthoWidth_3D/2,this.specs.projectionOrthoWidth_3D/2,-this.specs.projectionOrthoWidth_3D/2/e,this.specs.projectionOrthoWidth_3D/2/e,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D),e=this.gl.getUniformLocation(this.gl.program,"u_projection_matrix"),this.gl.uniformMatrix4fv(e,!1,this.gl.projectionMatrix);var u=this.gl.getUniformLocation(this.gl.program,"u_model_view_matrix"),h=this.gl.getUniformLocation(this.gl.program,"u_normal_matrix");this.gl.setMatrixUniforms=function(e){this.uniformMatrix4fv(u,!1,e),e=b.transpose(y.toInverseMat3(e,[])),this.uniformMatrix3fv(h,!1,e)},i=this.gl.getUniformLocation(this.gl.program,"u_dimension"),this.gl.uniformMatrix4fv(e,!1,this.gl.projectionMatrix),this.gl.uniform2f(i,this.gl.canvas.clientWidth,this.gl.canvas.clientHeight),this.picker=new g.Picker,this.picker.init(this.gl),this.picker.setDimension(this.gl,this.width,this.height)}},e.updateScene=function(){this.gl.fogging.setTempParameter(this.specs.fog_color_3D||this.specs.backgroundColor,this.specs.fog_start_3D,this.specs.fog_end_3D,this.specs.fog_density_3D);var e=this.width/this.height;this.specs.projectionWidthHeightRatio_3D&&(e=this.specs.projectionWidthHeightRatio_3D),this.gl.projectionMatrix=this.specs.projectionPerspective_3D?y.perspective(this.specs.projectionPerspectiveVerticalFieldOfView_3D,e,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D):y.ortho(-this.specs.projectionOrthoWidth_3D/2,this.specs.projectionOrthoWidth_3D/2,-this.specs.projectionOrthoWidth_3D/2/e,this.specs.projectionOrthoWidth_3D/2/e,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D),this.repaint()},e.mousedown=function(e){this.lastPoint=e.p},e.mouseup=function(){this.lastPoint=void 0},e.rightmousedown=function(e){this.lastPoint=e.p},e.drag=function(e){var t,n;this.lastPoint&&(f.monitor.ALT?((t=new m.Point(e.p.x,e.p.y)).sub(this.lastPoint),n=_.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*_.PI),n=this.depth/(this.height/2/n),y.translate(this.translationMatrix,[t.x*n,-t.y*n,0])):(n=e.p.x-this.lastPoint.x,t=e.p.y-this.lastPoint.y,n=y.rotate(y.identity([]),n*_.PI/180,[0,1,0]),y.rotate(n,t*_.PI/180,[1,0,0]),this.rotationMatrix=y.multiply(n,this.rotationMatrix)),this.lastPoint=e.p,this.repaint())},e.mousewheel=function(e,t){var n=this.specs.projectionPerspectiveVerticalFieldOfView_3D+t;this.specs.projectionPerspectiveVerticalFieldOfView_3D=n<.1?.1:179.9<n?179.9:n,this.specs.projectionOrthoWidth_3D=Math.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*Math.PI)*this.depth*2*this.specs.projectionWidthHeightRatio_3D,this.updateScene()},e.multitouchmove=function(e,t){var n,i;2===t&&(this.lastPoint.multi?((n=new m.Point(e.p.x,e.p.y)).sub(this.lastPoint),i=_.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*_.PI),i=this.depth/(this.height/2/i),y.translate(this.translationMatrix,[n.x*i,-n.y*i,0]),this.lastPoint=e.p,this.repaint()):(this.lastPoint=e.p,this.lastPoint.multi=!0))},e.gesturechange=function(e){var t;0!=e.originalEvent.scale-this.lastPinchScale&&(t=this.specs.projectionPerspectiveVerticalFieldOfView_3D+30*-(e.originalEvent.scale/this.lastPinchScale-1),this.specs.projectionPerspectiveVerticalFieldOfView_3D=t<.1?.1:179.9<t?179.9:t,this.specs.projectionOrthoWidth_3D=Math.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*Math.PI)*this.depth*2*this.specs.projectionWidthHeightRatio_3D,this.updateScene(),this.lastPinchScale=e.originalEvent.scale),this.repaint()},e.gestureend=function(){this.lastPinchScale=1,this.lastGestureRotate=0}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.RESIDUE,Math,document,ChemDoodle.lib.mat4,ChemDoodle.lib.mat3,ChemDoodle.lib.vec3,ChemDoodle.lib.jQuery,window),function(e,n,r,o){e.MolGrabberCanvas3D=function(e,t,n){e&&this.create(e,t,n),(t=[]).push('<br><input type="text" id="'),t.push(e),t.push('_query" size="32" value="" />'),t.push("<br><nobr>"),t.push('<select id="'),t.push(e),t.push('_select">'),t.push('<option value="pubchem" selected>PubChem'),t.push("</select>"),t.push('<button id="'),t.push(e),t.push('_submit">Show Molecule</button>'),t.push("</nobr>"),o.writeln(t.join(""));var i=this;r("#"+e+"_submit").click(function(){i.search()}),r("#"+e+"_query").keypress(function(e){13===e.which&&i.search()})},(e=e.MolGrabberCanvas3D.prototype=new e._Canvas3D).setSearchTerm=function(e){r("#"+this.id+"_query").val(e),this.search()},e.search=function(){var t=this;n.getMoleculeFromDatabase(r("#"+this.id+"_query").val(),{database:r("#"+this.id+"_select").val(),dimension:3},function(e){t.loadMolecule(e)})}}(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.lib.jQuery,document),function(e,c){e.MovieCanvas3D=function(e,t,n){e&&this.create(e,t,n),this.frames=[]},e.MovieCanvas3D.PLAY_ONCE=0,e.MovieCanvas3D.PLAY_LOOP=1,e.MovieCanvas3D.PLAY_SPRING=2;var t=e.MovieCanvas3D.prototype=new e._Canvas3D;t.timeout=50,t.frameNumber=0,t.playMode=2,t.reverse=!1,t.startAnimation=e._AnimatorCanvas.prototype.startAnimation,t.stopAnimation=e._AnimatorCanvas.prototype.stopAnimation,t.isRunning=e._AnimatorCanvas.prototype.isRunning,t.dblclick=e.RotatorCanvas.prototype.dblclick,t.nextFrame=function(){var e=this.frames[this.frameNumber];this.molecules=e.mols,this.shapes=e.shapes,2===this.playMode&&this.reverse?(this.frameNumber--,this.frameNumber<0&&(this.frameNumber=1,this.reverse=!1)):(this.frameNumber++,this.frameNumber>=this.frames.length&&(2===this.playMode?(this.frameNumber-=2,this.reverse=!0):(this.frameNumber=0)===this.playMode&&this.stopAnimation()))},t.center=function(){for(var e=new c.Atom,t=this.frames[0],n=0,i=t.mols.length;n<i;n++)e.add3D(t.mols[n].getCenter3D());e.x/=t.mols.length,e.y/=t.mols.length,(t=new c.Atom).sub3D(e);for(var e=0,r=this.frames.length;e<r;e++)for(var o=this.frames[e],n=0,i=o.mols.length;n<i;n++)for(var a=o.mols[n],s=0,l=a.atoms.length;s<l;s++)a.atoms[s].add3D(t)},t.addFrame=function(e,t){this.frames.push({mols:e,shapes:t})}}(ChemDoodle,ChemDoodle.structures),function(e,t,n){var i=[],r=[1,0,0],o=[0,1,0],a=[0,0,1];e.RotatorCanvas3D=function(e,t,n){e&&this.create(e,t,n)};var s=e.RotatorCanvas3D.prototype=new e._Canvas3D;s.timeout=33,t=t.PI/15,s.xIncrement=t,s.yIncrement=t,s.zIncrement=t,s.startAnimation=e._AnimatorCanvas.prototype.startAnimation,s.stopAnimation=e._AnimatorCanvas.prototype.stopAnimation,s.isRunning=e._AnimatorCanvas.prototype.isRunning,s.dblclick=e.RotatorCanvas.prototype.dblclick,s.mousedown=void 0,s.rightmousedown=void 0,s.drag=void 0,s.mousewheel=void 0,s.nextFrame=function(e){0===this.molecules.length&&0===this.shapes.length?this.stopAnimation():(n.identity(i),e/=1e3,n.rotate(i,this.xIncrement*e,r),n.rotate(i,this.yIncrement*e,o),n.rotate(i,this.zIncrement*e,a),n.multiply(this.rotationMatrix,i))}}(ChemDoodle,Math,ChemDoodle.lib.mat4),function(e){e.TransformCanvas3D=function(e,t,n){e&&this.create(e,t,n)},e.TransformCanvas3D.prototype=new e._Canvas3D}(ChemDoodle),function(e){e.ViewerCanvas3D=function(e,t,n){e&&this.create(e,t,n)},(e=e.ViewerCanvas3D.prototype=new e._Canvas3D).mousedown=void 0,e.rightmousedown=void 0,e.drag=void 0,e.mousewheel=void 0}(ChemDoodle),function(a,r,o){function s(e,t,n,i){this.element=e,this.x=t,this.y=n,this.dimension=i}a.PeriodicTableCanvas=function(e,t){this.padding=5,e&&this.create(e,18*t+2*this.padding,10*t+2*this.padding),this.cellDimension=t||20,this.setupTable(),this.repaint()};var e=a.PeriodicTableCanvas.prototype=new a._Canvas;e.loadMolecule=void 0,e.getMolecule=void 0,e.getHoveredElement=function(){if(this.hovered)return this.hovered.element},e.innerRepaint=function(e){for(var t=0,n=this.cells.length;t<n;t++)this.drawCell(e,this.specs,this.cells[t]);this.hovered&&this.drawCell(e,this.specs,this.hovered),this.selected&&this.drawCell(e,this.specs,this.selected)},e.setupTable=function(){this.cells=[];for(var e=this.padding,t=this.padding,n=0,i=0,r=a.SYMBOLS.length;i<r;i++){18===n&&(n=0,t+=this.cellDimension,e=this.padding);var o=a.ELEMENT[a.SYMBOLS[i]];2===o.atomicNumber?(e+=16*this.cellDimension,n+=16):5!==o.atomicNumber&&13!==o.atomicNumber||(e+=10*this.cellDimension,n+=10),(o.atomicNumber<58||71<o.atomicNumber&&o.atomicNumber<90||103<o.atomicNumber)&&o.atomicNumber<113&&(this.cells.push(new s(o,e,t,this.cellDimension)),e+=this.cellDimension,n++)}for(t+=2*this.cellDimension,e=3*this.cellDimension+this.padding,i=57;i<104;i++)90===(o=a.ELEMENT[a.SYMBOLS[i]]).atomicNumber&&(t+=this.cellDimension,e=3*this.cellDimension+this.padding),(58<=o.atomicNumber&&o.atomicNumber<=71||90<=o.atomicNumber&&o.atomicNumber<=103)&&(this.cells.push(new s(o,e,t,this.cellDimension)),e+=this.cellDimension)},e.drawCell=function(e,t,n){var i=e.createRadialGradient(n.x+n.dimension/3,n.y+n.dimension/3,1.5*n.dimension,n.x+n.dimension/3,n.y+n.dimension/3,n.dimension/10);i.addColorStop(0,"#000000"),i.addColorStop(.7,n.element.jmolColor),i.addColorStop(1,"#FFFFFF"),e.fillStyle=i,r.contextRoundRect(e,n.x,n.y,n.dimension,n.dimension,n.dimension/8),n!==this.hovered&&n!==this.selected||(e.lineWidth=2,e.strokeStyle="#c10000",e.stroke(),e.fillStyle="white"),e.fill(),e.font=r.getFontString(t.text_font_size,t.text_font_families),e.fillStyle=t.text_color,e.textAlign="center",e.textBaseline="middle",e.fillText(n.element.symbol,n.x+n.dimension/2,n.y+n.dimension/2)},e.click=function(){this.hovered&&(this.selected=this.hovered,this.repaint())},e.touchstart=function(e){this.mousemove(e)},e.mousemove=function(e){var t=e.p.x;e=e.p.y,this.hovered=void 0;for(var n=0,i=this.cells.length;n<i;n++){var r=this.cells[n];if(o.isBetween(t,r.x,r.x+r.dimension)&&o.isBetween(e,r.y,r.y+r.dimension)){this.hovered=r;break}}this.repaint()},e.mouseout=function(){this.hovered=void 0,this.repaint()}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,document),function(e,t,n){e.png={},e.png.create=function(e){n.open(t.getElementById(e.id).toDataURL("image/png"))}}(ChemDoodle.io,document,window),function(e,n){e.file={},e.file.content=function(e,t){n.get(e,"",t)}}(ChemDoodle.io,ChemDoodle.lib.jQuery),function(r,o,e,a,s,t){o.SERVER_URL="http://ichemlabs.cloud.chemdoodle.com/icl_cdc_v060001/WebHQ",o.inRelay=!1,o.asynchronous=!0,o.INFO={userAgent:navigator.userAgent,v_cwc:r.getVersion(),v_jQuery:s.version,v_jQuery_ui:s.ui?s.ui.version:"N/A"};var l=new e.JSONInterpreter,c=new a.Queue;o.useHTTPS=function(){o.SERVER_URL="https"+o.SERVER_URL.substr(4)},o._contactServer=function(t,e,n,i,r){this.inRelay?c.enqueue({call:t,content:e,options:n,callback:i,errorback:r}):(o.inRelay=!0,s.ajax({dataType:"text",type:"POST",data:JSON.stringify({call:t,content:e,options:n,info:o.INFO}),url:this.SERVER_URL,success:function(e){(e=JSON.parse(e)).message&&alert(e.message),o.inRelay=!1,i&&e.content&&!e.stop&&i(e.content),e.stop&&r&&r(),c.isEmpty()||(e=c.dequeue(),o.contactServer(e.call,e.content,e.options,e.callback,e.errorback))},error:function(){var e;"checkForUpdates"!=t&&alert("Call failed. Please try again. If you continue to see this message, please contact iChemLabs customer support."),o.inRelay=!1,r&&r(),c.isEmpty()||(e=c.dequeue(),o.contactServer(e.call,e.content,e.options,e.callback,e.errorback))},xhrFields:{withCredentials:!0},async:o.asynchronous}))},o.authenticate=function(e,t,n,i){this._contactServer("authenticate",{credential:e},t,function(e){n(e)},i)},o.calculate=function(e,t,n,i){this._contactServer("calculate",{mol:l.molTo(e)},t,function(e){n(e)},i)},o.createLewisDotStructure=function(e,t,n,i){this._contactServer("createLewisDot",{mol:l.molTo(e)},t,function(e){n(l.molFrom(e.mol))},i)},o.generateImage=function(e,t,n,i){this._contactServer("generateImage",{mol:l.molTo(e)},t,function(e){n(e.link)},i)},o.generateIUPACName=function(e,t,n,i){this._contactServer("generateIUPACName",{mol:l.molTo(e)},t,function(e){n(e.iupac)},i)},o.getAd=function(t,e){this._contactServer("getAd",{},{},function(e){t(e.image_url,e.target_url)},e)},o.getMoleculeFromContent=function(e,t,r,n){this._contactServer("getMoleculeFromContent",{content:e},t,function(e){for(var t=!1,n=0,i=e.mol.a.length;n<i;n++)if(0!==e.mol.a[n].z){t=!0;break}if(t)for(n=0,i=e.mol.a.length;n<i;n++)e.mol.a[n].x/=20,e.mol.a[n].y/=20,e.mol.a[n].z/=20;r(l.molFrom(e.mol))},n)},o.getMoleculeFromDatabase=function(e,i,r,t){this._contactServer("getMoleculeFromDatabase",{query:e},i,function(e){if(3===i.dimension)for(var t=0,n=e.mol.a.length;t<n;t++)e.mol.a[t].x/=20,e.mol.a[t].y/=-20,e.mol.a[t].z/=20;r(l.molFrom(e.mol))},t)},o.getOptimizedPDBStructure=function(e,t,n,i){this._contactServer("getOptimizedPDBStructure",{id:e},t,function(e){var t=e.mol?l.molFrom(e.mol):new a.Molecule;t.chains=l.chainsFrom(e.ribbons),t.fromJSON=!0,n(t)},i)},o.getZeoliteFromIZA=function(e,t,n,i){this._contactServer("getZeoliteFromIZA",{query:e},t,function(e){n(ChemDoodle.readCIF(e.cif,t.xSuper,t.ySuper,t.zSuper))},i)},o.isGraphIsomorphism=function(e,t,n,i,r){this._contactServer("isGraphIsomorphism",{arrow:l.molTo(e),target:l.molTo(t)},n,function(e){i(e.value)},r)},o.isSubgraphIsomorphism=function(e,t,n,i,r){this._contactServer("isSubgraphIsomorphism",{arrow:l.molTo(e),target:l.molTo(t)},n,function(e){i(e.value)},r)},o.kekulize=function(e,t,n,i){this._contactServer("kekulize",{mol:l.molTo(e)},t,function(e){n(l.molFrom(e.mol))},i)},o.optimize=function(i,r,o,e){this._contactServer("optimize",{mol:l.molTo(i)},r,function(e){if(e=l.molFrom(e.mol),2===r.dimension){for(var t=0,n=e.atoms.length;t<n;t++)i.atoms[t].x=e.atoms[t].x,i.atoms[t].y=e.atoms[t].y;o()}else if(3===r.dimension){for(t=0,n=e.atoms.length;t<n;t++)e.atoms[t].x/=20,e.atoms[t].y/=-20,e.atoms[t].z/=20;o(e)}},e)},o.readIUPACName=function(e,t,n,i){this._contactServer("readIUPACName",{iupac:e},t,function(e){n(l.molFrom(e.mol))},i)},o.readSMILES=function(e,t,n,i){this._contactServer("readSMILES",{smiles:e},t,function(e){n(l.molFrom(e.mol))},i)},o.saveFile=function(e,t,n,i){this._contactServer("saveFile",{mol:l.molTo(e)},t,function(e){n(e.link)},i)},o.simulate13CNMR=function(e,t,n,i){t.nucleus="C",t.isotope=13,this._contactServer("simulateNMR",{mol:l.molTo(e)},t,function(e){n(r.readJCAMP(e.jcamp))},i)},o.simulate1HNMR=function(e,t,n,i){t.nucleus="H",t.isotope=1,this._contactServer("simulateNMR",{mol:l.molTo(e)},t,function(e){n(r.readJCAMP(e.jcamp))},i)},o.simulateMassParentPeak=function(e,t,n,i){this._contactServer("simulateMassParentPeak",{mol:l.molTo(e)},t,function(e){n(r.readJCAMP(e.jcamp))},i)},o.writeSMILES=function(e,t,n,i){this._contactServer("writeSMILES",{mol:l.molTo(e)},t,function(e){n(e.smiles)},i)},o.version=function(e,t,n){this._contactServer("version",{},e,function(e){t(e.value)},n)},o.checkForUpdates=function(e){this._contactServer("checkForUpdates",{value:t.href},e,function(){},function(){})}}(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery,location);